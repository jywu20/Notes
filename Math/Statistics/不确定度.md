# 统计

## 不确定度

### 不确定度的三种来源

#### A类不确定度：多次测量
在相同的条件下对某个物理量做n次**独立测量**，测得值为$x_1, x_2, \ldots$，则有
$$
\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i,
$$
这个平均值是测量结果的最佳值，其不确定度
$$
u_A(\bar{x}) = t \sqrt{\frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n(n-1)}}.
$$
$t$因子的值由测量次数和置信概率（真值落在$\bar{x}\plusmn u_A(x)$范围内的概率）确定，测量次数较少时大于1，测量次数比较多且置信概率取0.683时趋向于1。在$n>10$时$t$已经小于1.01，此时可以直接取$t=1$。

A类不确定度的计算实际上已经涵盖了B1类不确定度，因此多次测量不需要计算B1类不确定度。B1类不确定度和A类不确定度同时出现的计算一定是错误的。

#### B1类不确定度：单次测量的估读

B1类不确定度指的是物理量单次测量的不确定度。它可以由估读引起，也可以由数字显示屏的示数的波动引起。
设$d$为仪器的分度值，则
$$
u_{B1}(x) = \frac{d}{\lambda},
$$
$\lambda$常见的取值有1/10, 1/5, 1/2, 1或更大。数字式仪器如果要考虑不确定度，可以取最后一位的数量级。

以下是三种仪器的B1类不确定度的评定方法：

- 游标类，即通过两个尺上的刻度对齐来读数的仪器，如游标卡尺。此时通常取$\lambda=1$，因为没有估读，对刻度对齐的位置判断不准确直接会导致最小分度值量级的误差；
- 数字显示类或者步进仪表盘类，同样不能估读，小的扰动会让示数差上一格，因此取$\lambda=1$；
- 指针式或刻度式仪表，如直尺，可以估读，$\lambda$取为让$d/\lambda$为有意义的最小估读值的$\lambda$。

很多时候使用数字显示屏的仪器可以省略这个不确定度。

#### B2类不确定度：仪器误差

B2类不确定度来自仪器本身带来的误差。设$a$为不确定度限值，则有
$$
u_{B2}(x) = \frac{a}{c},
$$
其中$c$是一个与一起不确定度的概率分布有关的常数，称为置信因子。在正态分布、均匀分布、三角形分布时分别有$c=3,\sqrt{3}, \sqrt{6}$。这些分布都是有可能的，例如由于热胀冷缩，刻度会有一个均匀分布的误差，而由于加工精度，刻度会有一个正态分布的误差。由于通常仪器加工比较精密，在没有关于仪器的更多信息时可以简单地认为仪器误差分布为均匀分布。

### 不确定度的合成
如果一个物理量的测量中有若干个相互独立的不确定度，那么最后总的不确定度是这些不确定度平方和开根号的结果。

#### 多次测量
对同一个量多次测量时不确定度为
$$
u(x) = \sqrt{u_A^2(x) + u_{B2}^2(x)} = \sqrt{t^2 \frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n(n-1)} + \frac{a^2}{c^2}}.
$$
这里$n(n-1)$的分母是因为什么？

#### 单次测量
$$
u(x) = \sqrt{u_{B1}^2(x) + u_{B2}^2(x)} = \sqrt{\frac{d^2}{\lambda^2} + \frac{a^2}{c^2}}.
$$

#### 使用同一个仪器单次测量两个量的差值
$$
x = x_1 - x_2, \\
u(x) = \sqrt{u_{B1}^2(x_1) + u_{B1}^2(x_2) + u_{B2}^2(x)}.
$$
注意$u_{B2}$只计算一次。这里不能使用后面的加减法合成公式来做，因为$x_1,x_2$的不确定度不是完全独立的，它们的仪器不确定度是有关系的。

#### 使用同一个仪器多次测量两个量以计算差值

#### 不同来源测量同一个量取平均值后的不确定度
我都很怀疑这个操作是不是合理的……

### 不确定度的传递
$$
y = f(x_1, x_2, \ldots, x_n),
$$
$$
u(y) = \sqrt{\sum_{i=1}^n\left(\frac{\partial f}{\partial x_i}\right)^2 u^2(x_i)}.
$$

#### 加减法
$$
y = x_1 + x_2,
$$
$$
u(y) = \sqrt{u^2(x_1) + u^2(x_2)}, \quad u^2(y) = u^2(x_1) + u^2(x_2).
$$

#### 乘除法
$$
y = x_1 x_2,
$$
$$
u(y) = \sqrt{x_2^2 u^2(x_1) + x_1^2 u^2(x_2)}, \quad \frac{u^2(y)}{y^2} = \frac{u^2(x_1)}{x_1^2} + \frac{u^2(x_2)}{x_2^2}.
$$

$$
y = \frac{x_1}{x_2},
$$
$$
u(y) = \sqrt{\frac{1}{x_2^2}u^2(x_1) + \frac{x_1^2}{x_2^4}u^2(x_2)}, \quad \frac{u^2(y)}{y^2} = \frac{u^2(x_1)}{x_1^2} + \frac{u^2(x_2)}{x_2^2}.
$$
因此对乘除法统一有
$$
\frac{u^2(y)}{y^2} = \frac{u^2(x_1)}{x_1^2} + \frac{u^2(x_2)}{x_2^2}.
$$

#### 乘方与开方
$$
y = x^n,
$$
$$
u(y) = nx^{n-1} u(x), \frac{u(y)}{y} = n \frac{u(x)}{x}.
$$

#### 单项式
$$
y = \mathrm{const} \cdot x_1^{n_1}x_2^{n_2}\ldots x_m^{n_m},
$$
$$
\frac{u(y)}{y} = \sqrt{\sum_{i=1}^m \left( n_i \frac{u(x_i)}{x_i} \right)^2}.
$$
注意$n_i$可以取负数，但由于平方运算不管它取正还是取负结果都是一样的。这个公式实际上对所有齐次的运算都成立。

#### 最小二乘法
最小二乘法拟合的不确定度：
$$
\hat{y} = a \hat{x} + b, \\
u(a) \approx a \sqrt{\frac{1-r^2}{r^2 (n-2)}}, u(b) \approx a \sqrt{\frac{(a-r^2) \sum_{i = 1}^n x_i^2}{r^2 n (n-2)}}
$$
