\documentclass[hyperref, UTF8, a4paper]{ctexbook}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{simplewick}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{siunitx}
\usepackage{slashed}
\usepackage{centernot}
\usepackage{tikz}
\usepackage{tikz-feynhand}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\comment}{\paragraph{注记}}
\newcommand{\fsl}[1]{{\centernot{#1}}}
\newcommand*{\reals}{\mathbb{R}}
\newcommand*{\complexes}{\mathbb{C}}

\newcommand*{\fd}[1]{\mathcal{D} #1}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\newenvironment{bigcase}{\left\{\quad\begin{aligned}}{\end{aligned}\right.}

\newcommand{\concept}[1]{\underline{\textbf{#1}}}
\renewcommand{\emph}{\textbf}

\tikzfeynhandset{
    every boldfermion@@/.style={
    /tikz/draw=none,
    /tikz/decoration={name=none},
    /tikz/postaction={
            /tikz/draw,
            /tikz/double,
            /tikz/line width = \feynhandlinesize,
            /tikzfeynhand/with arrow=0.5,
        },
    },
    every boldfermion/.style={/tikzfeynhand/every boldfermion@@/.append style={#1}},
    boldfermion/.style={
    /tikzfeynhand/every boldfermion@@,
    }
}

\allowdisplaybreaks[4]

\title{相对论性量子场论}
\author{吴晋渊}

\begin{document}

\maketitle

\vspace{2em}

如无特殊说明，本文所谓的本征态指的都是归一化。
希腊字母的指标跑遍所有时空维度，而拉丁字母的指标仅仅跑遍空间维度，也就是$\mu, \nu, \ldots = 0, 1, 2, 3$而$i, j, \ldots = 1, 2, 3$。
常规斜体字母$x, y, p$等若经说明为多分量对象，默认为四维矢量，相应的，$\vb*{x}, \vb*{y}, \vb*{p}$等为它们的空间部分。
常规斜体字母的点乘表示四维矢量乘法，如
\[
    p^2 = \omega^2 - \abs{\vb*{p}}^2, \quad x \cdot y = x^0 y^0 - \vb*{x} \cdot \vb*{y} = t_x t_y - \vb*{x} \cdot \vb*{y}.
\]
指标$a,b,\ldots$也有可能指各种多分量对象的指标，未必正好取$1, 2, 3$。
$T$表示编时算符，$N$表示正规序算符。

张量的分量矩阵默认以排在前面的指标为行指标，以排在后面的指标为列指标。

% 本文将略去所有最为基础的formalism：量子力学的基本框架——包括路径积分和正则形式，无论是关于单粒子的还是关于场的；如何将多粒子态写成场的激发态（即所谓二次量子化）；微扰论

\part{相对论性量子场论}

\input{symmetry.tex}

\input{fields.tex}

\input{observe.tex}

\part{规范场论}

如果一个体系在宇称变换之下不变，那么不可能仅仅使用一个左手旋量或者一个右手旋量描述它，因为宇称变换会改变旋量的手征。
因此，完整描述一个体系的物理量一定能够写成一对一对相互匹配的左手旋量和右手旋量。
我们称像这样由一个左手旋量和一个右手旋量组合而成的场
\begin{equation}
    \psi = \pmqty{\chi_L \\ \xi_R}
\end{equation}
为\concept{狄拉克旋量}。它是洛伦兹群的一个可约表示，因为其变换矩阵
\begin{equation}
    \Lambda_\text{Dirac} = \pmqty{\dmat{\Lambda_{(\frac{1}{2}, 0)}, \Lambda_{(0, \frac{1}{2})}}}
\end{equation}
是左手旋量和右手旋量的变换矩阵直和起来得到的结果。
现在我们做一个宇称变换，那么变换矩阵就成为
\[
    \Lambda'_\text{Dirac} = \pmqty{\dmat{\Lambda_{(0, \frac{1}{2})}, \Lambda_{(\frac{1}{2}, 0)}}}.
\]
因此，考虑宇称变换在狄拉克旋量上的表示$(\Lambda_P)_\text{Dirac}$，我们有
\[
    (\Lambda_P)_\text{Dirac} \Lambda_\text{Dirac} (\Lambda_P)_\text{Dirac}^{-1} = \Lambda'_\text{Dirac},
\]
于是
\[
    (\Lambda_P)_\text{Dirac} = a \pmqty{0 & I_{2\times 2} \\ I_{2 \times 2} & 0}.
\]
由于我们考虑的是幺正表示，$a$的模长为1。
请注意宇称变换、时间反演变换和恒等变换自成一个群，因此从有关正规洛伦兹群的表示的任何知识——它们是通过考虑正规洛伦兹群的李代数得到的，和宇称变换没有任何关系——都不可能把$a$的值确定下来。
不失一般性地%TODO：怎么就不失一般性了？？
通常取$a=1$，于是就有
\begin{equation}
    (\Lambda_P)_\text{Dirac} = \pmqty{0 & I_{2\times 2} \\ I_{2 \times 2} & 0}.
\end{equation}
那么狄拉克旋量在宇称变换下的变化就是
\begin{equation}
    \psi \stackrel{\Lambda_P}{\longrightarrow} \psi^P = \pmqty{0 & I_{2\times 2} \\ I_{2 \times 2} & 0} \pmqty{\chi_L \\ \xi_R} = \pmqty{\xi_R \\ \chi_L}.
\end{equation}
也就是说宇称变换把狄拉克旋量变成了另一个同样具有$\chi_L$和$\xi_R$的对象，但是上下位置发生了变化。

狄拉克旋量上可以定义一种重要的变换。它不是洛伦兹变换的一种，其形式为
\begin{equation}
    \psi = \pmqty{\chi_L \\ \xi_R} \longrightarrow \psi^C = \pmqty{\xi_L \\ \chi_R}.
\end{equation}
容易看出变换之后得到的结果还是狄拉克旋量。

\subsubsection{无限维表示}

洛伦兹群的无限维表示完全由旋转生成元的无限维表示和推动生成元的无限维表示确定。
前者已经由\eqref{eq:rotation-inf-rep}给出了。虽然\eqref{eq:rotation-inf-rep}是在三维空间中推导出来的，但是因为推导它时各个坐标的标号和本节一致，都是$x^1, x^2, x^3$，它也适用于四维闵可夫斯基时空。
使用基本上一样的方法，从\eqref{eq:boost-generators}可以导出
\begin{equation}
    K_1 = - \ii (x^1 \partial_0 + x^0 \partial_1), \quad K_2 = - \ii (x^2 \partial_0 + x^0 \partial_2), \quad K_3 = - \ii (x^3 \partial_0 + x^0 \partial_3).
    \label{eq:boost-inf-rep}
\end{equation}

\subsection{庞加莱群}

% TODO：将下标转为上标
正规子群平移群半直积上洛伦兹群就得到了庞加莱群。

现在我们分析庞加莱群的李代数。独立的生成元总共有10个，4个是平移群生成元，3个是旋转生成元，3个是推动生成元。
平移群的李代数为\eqref{eq:comm-of-trans}，而洛伦兹群的李代数为\eqref{eq:lie-algebra-lorentz}，因此只需要$P_\mu$和$J_i,K_i$的对易关系就能够完全确定庞加莱群的李代数。
首先由于旋转操作不涉及时间维，显然我们有
\begin{equation}
    \comm*{J_i}{P_0} = 0.
\end{equation}
使用\eqref{eq:transition-inf-rep}、\eqref{eq:rotation-inf-rep}和\eqref{eq:boost-inf-rep}三式，可以推导出以下关系：
\begin{equation}
    \comm*{J_i}{P_j} = \ii \epsilon_{ijk} P_k, \quad \comm*{K_i}{P_j} = \ii \delta_{ij} P_0, \quad \comm{K_i}{P_0} = - \ii P_i.
    \label{eq:comm-k-j-p}
\end{equation}
虽然使用的是特殊的表示，但由于推导出来的都是对易关系，因此它们普遍成立。
\eqref{eq:comm-k-j-p}和\eqref{eq:lie-algebra-lorentz}给出了庞加莱群的李代数。

为了简化记号，我们设$M_{\mu \nu}$是一个反对称的矩阵，且
\begin{equation}
    J_i = \frac{1}{2} \epsilon_{ijk} M_{jk}, \quad K_i = M_{0i},
\end{equation}
那么\eqref{eq:comm-k-j-p}完全等价于
\begin{equation}
    \comm*{M_{\mu \nu}}{P_\rho} = \ii (\eta_{\mu \rho} P_\nu - \eta_{\nu \rho} P_\mu),
    \label{eq:comm-m-p}
\end{equation}
而\eqref{eq:lie-algebra-lorentz}等价于
\begin{equation}
    \comm{M_{\mu \nu}}{M_{\rho \sigma}}  = \ii (\eta_{\mu \rho} M_{\nu \sigma} + \eta_{\nu \sigma} M_{\mu \rho} - \eta_{\mu \sigma} M_{\nu \rho} - \eta_{\nu \rho} M_{\mu \sigma}).
    \label{eq:comm-m}
\end{equation}
\eqref{eq:comm-of-trans}，\eqref{eq:comm-m-p}和\eqref{eq:comm-m}共同描述了庞加莱群的李代数。
% TODO：上面的几个公式有没有指标升降？
% TODO:建立群元的升降指标关系

庞加莱群的群参数一共有10个，在定义了$M$之后我们可以把群参数写成$a^\mu$和$\omega^{\mu \nu}$，其中$\omega$是反对称矩阵，从而庞加莱群就可以写成
\[
    \Lambda = \exp \left( \ii a^\mu P_\mu + \ii \omega^{\mu \nu} M_{\mu \nu} \right).
\]
实际上，即使$\omega$不是反对称的，上式照样给出庞加莱群，因为$\omega$的对称部分和$M$相乘得到的一定是零。反对称的要求仅仅是让每个变换对应唯一一个群参数。

庞加莱群的卡西米尔元有两个，它们分别是
\begin{equation}
    P_\mu P^\mu = m^2,
    \label{eq:momentum-and-mass}
\end{equation}
和
\begin{equation}
    W_\mu W^\mu = j_1 + j_2 = j,
\end{equation}
其中
\begin{equation}
    W^\mu = \frac{1}{2} \epsilon^{\mu \nu \rho \sigma} P_\nu M_{\rho \sigma}.
\end{equation}

我们使用$P_\mu P^\mu$给出的$m^2$实际上正是该表示下场的质量的平方。详情见\autoref{sec:k-g-eq}。

\subsection{对称性操作和守恒量}

\subsubsection{连续对称性对应的守恒量}

首先是最简单的平移。处理平移时假定场是标量场，这无损一般性，因为平移没有有限维表示，因此不会导致场分量发生混合。
平移变换作用于场上得到的结果是：
\[
    \begin{split}
        x^\mu \longrightarrow {x'}^{\mu} = x^\mu + a^\mu, \\
        \bar{\var}{\phi} = \phi'(x') - \phi(x) = 0.
    \end{split}
\]
平移变换导致的场的变化（就是没有变化）的扣除了坐标变化导致的影响的场的变化就是
\[
    \var{\phi} = \bar{\var}{\phi} - \partial_\mu \phi \var{x}^\mu = - \partial_\mu \phi \var{a^\mu},
\]
或者，由于场在坐标拖曳下的变动实际上就是平移变换的无限维表示，可以直接使用\eqref{eq:transition-inf-rep}得到上式。
于是对应的守恒流为
\[
    0 = \partial_\mu \left( - \pdv{\mathcal{L}}{\partial_\mu \phi} \partial_\nu \phi \var{a^\nu} + \mathcal{L} \var{a^\mu} \right) 
    = \partial_\mu \left( - \pdv{\mathcal{L}}{\partial_\mu \phi} \partial_\nu \phi + \mathcal{L} \delta^\mu_\nu \right) \var{a^\nu},
\]
考虑到$\var{a^\mu}$的任意性，我们有
\begin{equation}
    T_\mu^\nu = \pdv{\mathcal{L}}{\partial_\nu \phi} \partial_\mu \phi - \mathcal{L} \delta^\nu_\mu, \quad \partial_\nu T_\mu^\nu = 0.
\end{equation}
我们称$T^\nu_\mu$为\concept{能动张量}。它给出了4个守恒荷，其中一个是来自时间平移不变性的\concept{能量}
\begin{equation}
    E = \int \dd[3]{x} T^0_0 = \int \dd[3]{x} \left( \pdv{\mathcal{L}}{\partial_0 \phi} \partial_0 \phi - \mathcal{L} \right) ,
    \label{eq:field-energy}
\end{equation}
很容易看出$\mu=0$时这就是在做从拉氏量到哈密顿量的勒让德变换，即上式确确实实就是能量。
另外三个是来自空间平移不变性的\concept{动量}
\begin{equation}
    P_i = \int \dd[3]{x} T^0_i = \int \dd[3]{x} \pdv{\mathcal{L}}{\partial_0 \phi} \partial_i \phi .
    \label{eq:field-momentum}
\end{equation}
能动张量的纯空间部分是能量和动量的输运流，因此就是\concept{应力张量}。%
\footnote{在非相对论连续介质力学中这些结果也是成立的，因为时间和空间平移同时出现在伽利略群和庞加莱群中。}
相应的，
\begin{equation}
    \mathcal{P}_\mu = \pdv{\mathcal{L}}{\partial_0 \phi} \partial_\mu \phi - g_\mu^0 \mathcal{L}
\end{equation}
为四维动量$(E, \vb*{p})$的密度。
在计算场的三维动量时要注意一点：由于闵可夫斯基度规为$(+, -, -, -)$，闵可夫斯基时空中空间部分的基矢量实际上是指向空间坐标减少的方向的。从而，
\[
    \begin{aligned}
        \vb*{P} &= \int \dd[3]{x} \pdv{\mathcal{L}}{\partial_0 \phi} \partial_i \phi \vb*{g}^i \\
        &= - \int \dd[3]{x} \pdv{\mathcal{L}}{\partial_0 \phi} \partial_i \phi \vb*{g}^i_{\text{3dim}},
    \end{aligned}
\]
也即
\begin{equation}
    \vb*{P} = - \int \dd[3]{\vb*{x}} \pi \grad{\phi}.
\end{equation}

接下来是旋转对称性。%
\footnote{同样，这个对称性无论是在相对论性场论还是非相对论性场论中都是成立的。}%
旋转对称性不涉及时间维，于是我们有
\[
    \var{x^i} = \epsilon^i_{\ jk}  x^j \theta^k,
\]
相应的
\[
    \bar{\var}{\phi^a} = \ii (J_i)^a_{\ b} \theta^i \phi^b - \epsilon^i_{\ jk}  x^j \theta^k \partial_i \phi^a.
\]
其中指标$a,b$跑遍$\phi$的所有分量，$J$指的是旋转生成元在$\phi$所属的向量空间上的表示，具体表达式见\autoref{sec:rotation}。
我们使用了$\epsilon^i_{jk}  x^j \theta^k$这样的记号是因为要与\eqref{eq:generators-of-so3}保持一致，因为若取$J$为\eqref{eq:generators-of-so3}，正好就有
\[
    \epsilon^i_{\ jk}  x^j \theta^k = (\ii \theta^k J_k x)^i.
\]
则诺特定理导致的守恒流为
\[
    \begin{aligned}
        0 &= \partial_0 \left( \pdv{\mathcal{L}}{\partial_0 \phi^a} \left( \ii (J_k)^a_b \theta^k \phi^b - \epsilon^i_{\ jk}  x^j \theta^k \partial_i \phi^a \right) \right) + \partial_i (\text{something}) \\
        &= \theta^k \partial_0 \left( \ii (J_k)^a_b \phi^b \pdv{\mathcal{L}}{\partial_0 \phi^a} - \epsilon^i_{\ jk} x^j \mathcal{P}_i \right) \\
        &= \theta^k \partial_0 \left( \ii (J_k)^a_b \phi^b \pdv{\mathcal{L}}{\partial_0 \phi^a} + \epsilon^i_{\ jk} x^j \mathcal{P}_i \right),
    \end{aligned}
\]
于是我们就得到了一个守恒量 % TODO:正负号
\begin{equation}
    L_k = \int \dd[3]{\vb*{x}} \left( \ii (J_k)^a_b \phi^b \pdv{\mathcal{L}}{\partial_0 \phi^a} + \epsilon^i_{\ jk} x^j \mathcal{P}_i \right).
    \label{eq:field-angular-momentum}
\end{equation}
其中的
\begin{equation}
    \mathcal{M}_k = \epsilon^i_{\ jk} x^j \mathcal{P}_i 
\end{equation}
部分和质点的角动量形式一致，称为\concept{轨道角动量}，另一部分
\begin{equation}
    \mathcal{S}_k = \ii (J_k)^a_b \phi^b \pdv{\mathcal{L}}{\partial_0 \phi^a}
    \label{eq:spin-angular-momentum}
\end{equation}
则不会出现在没有内部结构的质点的角动量内部。由于其形式和有自转的粒子除去轨道角动量以外的角动量一致，称其为\concept{自旋角动量}。
正如其名称暗示的那样，自旋角动量源自场的内禀旋转自由度，也就是说，旋转群在场上的表示不仅仅含有无穷维的表示，还含有一个有限维的表示的时候就会出现自旋角动量。
如果场是标量场，那么旋转群在其上的有限维表示就是平凡的，此时$J_i$全部为零，就没有自旋角动量。

以上推导在有相互作用时可能是不安全的，因为此时涉及多个场，且相互作用会引入额外的能量，从而难以良定义“一个场的能量”或是“一个场的动量”。

\subsubsection{宇称、正反粒子变换和时间反演}

时间反演变换造成的结果和宇称变换完全一样，除了具体的变换矩阵差一个负号。

\subsection{单粒子态与庞加莱群的表示}

我们可能常常听到这样的说法：基本粒子是庞加莱群的不可约表示，但这究竟是什么意思？我们如何将一个电子与一个抽象的群的表示矩阵联系在一起？

通过上述讨论，我们知道对于一个量子系统来说，各种对称性变换构成的李群是以幺正表示的方式（连续地、有时投影地）作用在系统的希尔伯特空间上的。具体来说，例如李群$G$中的一个元素$g\in G$，考虑其幺正表示$g\to U(g)$，此群元同样可以自伴算子的方式作用在系统的一个可观测量$A$上：$A\to U(g)AU^\dagger(g)$，后者表示一个对称性变换$g$作用在系统上后，原来的可观测量$A$的形式。此变换既可看成$g$作用在系统本身上，也可看做作用在参考系上，但其视角并不妨碍我们的讨论。

在实际的物理系统中，如果我们能通过给一些可观测量安排一些实观测值从而完全确定某些系统，那么我们把这些基础的系统称为\concept{基本粒子}。例如我们考虑最简单的体系，我们通过实验得到一些质量$m$的观测值，它们为非负实数；同时得到一系列自旋$s$的观测值，它们的可取值有$\{1/2,1,3/2,\cdots\}$，而不同的数组$(m,s)$意味着不同的基本粒子（$m$与$s$恰好为庞加莱群$\mathcal{P}$的卡西米尔元）。这些数字有如下性质：它们在（正时正规）庞加莱群的群作用下是不变的，这是显然而且必须的，因为同一类粒子的相同可观测量的观测值必然不依赖于参考系，而参考系之间的变换正是由庞加莱群所连接的。考虑量子情形，我们因此必然有相应的可观测量$M$表示质量与$S$表示自旋，并且它们在庞加莱群的群作用下是不变的，即：
\begin{equation}
	U(g)MU^\dagger(g)=M,U(g)SU^\dagger(g)=S,\forall g\in \mathcal{P}
\end{equation}
同时也必须满足有固定值，即
\begin{equation}
	M=m\boldsymbol{I},S=s\boldsymbol{I}
\end{equation}
而Wigner证明了如果满足以上两个条件，那么表示$g\to U(g)$是不可约的。\footnote{同时Wigner也证明了另一个非常重要的定理，即任何对称变换可以表示成希尔伯特空间上的算符，这个算符要么是线性且幺正的，要么是反线性且反幺正的，见Weinberg。}实际上，如果我们反过来看，由于$M$,$S$为$\mathcal{P}$的卡西米尔元，也即$\mathcal{P}$的李代数的泛包络代数中的元素，他们可以用群表示的自伴的生成元来定义，那么我们应有：$U(g)MU^\dagger(g)=M,U(g)SU^\dagger(g)=S,\forall g\in \mathcal{P}$。如果$U$是不可约表示，那么$U(g)M=MU(g),U(g)S=SU(g)$，根据舒尔引理，我们自然有$M=m\boldsymbol{I},S=s\boldsymbol{I}$，其中$s,m\in \mathbb{R}$。

Wigner根据$m$的本征值的取值将庞加莱群的非负能量不可约表示分为了三类（即Wigner's classification）：
\begin{itemize}
	\item $m>0$，即$P=(m,0,0,0)$被称为有质量态。有质量态被$\operatorname{Spin}(3)$的不可约酉表示进一步分类（即自旋）。即：
	\begin{equation}
		P^2\Psi=m^2\Psi,W^2\Psi=m^2s(s+1)\Psi
	\end{equation}
	\item $m=0,P_0>0$。这些态可以被进一步分为两类，其中一种表示被整数倍的$1/2$的数字所分类，它们被称为螺旋度；而另一种则被称为“连续自旋”表示（continuous spin representation）。即：
	\begin{equation}
		P^2\Psi=0,W^2\Psi=\mu^2\Psi
	\end{equation}
	实际上，连续自旋表示虽然符合Wigner分类的所有要求，但是事实上我们并没有观测到连续自旋的无质量粒子\footnote{温伯格言：''are not observed to have''，见其量子场论P74。}。我们也可以通过要求因果性来排除掉连续自旋表示作为实际粒子，但其证明都非常冗长\footnote{参考文献可见网页：\url{https://www.physicsoverflow.org/24751}中的推荐列表。}。
	
	对于无质量粒子，其螺旋度等于手性(chirality)（有些约定中差一个$\hbar/2$），也常常被称为自旋。但对于有质量粒子，其螺旋度被定义为自旋在动量方向上的投影。如果粒子的自旋和运动方向相同，那么其螺旋度被定义为右手的（正的），反之则是左手的。
	
	但值得注意的是，如果对于有质量粒子，观测者有可能在某些参考系下运动地比粒子“快”，那么原本的螺旋度就会反向。因此我们可以看出，有质量粒子的螺旋度并非洛伦兹协变的，虽然它是一个运动常数，而对于有质量粒子，相应的洛伦兹协变的量为手性，但它并非一个运动常数。之前我们用自旋分类了有质量粒子，但其实可以用手性进一步分类。例如，对自旋$1/2$的粒子来说，在旋转$2\pi$后，波函数会获得一个负号（旋转给波函数带上一个复相位），而粒子的手性所区分的就是在复平面上，这个复相位是如何到达$-1$的，即是“左手地”从$1$转到$-1$，还是“右手地”从$1$转到$-1$。
	
	\begin{figure}
		\centering
		
		\input{chiral.tex}
		
		\caption{当你旋转一个自旋为$1/2$的费米子时，左手与右手费米子的相位变化表现不同，反映在波函数的变化上就是偏置不同。}
	\end{figure}
	
	如果我们考虑狄拉克方程\eqref{eq:dirac-eq}在手性基下的拉格朗日量：
	\begin{equation}
		\mathcal{L}_{D}=i \psi_{L}^{\dagger} \sigma^{\mu} \partial_{\mu} \psi_{L}+i \psi_{R}^{\dagger} \bar{\sigma}^{\mu} \partial_{\mu} \psi_{R}-m \psi_{L}^{\dagger} \psi_{R}-m \psi_{R}^{\dagger} \psi_{L}
	\end{equation}
	其中$\psi_L$为手性为左的费米子（后简称左手费米子），$\psi_R$为手性为右的费米子，它们在质量项中可以相互转换。
	
	\item  $m=0,P^{\mu}=0$，这种情况被称为\concept{真空}，而并不被看成一种基本粒子。
\end{itemize}

注意，并不是所有基本粒子都可以被Wigner的分类法所分类，例如中微子的质量$m$是“震荡”的；对于夸克，其内在的对称性为$SU(3)$对称性，此时庞加莱群就不能用来定义它们了，在描述它们时我们需要引入相应的规范群。

如果你有很多基本粒子，那么系统的希尔伯特空间自然是它们单独的希尔伯特空间的张量积，那么对应的变换也是相应的不可约表示的张量积，不过总表示就不再是不可约表示了。因此后面我们会着重讨论单粒子态，随后根据基本粒子的分类讨论相应的场，如$s=0$的标量场，$s=1/2$旋量场，$s=1$的矢量场等等。

% TODO:1：所谓“粒子作为庞加莱群的表示”，这里“粒子”的概念是什么意思？此处都是纯经典的，没有经过量子化的，那么“粒子”的概念从何而来？2.为什么massless的spin-1的粒子（光子）用矢量场$A_{\mu}$描述？而$A__{\mu}$的分量不独立，四个分量有两个约束，因此只有两个自由度，那么场的自由度和粒子的螺旋度能取的值又有什么关系？同理对于massless的.spin-2的graviton，为什么广相的自由度为2恰好对应graviton的螺旋度有两个取值？为什么引力子恰好是spin-2的？


% TODO:矢量在宇称变换之下的变换

\section{单粒子态}\label{sec:single-particle}

% TODO：将本节的非相对论性内容移动到别处，而加入相对论性单粒子态的东西，尤其是动量之类；二次量子化的一般手续也要放到这里

虽然本文主要是关于相对论性量子场论的，绕过场的概念直接分析单粒子态仍然是有益的。
所谓单粒子态应该能够使用粒子位置和一些附加的自由度完全描述。

\subsection{粒子的自由度}\label{sec:single-particle-quantity}

\subsubsection{位置算符与动量算符}\label{sec:position-and-momentum}

先考虑一维的位置算符$\hat{x}$。由于我们认为$\hat{x}$对应\concept{位置}，其谱为连续谱，本征值没有上下界，而是跑遍整个实数轴%
\footnote{注意这是\concept{定义}：我们单纯构造了一个李代数，仅此而已。这一步实际上并没有用到任何物理概念。}%
。
于是，我们考虑一个可以完全由$\hat{x}$描述的希尔伯特空间$\mathcal{H}_{1\text{d}}$，在其上我们可以写出
\begin{equation}
    \hat{x} = \int \dd{x} x \dyad{x},
\end{equation}
有
\begin{equation}
    \hat{x} \ket{x'} = x' \ket{x'},
\end{equation}
其中$\ket{x'}$代表位置在$x'$的本征态。

很自然地，我们考虑空间平移群导致的物理量。空间平移群是李群，它在$\mathcal{H}_{1\text{d}}$上有幺正表示，则其生成元是厄米的，从而是一个可观察量。设%
\footnote{容易看出这代表
\[
    \hat{p} = \ii \pdv{\hat{Q}}{x},
\]
刚好和一般的定义差了一个负号。这是因为平移群对“场算符”位置$\hat{x}$的作用是
\[
    \hat{x} \stackrel{Q_\text{operator}}{\longrightarrow} \hat{x} + a,
\]
使用同一个群参数$a$，上式按照\eqref{eq:field-and-state-corr}诱导出的在态矢量上的作用就是
\[
    \ket{x} \stackrel{Q_\text{operator}}{\longrightarrow} \ket{x - a}.
\]
然而，我们通常希望空间平移群在态矢量上的作用是
\[
    \ket{x} \stackrel{Q_\text{state}}{\longrightarrow} \ket{x + a},
\]
因此为了让$Q_\text{operator}$按\eqref{eq:field-and-state-corr}诱导出的在态矢量上的作用的生成元和$Q_\text{state}$的生成元一致，在定义$Q_\text{state}$的生成元时我们特意加了一个负号。正文中的$\hat{Q}$指的都是$Q_\text{state}$。
\label{note:state-and-operator-minus-symbol}}
\begin{equation}
    \hat{Q}(\dd{x}) = \hat{I} + \frac{1}{\ii} \dd{x} \hat{p},
\end{equation}
其中$\hat{p}$是一个不显含任何参量的厄米算符。容易看出它具有动量量纲。
注意到
\[
    \begin{split}
        \hat{x} \hat{Q}(\dd{x'}) \ket{x'} = \hat{x} \ket{x' + \dd{x'}} = (x' + \dd{x'}) \ket{x' + \dd{x'}}, \\
        \hat{Q}(\dd{x'}) \hat{x} \ket{x'} = \hat{Q}(\dd{x'}) x' \ket{x'} = x' \hat{Q}(\dd{x'}) \ket{x'} = x' \ket{x' + \dd{x'}},
    \end{split}
\]
就有
\[
    [\hat{x}, \hat{Q}(\dd{x'})] \ket{x'} = \dd{x'} \ket{x' + \dd{x'}} \approx \dd{x'} \ket{x'}.
\]
考虑到$\ket{x'}$的任意性，我们得到
\[
    [\hat{x}, \hat{Q}(\dd{x'})] = \left[\hat{x}, \hat{I} + \frac{1}{\ii} \dd{x} \hat{p}\right] = \hat{I},
\]
从而
\begin{equation}
    [\hat{x}, \hat{p}] = \ii . 
    \label{eq:x-p-commutator-1d}   
\end{equation}
对易关系\eqref{eq:x-p-commutator-1d}完全确定了$\hat{x}$和$\hat{p}$的李代数结构。
实际上，完全可以使用更加简单的方法获得\eqref{eq:x-p-commutator-1d}。设一维空间平移群在$\mathcal{H}_\text{1d}$上的表示为$\hat{p}$。一维空间平移群对算符$\hat{x}$的作用的微分为
\[
    \frac{1}{\ii} \dv{a} {((x + a) - x)} = - \ii,
\]
从而由算符上的场表示和态空间上的表示之间的关系\eqref{eq:field-and-state-corr}，我们有
\[
    \comm{\hat{p}}{\hat{x}} = - \ii,
\]
就得到了\eqref{eq:x-p-commutator-1d}。

我们来分析动量算符在坐标表象下的表示。
我们有
\[
    \begin{aligned}
        (1 - \ii \hat{p} \dd{x}) \ket{\psi} &= \hat{Q}(\dd{x'}) \ket{\psi} \\
        &= \int \dd{x'} \hat{Q}(\dd{x}) \ket{x'} \braket{x'}{\psi} \\
        &= \int \dd{x'} \ket{x' + \dd{x}} \braket{x'}{\psi} \\
        &= \int \dd{x'} \ket{x'} \braket{x' - \dd{x}}{\psi} \\
        &= \int \dd{x'} \ket{x'} \left(\braket{x'}{\psi} - \dd{x} \pdv{x'} \braket{x'}{\psi} \right) \\
        &= \ket{\psi} - \dd{x} \int \dd{x'} \ket{x'} \pdv{x'} \braket{x'}{\psi}, 
    \end{aligned}
\]
从而
\begin{equation}
    \hat{p} \ket{\psi} = - \ii \int \dd{x'} \ket{x'} \pdv{x'} \braket{x'}{\psi},
\end{equation}
或者等价的，
\begin{equation}
    \mel{x}{\hat{p}}{\psi} = - \ii \pdv{x} \braket{x}{\psi}.
    \label{eq:p-in-x-representation-1d}
\end{equation}
当然，完全可以使用空间平移群在无限维空间上的表示得到这个结果；由\autoref{note:state-and-operator-minus-symbol}，虽然使用同一个群参数的空间平移群在算符$\hat{x}$和态$\ket{x}$上的作用正好是相反的，但由于定义$\hat{p}$时已经考虑了这一点，从\eqref{eq:transition-inf-rep}就能够得到\eqref{eq:p-in-x-representation-1d}。

从\eqref{eq:p-in-x-representation-1d}可以导出位置的本征态和动量本征态之间的切换关系。取$\ket{\psi}$为$\ket{p}$，我们有
\[
    \mel{x}{\hat{p}}{p} = - \ii \pdv{x} \braket{x}{p} = \mel{x}{p}{p} = p \braket{x}{p},
\]
即微分方程
\[
    \pdv{x} \braket{x}{p} = \ii p \braket{x}{p},
\]
从而
\[
    \braket{x}{p} = C \ee^{\ii p x}.
\]
由于总是可以在所有$\ket{p}$上一起乘上一个模长为1的常数而不产生任何影响，不失一般性地我们取$C$为实数。
归一化条件为
\[
    \delta(p - p') = \braket{p}{p'} = \int \dd{x} \braket{p}{x} \braket{x}{p'},
\]
从而计算得到
\begin{equation}
    \braket{x}{p} = \frac{1}{\sqrt{2\pi}} \ee^{\ii p x}.
\end{equation}
这表明坐标表象和动量表象之间的变换是傅里叶变换。

下面转而讨论三维的情况。三维位置算符$\hat{\vb*{x}}$指的是
\begin{equation}
    \hat{\vb*{x}} = \hat{x}^1 \vb*{e}_1 + \hat{x}^2 \vb*{e}_2 + \hat{x}^3 \vb*{e}_3,
\end{equation}
其中为方便起见选取$\vb*{e}_1, \vb*{e}_2, \vb*{e}_3$为一组规范正交基。
$\hat{x}^1, \hat{x}^2, \hat{x}^3$的本征值均跑遍整条实数轴，因此$\hat{\vb*{x}}$的本征值是$\reals^3$中全体矢量。
我们还需要加入另一个假设：$\hat{x}^1, \hat{x}^2, \hat{x}^3$彼此对易。这个假设要求这三个算符满足某种“独立性”。
在一个完全能够由$\hat{\vb*{x}}$描述的希尔伯特空间$\mathcal{H}_{3\text{d}}$中我们写出其形式
\begin{equation}
    \hat{\vb*{x}} = \int \dd[3]{\vb*{x}} \vb*{x} \dyad{\vb*{x}} 
    = \int \dd[3]{\vb*{x}} (\hat{x}^1 \vb*{e}_1 + \hat{x}^2 \vb*{e}_2 + \hat{x}^3 \vb*{e}_3) \dyad{x^1, x^2, x^3}.
\end{equation}

沿着$\vb*{e}_1, \vb*{e}_2, \vb*{e}_3$的平移操作是对易的，这就意味着
\begin{equation}
    [\hat{p}_1, \hat{p}_2] = [\hat{p}_2, \hat{p}_3] = [\hat{p}_3, \hat{p}_1] = 0.
\end{equation}
所有生成元彼此对易。这样三维空间平移群的李代数就被拆分成了三个一维空间平移群的李代数的直和，三维空间平移群就被拆分成了三个一维空间平移群的直积。
这三个一维空间平移群分别是$x^1$方向上的平移群$\hat{Q}_1(a)$，$x^2$方向上的平移群$\hat{Q}_2(a)$，以及$x^3$方向上的平移群$\hat{Q}_3(a)$。
另一方面，注意到三维位置算符对应的本征态张成的空间$\{ \ket{x^1, x^2, x^3} \}_{x_1,x_2,x_3}$实际上是三个一维位置算符对应的本征态张成的空间的直积，
这是因为$\hat{x}^1, \hat{x}^2, \hat{x}^3$彼此对易。于是我们做拆分
\[
    \mathcal{H}_\text{3d} = \mathcal{H}_\text{1d1} \otimes \mathcal{H}_\text{1d2} \otimes \mathcal{H}_\text{1d3},
\]
并且用$\hat{x}^1$完全描述$\mathcal{H}_\text{1d1}$，用$\hat{x}_2$完全描述$\mathcal{H}_\text{1d2}$，用$\hat{x}_3$完全描述$\mathcal{H}_\text{1d3}$。
由于$\hat{Q}_1(a)$不改变$x^2, x^3$，它在$\mathcal{H}_\text{1d2},\mathcal{H}_\text{1d3}$上没有作用。同样也可以对$\hat{Q}_2(a),\hat{Q}_3(a)$做同样的论证。从而，下标不一样的$\hat{x}^i$和$\hat{p}_i$彼此对易。
这样关于诸$\hat{x}$和诸$\hat{p}$的李代数就可以拆分成$\{\hat{x}^1, \hat{p}_1\}$、$\{\hat{x}^2, \hat{p}_2\}$和$\{\hat{x}^3, \hat{p}_3\}$三对量的李代数的直和。
最后注意到在每个空间$\mathcal{H}_\text{1d$i$}$中，
\[
    \hat{Q}_i(a) \ket{x^i} = \ket{x^i + a},
\]
于是我们可以原封不动地套用对一维动量和位置的论证，得到
\[
    [\hat{x}^i, \hat{p}_i] = \ii \delta_{j}^i.
\]
于是，在没有做任何计算，而只是观念性地拆分了态空间之后，我们得到三维情况下的动量-位置对易关系：
\begin{equation}
    [\hat{x}^i, \hat{x}^j] = 0, \quad [\hat{p}_i, \hat{p}_j] = 0, \quad [\hat{x}^i, \hat{p}_j] = \ii .
\end{equation}
同样，也可以通过\eqref{eq:field-and-state-corr}得到上式。
同样，套用一维动量和位置的论证，我们得到动量算符在坐标表象下的形式
\begin{equation}
    \mel{\vb*{x}}{\hat{\vb*{p}}}{\psi} = - \ii \grad{\braket{\vb*{x}}{\psi}},
    \label{eq:p-in-x-representation}
\end{equation}
以及相应的表象变换矩阵
\begin{equation}
    \braket{\vb*{x}}{\vb*{p}} = \frac{1}{(2\pi)^{3/2}} \ee^{\ii \vb*{p} \cdot \vb*{x}}.
    \label{eq:x-p-trans}
\end{equation}

以上我们讨论了三维动量表象。但实际上，空间平移群是在闵可夫斯基时空中的，因此我们还可以讨论四维动量表象。
所谓四维动量就是四维空间平移群的场表示按照\eqref{eq:field-and-state-corr}产生的、作用在态矢量上的生成元。
它的空间部分就是我们已知的$\hat{p}$，它的时间部分$\hat{E}$满足
\[
    - \ii \pdv{\psi}{t} = [\hat{E}, \psi],
\]
其中$\psi$是某个场。因此$\hat{E}$就是能量。我们不说这是哈密顿量是因为它仅仅关于被讨论的单个粒子，而真正的哈密顿量应该关于整个体系。
按照\autoref{sec:translation}中的描述，四维动量的四个分量彼此对易。因此，四维矢量算符$\hat{p}^\mu$似乎应该是态空间
\[
    \{\ket{p}\}_p = \{\ket{\vb*{p}} \ket{E}\}
\]
的CSCO。然而，完整地描述单粒子的坐标空间实际上并不需要全部的$\{\ket{\vb*{p}} \ket{E}\}$——这是当然的，既然使用$\hat{p}$已经能够完整描述态空间了。
事实上，考虑到\eqref{eq:momentum-and-mass}，我们有
\begin{equation}
    \hat{E}^2 - \hat{\vb*{p}}^2 = m^2,
\end{equation}
如果态$\ket{p}$描述的是坐标空间中的某个态，就可以把上式作用在$\ket{p}$上：
\[
    \begin{aligned}
        m^2 \ket{p} &= \hat{E}^2 \ket{p} - \hat{\vb*{p}}^2 \ket{p} \\
        &= (E^2 - \vb*{p}^2) \ket{p},
    \end{aligned}
\]
从而
\[
    m^2 = E^2 - \vb*{p}^2 = p_\mu p^\mu.
\]
为了保证$E$的单值性我们要求$E>0$，于是
\begin{equation}
    m^2 = E^2 - \vb*{p}^2 = p_\mu p^\mu, \quad E > 0.
    \label{eq:mass-shell}
\end{equation}
我们看到，\eqref{eq:mass-shell}在四维闵可夫斯基时空中选出了一个三维的子流形。我们称这个子流形为\concept{质壳}。
态$\ket{p}$描述了一个实际的单粒子的坐标空间，当且仅当，$p$在质壳\eqref{eq:mass-shell}上，或者说$p$\concept{在壳}。
从而，给定一个$\vb*{p}$，我们把使用质壳方程写出的对应能量记作
\begin{equation}
    \omega_{\vb*{p}} = \sqrt{ m^2 + \vb*{p}^2 }.
\end{equation}

到现在为止这里的$m$都完全是一个来自群表示论的参数。然而，我们将在\autoref{sec:k-g-eq}中看到，这里的$m$和场的克莱因-高登方程中的$m$是同一个东西，而随后退化到非相对论情况后，我们会发现这个$m$实际上根本就是粒子质量。

由于$\eqref{eq:mass-shell}$让我们能够从$\vb*{p}$直接导出$p_0$也就是$E$，实际上完全可以使用$\vb*{p}$来标记在质壳上的$\ket{p}$。但我们并没有这么做，原因马上可以看到。
现在我们来归一化$\ket{p}$。因为我们在四维闵可夫斯基时空中工作，不再能够使用$\int \dd[3]{\vb*{p}}$来做归一化了，因为它不满足洛伦兹协变性：做一个洛伦兹变换，就有可能把一部分$\vb*{p}$弄到$p_0$中。
因此我们需要在四维矢量空间上定义一个积分测度，它只能在质壳上给出非零值，且这个积分测度必须是洛伦兹标量。
容易看出，
\[
    \int \dd[4]{p} \delta(p^2 - m^2) \theta(p_0)
\]
正是一个满足这种条件的积分测度。实际上，质壳是两个对顶的四维锥面，以上积分相当于对其中一个超锥面做积分。因此归一化条件为
\[
    1 = \int \dd[4]{p} \delta(p^2 - m^2) \theta(p_0) \dyad{p}.
\]
由于
\[
    \begin{aligned}
        \int \dd[4]{p} \delta(p^2 - m^2) \theta(p_0) &= \int \dd[3]{\vb*{p}} \int \dd{p_0} \delta (p_0^2 - \vb*{p}^2 - m^2) \theta(p_0) \\
        &= \int \dd[3]{\vb*{p}} \int \dd{p_0} \left( \frac{\delta(p_0 - \omega_{\vb*{p}})}{2 \omega_{\vb*{p}}} + \frac{\delta(p_0 + \omega_{\vb*{p}})}{- 2 \omega_{\vb*{p}}} \right) \theta (p_0) \\
        &= \int \frac{\dd[3]{\vb*{p}}}{2 \omega_{\vb*{p}}},
    \end{aligned}
\]
我们得到
\[
    \int \frac{\dd[3]{\vb*{p}}}{2\omega_{\vb*{p}}} \dyad{p} = 1.
\]
此时得到的$\ket{p}$是洛伦兹不变的，用于求和动量模式的积分测度$\dd[3]{\vb*{p}} / 2 \omega_{\vb*{p}}$也是洛伦兹不变的。
另一方面，单粒子量子力学中动量本征态通常不是用上式归一化的。我们于是需要在这两种动量本征态之间建立一个关系。
我们不失一般性地认为在壳的$\ket{p}$就在单粒子量子力学的坐标空间中，且由于$\ket{p}$与以它的空间部分$\vb*{p}$为标记的态$\ket{\vb*{p}}$一一对应，不失一般性地要求$\ket{p}$和$\ket{\vb*{p}}$差一个实数。
例如，下式是一种常用的归一化方案：
\[
    \int \dd[3]{\vb*{p}} \dyad{\vb*{p}} = 1, \quad \braket{\vb*{q}}{\vb*{p}} = \delta^3(\vb*{q} - \vb*{p}),
\]
在此假设下就有
\begin{equation}
    \ket{p} = \sqrt{2 \omega_{\text{p}}} \ket{\vb*{p}}.
\end{equation}
在三维动量空间中，$\ket{p}$是没有被归一化的；但在质壳中，$\ket{\vb*{p}}$反而是没有被归一化的那个。
为了保证洛伦兹协变性，在讨论相对论性量子场论时多用$\ket{p}$而不是$\ket{\vb*{p}}$，虽然它们表示的物理状态完全是一样的。
在坐标表象和$p$表象之间切换只需要使用
\begin{equation}
    \braket{\vb*{x}}{p} = \sqrt{\frac{2 \omega_{\vb*{p}}}{(2\pi)^3}} \ee^{\ii \vb*{p} \cdot \vb*{x}}.
    \label{eq:relativity-x-p-trans}
\end{equation}
但实际上这个公式很少真的被使用，因为一来相对论情况下很少需要讨论粒子位置，二来从相对论动量表象也就是$p$表象切换回$\vb*{x}$表象时需要使用积分测度$\int \dd[3]{\vb*{x}}$，而这不是洛伦兹协变的。由于我们在实际计算时有时需要将时间单独拿出来当成一个“演化参数”来看待而不是把它当成坐标，通常不讨论$\int \dd[3]{\vb*{x}}$的洛伦兹协变版本，从而从$p$表象切换回$\vb*{x}$表象会有困难，我们也不去理会它。

在本文中，我们还需要对上式做一个小小的调整。如\autoref{sec:canonical-general}所示，我们希望动量本征态可以直接由产生算符作用在真空态上产生，而产生算符是（坐标表象下的）场算符的傅里叶分量。
将坐标表象下的场算符展开成傅里叶分量时需要对所有动量取值求和，而通常我们使用积分测度$\int \dd[3]{\vb*{p}} / (2\pi)^3$，于是我们转而使用归一化方案
\begin{equation}
    \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \dyad{\vb*{p}} = 1, \quad \braket{\vb*{q}}{\vb*{p}} = (2\pi)^3 \delta^3(\vb*{q} - \vb*{p}),
\end{equation}
但是为了让
\begin{equation}
    \ket{p} =  \sqrt{2 \omega_{\text{p}}} \ket{\vb*{p}}
    \label{eq:relativity-p}
\end{equation}
仍然成立，$\ket{p}$的归一化可能看起来比较奇怪：
\begin{equation}
    \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3 2 \omega_{\vb*{p}}} \dyad{p} = 1.
    \label{eq:strange-p-state}
\end{equation}

\subsubsection{角动量}

% TODO：把指标升降放到最后做

角动量算符就是旋转生成元在态矢量上的表示。有限维的旋转生成元是一些矩阵，它们实际上就是三个方向上的角动量算符在$\hat{J}_z$的本征态上的分量矩阵（为什么是$\hat{J}_z$是因为在导出具体的矩阵表达式时是使用$J_x$和$J_y$构造$J_z$的本征态的产生湮灭算符的）。
与\autoref{note:state-and-operator-minus-symbol}中提到的类似，如果旋转群$\hat{R}(\vb*{\phi})$是直接作用在态上的，那么定义
\begin{equation}
    \hat{R}(\vb*{\phi}) = \hat{I} + \frac{1}{\ii} (\phi_1 \hat{J}^1 + \phi_2 \hat{J}^2 + \phi_3 \hat{J}^3), 
\end{equation}
而如果它是作用在算符上，那么定义
\[
    \hat{R}(\vb*{\phi}) = \hat{I} + \ii (\phi_1 \hat{J}^1 + \phi_2 \hat{J}^2 + \phi_3 \hat{J}^3).
\]
两种定义给出的$\hat{J}^i$是一样的，只是群参数差了一个负号。这就是\autoref{note:state-and-operator-minus-symbol}中提到的情况。

$J^i$可以分解成两部分：一部分改变$\vb*{x}$的取值，一部分不改变。改变$\vb*{x}$取值的那一部分记作$L^i$，称为\concept{轨道角动量}，它与粒子的位置自由度有关，因此有这个名称；不改变$\vb*{x}$取值的那一部分记作$S^i$，称为\concept{自旋角动量}，因为它和粒子的内禀自由度有关。
$J^i$服从\eqref{eq:lie-algebra-so3}，因此我们也称\eqref{eq:lie-algebra-so3}为\concept{角动量代数}。
通常设
\begin{equation}
    \vb*{J} = J_1 \vb*{e}_1 + J_2 \vb*{e}_2 + J_3 \vb*{e}_3,
\end{equation}
则角动量代数就是
\begin{equation}
    \vb*{J} \times \vb*{J} = \ii \vb*{J}.
\end{equation}
不过，实际计算时很少用到这个矢量，因为由于$\hat{J}^i$是三维旋转群的李代数的无穷维厄米表示，它们遵循角动量代数，因此彼此间不对易。
$\hat{\vb*{J}}$没有本征态。但由角动量代数，$\hat{\vb*{J}}^2$却和三个$\hat{J}^i$都对易。

需要注意的是，以上定义不能够一般地将轨道角动量和自旋角动量完全分开，因为可以任意地将自旋角动量划归一部分给轨道角动量。因此我们人为要求轨道角动量仅仅作用在坐标空间上，而自旋角动量仅仅作用在内禀自由度上。

按照\eqref{eq:rotation-inf-rep}和\eqref{eq:p-in-x-representation}，我们有
\[
    \begin{aligned}
        \mel{\vb*{x}}{\hat{L}^1}{\psi} &= x^2 (- \ii \partial_3) \braket{\vb*{x}}{\psi} - x^3 (- \ii \partial_2) \braket{\vb*{x}}{\psi} \\
        &= \mel{\vb*{x}}{(\hat{x}^2 \hat{p}_3 - \hat{x}^3 \hat{p}_2)}{\psi}, \\
        \hat{L}^1 &= \hat{x}^2 \hat{p}_3 - \hat{x}^3 \hat{p}_2.
    \end{aligned}
\]
同样也可以这样计算出$\hat{L}^2$和$\hat{L}^3$。从而我们得到
\begin{equation}
    \hat{\vb*{L}} = \hat{\vb*{x}} \times \hat{\vb*{p}},
\end{equation}
其中$\hat{\vb*{L}}$就是
\begin{equation}
    \hat{\vb*{L}} = \hat{L}^i \vb*{e}_i.
\end{equation}

\begin{equation}
    \hat{\vb*{L}}^2 = \hat{\vb*{x}}^2 \hat{\vb*{p}}^2 - (\hat{\vb*{x}} \cdot \hat{\vb*{p}})^2 + \ii \hat{\vb*{x}} \cdot \hat{\vb*{p}} = \hat{\vb*{x}}^2 \hat{\vb*{p}}^2 - (\hat{\vb*{x}} \cdot \hat{\vb*{p}}) (\hat{\vb*{p}} \cdot \hat{\vb*{x}}).
\end{equation}

总角动量$\hat{J}^i$和轨道角动量$\hat{L}$都遵循角动量代数，也即
\[
    \begin{aligned}
        \comm*{\hat{L}^i+\hat{S}^i}{\hat{J}^j+\hat{S}^j} &= \ii \epsilon_{ijk} (J^k+S^k), \\
        \comm*{\hat{L}^i}{\hat{L}^j} &= \ii \epsilon_{ijk} L^k,
    \end{aligned}
\]
而由于轨道角动量和自旋角动量作用在态空间的不同自由度上，它们是彼此对易的，从而我们推导出
\[
    \comm*{\hat{S}^i}{\hat{S}^j} = \ii \epsilon_{ijk} \hat{S}^k,
\]
因此自旋角动量确确实实是一种角动量：它也满足角动量代数。

我们也可以定义
\begin{equation}
    H = \hat{\vb*{S}} \cdot \frac{\hat{\vb*{P}}}{\abs{\vb*{P}}}
\end{equation}

如前所述，$J^2$和$\hat{J}_i$中的任何一个都对易。习惯上考虑$\hat{J}_3$，我们会发现$\hat{J}^2$和$J_3$实际上构成了角动量代数中的一组CSCO，因为$\hat{J}^2$是角动量代数的卡西米尔元，它确定了$\hat{J}_3$的取值的上下限，再加上$\hat{J}_3$的取值，系统的角动量状况就完全确定了。
通常称$\hat{L}^2$的本征值$\sqrt{j(j+1)}$中的$j$为\concept{角量子数}，$\hat{L}_3$的本征值为\concept{磁量子数}，而$\hat{S}_3$称为\concept{自旋量子数}。
$\hat{S}^2$没有专门的称呼，因为对种类确定的粒子它是固定的。

容易验证，若$\vb*{J}_1$和$\vb*{J}_2$都是角动量算符（也即，它们构成角动量代数），则它们之和$\vb*{J}_1 + \vb*{J}_2$也是角动量算符。
我们会看到将$\vb*{J}_1$和$\vb*{J}_2$叠加会得到一个可约表示，$\vb*{J}_1 + \vb*{J}_2$作用在$\vb*{J}_1$和$\vb*{J}_2$各自作用的空间的直积上，而这个直积实际上是一系列空间的直和。
我们设
\[
    \hat{J}^2 \ket{jm} = j(j+1) \ket{jm}, \quad \hat{J} \ket{jm} = m \ket{jm},
\]
特意加上一个$j$的标记是因为这个表示可能是可约的。到现在为止$j$可以取哪些值都是完全不清楚的，不过无论如何，上式构成了$\hat{J}$的表示空间的一组基。另一方面，容易看出
\[
    \ket{j_1 j_2 m_1 m_2} = \ket{j_1 m_1} \otimes \ket{j_2 m_2}
\]
实际上也是$\hat{J}$的表示空间的一组基。
容易验证$\ket{j_1 j_2 m_1 m_2}$是$J_z$的一组本征态，且
\begin{equation}
    m = m_1 + m_2,
    \label{eq:m-m1-m2}
\end{equation}
但是并不是$\vb*{J}^2$的一组本征态。
两组基之间的变换系数$\braket{j_1 j_2 m_1 m_2}{j m}$称为\concept{CG系数}。
$\{\ket{jm}\}$实际上是由若干不可约表示直和而成的基矢量（由不同的$j$对应的表示直和而成），而$\{\ket{j_1 j_2 m_1 m_2}\}$则是两个不可约表示直积而成的基矢量，CG系数用于在这两组基矢量来回切换。
可以预期，CG系数应该能够反映\eqref{eq:m-m1-m2}这一事实。的确如此：将用CG系数表示的$\ket{jm}$代入本征方程得到
\[
    \sum_{m_1, m_2} (m - m_1 - m_2) \braket{j_1 j_2 m_1 m_2}{j m} \ket{j_1 j_2 m_1 m_2} = 0,
\]
于是
\[
    (m - m_1 - m_2) \braket{j_1 j_2 m_1 m_2}{j m} = 0.
\]
这就意味着
\[
    \ket{jm} = \sum_{m_1} \ket{j_1 j_2 m_1 (m-m_1)} \braket{j_1 j_2 m_1 (m-m_1)}{jm}.
\]
由于$m$是$m_1$和$m_2$之和，$m$的最大值是$j_1+j_2$，最小值是$-j_1-j_2$，在此之间的所有值都可以取到。
% TODO:证明
$j$的取值为
\[
    j = j_1 + j_2, j_1 + j_2 - 1, \ldots, \abs{j_1 - j_2}.
\]
在半经典的图景中，这意味着叠加两个态的角动量时，它们的夹角是量子化的。
计算每个$j$对应的不可约表示的维度，把它们加起来，得到的结果正是$(2j_1 - 1) (2j_2 - 1)$。

CG系数的具体计算需要用到$\vb*{J}$的升降算符，注意到
\begin{equation}
    J_{\pm} \ket{jm} = \sum_{m_1 + m_2 = m} (J_{1 \pm} \ket{j_1 m_1} \ket{j_2 m_2} + \ket{j_1 m_1} J_{2 \pm} \ket{j_2 m_2}) \braket{j_1 j_2 m_1 m_2}{jm},
    \label{eq:addition-of-ca-opearator-su2}
\end{equation}
首先可以用这个关系式计算出$j=m$的CG系数，注意到
\[
    J_+ \ket{jm} = 0,
\]
就有
% TODO
可以递推得到

类似的方法还可以计算出三个角动量算符叠加而得到的结果，乃至更多。

需要注意的是按照以上步骤将角动量算符叠加之后得到的角动量基矢量并没有对称化/反对称化。
反对称化可能会让一些状态实际上取不到。

% TODO：螺旋度

\subsection{对称性操作}

\subsubsection{宇称变换}

% TODO

\subsubsection{电荷}

\subsubsection{粒子-反粒子共轭}


\section{标量场}

\subsection{实标量场的克莱因-高登方程}\label{sec:k-g-eq}

标量场的拉氏量中只能够出现$\phi$和$\partial_\mu \phi$构成的一次或二次不变量。
$\phi$构造出的一次不变量有$\phi$，二次不变量有$\phi^2$，$\partial_\mu \phi$是矢量，$\partial_\mu \phi$不可能和$\phi$缩并，而由于拉氏量中的参数都是标量它也不可能和参数缩并，因此它只能和自己缩并，得到$\partial_\mu \phi \partial^\mu \phi$。
这样我们得到
\[
    \mathcal{L} = A \phi + B \phi^2 + C \partial_\mu \phi \partial^\mu \phi.
\]
拉氏量中的$\phi$项实际上无关紧要，因为完全可以通过重新定义一个$\phi' = \phi + \const$来把一次项消除掉，于是我们略去这一项。
最后，通过重新定义长度单位和$m$，可以得到
\begin{equation}
    \mathcal{L} = \frac{1}{2} (\partial_\mu \phi \partial^\mu \phi - m^2 \phi^2).
    \label{eq:klein-gordon-lagrangian}
\end{equation}
这个拉氏量导致下面的运动方程：
\begin{equation}
    (\partial_\mu \partial^\mu + m^2) \phi = 0.
    \label{eq:klein-gordon-eq}
\end{equation}
这就是\concept{克莱因-高登方程}，标量场或者说自旋0场的基本运动方程。
可以证明，为了让\eqref{eq:klein-gordon-eq}给出有物理意义的预言（例如不出现无限下降的能量，等等），应当取$m \geq 0$。

实际上，所有场的运动方程均满足克莱因-高登方程。我们将在推导其它场的运动方程之后证明这一点。
这就导致了一个重要的结果。平移生成元在场表示中为\eqref{eq:transition-inf-rep}，从而
\[
    P_\mu P^\mu = - \partial_\mu \partial^\mu,
\]
于是代入\eqref{eq:klein-gordon-eq}，得到
\[
    P_\mu P^\mu \phi = - \partial_\mu \partial^\mu = m^2 \phi,
\]
其中$m$为克莱因-高等方程中出现的那个$m$。也即，通过$P_\mu P^\mu$的表示的本征值（实际上就是它和恒等变换之间差的倍数，因为$P_\mu P^\mu$是卡西米尔元）得到的$m$和场的运动方程得到的$m$是一样的。
这个$m$实际上就是粒子的静质量。在\autoref{sec:sch-eq-from-kg}中我们会看到它就对应着薛定谔方程中的质量。

现在导出标量场的哈密顿表述。计算得到
\begin{equation}
    \pi = \partial_0 \phi = \dot{\phi},
    \label{eq:klein-gordon-pi}
\end{equation}
相应的
\begin{equation}
    \mathcal{H} = \frac{1}{2} \dot{\phi}^2 + \frac{1}{2} (\grad{\phi})^2 + \frac{1}{2} m^2 \phi^2.
\end{equation}
如我们希望的那样，哈氏量密度是正定的。这当然是因为我们适当地选择了$\mathcal{L}$的正负号。

另外，注意到 % TODO：好像我们还从来没有严格定义过下式？
\[
    P_0 = E, \quad P_i \vb*{e}^i = \vb*{p},
\]
在场表示中我们可以写出
\[
    E^2 - \vb*{p}^2 = m^2
\]
或者说
\[
    E^2 = m^2 + \vb*{p}^2.
\]
这正是质壳关系\eqref{eq:mass-shell}。这就提示我们，还有另一种量子化方式：做替换
\[
    E \longrightarrow \hat{E} = \ii \partial_0, \quad \vb*{p} \longrightarrow \hat{\vb*{p}} = - \ii \grad,
\]
则从能量-动量关系就可以得到克莱因-高登方程。
我们不采用这种方案，因为它隐含地引入了太多的假设：算符$E, \vb*{p}$是作用在一个算符场上而不是态矢量上；$E,\vb*{p}$是厄米算符，也即，平移群在此算符场上取幺正表示（注意这一点并不一般成立！例如，场表示中的有限维表示就常常不是幺正的），等等。
为了和经典场论中的记号保持一致，我们后面将用$\omega$代替$E$。
$\omega$或者说场的傅里叶分量的频率在经典场论下有明确意义，而在量子场论的语境下，它实际上对应了这个场的傅里叶分量（粒子产生算符或者湮灭算符）产生/湮灭的粒子的能量$E$。

\subsection{实标量场的正则量子化}

\subsubsection{平面波模式}

无需额外考虑标量场的基，于是对实标量场，可以直接取
\begin{equation}
    {\phi}(\vb*{x}, t) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{\sqrt{2 \omega_{\vb*{p}}}} \left( {a}^\dagger_{\vb*{p}} \ee^{ - \ii \vb*{p} \cdot \vb*{x} + \ii \omega_{\vb*{p}} t} + {a}_{\vb*{p}} \ee^{ \ii \vb*{p} \cdot \vb*{x} - \ii \omega_{\vb*{p}} t} \right),
    \label{eq:expanding-klein-gordon-field}
\end{equation}
显然它是\eqref{eq:klein-gordon-eq}的一个解。相应的使用\eqref{eq:klein-gordon-pi}，有
\begin{equation}
    {\pi}(\vb*{x}, t) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \  \ii \sqrt{\frac{\omega_{\vb*{p}}}{2}} \left( {a}^\dagger_{\vb*{p}} \ee^{ - \ii \vb*{p} \cdot \vb*{x} + \ii \omega_{\vb*{p}} t} - {a}_{\vb*{p}} \ee^{ \ii \vb*{p} \cdot \vb*{x} - \ii \omega_{\vb*{p}} t} \right)
\end{equation}
共轭动量不是洛伦兹协变的。这并不让人意外，因为其定义和时间维的选取有关。
计算得到
\[
    {H} = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{2} \omega_{\vb*{p}} ({a}_{\vb*{p}}^\dagger {a}_{\vb*{p}} + {a}_{\vb*{p}} {a}^\dagger_{\vb*{p}}).
\]

下面把正则对易关系施加到标量场${\phi}$上。
通过计算可以得知，这等价于
\begin{equation}
    \comm*{{a}_{\vb*{p}}}{{a}^\dagger_{\vb*{p}'}} = (2\pi)^3 \delta^3 (\vb*{p} - \vb*{p}'), \quad \comm*{{a}_{\vb*{p}}}{{a}_{\vb*{p}'}} = 0.
    \label{eq:quantization-scalar}
\end{equation}
相应的，反对易关系等价于
\[
    \acomm*{{a}_{\vb*{p}}}{{a}^\dagger_{\vb*{p}'}} = (2\pi)^3 \delta^3 (\vb*{p} - \vb*{p}'), \quad \acomm*{{a}_{\vb*{p}}}{{a}_{\vb*{p}'}} = 0.
\]
将反对易关系代入哈密顿量表达式会导致哈密顿量变成常数，因此这是平凡解，舍去。
将对易关系代入哈密顿量的表达式，得到
\begin{equation}
    {H} = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} \left({a}_{\vb*{p}}^\dagger {a}_{\vb*{p}}  + \frac{1}{2} \comm*{{a}_{\vb*{p}}}{{a}^\dagger_{\vb*{p}}} \right).
    \label{eq:hamiltonian-of-klein-gordon}
\end{equation}
容易看出第二项实际上是发散的。
产生这种发散的原因在于，相对论性量子场论不会被用于处理动量特别高的问题（在那里需要新的物理，通常称为“紫外端的物理”），因此所谓的对整个动量空间的积分实际上只是对动量空间中一块很大的区域的积分。
在这种意义下，\eqref{eq:hamiltonian-of-klein-gordon}中的第二项是一个很大的常数，称为\concept{真空零点能}。因此在讨论全空间内的问题时，可以丢弃它得到等效的哈密顿量（注意此时哈密顿量的正定性实际上被破坏了）%？真的吗？
\begin{equation}
    {H} = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} {a}_{\vb*{p}}^\dagger {a}_{\vb*{p}}.
\end{equation}
这是一个福克空间上的$1$粒子算符。它表明自由场情况下单粒子携带能量为$\omega_{\vb*{p}}$。
通过反复使用对易关系\eqref{eq:quantization-scalar}以及真空态被湮灭算符作用后得到$0$这一事实，可以计算出
\begin{equation}
    {H} {a}_{\vb*{p}}^\dagger \ket{0} = \omega_{\vb*{p}} {a}_{\vb*{p}}^\dagger \ket{0}.
\end{equation}
因此正如我们预期的那样，单粒子态$\ket{\vb*{p}}$是哈密顿量的本征态。

真空零点能的出现实际上意味着原来的哈密顿量中的各个项是不对易的，因此真空态的能量不能是零，如果它是零，那么由哈密顿量的正定性，哈密顿量中的每一项作用在真空态上都会得到零，于是真空态是哈密顿量的每一项的本征态，这就产生了矛盾。
% TODO:实际上不对易的算符还是可以有共同本征态的，以上说法不正确，需要进一步说明
不对易性是纯粹的量子概念，因此真空零点能只有在量子场论中才能够得到良好的定义。
如果哈密顿量中所有的项都是彼此对易的，就不会有真空零点能。有时真空零点能的存在也称为量子涨落，因为即使在真空态，也不是所有的物理量都有完全确定的值。

需要注意的是如果我们讨论的问题不是定义在全空间上的，可能不能直接把真空零点能丢弃。例如，设有两块无穷大的金属板，它们施加的边界条件会让\eqref{eq:expanding-klein-gordon-field}中的一些模式为零，通过计算可以发现板间的真空零点能小于板外，从而产生一个板之间的吸引力。

总之，标量场需要使用正则对易关系来量子化，不能用反对易关系。因此标量场描述$0$自旋玻色子。

\subsubsection{守恒量}

场的动量为
\[
    P_i = \int \dd[3]{\vb*{x}} \pi \partial_i \phi,
\]
从而
\begin{equation}
    {\vb*{P}} = - \int \dd[3]{\vb*{x}} {\pi} \grad{{\phi}} = \int \dd[3]{\vb*{x}} \vb*{p} {a}^\dagger_{\vb*{p}} {a}_{\vb*{p}} + \text{vaccum zero-point item},
\end{equation}
正如我们预期的，场的动量也是单粒子算符，并且正好就是所有粒子的动量之和。

标量场没有内禀自由度，因此也不携带自旋角动量。我们无需讨论其自旋角动量。

\subsubsection{实标量场的传播子}

通过\eqref{eq:quantization-scalar}中的归一化常数我们可以写出动量空间中的同时间两点关联函数：
\begin{equation}
    \mel{0}{a_{\vb*{p}} a^\dagger_{\vb*{q}}}{0} = (2\pi)^3 \delta(\vb*{p} - \vb*{q}), \quad \mel{0}{a^\dagger_{\vb*{p}} a_{\vb*{q}}}{0} = 0.
\end{equation}
代入展开式\eqref{eq:expanding-klein-gordon-field}，就得到实空间下的两点关联函数（这两个点可以不等时）：
\begin{equation}
    D(x-y) = \mel{0}{\phi(x) \phi(y)}{0} = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{2 \omega_{\vb*{p}}} \ee^{-\ii p \cdot (x - y)} |_{p^0 = E_{\vb*{p}}} .
\end{equation}
被积分的$\ee$指数是洛伦兹不变的，积分测度也是洛伦兹不变的，等式左边也是洛伦兹不变的——本该如此，既然标量场是洛伦兹不变的。
这个式子可以写成更加明显的洛伦兹不变的形式。
容易看出
\[
    \int \dd{\omega} \frac{1}{(\omega - \omega_{\vb*{p}})(\omega + \omega_{\vb*{p}}  - \ii 0^+)} \ee^{-\ii p \cdot (x - y)} = - \pi \ii \frac{1}{2 \omega_{\vb*{p}}} \ee^{-\ii p \cdot (x - y)} |_{p^0 = E_{\vb*{p}}} ,
\]
这里积分号表示计算积分主值，负号是由于$\ee^{-\ii \omega t}$在下半平面衰减而不是上半平面。
于是就有
\begin{equation}
    \begin{aligned}
        D(x-y) &= 2 \int \frac{\dd[4]{p}}{(2\pi)^4} \frac{\ii}{(\omega - \omega_{\vb*{p}})(\omega + \omega_{\vb*{p}}  - \ii 0^+)} \ee^{-\ii p \cdot (x - y)} \\
        &= 2 \int \frac{\dd[4]{p}}{(2\pi)^4} \frac{\ii}{p^2 - m^2 - \ii 0^+ (\omega - \omega_{\vb*{p}})} \ee^{-\ii p \cdot (x - y)}.
    \end{aligned}
\end{equation}
这个积分看起来非常不自然：我们需要忽略其中一个极点，并且取另一个极点的积分主值，然后再将结果乘以$2$。
这种不自然性暗示$\mel*{0}{\phi(x) \phi(y)}{0}$可能并不是非常好用的表示两点关联的方式——它的确不是，因为当$x^0 < y^0$时它还是会给出一个值，并没有很好地反映因果性。
对这个量的有意义的使用局限于$x^0 > y^0$时。

在等时情况下上式实际上可以进一步往下计算。设$x^0-y^0=0$，$\vb*{x} - \vb*{y} = \vb*{r}$，采用球坐标系，有
\[
    \begin{aligned}
        D(x-y) &= \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{2 \omega_{\vb*{p}}} \ee^{\ii \vb*{p} \cdot \vb*{r}} \\
        &= \frac{2\pi}{(2\pi)^3} \int \frac{p^2 \dd{p}}{2 \omega_{\vb*{p}}} \frac{\ee^{\ii p r} - \ee^{- \ii p r}}{\ii p r} \\
        &= - \frac{\ii}{2 (2\pi)^2 r} \int_{-\infty}^\infty \frac{p \dd{p}}{\sqrt{p^2 + m^2}} \ee^{\ii p r},
    \end{aligned}
\]
被积函数是一个多值函数，从$\ii m$到$\ii \infty$，$- \ii m$到$- \ii \infty$作割线，即确定一个单值分支。
将积分路径换成围绕从$\ii m$到$\ii \infty$的割线，并作变量代换$p = \ii \rho$，可将上式化为
\[
    D(x-y) = \frac{1}{4\pi^2 r} \int_{m}^\infty \dd{\rho} \frac{\rho \ee^{-\rho r}}{\sqrt{\rho^2 - m^2}} \stackrel{r \to \infty}{\sim} \ee^{- m r}.
\]
这就是说，即使是彼此之间有类空间隔的两点之间实际上也是有关联的，虽然随着举例增加关联函数快速下降；或者说，在光锥之外，跃迁振幅会指数下降但是不会一开始就降到零。

这实际上并没有直接破坏因果律，因为量子态并不是直接可观测的，真正有意义的是测量，如果具有类空间隔的两点之间的同种可观测量是对易的，因果律还是能够保持。
计算$\phi(x)$和$\phi(y)$的对易子：
\begin{equation}
    \begin{aligned}
        \comm*{\phi(x)}{\phi(y)} &= \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{2 \omega_{\vb*{p}}} (\ee^{\ii p \cdot (y - x)} - \ee^{\ii p \cdot (x - y)}) \\
        &= D(x-y) - D(y-x),
    \end{aligned}
\end{equation}
在$x$和$y$之间为类空间隔时，洛伦兹变换可以让$x-y$变成$y-x$，由于$D(x-y)$和$D(y-x)$各自是洛伦兹标量，$\comm*{\phi(x)}{\phi(y)}$就是零。
否则，洛伦兹变换不能让$x-y$变成$y-x$，因为此时时间的先后顺序是绝对的，从而$\phi(x)$和$\phi(y)$不对易。
因此因果律在这里确实是能够保持的。

我们看到$\phi(x)$和$\phi(y)$的对易子实际上就是一个普通的数，即

在实际计算中通常计算编时格林函数，因为其携带了足够多的信息，并且在自由场情况下有Wick定理。
仿照前述引入$\omega$积分的方法，可以验证我们有
\begin{equation}
    D_F(x-y) = \mel*{0}{T \phi(x) \phi(y)}{0} = \int \frac{\dd[4]{p}}{(2\pi)^4} \frac{\ii}{p^2 - m^2 + \ii 0^+} \ee^{- \ii p \cdot (x - y)}.
\end{equation}
这称为\concept{费曼传播子}，可以看到它在动量空间中的形式是非常简单的。

\subsection{实标量场的路径积分量子化}

旋量场的路径积分需要额外提几句，因为此时所谓的“经典场”实际上是一些彼此反对易的算符（所谓\concept{格拉斯曼数}），而不是正常的数。
格拉斯曼数的积分基本上只用在写出配分函数上，

\[
    S = \int \dd[4]{x} \bar{\psi} (\ii G^{-1}) \psi
\]

\subsection{非相对论极限}

\subsubsection{克莱因-高登方程的退化形式}\label{sec:sch-eq-from-kg}

我们将讨论克莱因-高登方程的退化形式。旋量场和标量场由于也服从克莱因-高登方程，没有必要单独考虑——它们多出来的自由度可以使用其它方式，如自旋等，引入。
实际上我们讨论的应该是复的克莱因-高登方程，因为旋量场是复的，但本节的讨论并不会用到场是不是复的这个信息。

首先我们注意到一个事实：时谐波
\begin{equation}
    \phi = \ee^{- \ii m t}
    \label{eq:lowest-energy}
\end{equation}
是\eqref{eq:klein-gordon-eq}的解，并且它的能量最低，就是零。（代入哈氏量可得）因此，能量不高的场只是微微偏离\eqref{eq:lowest-energy}，我们设其为
\begin{equation}
    \phi(\vb*{x}, t) = \psi(\vb*{x}, t) \ee^{- \ii m t},
    \label{eq:low-energy-ansatz}
\end{equation}
则
\[
    (\partial_\mu \partial^\mu + m^2) \phi = \ee^{- \ii m t} (-2 \ii m \partial_t \psi + \partial_t^2 \psi - \laplacian{\psi}).
\]
由于$\phi$只是略微偏离\eqref{eq:lowest-energy}%
\footnote{需要注意的是这个说法字面上实际上是不严谨的。${\phi}$是一个算符，它包含了所有可能的$\phi$的取值，不应该“只是略微偏离\eqref{eq:lowest-energy}”。
然而，${\phi}$的本征态中非常偏离\eqref{eq:lowest-energy}的那部分模式在我们的低能有效理论中并不会被涉及到。
换而言之，我们关心的那部分$\ket{\phi}$只是略微偏离\eqref{eq:lowest-energy}，因此认为${\phi}$只是略微偏离\eqref{eq:lowest-energy}并不会显著改变我们的理论的行为。
}%
，可以预期$\psi$的时间部分振荡不会特别明显，于是取近似
\[
    \partial_t^2 \psi \ll m \partial_t \psi,
\]
就得到
\begin{equation}
    \ii \partial_t \psi + \frac{1}{2m} \laplacian{\psi} = 0.
    \label{eq:schodinger-eq}
\end{equation}
\eqref{eq:schodinger-eq}称为\concept{薛定谔场}的运动方程。容易看出它不是洛伦兹协变的，这是理所当然的，因为它描述的现象发生在低能近似下，此时伽利略对称性就足够了。
薛定谔场是复的，无论$\phi$是不是复场，因为拟设\eqref{eq:low-energy-ansatz}引入了一个复数因子。

方程\eqref{eq:schodinger-eq}是以下拉氏量%
\footnote{$\grad{\psi}^\dagger \cdot \grad{\psi}$代表将两个梯度算符做缩并，行向量$\psi^\dagger$和列向量$\psi$相乘，即$\partial_i \psi^\dagger \partial^i \psi$。混合使用不变量记号和矩阵记号是因为我们并不知道$\psi$的内部结构，只知道$\psi^\dagger \psi$是标量，因此把$\psi$当成一个整体，好像一个标量一样，来做计算。}
\begin{equation}
    \mathcal{L} = \frac{\ii}{2} \left( \psi^\dagger \dot{\psi} - \psi \dot{\psi}^\dagger \right) - \frac{1}{2m} \grad{\psi^\dagger} \cdot \grad{\psi}
    \label{eq:schodinger-lagrangian}
\end{equation}
的运动方程。把$\psi$和$\psi^\dagger$看成两个独立的场，分别应用欧拉-拉格朗日方程，就能够得到\eqref{eq:schodinger-eq}和其共轭转置。

容易看出，
\[
    \pi(\psi) = \pdv{\mathcal{L}}{\dot{\psi}} = \frac{\ii}{2} \psi^\dagger, \quad \pi(\psi^\dagger) = \pdv{\mathcal{L}}{\dot{\psi}^\dagger} = - \frac{\ii}{2} \psi^\top,
\]
从而可以计算出
\begin{equation}
    \mathcal{H} = \frac{1}{2m} \grad{\psi^\dagger} \cdot \grad{\psi}.
\end{equation}
这个哈氏量中出现了$\pi$的导数，处理起来会比较麻烦。为了规避这些麻烦，我们将不再讨论经典的哈密顿动力学，而直接开始做量子化。

电荷密度为
\begin{equation}
    \rho(\vb*{r}) = q \psi^\dagger(\vb*{r}) \psi(\vb*{r}),
\end{equation}
而且电流密度为
\begin{equation}
    \vb*{j}(\vb*{r}) = \frac{1}{2m\ii} (\psi^\dagger(\vb*{r}) \grad{\psi}(\vb*{r}) - \psi(\vb*{r}) \grad{\psi}^\dagger(\vb*{r}))
\end{equation}

\subsubsection{薛定谔场}

% TODO:可以看到，$j=0$的标量场给出的粒子的自旋角动量为0，$j=\pm \frac{1}{2}$的旋量场给出的粒子的自旋角动量为$\pm 1/2$，$j=1$的矢量场给出的粒子的自旋角动量为$\pm 1$。这并不让人意外，因为$j$决定了粒子的内禀自由度的维度($2j+1$)。无质量的情况比较特殊
实际上也可以通过量子化薛定谔场来得到非相对论性量子场论。薛定谔场实际上是标量场、旋量场、矢量场退化而来的场，因此它也有内禀自由度。使用自旋（或者螺旋度）标记这些内禀自由度。
由于薛定谔场不是实场，考虑对易关系
\[
    \comm*{{\psi}^i(\vb*{x}, t)}{{\pi}_j(\vb*{y}, t)} = \ii \delta^i_j \delta^3 (\vb*{x} - \vb*{y}),
\]
即
\[
    \comm*{{\psi}^i(\vb*{x}, t)}{({\psi}^j)^\dagger (\vb*{y}, t)} = 2 \delta^3 (\vb*{x} - \vb*{y}),
\]
这表明

总之，在不涉及粒子相互作用时，单粒子量子力学足以覆盖薛定谔场的情况，即“非相对论量子场论”就是量子力学。%
\footnote{
    量子场论和量子力学的对应实际上有两方面：首先，量子场论和量子力学都可以写成哈密顿动力学的形式，当然前者各个物理量可以使用空间位置作为标签而后者物理量的标签都是离散的；其次，量子场论和量子力学都能够描述多粒子态。
    当我们说非相对论性量子场论就是量子力学时我们是在说后者，当我们说量子场论是3+1维量子力学时我们是在说前者。
}%
我们再一次看到场自由度和数量可变的粒子自由度实际上就是一回事。
初等量子力学中可以直接定义S算符、单粒子费曼图（“原子吸收一个光子、释放一个光子”，等等），你可能会问为什么这些本来用于场论的概念也可以被用在单粒子量子力学上，毕竟前者是3+1维理论而后者是0+1维理论。但实际上，这些用在量子场论上的概念完全可以被应用在薛定谔场上，而由于薛定谔场不涉及粒子数变化，这些概念就可以被套用在单粒子态量子力学上。

\subsubsection{关于归一化的注记}

在将相对论性的相互作用顶角移植到非相对论极限下时需要注意归一化问题。
在非相对论性极限下我们更喜欢使用$\{\ket{\vb*{p}}\}$表象，而不是$\{\ket{p}\}$表象。
我们知道
\[
    \ket{p} = \sqrt{2 \omega_{\vb*{p}}} \ket{\vb*{p}},
\]
在非相对论极限下就有
\begin{equation}
    \ket{\vb*{p}} = \frac{1}{\sqrt{2m}} \ket{p},
\end{equation}
于是应有
\begin{equation}
    \mel*{\vb*{p}_1, \ldots, \vb*{p}_m}{S}{\vb*{q}_1, \ldots, \vb*{q}_n} = \frac{1}{(2m)^{(m+n)/2}} \mel*{p_1, \ldots, p_m}{S}{q_1, \ldots, q_n}.
\end{equation}

\section{旋量场}

\subsection{旋量场的狄拉克方程}

旋量场实际上几乎从来不会在经典情况下遇到，因为它们的场值是复数，因此不具有直接的物理意义。

本节讨论旋量的运动方程。使用凑拉氏量的方法处理旋量会比较困难，因为旋量的指标分带点的和不带点的，因此会频繁地涉及求共轭等运算，在拉格朗日动力学中讨论这些问题并不方便。
因此接下来我们尝试直接构造旋量的运动方程，从这些运动方程反推对应的拉氏量。
我们将尝试构造一阶运动方程。如果对魏尔旋量和狄拉克旋量都能够构造出一阶运动方程，那就没有必要考虑更高阶的运动方程。
% TODO:为什么？

\subsubsection{魏尔旋量的运动方程} 

首先讨论魏尔旋量的运动方程。满足平移不变性的方程形如
\[
    \partial_0 \psi = b^i \partial_i \psi + C \psi,
\]
其中$b^i$和$C$是常数，$C$可以是一个旋量矩阵。
由于我们同时还要求旋转不变性，$C$只能是一个标量。显然，这个方程中所有含有导数的项加在一起必然得到一个旋量，即
\[
    \partial_0 \psi - b^i \partial_i \psi = \text{a covariant term} = C \psi.
\]
梯度算符是矢量，按照\eqref{eq:vector-is-spin-tensor}，我们可以写出作用在魏尔旋量上的导数算符
\begin{equation}
    \partial_{a \dot{b}} = \partial_\nu \sigma^\nu_{a \dot{b}}.
\end{equation}
从而魏尔旋量的梯度就是
\[
    \partial_{a \dot{b}} \psi^{\dot{b}} = \partial_\nu \sigma^\nu_{a \dot{b}} \psi^{\dot{b}}
\]
和
\[
    \partial^{\dot{a} b} \psi_b = \partial_\mu (\sigma^\mu)^{\dot{a} b} \psi_b.
\]
两个表达式中，$\sigma$的指标都一个带点一个不带点，这是为了保证梯度算符的协变性，因为矢量是一个左手旋量和一个右手旋量直积的结果。
$\partial_0 \psi - b^i \partial_i \psi$应该能够写成以上两种旋量梯度的函数。由于以上两种旋量梯度带一个指标，而$\partial_0 \psi - b^i \partial_i \psi$也是单指标对象，显然两者只应该差一个倍数。（当然，也可以将一个旋量张量参数和旋量梯度做缩并，但这样就没有旋转不变性了）这个倍数可以被吸收到$C$中。
从而运动方程形如
\[
    \mathrm{grad} \psi = C \psi.
\]
然而，注意到左手旋量的梯度是一个右手旋量，右手旋量的梯度是一个左手旋量，因此以上的方程会让一个右手旋量的各个分量等于一个左手旋量的各个分量，从而破坏了洛伦兹协变性。
消除这个矛盾的唯一可能就是让$C=0$，于是左手旋量的运动方程为
\[
    \partial_\mu (\sigma^\mu)^{\dot{a} b} \psi_b = 0,
\]
右手旋量的运动方程为
\[
    \partial_\nu \sigma^\nu_{a \dot{b}} \psi^{\dot{b}} = 0.
\]
由定义，$(\sigma^\mu)_{a \dot{b}}$的分量矩阵就是$\sigma$矩阵，而$(\sigma^\mu)^{\dot{a} b}$的分量矩阵则需要通过指标升降关系
\[
    (\sigma^\mu)^{\dot{a} b} = (\epsilon^{ac} (\sigma^\mu)_{c \dot{d}} \epsilon^{\dot{b} \dot{d}})^*
\]
得到。定义$(\sigma^\mu)^{\dot{a} b}$的分量矩阵为$\bar{\sigma}^\mu$，通过计算可以发现
\begin{equation}
    \bar{\sigma}^0 = \sigma^0 = I, \quad \bar{\sigma}^i = - \sigma^i,
\end{equation}
于是可以使用矩阵形式写出运动方程：
\begin{equation}
    \partial_0 \psi \pm \sigma^i \partial_i \psi = 0 .
    \label{eq:weyl-eq}
\end{equation}
负号为左手旋量，正号为右手旋量。从\eqref{eq:weyl-eq}立刻可以得到
\[
    \partial_\mu \partial^\mu \psi = 0,
\]
无论是右手旋量还是左手旋量。因此，单独一个旋量场一定是没有质量的。

然而，拉氏量中的质量项实际上是自由理论的一部分，因此一种非常简单的让旋量场获得质量而与此同时理论保持为自由理论的方法是让一对旋量耦合起来。
两个旋量场的耦合意味着拉氏量中要出现一个二次项，它由两个旋量的乘积构成，而由于这个二次项必须是标量，它应该包含一个左手旋量和一个右手旋量。
考虑到我们可以把一个左手旋量和一个右手旋量打包成一个狄拉克旋量，有必要分析狄拉克旋量的运动方程。
% TODO: majorana费米子

\subsubsection{狄拉克旋量的运动方程} 

\paragraph{魏尔表象} 我们现在让狄拉克旋量中的两个旋量之间有线性的相互作用（从而，关于狄拉克旋量的方程仍然是线性的）。
我们将狄拉克旋量写成一个左手旋量和一个右手旋量拼合的形式，称为\concept{魏尔表象}或\concept{手性基}，虽然实际上有其它方式可以表示狄拉克旋量。
洛伦兹不变性的要求意味着，唯一可能的方程形式如下：
\begin{equation}
    \begin{aligned}
        (\partial_0 + \sigma^i \partial_i) \psi_R = - \ii m_1 \psi_L, \\
        (\partial_0 - \sigma^i \partial_i) \psi_L = - \ii m_2 \psi_R.
    \end{aligned}
    \label{eq:interacting-weyl-eq}
\end{equation}
其中我们为了节省符号，使用$\psi_L$和$\psi_R$分别代表狄拉克旋量$\psi$的左手部分和右手部分。
当然，$m=0$时就狄拉克旋量的运动方程就退化为了一对完全无关的左手旋量和右手旋量。
这也就是实际计算时没有必要单独讨论魏尔旋量的原因。
在\eqref{eq:interacting-weyl-eq}中各个方程的两边作用适当的算符来让两个场解耦，就得到
\[
    \partial_\mu \partial^\mu \psi_L = - m_1 m_2 \psi_L, \quad \partial_\mu \partial^\mu \psi_R = - m_1 m_2 \psi_R,
\]
也就是说狄拉克旋量也满足克莱因-高登方程，只需要我们令$m^2=m_1 m_2$。从而为了得到物理解，我们要求$m \geq 0$。
可以看到$m_1$和$m_2$的具体取值实际上是无关紧要的，重要的是它们的乘积，因此以下让它们都取$m$。

为了将\eqref{eq:interacting-weyl-eq}写成更加紧凑的形式，引入$\gamma$矩阵%
\footnote{这里给出的$\gamma$矩阵的形式实际上只是一种可能性。我们称这种将狄拉克旋量的左手部分和右手部分分开处理（或者等价地说，狄拉克旋量的基或者只含有左手旋量，或者只含有右手旋量），并且按照\eqref{eq:gamma-matrix}引入$\gamma$矩阵的方式为\concept{魏尔表象}。也可以取其它的旋量基，从而获得其它表象。}
\begin{equation}
    \gamma^\mu = \pmqty{0 & \sigma^\mu \\ \bar{\sigma}^\mu & 0}, \quad \gamma^5 = \pmqty{-I & 0 \\ 0 & I},
    \label{eq:gamma-matrix}
\end{equation}
从而
\begin{equation}
    \gamma_\mu = \eta_{\mu \nu} \gamma^\nu = \pmqty{ 0 & \bar{\sigma}^\mu \\ \sigma^\mu & 0 },
\end{equation}
则得到
\begin{equation}
    (\ii \gamma^\mu \partial_\mu - m) \psi = 0.
    \label{eq:dirac-eq}
\end{equation}
这就是\concept{狄拉克方程}。如前所述，它能够推导出克莱因-高登方程，并且在$m$取零时退化为一个左手旋量场和一个右手旋量场的简单组合。

现在我们尝试拼凑一个拉氏量出来。由于狄拉克场的运动方程是一阶的而它又是一个复场，需要通过$\psi$的复共轭拼凑出一个在运动方程意义下“独立”的场，然后构造一个同时包含$\psi$及其复共轭的拉氏量，由这个拉氏量给出关于$\psi$和它的复共轭的两个方程，并且这两个方程必须等价。
现在我们尝试寻找和\eqref{eq:dirac-eq}等价，但是仅仅包含其复共轭的方程。
由\eqref{eq:dirac-eq}取共轭转置%
\footnote{这里的共轭转置是指场的共轭转置，不需要对作用在场上的算符$\partial_\mu$取共轭转置。}
，得到
\[
    (-\ii) \partial_\mu \psi^\dagger (\gamma^\mu)^\dagger - m \gamma^\dagger = 0.
\]
容易验证$\gamma$矩阵具有下面的性质：
\[
    (\gamma^0)^\dagger = \gamma^0, \quad (\gamma^i)^\dagger = - \gamma^i, 
\]
以及
\[
    \gamma^i \gamma^0 = - \gamma^0 \gamma^i,
\]
我们发现
\[
    \ii \partial_0 \psi^\dagger \gamma^0 \gamma^0 + \ii \partial_i \psi^\dagger \gamma^0 \gamma^i + m \psi^\dagger \gamma^0 = 0.
\]
定义
\begin{equation}
    \bar{\psi} = \psi^\dagger \gamma^0,
\end{equation}
则其运动方程为
\begin{equation}
    \ii \partial_\mu \bar{\psi} \gamma^\mu + m \bar{\psi} = 0.
    \label{eq:cog-dirac-eq}
\end{equation}
这正是我们需要的另一个运动方程。
我们会发现，拉氏量
\begin{equation}
    \mathcal{L} = \bar{\psi} (\ii \gamma^\mu \partial_\mu - m) \psi
    \label{eq:dirac-lagrangian}
\end{equation}
分别对$\psi$和$\bar{\psi}$应用欧拉-拉格朗日方程，就得到\eqref{eq:dirac-eq}和\eqref{eq:cog-dirac-eq}。同时容易验证这是一个洛伦兹标量。这表明\eqref{eq:dirac-lagrangian}确实就是狄拉克场的拉氏量。
我们之后还会非常频繁地写$\gamma^\mu a_\mu$这样的量，可以将其简记为$\slashed{a}$。

从\eqref{eq:dirac-lagrangian}可以推导出对应的哈氏量。计算共轭动量可以得到
\begin{equation}
    \pi = \ii \bar{\psi} \gamma^0 = \ii \psi^\dagger,
\end{equation}
从而能够得到哈氏量密度
\begin{equation}
    \mathcal{H} = - \ii \bar{\psi} \gamma^i \partial_i \psi  + m \bar{\psi} \psi = - \pi \gamma^0 \gamma^i \partial_i \psi - \ii m \pi \gamma^0 \psi.
    \label{eq:dirac-hamiltonian}
\end{equation}

有时我们需要让一个狄拉克旋量中的左手部分或是右手部分单独拿出来与其它场耦合。
容易看出，矩阵
\begin{equation}
    P_L = \frac{1 - \gamma^5}{2}, \quad P_R = \frac{1 + \gamma^5}{2}
\end{equation}
分别是左手旋量和右手旋量的投影算符。

\paragraph{狄拉克表象} 以上我们都设$\psi$的各分量由一个左手旋量和一个右手旋量拼凑而成。这称为\concept{手性基}或者\concept{魏尔表象}。%
\footnote{
    虽然我们在讨论场算符，但是这些场算符可以直接激发出单粒子态，后者和前者之间的关系是线性的，所以“基底”或“表象”的术语确实是正确的：它们的确给出了单费米子的一组基底。
}%
在手性基当中，拉氏量的质量项为
\[
    - \bar{\psi} m \psi = - m (\chi_L^\dagger \xi_R + \xi_R^\dagger \chi_L),
\]
这不是一个对角化的二次型。若做分量变换
\begin{equation}
    \psi' = \frac{1}{\sqrt{2}} \underbrace{\pmqty{1 & 1 \\ -1 & 1}}_{U} \psi, \quad \gamma'^\mu = U \gamma^\mu U^\dagger,
\end{equation}
质量项就被对角化了。我们称这种分量选取为\concept{质量基}或者\concept{狄拉克表象}。
在后面做量子化时会看到，在魏尔表象中，$\psi$的$p^0 > 0$的解包含权重相等的一个左手旋量分量和一个右手旋量分量，$p^0 < 0$的解包含权重正好差一个负号的一个左手旋量分量和一个右手旋量分量，因此狄拉克表象下，$\psi$的前两个分量代表$p^0 > 0$的模式而后两个分量代表$p^0 < 0$的模式。
实际上，这就意味着狄拉克表象的前两个分量代表自旋一上一下的两种粒子，而后两个分量分别代表自旋一上一下的两种反粒子。

容易计算出质量基下
\begin{equation}
    \gamma^0 = \pmqty{I & 0 \\ 0 & -I}, \quad \gamma^i = \pmqty{0 & \sigma^i \\ - \sigma^i & 0 }, \quad \gamma^5 = \pmqty{0 & I \\ I & 0}.
\end{equation}
在质量基下，左手投影算符和右手投影算符分别是

\subsubsection{$\gamma$矩阵和Clifford代数}

\paragraph{$\gamma$矩阵的乘法规则}

\paragraph{$\gamma$矩阵的洛伦兹变换} %TODO：旋量场的洛伦兹标量

$\gamma$矩阵的洛伦兹变换需要一些特别的注记。如果我们做像本文定义的那样的洛伦兹变换，即让旋量场变换，那么$\gamma$矩阵在洛伦兹变换下根本就不应该发生变化。
但是，另一方面，$\bar{\psi} \gamma^\mu \psi$可以验证的确是矢量。
这种看似冲突的情况——$\gamma$矩阵同时看起来像标量和矢量——当然来自它们代表的是可以作用在单粒子态上的算符，或者作用在场算符上的“元算符”，而非场算符本身这一事实。
回顾引入狄拉克旋量的过程，$\gamma$矩阵的作用其实是“正确地将左手部分的魏尔旋量和右手部分的魏尔旋量混合起来”，它实际上提供了拉氏量关于旋量场的形式，自然在洛伦兹变换下可以没有变化。

这样在实际计算中我们其实可以在很多时候将旋量有关的量——旋量场和$\gamma$矩阵——当成没有内部结构的对象，即假装系统中只有标量和矢量，而通过正确地排列旋量场和$\gamma$矩阵的顺序来完成本应通过旋量指标完成的工作。
对矢量当然也可以这么做，实际上研究数值计算时我们将一切都写成矩阵就是在做这件事；在量子场论中不这么做的主要原因是，在量子场论中我们需要频繁讨论矢量的任意张量积，从而保留上下指标会让计算变得直观，而对旋量做的操作则相当有限。

\paragraph{$\gamma$矩阵的物理意义} 我们已经看到$(1-\gamma^5)/2$和$(1+\gamma^5)/2$分别是左手和右手的手征投影算符。
还可以验证，
\begin{equation}
    \gamma^5 P_L \psi = - P_L \psi, \quad \gamma^5 P_R \psi = P_R \psi,
\end{equation}
因此$\gamma^5$是\concept{手征算符}，其负本征值对应左旋态而正本征值对应右旋态。
另一方面，$\gamma^0$则交换一个狄拉克旋量的左手和右手部分。

\subsection{旋量场的正则量子化}

\subsubsection{平面波模式}

我们还是例行公事地观察狄拉克方程的平面波解，并将其中的场变量用算符代替。接下来将使用手性基。
平面波旋量场的分量应该包括这些标记：首先是动量。三维动量给定之后，对时谐场有$p^0 = \pm \omega_{\vb*{p}}$，但由于旋量场不是实场，因此其正频率部分和负频率部分之间没有简单的关系，即不能统一用$a$和$a^\dagger$表示而需要引入两种模式。
在动量给定后，只需要求解
\[
    (\gamma^\mu p_\mu - m) \psi = 0.
\]
洛伦兹变换不会改变这个方程的解的结构，所以为了弄清楚方程的解大致是什么样的我们可以先求解
\[
    (\gamma^0 p_0 - m) \psi = 0.
\]
我们会发现$p^0 = \pm \omega_{\vb*{p}}$各自对应两个独立的解，分别是
\[
    \pmqty{1 \\ 0 \\ 1 \\ 0}, \quad \pmqty{0 \\ 1 \\ 0 \\ 1}, \quad \pmqty{1 \\ 0 \\ -1 \\ 0}, \quad \pmqty{0 \\ 1 \\ 0 \\ -1}.
\]
容易验证自旋算符和哈密顿量对易，且魏尔旋量的两个分量正好就代表两种不同的自旋。
因此，标记平面波旋量场的分量的独立标签包括：三维动量，频率的正负，以及自旋$1/2$。
这样，我们设
\begin{equation}
    \psi(x) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{\sqrt{2 \omega_{\vb*{p}}}} (a_{\vb*{p}, s} u^s(p) \ee^{-\ii p \cdot x} + b_{\vb*{p}, s} v^s(p) \ee^{\ii p \cdot x}),
\end{equation}
其中$s = \pm 1/2$，$u^s$和$v^s$分别满足（这里$p_i$仍然和$p^i$差一个负号，以和闵可夫斯基时空度规一致）
\begin{equation}
    (\gamma^0 \omega_{\vb*{p}} + \gamma^i p_i) u_s(p) = m u_s(p), \quad (- \gamma^0 \omega_{\vb*{p}} + \gamma^i p_i) v_s(p) = m v_s(p), 
    \label{eq:u-v-eigen}
\end{equation}
并且被归一化为
\begin{equation}
    (u^r(p))^\dagger u^s(p) = 2 \omega_{\vb*{p}} \delta^{rs}, \quad (v^r(p))^\dagger v^s(p) = 2 \omega_{\vb*{p}} \delta^{rs}, \quad (u^r(p))^\dagger v^s(p) = 0.
    \label{eq:dirac-norm}
\end{equation}
这里$2\omega_{\vb*{p}}$因子是为了和后面的正则量子化中的动量积分中的$1/2\omega_{\vb*{p}}$因子抵消，从而保证正确的归一化，让动量产生湮灭算符的对易子为$\delta^3(\vb*{p} - \vb*{p})$的同时，$\psi$和$\ii \psi^\dagger$的对易子为$\ii \delta(\vb*{x} - \vb*{y})$。

代入哈密顿量，可以得到（我们会发现哈密顿量\eqref{eq:dirac-hamiltonian}中的第一项和\eqref{eq:u-v-eigen}左边的第二项抵消了）
\[
    H = \sum_{s} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} (a^\dagger_{\vb*{p}, s} a_{\vb*{p}, s} - b^\dagger_{\vb*{p}, s} b_{\vb*{p}, s}).
\]

看起来我们有麻烦了——$b$模式上的粒子产生得越多，能量越低，似乎出现了能量的无限下降。
然而，如果对$\psi$场施加反对易关系，就会得到
\[
    H = \sum_{s} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} (a^\dagger_{\vb*{p}, s} a_{\vb*{p}, s} + b_{\vb*{p}, s} b^\dagger_{\vb*{p}, s} - 1),
\]
在略去发散但是是常数的真空零点能之后就得到
\begin{equation}
    H = \sum_{s} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} (a^\dagger_{\vb*{p}, s} a_{\vb*{p}, s} + b_{\vb*{p}, s} b^\dagger_{\vb*{p}, s} ).
\end{equation}
现在如果我们将$b$看成某种粒子的\emph{产生}算符，而将$b^\dagger$看成\emph{湮灭}算符，那么我们就完成了量子化——哈密顿量变成了占据数的一次函数，并且有正确的反对易关系。
另一方面，如果施加对易关系，虽然也可以得到不会无限下降的哈密顿量，但是不能将$b$看成某种粒子的\emph{产生}算符，而将$b^\dagger$看成\emph{湮灭}算符，因为设$\tilde{b} = b^\dagger$，就有$\comm*{\tilde{b}}{\tilde{b}^\dagger} = -1$，而不是我们需要的$+1$。

于是，我们交换$b$和$b^\dagger$的位置，而要求
\begin{equation}
    \psi(x) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{\sqrt{2 \omega_{\vb*{p}}}} (a_{\vb*{p}, s} u^s(p) \ee^{-\ii p \cdot x} + b^\dagger_{\vb*{p}, s} v^s(p) \ee^{\ii p \cdot x}),
\end{equation}
并施加反对易关系
\begin{equation}
    \acomm*{\psi_a(\vb*{x})}{\psi^\dagger_b(\vb*{y})} = \delta^3(\vb*{x} - \vb*{y}) \delta_{ab},
\end{equation}
则哈密顿量就是
\begin{equation}
    H = \sum_{s} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} (a^\dagger_{\vb*{p}, s} a_{\vb*{p}, s} + b^\dagger_{\vb*{p}, s} b_{\vb*{p}, s} ).
\end{equation}

$b$模式和$a$模式互为反粒子。通过将$\psi$场的傅里叶展开中的积分变量换成$-\vb*{p}$（不改变积分值），可以发现
% 有误：只是对应，还需要加上$u$和$v$矩阵的切换
\[
    a^\dagger_{\vb*{p}} \ee^{- \ii \omega_{\vb*{p}} t} = b_{-\vb*{p}} \ee^{\ii \omega_{\vb*{p}} t},
\]
即它们的确互为反粒子。我们通常以$b^\dagger$为反粒子，虽然这只是习惯问题。
在绘制含有反粒子的费曼图时应当令传播子上的箭头和与传播子平行的动量箭头方向相反，这样顶角的形式无需因为传入的是粒子还是反粒子而改变（例如，$\gamma^\mu A_\mu \bar{\psi} \psi$的形式在这种情况下永远是“一条玻色子线连接一条方向指向顶角的费米子线和一条方向远离顶角的费米子线”），而又提醒了我们一个传播子是反粒子，同时顶角的动量守恒关系也非常直观。
这可以直观地展示为
\[
    \begin{tikzpicture}
        \begin{feynhand}
            \vertex (a) at (0,0); \vertex (b) at (2,0);
            \propag[fer, mom={$-k$}] (a) to (b);
        \end{feynhand}
    \end{tikzpicture} a(-k) = 
    \begin{tikzpicture}
        \begin{feynhand}
            \vertex (a) at (0,0); \vertex (b) at (2,0);
            \propag[fer, revmom={$k$}] (a) to (b);
        \end{feynhand}
    \end{tikzpicture} =
    b^\dagger(k) \begin{tikzpicture}
        \begin{feynhand}
            \vertex (a) at (0,0); \vertex (b) at (2,0);
            \propag[anti fermion, mom={$-k$}] (a) to (b);
        \end{feynhand}
    \end{tikzpicture} .
\]

总之，对旋量场，由于负能量部分（即反粒子）的存在，对易关系是不适用的，因此必须选择反对易关系，这意味着旋量场一定是费米场。

\subsubsection{旋量场的偏振}

现在我们只是形式地写出了$u$和$v$，但是并没有真的计算出它们具体是多少。
计算它们具体是多少是很重要的，因为显然易见，计算偏振方向任意的散射振幅时要用到它们。

首先，对$\vb*{p}=0$的情况，有
\begin{equation}
    u(p) = \sqrt{m} \pmqty{\xi \\ \xi}, \quad \xi^\dagger \xi = 1,
\end{equation}
这样和归一化条件\eqref{eq:dirac-norm}一致。

不失一般性地，认为$\vb*{p}$指向$z$轴。我们的策略是这样的：首先写出动量和推动参数$\eta$之间的关系%
\footnote{
    这里有一个可能的问题，虽然我们确定与能量匹配、共同组成四维动量的那个$\vb*{p}$和标记了自由旋量场的稳定模式的那个$\vb*{p}$都是空间平移的生成元，万一它们没有被一起“定标”怎么办？比如说，如果正好差一个常数怎么办？自旋就有这样的情况。
    好在我们已经证明，对后者也有$E^2 = \abs*{\vb*{p}}^2 + m^2$，因此这两个$\vb*{p}$的的确确是同一个东西。
}%
，然后将$\eta$代入旋量场的洛伦兹变换计算出动量为$\vb*{p}$的模式。

设我们做了一个洛伦兹变换，空间动量方向指向$z$轴，即有
\[
    \pmqty{E \\ p^3} = \exp(\eta \pmqty{0 & 1 \\ 1 & 0}) \pmqty{m \\ 0} = \pmqty{m \cosh \eta \\ m \sinh \eta},
\]
另一方面，在$p=(E, 0, 0, p^3)$时
% TODO:以及统一记号

\begin{equation}
    u(p) = \pmqty{ \sqrt{p \cdot \sigma} \xi \\ \sqrt{p \cdot \bar{\sigma}} \xi },
\end{equation}
类似地可以得到
\begin{equation}
    v(p) = \pmqty{ \sqrt{p \cdot \sigma} \xi \\ - \sqrt{p \cdot \bar{\sigma}} \xi }.
\end{equation}

\begin{equation}
    \bar{u}^r(p) u^s(p) = 2 m \delta^{rs}, \quad u^{r \dagger}(p) u^s(p) = 2 \omega_{\vb*{p}} \delta^{rs},
\end{equation}
\begin{equation}
    \bar{v}^r(p) v^s(p) = - 2 m \delta^{rs}, \quad v^{r \dagger}(p) v^s(p) = 2 \omega_{\vb*{p}} \delta^{rs}.
\end{equation}

\begin{equation}
    \sum_s u^s(p) \bar{u}^s(p) = \slashed{p} + m, \quad \sum_s v^s(p) \bar{v}^s(p) = \slashed{p} - m.
\end{equation}

后面我们将会用$\xi$表示$(\xi^1, \xi^2)$，从而$\xi^\dagger \xi = \sigma^0$。

\concept{Gordon恒等式}

\begin{equation}
    \bar{u}(q_2) (q_1^\mu )
\end{equation}

\subsubsection{守恒量和洛伦兹不变量}

\begin{equation}
    \sigma^{\mu \nu} = \frac{\ii}{2} \comm*{\gamma^\mu}{\gamma^\nu}
\end{equation}

\subsubsection{旋量场的传播子}

现在计算旋量场的各种传播子。旋量场的传播子定义需要特别注意，因为一个$\psi$中含有一种粒子和一种反粒子。
所幸，一个只含有空间定域的正费米子的态还是可以通过$\psi^\dagger \ket{0}$创建，因为反费米子的湮灭算符作用在真空态上给出零，没有任何贡献。
看起来，用$\mel*{0}{\psi \psi^\dagger}{0}$做正费米子的传播子而用$\mel*{0}{\psi^\dagger \psi}{0}$做反费米子的传播子应该是正确的。
然而，可以发现，这样的传播子不是洛伦兹协变的。能够从相对论性量子场论的路径积分计算出来的关联函数肯定是洛伦兹协变的，既然$\mel*{0}{T \psi \psi^\dagger}{0}$不是洛伦兹协变，那么可能并不能很容易地计算它，可能Wick定理都不一定成立，等等。
因此我们应该计算和$\mel*{0}{T \psi \psi^\dagger}{0}$只差一个可逆矩阵变换但是是洛伦兹协变的$\mel*{0}{T \psi \bar{\psi}}{0}$。%
\footnote{
    没有什么规定了传播子一定要定义成$\mel*{0}{\psi \psi^\dagger}{0}$的形式；计算传播子的目的是获得一种简便易行的方式，可用于从一个拉氏量中提取时间演化算符在多粒子态（可以使用场的连乘构造）下的矩阵元，因此传播子只需要大体上长成$\mel*{0}{\psi \psi^\dagger}{0}$的形式即可，差一个线性变换是完全可以的，只要所有重要的信息都能够恢复出来。
}%

\subsubsection{旋量场的路径积分量子化}

其实用路径积分算这个更快
\begin{equation}
    D_F(x-y) = \mel{0}{T \psi(x) \bar{\psi}(y)}{0} = \int \frac{\dd[4]{p}}{(2\pi)^4} \frac{\ii (\slashed{p} + m)}{p^2 - m^2 + \ii 0^+} \ee^{- \ii p \cdot (x- y)}.
\end{equation}

% TODO：费曼图
费米子的费曼规则比较难写。但是在规范场论中其实很好写，因为一张图中不存在涉及一个以上费米子的顶角，即每个顶角中都只有一个费米子进去，一个费米子出来，矩阵$\gamma^\mu$，$u$和$v$（列矢量按照$s$指标排成矩阵）只需要按照这个费米子的“世界线”依次累乘即可。

\subsection{非相对论极限}

在非相对论极限下旋量场当然也会退化成薛定谔场。

\section{矢量场}


\subsection{矢量场的麦克斯韦方程和布洛卡方程}

\subsubsection{对称性分析}

% TODO：$(\partial_\mu A^\mu)^2$
由于自由场导数阶数的限制，出现在拉氏量中的只能是$A^\mu$和$\partial^\nu A^\mu$构成的一次或二次不变量。当然，实际上也可以出现$\partial_\mu A^\nu$或者$\partial_\mu A_\mu$这种，但因为它们都可以使用$\partial^\nu A^\mu$表示出来，故没有必要考虑它们。
只含有$A^\mu$二次不变量为$A^\mu A_\mu$，没有一次不变量；只含有$\partial^\mu A^\nu$的一次不变量是它自我缩并得到的$\partial^\mu A_\mu$，二次的不变量是两个$\partial^\mu A^\nu$缩并得到的$\partial^\mu A^\nu \partial_\mu A_\nu$和$\partial^\mu A^\nu \partial_\nu A_\mu$。
由于参数都是标量，$\partial^\mu A^\nu$不能和参数缩并，也不能和$A^\mu$缩并（$C^\nu A^\mu \partial_\nu A_\mu$要求参数是矢量，$A^\mu A^\nu \partial_\mu A_\nu$是三次项），因此我们得到了所有可能的不变量。
从而拉氏量形如
\[
    \mathcal{L} = C_1 A^\mu A_\mu + C_2 \partial^\mu A_\mu + C_3 \partial^\mu A^\nu \partial_\mu A_\nu + C_4 \partial^\mu A^\nu \partial_\nu A_\mu.
\]
代入欧拉-拉格朗日方程可以看出，$C_2$项在运动方程中不会引入任何项，故略去。
于是
\[
    \mathcal{L} = C_1 A^\mu A_\mu + C_3 \partial^\mu A^\nu \partial_\mu A_\nu + C_4 \partial^\mu A^\nu \partial_\nu A_\mu.
\]
代入欧拉-拉格朗日方程，得到
\begin{equation}
    \partial_\mu (C_3 \partial^\mu A^\nu +  C_4 \partial^\nu A^\mu) = C_1 A^\nu.
    \label{eq:vector-motion-eq}
\end{equation}
我们首先考虑$C_3 = - C_4$时的特殊情况。重新定义各系数，使得
\begin{equation}
    \mathcal{L} = - \frac{1}{2} \partial^\mu A^\nu \partial_\mu A_\nu + \frac{1}{2} \partial^\mu A^\nu \partial_\nu A_\mu + \frac{m^2}{2} A_\mu A^\mu,
\end{equation}
对应的，
\begin{equation}
    \partial_\mu (\partial^\mu A^\nu - \partial^\nu A^\mu) + m^2 A^\nu = 0.
    \label{eq:proca-eq}
\end{equation}
常定义
\begin{equation}
    F^{\mu \nu} = \partial^\mu A^\nu - \partial^\nu A^\mu,
\end{equation}
于是就有
\begin{equation}
    \mathcal{L} = - \frac{1}{4} F_{\mu \nu} F^{\mu \nu} + \frac{1}{2} m^2 A_\mu A^\mu.
    \label{eq:proca-lagrangian}
\end{equation}
现在回到一般情况。我们指出这样一个结论：无论$C_3,C_4$取什么值，对应的场$A^\mu$都可以和$C_3 = - C_4$时的某个场${A'}^\mu$建立一一对应。
% TODO:证明
因此布洛卡方程\eqref{eq:proca-eq}就不失一般性地描写了所有的矢量场的运动方程。

\eqref{eq:proca-eq}在$m \neq 0$时可以推导出克莱因-高登方程。注意到
\[
    m^2 \partial_\nu A^\nu = \partial_\nu \partial_\mu \partial^\nu A^\mu - \partial_\mu \partial^\mu \partial_\nu A^\nu = 0,
\]
于是
\begin{equation}
    \partial_\mu A^\mu = 0.
    \label{eq:lorentz-gauge}
\end{equation}
回代入\eqref{eq:proca-eq}，发现其左边第二项为零，于是
\[
    \partial_\mu \partial^\mu A^\nu + m^2 A^\nu = 0.
\]
于是\eqref{eq:proca-eq}就约化成了\eqref{eq:lorentz-gauge}和四个克莱因-高登方程。
而当$m=0$时，运动方程在规范变换
\begin{equation}
    A^\mu \longrightarrow {A'}^\mu = A^\mu + \partial^\mu \varphi
\end{equation}
下不变。这意味着矢量场$A^\mu$的四个自由度实际上是多余的。%
\footnote{显然，只要选定了一个$\varphi$，同一个时间点上的$A^\mu$和${A'}^\mu$之间必定可以建立起一一对应关系。形象地说，不同$\varphi$对应的$A'$的运行轨迹相互平行，因此只需要其中一条轨迹就能够确定所有轨迹。选取特定的一条轨迹就是选取一个规范。
规范自由度——也就是决定“实际的轨道是哪一条”的自由度——是一个隐藏的额外自由度。
这里的情况和对称性自发破缺有点类似，在后者中，隐藏的自由度是序参量。不同的隐藏的额外自由度取值将系统的态空间分成了互不相交的分支。
可以认为规范自由度不是物理的自由度，也就是说它仅仅出现在拉氏量中，而规范自由度取值不同的状态在希尔伯特空间中应该被认为是同样的状态。
选取一个规范意味着先假定规范自由度取值不同的状态真的是不一样的，然后取状态空间中的一个分支。}%
换而言之，存在\emph{规范冗余性}。

\subsubsection{重矢量场的哈密顿量}

矢量场的共轭动量为
\[
    \pi_\mu = \partial_\mu A^0 - \partial^0 A_\mu,
\]
或者写成
\begin{equation}
    \pi^\mu = \partial^\mu A^0 - \partial^0 A^\mu.
\end{equation}
注意到$\pi^0 = 0$，因此可以只讨论其空间部分$\vb*{\pi}$。
在质量$m$不为零时场没有规范不变性，可以直接做计算得到
\begin{equation}
    A^0 = - \frac{1}{m^2} \div{\vb*{\pi}},
\end{equation}
以及
\begin{equation}
    \partial_0 A^0 = - \partial_i A^i = - \div{\vb*{A}},
\end{equation}
哈氏量为
\begin{equation}
    \mathcal{H} = \frac{1}{2} \vb*{\pi}^2 + \frac{1}{2m^2} (\div{\vb*{\pi}})^2 + \frac{1}{2} (\curl{\vb*{A}})^2 + \frac{1}{2} m^2 \vb*{A}^2.
\end{equation}
$m$出现在了分母中，这意味着无质量的场需要额外处理。

\subsubsection{麦克斯韦理论的经典规范选取}

现在来处理无质量的场。其运动方程为
\[
    \partial_\mu (\partial^\mu A^\nu - \partial^\nu A^\mu) = 0.
\]
无论$\partial_\mu A^\mu$是什么，总可以找到一个$\varphi$使得
\[
    \partial_\mu \partial^\mu \varphi = - \partial_\mu A^\mu,
\]
从而对应的有
\[
    \partial_\mu {A'}^\mu = 0.
\]
于是我们不失一般性地强行要求\eqref{eq:lorentz-gauge}对$m=0$时的矢量场成立。这称为选取了\concept{洛伦兹规范}。选取了洛伦兹规范意味着，实际的场自由度只有三个。知道了$A$的三个分量就可以计算出第四个。
当然，这不是唯一的规范选取方式。例如可以直接要求$A^0 = 0$，称为\concept{辐射规范}。
选取洛伦兹规范的好处在于，方程\eqref{eq:lorentz-gauge}是洛伦兹协变的，因此在做量子化时能够直接套用正则量子化关系而不必担心场方程不是洛伦兹协变而产生的修正。

我们施加洛伦兹规范。当然也可以选取别的规范，但这可能会破坏洛伦兹协变性，从而导致我们得到的哈密顿动力学实际上是带有约束的，从而给之后做量子化带来麻烦。
此时运动方程为
\begin{equation}
    \partial_\mu \partial^\mu A^\nu = 0.
    \label{eq:massless-vector-eq}
\end{equation}
拉氏量\eqref{eq:proca-lagrangian}直接导出的不是这个方程，于是我们使用另一个能够直接导出\eqref{eq:massless-vector-eq}的拉氏量
\begin{equation}
    \mathcal{L} = - \frac{1}{4} F_{\mu \nu} F^{\mu \nu} - \frac{1}{2} (\partial_\mu A^\mu)^2.
    \label{eq:maxwell-lagrangian-fixed}
\end{equation}
可以看到这个拉氏量多出了一项，这个实际上就是所谓的规范固定项。
在给定了洛伦兹规范的前提下，这个拉氏量实际上就和$m=0$的\eqref{eq:proca-lagrangian}是等价的。
此时
\begin{equation}
    \pi^0 = -\partial_\mu A^\mu, \quad \pi^i = \partial^i A^0 - \partial^0 A^i.
\end{equation}
当然，由洛伦兹规范，$\pi^0$就是零，不过我们完全可以算出哈密顿量之后再施加洛伦兹规范。
哈密顿量为 % TODO:这一部分似乎不需要太多笔墨，反正量子化的时候都是重新算的 关键之处在于哈密顿量和规范是有关的
\begin{equation}
    \mathcal{H} = 
\end{equation}

\subsection{无质量矢量场的正则量子化}

无质量矢量场的正则量子化涉及很多棘手的细节。

\subsubsection{横场量子化}

使用\eqref{eq:field-operator-fourier}展开一个无质量矢量场为
\begin{equation}
    A_\mu (\vb*{x}, t) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{\sqrt{2 \omega_{\vb*{p}}}} \sum_{r=0}^3 \epsilon_\mu^r(\vb*{p}) \left({a}_{\vb*{p}, r}^\dagger \ee^{ - \ii \vb*{p} \cdot \vb*{x} + \ii \omega_{\vb*{p}} t} + {a}_{\vb*{p}, r} \ee^{ \ii \vb*{p} \cdot \vb*{x} - \ii \omega_{\vb*{p}} t} \right), 
    \label{eq:expanding-massless-vector-field}
\end{equation}
由于没有质量，
\begin{equation}
    \omega_{\vb*{p}} = \abs{\vb*{p}}.
\end{equation}
$\epsilon^r$为一组闵可夫斯基时空的基矢量，称它们为\concept{偏振矢量}，也即，
\begin{equation}
    (\epsilon^r)_\mu (\epsilon^{r'})^\mu = \eta^{r r'}.
\end{equation}
为了确定偏振矢量，通常要求
\begin{equation}
    \epsilon^1 \cdot p = \epsilon^2 \cdot p = 0,
\end{equation}
并认为$\epsilon^0$是类时的，而$\epsilon^{1,2,3}$是类空的。这样，当$p^\mu \propto (1, 0, 0, 1)$，即$\vb*{p}$指向$z$轴时，我们有
\begin{equation}
    \epsilon^0 = \pmqty{1 \\ 0 \\ 0 \\ 0}, \quad \epsilon^1 = \pmqty{0 \\ 1 \\ 0 \\ 0}, \quad \epsilon^2 = \pmqty{0 \\ 0 \\ 1 \\ 0}, \quad \epsilon^3 = \pmqty{0 \\ 0 \\ 0 \\ 1}.
    \label{eq:z-axis-p-epsilon}
\end{equation}
% TODO:这是$\epsilon^\mu$还是$\epsilon_\mu$？？？
$p$取其它值时只需要对\eqref{eq:z-axis-p-epsilon}做洛伦兹变换即可，因为$\epsilon$的定义完全是洛伦兹协变的。

% TODO:为什么？这一片我都没有动手算过，
可以计算出
\begin{equation}
    \pi^\mu (\vb*{x}, t) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \sqrt{\frac{\omega_{\vb*{p}}}{2}} \ii \sum_{r=0}^3 (\epsilon^r)^\mu (\vb*{p}) \left( {a}_{\vb*{p}, r} \ee^{\ii \vb*{p} \cdot \vb*{x} - \ii \omega_{\vb*{p}} t} - {a}_{\vb*{p}, r}^\dagger \ee^{ - \ii \vb*{p} \cdot \vb*{x} + \ii \omega_{\vb*{p}} t} \right),
\end{equation}
施加正则对易关系，通过计算得到
% TODO：真的可以**等价**地得到下式吗？？
\begin{equation}
    \comm*{{a}_{\vb*{p}, \lambda}}{{a}^\dagger_{\vb*{p}', \lambda'}} = - \eta_{\lambda \lambda'} (2\pi)^3 \delta^3(\vb*{p} - \vb*{p}'), \quad \comm*{{a}^\dagger_{\vb*{p}, \lambda}}{{a}^\dagger_{\vb*{p}', \lambda'}} = \comm*{{a}_{\vb*{p}, \lambda}}{{a}_{\vb*{p}', \lambda'}} = 0.
\end{equation}
$\lambda=1, 2, 3$时对易关系是正确的，但是$\lambda=0$给出了一个不正常的对易关系
\[
    \comm*{{a}_{\vb*{p}, 0}}{{a}^\dagger_{\vb*{p}', 0}} = - (2\pi)^3 \delta^3 (\vb*{p} - \vb*{p}').
\]
例如，它产生的同样的单粒子态的内积将会是一个负数，这和我们对单粒子态的通常认识不符。
此外，哈密顿量成为
\begin{equation}
    {H} = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} \left( - {a}_{\vb*{p},0}^\dagger {a}_{\vb*{p}, 0} + \sum_{i=1}^3 {a}_{\vb*{p},i}^\dagger {a}_{\vb*{p}, i} \right),
\end{equation}
因此能量非正定。
显然这些问题都和${a}^\dagger_{\vb*{p},0}$有关，也就是说来自一个非物理的自由度。
会有非物理的自由度是显然的，因为我们在处理一个有规范不变性的场却从来没有选取过一个规范。
现在我们处理的是量子场，因此既可以直接对场做约束，也可以缩小态空间的范围。

我们先尝试直接将洛伦兹规范作用在场上，即要求对场算符有
\[
    \partial^\mu A_\mu = 0.
\]
然而，这是不可能的，
% TODO
经过检验，Gupia-Blenler量子化条件
\begin{equation}
    \partial^\mu {A}_\mu^{(+)} \ket{\psi} = 0
    \label{eq:gupia-blenlder}
\end{equation}
是一个可行的方案。
它实际上约束了态空间的范围。
代入\eqref{eq:expanding-massless-vector-field}，并注意到$\epsilon^1$与$\epsilon^2$和四维动量做内积得到零，我们发现
\begin{equation}
    ({a}_{\vb*{p}, 0} - {a}_{\vb*{p}, 3}) \ket{\psi} = 0.
\end{equation}
这意味着在无质量矢量场的态空间中哈密顿量实际上是
\begin{equation}
    {H} = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \omega_{\vb*{p}} ({a}_{\vb*{p},1}^\dagger {a}_{\vb*{p}, 1} + {a}_{\vb*{p},2}^\dagger {a}_{\vb*{p}, 2}).
\end{equation}
于是负能量问题也就解决了。哈密顿量中没有出现的量可以直接被略去，因为它们对系统的动力学不产生任何影响。
% TODO:严格说明
于是取
\begin{equation}
    A_\mu (\vb*{x}, t) = \int \frac{\dd[3]{\vb*{x}}}{(2\pi)^3} \frac{1}{\sqrt{2 \omega_{\vb*{p}}}} \sum_{r=1}^2 \epsilon_\mu^r(\vb*{p}) \left({a}_{\vb*{p}, r}^\dagger \ee^{ - \ii \vb*{p} \cdot \vb*{x} + \ii \omega_{\vb*{p}} t} + {a}_{\vb*{p}, r} \ee^{ \ii \vb*{p} \cdot \vb*{x} - \ii \omega_{\vb*{p}} t} \right),
\end{equation}
以及
\begin{equation}
    \pi^\mu (\vb*{x}, t) = \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \sqrt{\frac{\omega_{\vb*{p}}}{2}} \ii \sum_{r=1}^2 (\epsilon^r)^\mu (\vb*{p}) \left( {a}_{\vb*{p}, r} \ee^{\ii \vb*{p} \cdot \vb*{x} - \ii \omega_{\vb*{p}} t} - {a}_{\vb*{p}, r}^\dagger \ee^{ - \ii \vb*{p} \cdot \vb*{x} + \ii \omega_{\vb*{p}} t} \right),
\end{equation}
重新计算对易关系得到
\begin{equation}
    \comm*{{a}_{\vb*{p}, \lambda}}{{a}^\dagger_{\vb*{p}', \lambda'}} = \delta_{\lambda \lambda'} (2\pi)^3 \delta^3(\vb*{p} - \vb*{p}'), \quad \comm*{{a}^\dagger_{\vb*{p}, \lambda}}{{a}^\dagger_{\vb*{p}', \lambda'}} = \comm*{{a}_{\vb*{p}, \lambda}}{{a}_{\vb*{p}', \lambda'}} = 0, \quad \lambda = 1, 2.
\end{equation}

\subsubsection{守恒量}

下面我们推导动量和自旋角动量的公式。轨道角动量的由于是动量衍生出来的量，我们暂不考虑。
首先假设$p^\mu \propto (1, 0, 0, 1)$。
按照\eqref{eq:spin-angular-momentum}可以计算得到
\[
    {S}_3 = \int \dd[3]{\vb*{x}} \mathcal{S}_3 = \ii \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} (- {a}_{\vb*{p},1} {a}^\dagger_{\vb*{p}, 2} + {a}^\dagger_{\vb*{p}, 1} {a}_{\vb*{p}, 2} + {a}_{\vb*{p}, 2} {a}_{\vb*{p}, 1}^\dagger - {a}_{\vb*{p}, 2}^\dagger {a}_{\vb*{p}, 1} ) ,
\]
另外两个方向上的自旋角动量都是零。

我们原本预期矢量场会有三个自由度（因为\eqref{eq:lorentz-gauge}消除掉了一个自由度），但是实际上无质量矢量场只有两个自由度。
导致这一切的原因当然是无质量这个事实——它使得四维动量$p$不再能够写成$(1, 0, 0, 0)$这样的形式，而只能够写成$(1,0,0,1)$这样，从而让$A^0$和$A^3$相互抵消了。
从洛伦兹群在态空间上的表示出发可以更好地看待这个问题：$m=0$时洛伦兹群保持动量不变的小群不再是旋转群。
以一种更加物理的视角，无质量矢量场对应的粒子一直在以光速运动，不能找到一个相对它静止的参考系，因此对一个这样的粒子，实际上总是有一个特定的空间方向即它的运动方向，为了保持协变性，其自旋只能够沿着这个方向。换而言之，此时有意义的实际上是螺旋度而不是三维的角动量${\vb*{S}}$，即其内禀自由度是平面旋转群（以运动方向为轴旋转）的表示而不是三维旋转群的表示。
而对有质量的粒子，总是可以找到一个相对它静止的参考系，在这个参考系中空间是各向同性的，因此可以应用$SO(3)$的表示。
这和经典电磁场的偏振只有两个方向是对应的。
% TODO：经典场的傅里叶分量就是量子的产生湮灭算符

% TODO：场实际上只有两个自由度，因此粒子也只有两个内禀自由度，因此螺旋度是粒子的内禀自由度空间的CSCO。

% TODO：所以总之就是，无质量矢量场的自旋只在动量的方向上有非零分量，因此描述无质量矢量场的粒子的内禀自由度需要的实际上是螺度

\subsubsection{传播子}

由于洛伦兹度规的空间部分全部都是负的，我们有
\begin{equation}
    D_F = \mel*{0}{T A_{\mu}(x) A_{\nu}(y)}{0} = - \int \frac{\dd[4]{p}}{(2\pi)^4} \frac{\ii \eta_{\mu \nu}}{p^2 + \ii 0^+} \ee^{- \ii p \cdot (x - y)} = \int \frac{\dd[4]{p}}{(2\pi)^4} \frac{\ii \delta_{\mu \nu}}{p^2 + \ii 0^+} \ee^{- \ii p \cdot (x - y)}.
\end{equation}

有一点应该指出：规范选取\eqref{eq:gupia-blenlder}是作用在态上的。
这就是说，% TODO：虚光子？？？

\subsection{重矢量场的正则量子化}

\subsection{路径积分量子化和规范固定}

我们现在从路径积分的角度量子化无质量矢量场。我们首先尝试朴素地直接将$m=0$的\eqref{eq:proca-lagrangian}放入$\ee$指数，通过分部积分，得到
\begin{equation}
    S = - \frac{1}{4} \int \dd[4]{x} F_{\mu \nu} F^{\mu \nu} = \frac{1}{2} \int \dd[4]{x} = \frac{1}{2} \int \dd[4]{x} A^\mu (\eta_{\mu \nu} \partial^2 - \partial_\mu \partial_\nu) A^\nu,
\end{equation}
那么，合乎情理的下一步就是取积分核$(\eta_{\mu \nu} \partial^2 - \partial_\mu \partial_\nu)$的逆。
现在问题出现了：这个积分核根本就没有逆——其行列式为零。
因此，直接将$m=0$的\eqref{eq:proca-lagrangian}放入$\ee$指数得到的结果是发散的。
这当然是因为我们没有做规范固定。对无相互作用的无质量矢量场，局域对称操作
\[
    A^\mu \longrightarrow A^\mu + \partial^\mu \alpha
\]
不改变哈密顿量。实际上这是一个规范对称性，即这个局域操作不会改变量子态。然而，朴素地做路径积分不会考虑这一点，从而路径积分会对本该只求和一遍的场构型求和无数多遍。

本节将使用\concept{Faddeev-Popov量子化}方法，大致的思路是通过适当手段插入一个$\delta$函数，对一族规范等价的场构型，只挑选其中一个纳入路径积分。
这一方法的不足之处在于可能还不能消除所有的规范冗余性，但是对微扰计算来说，由于场构型的变动总是充分小的，Faddeev-Popov量子化足够给出可靠的答案。
我们在朴素版本的配分函数的$A$的积分后面插入
\[
    1 = \int \fd{\alpha} \delta(G(A^\alpha)) \det\left( \fdv{G(A^\alpha)}{\alpha} \right),
\]
其中$A^\alpha$就是$A+\partial \alpha$。这样就有
\[
    \begin{aligned}
        Z &= \int \fd{A} \int \fd{\alpha} \delta(G(A^\alpha)) \det\left( \fdv{G(A^\alpha)}{\alpha} \right) \ee^{\ii S[A]} \\
        &= \int \fd{\alpha} \int \fd{A^\alpha} \delta(G(A^\alpha)) \det\left( \fdv{G(A^\alpha)}{\alpha} \right) \ee^{\ii S[A^\alpha]},
    \end{aligned}
\]
其中$A^\alpha$的积分测度和$A$完全一样，且规范对称性意味着$S[A^\alpha]$和$S[A]$也一样。
为了保持洛伦兹协变性，$G(A)$可以选择为这样：
\begin{equation}
    G(A^\alpha) = \partial^\mu A_\mu^\alpha - \omega(x) = \partial^\mu A_\mu + \partial^2 \alpha - \omega(x),
\end{equation}
其中$\omega$是一个任意的标量函数。这样，雅可比行列式因子就可以提出积分号外，得到
\[
    \begin{aligned}
        Z &= (\det \partial^2) \int \fd{\alpha} \int \fd{A^\alpha} \delta(\partial^\mu A_\mu^\alpha - \omega) \ee^{\ii S[A^\alpha]} \\
        &= (\det \partial^2) \int \fd{\alpha} \int \fd{A} \delta(\partial^\mu A_\mu - \omega)  \ee^{\ii S[A]},
    \end{aligned}
\]
这里我们已经重新标记$A^\alpha$为$A$了。既然$\omega$可以随意变动，我们不妨对所有的$\omega$做一次求和，得到
\[
    \begin{aligned}
        Z' &= \int \fd{\omega} \ee^{-\ii \int \dd[4]{x} \frac{\omega^2}{2 \xi}} (\det \partial^2) \int \fd{\alpha} \int \fd{A} \delta(\partial^\mu A_\mu - \omega)  \ee^{\ii S[A]} \\
        &= (\det \partial^2) \int \fd{\alpha} \int \fd{A} \ee^{\ii S[A]} \exp(- \ii \int \dd[4]{x} \frac{1}{2 \xi} (\partial^\mu A_\mu)^2).
    \end{aligned}
\]
现在可以把前面的一大堆因子全部扔掉，得到最后的配分函数：
\begin{equation}
    Z = \int \fd{A} \exp(\ii \int \dd[4]{x} \left( - \frac{1}{4} F_{\mu \nu} F^{\mu \nu} - \frac{1}{2 \xi} (\partial^\mu A_\mu)^2\right)).
\end{equation}
可以看到，这实际上就是向拉氏量加了一个\concept{规范固定项}，破坏了拉氏量的规范对称性，但是得到的物理是完全一样的。
$\xi=1$称为\concept{费曼规范}，和\eqref{eq:maxwell-lagrangian-fixed}是一致的；$\xi=0$称为\concept{朗道规范}。

做完规范固定之后，可以按照正常的手续求出传播子。通过分部积分将作用量写成
\[
    S = \int \dd[4]{x} (A^\mu (\eta_{\mu \nu} \partial^2 - (1 - \frac{1}{\xi}) \partial_\mu \partial_\nu) A^\nu),
\]
于是
\[
    \mel{0}{T A_\mu(x) A_\nu(y)}{0} = \int \frac{\dd[4]{x}}{(2\pi)^4} \frac{\ii}{-k^2 \eta^{\mu \nu} + (1 - \frac{1}{\xi}) k^\mu k^\nu},
\]
并需要加上一个无穷小虚部。我们会发现
\[
    \left( -k^2 \eta^{\mu \nu} + (1 - \frac{1}{\xi}) k^\mu k^\nu \right) \left(\eta_{\nu \rho} - (1 - \xi) \frac{k_\nu k_\rho}{k^2} \right) = - k^2 \delta^\mu_\rho,
\]
于是
\begin{equation}
    D_F(x - y)_{\mu \nu} = \mel*{0}{T A_\mu(x) A_\nu(y)}{0} = \int \frac{\dd[4]{k}}{(2\pi)^4} \frac{-\ii}{k^2 + \ii 0^+} \left( \eta_{\mu \nu} - (1 - \xi) \frac{k_\mu k_\nu}{k^2} \right).
\end{equation}
这里多出来的一个负号是因为，在标量场和旋量场中，拉氏量动能项的两个导数算符分别作用在两个场上，将一个场视为入射，一个视为出射，切换到动量空间，得到的是$- \ii k \cdot \ii k = k^2$，而在这里，两个导数算符都作用在右边的场上，得到的是$(\ii k)^2=-k^2$。
请注意上式已经是做完规范固定之后的结果，无需再额外做任何规范固定，这就是说，对一张费曼图的中间态求和时，$\mu$和$\nu$的确要取遍$0$到$4$。
只有入射光子外线和出射光子外线需要特别选择。

\section{散射}

高能物理实验中涉及的物理过程的时间尺度通常远远小于我们能够观察的时间尺度，并且一般很难研究束缚态（部分是因为束缚态问题基本上是凝聚态研究的范畴而此时除了库仑定律以外也不需要太多物理，部分是因为微扰计算束缚态问题非常困难）。
因此，大部分情况下我们都只需要考虑初末态均在无穷远处的散射问题即可。因此，需要计算的主要就是$S$矩阵——实际上是动量表象下的$S$矩阵，以下如无特殊说明，$S$矩阵指的就是动量表象下的$S$矩阵。
然而，实验中能够制备的含有一定量的动量确定的粒子的态是完整的哈密顿量的本征态（而不是自由理论的本征态），此时的多粒子态的能量不是其单粒子能量的简单相加。
原则上我们同样可以微扰计算完整的哈密顿量的本征态，但是这将是非常费力并且困难的。

然而，在实际的散射问题中，无论是入射态还是出射态的结构都相对简单，因为实际的物理粒子的波函数的分布不可能是遍布全空间的平面波，而只能是动量大体上确定的波包，而将时间推到$\infty$或是$-\infty$时这些波包会相隔得足够远，从而它们之间没有相互作用，整个量子态的能量也就是各个粒子的能量之和。（或者等价地说，入射和出射时相互作用可能认为是“关闭”的，而只有粒子相隔得足够近才被打开）
因此，入射态和出射态实际上仍然能够写成
\[
    \ket{p_1, p_2, \cdots, p_n} = \sqrt{2\omega_{\vb*{p}_1}} \cdots \sqrt{2\omega_{\vb*{p}_n}} a^\dagger_{\vb*{p}_1} a^\dagger_{\vb*{p}_2} \cdots a^\dagger_{\vb*{p}_n} \ket{\Omega}
\]
的形式，但是此时的$a$算符——可以记为$a_\text{in}$或$a_\text{out}$——已经不再是自由场（“裸的”场）的$a$算符了，因为它创建的单粒子态是实际的、加入了相互作用的哈密顿量的本征态，即它创建的单粒子态是物理粒子，而不是没有相互作用时的裸粒子；同样$\omega$也不再是裸的单粒子能量。%
\footnote{
    我们对入射态和出射态的要求是非常严格的：一方面，出现在这些态中的粒子一定是能够稳定存在的粒子，寿命有限的准粒子（对应完整的哈密顿量的展宽的能级，可以看成是近似的本征态，但是因为各种扰动而不是严格的本征态）不能出现在入射态和出射态中；我们还进一步要求这些粒子之间的距离足够远，以至于可以近似看成自由的；最后我们还要求这些态被正确地归一化了，从而引入场强重整化因子。

    凝聚态理论考虑的系统状态比这多得多：寿命有限的准粒子时常需要被讨论，并且通常不会一次重整化就把所有相互作用都去除而只留下带自能修正的粒子。
    例如，费米液体理论中的“电子”实际上是已经经过相互作用修正的能带电子，但是即使在系统基态中这些准粒子的相互碰撞仍然需要纳入考虑。
}%
在海森堡绘景下，$S$矩阵的矩阵元基本上就具有
\[
    \braket*{p_1, p_2}{k_1, k_2} = \sqrt{2\omega_{\vb*{p}_1}} \sqrt{2\omega_{\vb*{p}_2}} \sqrt{2\omega_{\vb*{k}_1}} \sqrt{2\omega_{\vb*{k}_2}} \mel*{\Omega}{a_{\vb*{p}_2} a_{\vb*{p}_1} a^\dagger_{\vb*{k}_1} a^\dagger_{\vb*{k}_2}}{\Omega}
\]
这样的形式，这意味着只要能够找到$a_\text{in}$，$a_\text{out}$和裸场$a$之间的关系，即可确定关联函数和$S$矩阵的关系。
为了看出$a_\text{in}$，$a_\text{out}$和裸场$a$之间的关系，我们可以尝试为这种近乎独立的$a_\text{in}$和$a_\text{out}$所描述的“自由粒子”写下一个有效理论，显然这个有效理论是完整的、带有相互作用的理论不断重整化的结果，相互作用会修正“自由理论”的参数。
由于只考虑单粒子，相互作用带来的修正实际上就是所谓的自能修正：能够调整的参数包括质量项和$\partial_\mu \phi \partial^\mu \phi$项，对后者的调节等价于对场本身的变换。（此外，由于只考虑单粒子，且四维动量$p$的安排非常接近在壳，粒子无法衰变，因此自能修正没有虚部）
因此我们得出结论：$a_\text{in}$，$a_\text{out}$和裸场$a$之间应该差一个常数，这个常数是场强重整化引入的因子。
这就确定了关联函数和$S$矩阵之间的关系：在统一到动量空间中之后，两者首先由于相互作用修正的原因会差一个场强重整化因子；动量空间中的关联函数的解析性质和自由场的关联函数非常相似，只不过前者的极点给出的“质量”会出现跑动；相比之下，$S$矩阵要光滑很多，因为没有极点。
可以从关联函数计算$S$矩阵，但是不能反过来，因为$S$矩阵仅仅包含初态位于$-\infty$而末态位于$\infty$的过程。
因此应当有：
\[
    \prod_{i} \frac{\text{renormalization factors}}{\omega - \omega_{\vb*{k}} + \ii 0^+} \times \mel*{p}{S}{k} \propto \text{Fourier transformation of} \mel*{\Omega}{\phi(x_1) \cdots \phi(x_n)}{\Omega}.
\]

虽然我们做出了以上形式的论证，完整地做Wilson重整化群计算而得到场强重整化因子当然还是非常繁琐的，因此本节尝试以一种更加简单的方法建立微扰计算$S$矩阵的方法。
本节将始终在以下对高能物理来说非常一般的假设下工作：系统具有完整的洛伦兹对称性；入射和出射态中各个粒子相隔足够远；只有接近关联函数极点时的动量-能量安排才是值得分析的，因为其它时候实验现象也不明显。

本节将首先介绍一些可以使用$S$矩阵计算的物理量，以展示计算$S$矩阵的必要性，然后给出微扰计算$S$矩阵的方法。

\subsection{可观察物理量}

\subsubsection{散射截面}

\begin{equation}
    \mel*{p_1, p_2, \ldots, p_m}{\ii T}{k_1, k_2, \ldots, k_n} = \ii (2\pi)^4 \delta^4(\sum_i p_i - \sum_j k_j) \mathcal{M}(k_1, k_2, \ldots, k_n \to p_1, p_2, \ldots, p_m).
\end{equation}

\subsubsection{跃迁率}

\subsubsection{非相对论极限}

我们知道$S$矩阵可以用所谓李普曼-施温格方程写出。非相对论性单粒子量子力学中通常采取这样的归一化方案：
\[
    \hat{T} = \hat{H}' + \hat{H}' \frac{1}{E - \hat{H}_0} \hat{H}' + \cdots, \quad \hat{S} = 1 - 2 \pi \ii \delta(E_f - E_i) \hat{T},
\]
% TODO：怎么计算等效势能

\subsection{S矩阵和关联函数的关系}

\subsubsection{标量场编时格林函数的解析结构和LSZ约化公式}

考虑一个$n$点关联函数$\mel{\Omega}{T \phi(x_1) \cdots \phi(x_n)}{\Omega}$。
我们对$x_1$做傅里叶变换，这是因为实际上用于计算$S$矩阵矩阵元的本征态都是动量本征态，因此我们首先应该在$n$点关联函数中引入动量的概念。
我们没有直接使用用动量标记的产生湮灭算符，因为我们还希望用频率代替时间，而“频率”并不是量子数，因此不是任何一套产生湮灭算符的标签的一部分，如果使用用动量标记的产生湮灭算符就还需要对时间做一次傅里叶变换，表达式就看起来不协变了。
反之，对四维坐标$x_1$做完傅里叶变换之后，我们就可以用四维动量$k_1$代替$x_1$作为标记了，洛伦兹协变性就很明显。
这样得到的动量空间关联函数不保证入射和出射的四维动量是在壳的。（另一方面，$S$矩阵肯定是在壳的）

我们有
\begin{equation}
    \begin{aligned}
        &\quad \int \dd[4]{x_1} \ee^{\ii k_1 \cdot x_1} \mel{\Omega}{T \phi(x_1) \phi(x_2) \cdots \phi(x_n)}{\Omega} \\
        &= \left( \int_{-\infty}^{T_-} + \int_{T_-}^{T_+} + \int_{T_+}^\infty \right) \dd{t_1} \int \dd[3]{\vb*{x}_1} \ee^{\ii \omega_1 t_1 - \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{T \phi(x_1) \phi(x_2) \cdots \phi(x_n)}{\Omega} \\
        &= \int_{-\infty}^{T_-} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{T [\phi(x_2) \cdots \phi(x_n)] \phi(x_1)}{\Omega} \\
        &+ \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &+ \int_{T_-}^{T_+} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{T [\phi(x_1) \phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
    \label{eq:correlation-after-fourier}
\end{equation}
最后一个等号只需要令$T^+$充分大，$T_-$充分小即可成立。
做完傅里叶变换之后的结果肯定具有奇异性：在相互作用下稳定的单粒子态有确定的动量和能量，因此在$\omega_1$和$\vb*{k}_1$之间满足正确的色散关系时，上式发散。
（多粒子态由于能量给定时其中某个动量可以连续变化，不会产生奇异性，但是会产生有限高度的峰）

高能物理实验中实际会测量的区域通常就在这种会导致奇异性的$\omega$和$\vb*{k}$的取值附近，因为这里效应最明显。
在\eqref{eq:correlation-after-fourier}的极点附近，$T_-$到$T_+$区段的积分基本上没有什么作用，因为其奇异性弱于$T_+$到$\infty$的积分和$-\infty$到$T_-$的积分。
因此之后我们不再考虑$T_-$到$T_+$区段的积分。

现在使用常用的技巧：在算符连乘积序列中插入一个完备关系，从而将$n$点关联函数转化为$n-1$点关联函数。
即使在加入相互作用之后，动量仍然是好量子数，因此可以有完备关系
\[
    1 = \sum_{\Lambda} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \dyad*{\Lambda_{\vb*{p}}}, 
\]
其中$\Lambda$标记了冗余的量子数。对\eqref{eq:correlation-after-fourier}最后一步的第二项，插入完备关系得到
\[
    \begin{aligned}
        &\quad \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel*{\Omega}{\phi(x_1) \sum_{\Lambda} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \dyad*{\Lambda_{\vb*{p}}} T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \sum_{\Lambda} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel*{\Omega}{\phi(x_1)}{\Lambda_{\vb*{p}}} \mel*{\Lambda_{\vb*{p}}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
因子$\mel*{\Omega}{\phi(x_1)}{\Lambda_{\vb*{p}}}$可以进一步展开。
首先，因子$\mel*{\Omega}{\phi(0)}{\Lambda_{\vb*{k}_1}}$实际上只在$\ket{\Lambda_{\vb*{k}_1}}$是单粒子态时才能够有非零值（因为它可以写成一个经过场强重整化的产生算符作用在真空态上，而入射态和出射态可以近似看成自由理论，从而被夹在$\mel*{\Omega}{\cdot}{\Omega}$中的产生算符和湮灭算符数目必须一致）。
其次，我们注意到，实际上可以将$\phi(x_1)$写成$\ee^{\ii P \cdot x} \phi(0) \ee^{- \ii P \cdot x}$，其中$P$是全空间的动量算符，或者说平移群的生成元。在有相互作用的情况下，这样作用的结果并不方便计算，因为其中包含一个时间演化算符，但是我们总是可以形式地写出这样的式子。
于是
\[
    \mel*{\Omega}{\phi(x)}{\Lambda_{\vb*{p}}} = \mel*{\Omega}{\phi(x)}{\Lambda_{\vb*{p}}} \ee^{- \ii p \cdot x} |_{p^0 = E_{\vb*{p}}}. 
\]
于是就有
\[
    \begin{aligned}
        &\quad \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \sum_{\Lambda} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii (\omega_1 - E_{\vb*{p}}) t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii (\vb*{k}_1 - \vb*{p}) \cdot \vb*{x}_1} \mel*{\Omega}{\phi(0)}{\Lambda_{\vb*{p}}} \mel*{\Lambda_{\vb*{p}}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \sum_{\Lambda} \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \left( - \frac{1}{\ii (\omega_1 - E_{\vb*{p}} + \ii 0^+)} \ee^{\ii (\omega_1 - E_{\vb*{p}}) T_+} \right) (2\pi)^3 \delta(\vb*{k}_1 - \vb*{p}) \\
        & \quad \times \mel*{\Omega}{\phi(0)}{\Lambda_{\vb*{p}}} \mel*{\Lambda_{\vb*{p}}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \sum_{\Lambda} \frac{\ii}{\omega_1 - E_{\vb*{k}_1}(\Lambda) + \ii 0^+} \ee^{\ii (\omega_1 - E_{\vb*{p}}) T_+} \mel*{\Omega}{\phi(0)}{\Lambda_{\vb*{k}_1}} \mel*{\Lambda_{\vb*{k}_1}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
上式中（以及之后），$E_{\vb*{k}}$代表的都是$\ket{\Lambda_{\vb*{k}_1}}$的能量，不是裸粒子的能量，已经加入了自能修正。
在这里我们使用标准的在对时间的积分中引入无穷小虚部，让$\omega_1$的奇点出现在下半平面的方法；实际上，如果不这样，积分也无法收敛。
我们现在稍微改变一下$\ket{\Lambda_{\vb*{p}}}$的归一化方式。目前使用的归一化方案是不协变的，对应于$\ket{\vb*{p}}$，现在我们转而使用
\[
    \ket{\lambda_{\vb*{p}}} = \sqrt{2 E_{\vb*{p}}} \ket{\Lambda_{\vb*{p}}},
\]
于是就有
\[
    \begin{aligned}
        &\quad \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \sum_{\lambda} \frac{1}{2E_{\vb*{k}_1}(\Lambda)} \frac{\ii}{\omega_1 - E_{\vb*{k}_1}(\Lambda) + \ii 0^+} \ee^{\ii (\omega_1 - E_{\vb*{p}}) T_+} \mel*{\Omega}{\phi(0)}{\lambda_{\vb*{k}_1}} \mel*{\lambda_{\vb*{k}_1}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
在接近\eqref{eq:correlation-after-fourier}的极点时，就有
\[
    \begin{aligned}
        &\quad \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \sum_{\lambda} \frac{\ii}{(\omega_1)^2 - (E_{\vb*{k}_1}(\lambda))^2 + \ii 0^+} \mel*{\Omega}{\phi(0)}{\lambda_{\vb*{k}_1}} \mel*{\lambda_{\vb*{k}_1}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
类似地可以得到
\[
    \begin{aligned}
        &\quad \int_{-\infty}^{T_-} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{T [\phi(x_2) \cdots \phi(x_n)] \phi(x_1)}{\Omega} \\
        &= - \sum_{\lambda} \frac{1}{2E_{\vb*{k}_1}(\lambda)} \frac{\ii}{\omega_1 + E_{\vb*{k}_1}(\lambda) + \ii 0^+} \ee^{\ii (\omega_1 + E_{\vb*{p}}) T_-} \mel*{\Omega}{T [\phi(x_2) \cdots \phi(x_n)]}{\lambda_{\vb*{k}_1}} \mel*{\lambda_{\vb*{k}_1}}{\phi(0)}{\Omega},
    \end{aligned}
\]
其中由于$\phi(x_1)$的位置发生了变化，一些量的正负号和左右矢的顺序发生了变化。不过，这一项并不产生极点。
因此最终我们得到
\[
    \begin{aligned}
        &\quad \int_{T_+}^{\infty} \dd{t_1} \ee^{\ii \omega_1 t_1} \int \dd[3]{\vb*{x}_1} \ee^{- \ii \vb*{k}_1 \cdot \vb*{x}_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &\stackrel{\omega_1 \to E_{\vb*{k}_1}(\Lambda)}{\sim} \sum_{\lambda} \frac{\ii}{(\omega_1)^2 - (E_{\vb*{k}_1}(\lambda))^2 + \ii 0^+} \mel*{\Omega}{\phi(0)}{\lambda_{\vb*{k}_1}} \mel*{\lambda_{\vb*{k}_1}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
此外，设$U$是一个让三维动量减小$\vb*{k}_1$的洛伦兹变换，则
\[
    \begin{aligned}
        \mel*{\Omega}{\phi(0)}{\lambda_{\vb*{k}_1}} &= \mel*{\Omega}{\phi(0)U^{-1} U}{\lambda_{\vb*{k}_1}} \\
        &= \mel*{\Omega}{U \phi(0)U^{-1} U}{\lambda_{\vb*{k}_1}} \\
        &= \mel*{\Omega}{\phi(0)}{\lambda_0},
    \end{aligned}
\]
第二个等号是因为真空态在洛伦兹变换下显然是不变的，第三个等号用到了$U \phi(0) U^{-1} = \phi(0)$这一事实（将$\phi(0)$展开为傅里叶级数就能看出为什么）。
于是就得到
\[
    \begin{aligned}
        &\quad \int \dd[4]{x_1} \ee^{\ii k_1 \cdot x_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &\stackrel{\omega_1 \to E_{\vb*{k}_1}(\lambda)}{\sim} \sum_{\lambda} \frac{\ii}{(\omega_1)^2 - (E_{\vb*{k}_1}(\lambda))^2 + \ii 0^+} \mel*{\Omega}{\phi(0)}{\lambda_{0}} \mel*{\lambda_{\vb*{k}_1}}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
上面的结果的意义非常明显了：$x_1$变量做了傅里叶变换的关联函数会有一系列极点，这些极点的具体位置由在带相互作用的场论下的本征态的能谱（而不是自由粒子的能谱）决定；并且，会多出来一个因子$\mel*{\Omega}{\phi(0)}{\lambda_{0}}$。
由于$\ket{\lambda_{\vb*{k}_1}}$是经过相互作用修正的单粒子态，实际上只需要一个动量参数就足够标记它，于是我们去掉对$\lambda$的求和（因为显然只有一个可能的$\lambda$），并且用$\omega$代替$E$（再次提醒：这是已经经过相互作用修正的单粒子能量），就得到
\begin{equation}
    \begin{aligned}
        &\quad \int \dd[4]{x_1} \ee^{\ii k_1 \cdot x_1} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &\stackrel{\omega_1 \to \omega_{\vb*{k}_1}}{\sim} \frac{\ii}{\omega_1^2 - \omega_{\vb*{k}_1}^2 + \ii 0^+} \mel*{\Omega}{\phi(0)}{p={0}} \mel*{k_1}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
    \label{eq:scalar-correlation-pole-single}
\end{equation}
这里我们已经用$\ket{k_1}$代替了$\ket{\lambda_{\vb*{k}_1}}$，前者就表示无穷远处的单粒子态。

现在设想我们对$\mel*{\Omega}{T \phi(x_1) \phi(x_n)}{\Omega}$中的每一个位置变量都做傅里叶变换。
由\eqref{eq:scalar-correlation-pole-single}，会发现每个$k_i$实际上都有极点。
我们实际上可以在一个公式内把所有这些极点都反映出来。考虑对\eqref{eq:scalar-correlation-pole-single}中的$x_2$做傅里叶变换，由于$x_2$仅仅包含在最后一个因子中，只需要计算
\[
    \begin{aligned}
        &\quad \int \dd[4]{x_2} \ee^{\ii k_2 \cdot x_2} \mel*{k_1}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &= \left( \int_{-\infty}^{T_-} + \int_{T_-}^{T_+} + \int_{T_+}^\infty \right) \dd{t_2} \ee^{\ii \omega_2 t_2} \int \dd[3]{\vb*{x}_2} \ee^{-\ii \vb*{k}_2 \cdot \vb*{x}_2} \mel*{k_1}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
\]
仿照我们先前做的操作，只需要计算$T_+$到$\infty$的积分即可得到最为奇异的部分，于是可以将$\phi(x_2)$提出编时算符的作用域内，放在最左边，然后仿照前面的操作，在$\phi(x_2)$和编时算符序列之间插入完备性关系，得到
\[
    \begin{aligned}
        &\quad \int_{T_+}^\infty \dd{t_2} \ee^{\ii \omega_2 t_2} \int \dd[3]{\vb*{x}_2} \ee^{-\ii \vb*{k}_2 \cdot \vb*{x}_2} \mel*{k_1}{\phi(x_2) T [\phi(x_3) \cdots \phi(x_n)]}{\Omega} \\
        &= \int \frac{\dd[3]{\vb*{p}_1}}{(2\pi)^3} \frac{1}{2 \omega_{\vb*{p}_1}} \int \frac{\dd[3]{\vb*{p}_2}}{(2\pi)^3} \frac{1}{2 \omega_{\vb*{p}_2}} \int_{T_+}^\infty \dd{t_2} \ee^{\ii \omega_2 t_2} \int \dd[3]{\vb*{x}_2} \ee^{-\ii \vb*{k}_2 \cdot \vb*{x}_2} \\ 
        &\quad \quad \times \mel*{k_1}{\phi(x_2)}{p_1, p_2} \mel*{p_1, p_2}{T [\phi(x_3) \cdots \phi(x_n)]}{\Omega} \\
        &= \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} \frac{1}{2 \omega_{\vb*{p}}} \int_{T_+}^\infty \dd{t_2} \ee^{\ii \omega_2 t_2} \int \dd[3]{\vb*{x}_2} \ee^{-\ii \vb*{k}_2 \cdot \vb*{x}_2}  \mel*{\Omega}{\phi(x_2)}{p} \mel*{k_1, p}{T [\phi(x_3) \cdots \phi(x_n)]}{\Omega} \\
    \end{aligned}
\]
这一次只有$\mel*{k_1}{\phi(x_2)}{p_1, p_2}$有非零值（注意$\ket{p_1, p_2}$是入射/反射态，可以用经过场重整化的产生算符作用两次产生），于是我们引入了两个动量积分；第二个等号还是因为$\ket{p_1, p_2}$可以拆分，从而其中一个必须和$k_1$相等。
对因子$\mel*{\Omega}{\phi(x_2)}{p}$施加如前所述的插入四维平移算符的操作，得到
\[
    \mel*{\Omega}{\phi(x_2)}{p} = \mel*{\Omega}{\phi(0)}{p=0} \ee^{-\ii p \cdot x_2}|_{p^0=E_{\vb*{p}}},
\]
然后积掉$t_2$和$\vb*{x}_2$，就得到
\begin{equation}
    \begin{aligned}
        &\quad \int \dd[4]{x_1} \ee^{\ii k_1 \cdot x_1} \int \dd[4]{x_2} \ee^{\ii k_2 \cdot x_2} \mel{\Omega}{\phi(x_1) T [\phi(x_2) \cdots \phi(x_n)]}{\Omega} \\
        &\stackrel{\omega_1 \to \omega_{\vb*{k}_1}, \omega_2 \to \omega_{\vb*{k}_2}}{\sim} \frac{\ii \mel*{\Omega}{\phi(0)}{p={0}}}{\omega_1^2 - \omega_{\vb*{k}_1}^2 + \ii 0^+} \frac{\ii \mel*{\Omega}{\phi(0)}{p={0}}}{\omega_2^2 - \omega_{\vb*{k}_2}^2 + \ii 0^+} \mel*{k_1, k_2}{T [\phi(x_2) \cdots \phi(x_n)]}{\Omega}.
    \end{aligned}
    \label{eq:scalar-correlation-pole-double}
\end{equation}
如此重复——实际上，我们还可以反过来做以上步骤，此时为了让极点出现，傅里叶变换的$\ee$指数要加上一个减号，在本节处理的标量场中这无所谓，但是对有粒子-准粒子区别的场，代表入射粒子的场算符和代表出射粒子的场算符差一个负号，从而一些要正着做傅里叶变换一些要反着做傅里叶变换——就得到
\begin{equation}
    \begin{aligned}
        &\quad \prod_{i=1}^m \int \dd[4]{x_i} \ee^{\ii p_i \cdot x_i} \prod_{j=1}^n \int \dd[4]{y_j} \ee^{- \ii k_j \cdot y_j} \mel{\Omega}{T [\phi(x_1) \cdots \phi(x_n) \phi(y_1) \cdots \phi(y_n)]}{\Omega} \\
        &\stackrel{p_i^0 \to \omega_{\vb*{p}_i}, \; k_j^0 \to \omega_{\vb*{k}_j}}{\sim} \prod_{i=1}^m \frac{\ii \sqrt{Z}}{\omega_i^2 - \omega_{\vb*{p}_i}^2 + \ii 0^+} \prod_{j=1}^n \frac{\ii \sqrt{Z}}{\omega_j^2 - \omega_{\vb*{k}_j}^2 + \ii 0^+} \braket*{p_1, p_2, \ldots, p_m}{k_1, k_2, \ldots, k_n},
    \end{aligned}
    \label{eq:lsz-reduction-scalar}
\end{equation}
其中
\begin{equation}
    Z = \abs{\mel*{\Omega}{\phi(0)}{p=0}}^2.
    \label{eq:z-factor-def}
\end{equation}
以上所有的推导都是在海森堡绘景下完成的，因此上式右边的因子就是$S$矩阵。
于是我们就得到了联系$S$矩阵和关联函数的公式，其形式和之前的分析完全一样，$Z$正是场强重整化因子。%
\eqref{eq:lsz-reduction-scalar}就是标量场的\concept{LSZ约化公式}，其形式和之前我们预期的完全一样。
实际上，LSZ约化公式说明重整化后的格林函数是重整化前的$1 / Z^{(m+n)/2}$倍。

\subsubsection{$S$矩阵的微扰计算}

在得到了\eqref{eq:lsz-reduction-scalar}之后就可以微扰计算$S$矩阵了，因为可以微扰计算关联函数。
实际上，计算关联函数比计算$S$矩阵更加困难。这本质上是因为$S$矩阵丢弃了初末态均为有限时间的信息（$S$矩阵仅仅保留了动量空间关联函数那些四维动量均在壳的那部分初末态），并且在费曼图的语言下有非常显然的解释。
下面我们来分析关联函数的费曼图，并给出直接微扰计算$S$矩阵的方法。

计算关联函数的任何一张费曼图都具有这样的形式：一个amputated diagram居于中间，外线和它之间连接有自能修正图。
在动量空间下，一张自能修正图可以等价地看成
\[
    \int \dd[4]{x} \ee^{\ii p \cdot x} \int \dd[4]{y} \ee^{- \ii k \cdot y} \mel{\Omega}{\phi(x) \phi(y)}{\Omega},
\]
按照\eqref{eq:z-factor-def}，$\sqrt{Z}$对应$\mel{\Omega}{\phi(x_1) a^\dagger_\text{in}}{\Omega}$，这个关联函数中的两个场中，一个做了场强重整化而另一个没有。
既然$\mel{\Omega}{a_\text{out} a^\dagger_\text{in}}{\Omega}$就是$1$，$\mel{\Omega}{\phi(x_1) \phi(x_2)}{\Omega}$的场强重整化因子为$Z$。

关联函数$\mel{\Omega}{\phi(x_1) \phi(x_2)}{\Omega}$可以直接微扰计算，从而在理论已经给定的情况下，我们可以把$Z$到底是什么写出来。
设$- \ii M^2(p^2)$是单粒子不可约图（对应自能修正），那么就有
\[
    \begin{aligned}
        &\quad \int \dd[4]{x} \ee^{\ii p \cdot x} \int \dd[4]{y} \ee^{- \ii k \cdot y} \mel{\Omega}{\phi(x_1) \phi(x_2)}{\Omega} \\
        &= \frac{\ii}{p^2 - m_0^2} + \frac{\ii}{p^2 - m_0^2} (- \ii M^2(p^2)) \frac{\ii}{p^2 - m_0^2} + \cdots \\
        &= \frac{\ii}{p^2 - m_0^2 - M^2(p^2)},
    \end{aligned}
\]
其中$m_0$为粒子裸质量。自能$M^2$关于$p^2$的最低阶项当然是$p^2$自己，即
\[
    M^2 = c_0 + c_1 p^2 + \cdots.
\]
在低阶近似下$c_1=1$，高阶下则会有可见的修正，实际上这就对应着对$(\partial_\mu \phi)^2$的修正。
因此，在极点附近，我们有
\begin{equation}
    \int \dd[4]{x} \ee^{\ii p \cdot x} \int \dd[4]{y} \ee^{- \ii k \cdot y} \mel{\Omega}{\phi(x_1) \phi(x_2)}{\Omega} \stackrel{p^0 \to E_{\vb*{p}}}{\sim} \frac{\ii Z}{p^2 - m^2} + \text{regular}. 
\end{equation}
因此这给出了计算$Z$和有效质量$m$的方法：微扰计算自能修正，然后按照上式化简，观察极点位置就得到了$m$，在极点附近比较关联函数和$\ii / (p^2 - m^2)$就得到了$Z$。
将上式代入\eqref{eq:lsz-reduction-scalar}，就发现
\begin{equation}
    \braket*{p_1, p_2, \ldots, p_m}{k_1, k_2, \ldots, k_n} \stackrel{p_i^0 \to \omega_{\vb*{p}_i}, \; k_j^0 \to \omega_{\vb*{k}_j}}{\sim} (\sqrt{Z})^{m+n} \times \text{amputated diagrams}.
    \label{eq:amputated-diagram-z-factor}
\end{equation}
因此，计算自能修正并得到$Z$之后，只需要计算amputated diagrams就能够微扰计算得到$S$矩阵。

我们还可以更加简化一些。注意到，所有只含有单粒子自能修正的图——即有$n$个入射粒子，$n$个出射粒子，总共有$n$个连通子图，不同粒子对应不同连通子图的图——在amputate之后就是简单地将入射端和出射端连接起来，而这些图正好对应$S=1 + \ii T$中的$1$，因此如果只计算$\mathcal{M}$，无需计算这些图。

如果只计算树图，那么显然$Z=1$，因为此时没有任何自能修正，从而无论是物理质量还是场强都没有做重整化。
因此，计算树图时只将amputated tree diagram求和即可。
圈图的计算一般要用到重整化，此时为了方便看出场强重整化因子，并不会使用\eqref{eq:amputated-diagram-z-factor}。
但是，在圈图计算中，场强重整化的那些$\sqrt{Z}$通常是作为抵消项被引入了，在施加重整化条件之后，它们和圈图计算中的发散抵消了，从而其实也无需显式计算$Z$。
总之我们实际上不会直接使用LSZ约化公式计算散射振幅：如果只计算树图，那么$Z=1$；而如果计算圈图，那么$Z$是作为抵消项被考虑进去的，圈图计算的最终结果是对树图中的传播子的物理参数（基本上是质量）和顶角函数做了一定修正，因此$Z$同样不会出现在最终的计算结果中。

% TODO：路径积分量子化中的LSZ

\section{正规化和重整化}

如果朴素地做圈图计算，通常会得到紫外发散。%
\footnote{
    相对论性量子场论中的红外发散一般是因为少考虑了一些过程，如由于光子无能隙，可以任意地产生和消灭，从而一个过程的概率分散在很多个有入射和出射“软光子”（能量很低并无可观测效应的光子）。
    当求和所有这些过程后，发散一般就消失了，并不具有特别的意义。

    凝聚态场论中的情况正好相反：紫外发散是没有关系的，因为凝聚态系统中有最小的特征长度，如果出现了发散，可以引入一个物理可观测的紫外截断消除这个发散（如BCS理论中的$\omega_\text{D}$）。
    红外发散反而不那么好处理。
}%
这并不特别令人意外，因为没有什么保证了我们的理论在任意能标下都一定成立，从而，将动量积分的上限推到无穷大大约是不合适的。
要想计算出有意义的结果通常要求我们知道更高能标处的物理的细节；然而，如果我们的理论实际上具有低能标下的一个不动点，那么更高能标处的物理实际上无关紧要，只要我们只关心低能的现象。

在这种情况下，可以做下面的操作来消除发散：
\begin{enumerate}
    \item 在圈图计算中寻找一个能够标记重整化群流的参数，可能是和Wilson重整化群流一致的动量积分上限$\Lambda$，也可以将维数延拓到实数中，从而用维数偏离$4$的程度$\epsilon$做这个参数。此时积分的发散部分可以被分离出来，这就是\concept{正规化}。
    \item 令理论中的各个参数（所谓“裸”参数）跑动起来，包括场强，即引入\concept{抵消项}，其大小暂时未知。
    \item 计算若干个可以实际观察到的物理量（通常具有和裸参数类似的物理意义，从而它们可以称为\concept{物理参数}，如自由场的关联函数的极点给出裸质量，而有相互作用的关联函数的极点给出物理质量），将它们写成裸参数、参数跑动（即抵消项中的参数）和重整化群流参数的形式。
    \item 在低能不动点处，物理参数应当和重整化群流参数无关，因此可以反过来将参数跑动写成重整化群流参数和物理参数的函数，从而求解出所有抵消项。
    用于确定抵消项的条件即为\concept{重整化条件}。
    如果理论可重整，此时所有其它可以实际观察到的物理量中的发散都会相互抵消，从而我们成功地将一些可以实际观察到的物理量写成了另一些可以实际观察到的物理量（即物理参数）的函数，即给出了实验预言。
\end{enumerate}
在最终的计算结果中裸参数都没有出现；这是正确的，因为实际上并没有什么能够真的“观察”到裸参数——无法确定实际测到的物理参数有多少来自裸参数，多少来自相互作用修正。
实际上，为了和发散抵消，裸参数一般都是反向发散的。

在实际的计算中，还有以下技巧：
\begin{itemize}
    \item 由于圈图数目非常多，通常我们会以需要计算的散射振幅的树图当成骨架，将圈图当成对骨架图中各个成分的修正。
    这样的好处是，做完全部修正的骨架图的各个成分通常足够给出物理参数了，如做完自能修正的传播子可以给出物理质量，做完顶角修正的amputated vertex diagram可以给出有效相互作用强度。
    \item 由于实际有意义的关联函数、散射振幅等均已经做过场强重整化，可以用场强重整化之后的场来做拉氏量中的基本自由度；这样与场强重整化有关的抵消项会自动出现在拉氏量中，并且做完重整化之后直接计算amputated diagram即可得到散射振幅，没有必要再显式计算$Z$。
    \item 抵消项可以被显式给出。如果不希望引入太多顶角，也可以首先形式地写出含有未知的裸参数的散射振幅的形式，然后用未知的裸参数去拼凑出物理参数。
    如果显式地使用抵消项，由于我们在重整化不动点附近工作，其实可以将抵消项设置为“裸参数偏离物理参数的多少”，而直接将物理参数放进拉氏量中。
\end{itemize}

表面上，任何一个理论都可以做这样的操作——对称性允许的拉氏量中的项是无限多的，我们可以引入任意多的抵消项来消除发散。
但是，如果需要引入无数多的抵消项，那么重整化操作就是无法完成的。

为了估计发散的程度，我们可以引入一些指标。\concept{原始发散图}指的是只要切断一根内线（即不计算这根内线的积分），就能够收敛的图。发散的图是用原始发散图组装起来的。
如果一个理论中的原始发散图的个数有限，

由于紫外发散来自动量积分有太多重，一张图$\Gamma$中的动量的幂次——所谓\concept{表观发散度}——为
\begin{equation}
    D(\Gamma) = \sum_i n_i d_i + 2 I_\text{B} + 3 I_\text{F} - 4(\sum_i n_i - 1),
\end{equation}
其中$n_i$指的是某一类型的顶角的个数，$d_i$是类型$i$的顶角中的动量幂次，$I_\text{B}$和$I_\text{F}$分别表示玻色子和费米子线的个数，因为费米子传播子的分母中只有一个$k$，做完四维动量积分之后动量幂次为3，而玻色子传播子的分母中有两个$k$，做完四维动量积分之后动量幂次为2。
最后一项是因为顶角会引入一个动量守恒条件；我们故意减去了$1$，因为费曼图最终的计算结果也肯定满足动量守恒条件，即有一个$\delta(\sum \vb*{k})$并没有被积分掉，而是留到了计算结果中。
现在我们进一步设$i$类型顶角中有$b_i$个玻色子线，$f_i$个费米子线，并设有$E_\text{F}$条费米子外线，$E_\text{B}$条玻色子外线，则
\[
    E_\text{F} + 2 I_\text{F} = \sum_i n_i f_i, \quad E_\text{B} + 2 I_\text{B} = \sum_i n_i b_i,
\]
因为一条内线连接两个顶角。这样就有
\begin{equation}
    D(\Gamma) = \sum_i n_i \left( d_i + b_i + \frac{3}{2} f_i - 4  \right) + 4 - E_\text{B} - \frac{3}{2} E_\text{F}.
\end{equation}

表观发散度实际上就是在做量纲分析，而且做的是朴素的工程量纲分析，因此是不尽然可靠的。
大体上说，如果表观发散度大于零，那么这张图发散，如果小于零，那么这张图收敛，如果等于零，那么这张图应该对数发散，但是这只是一个非常粗略，可能不准确的估计。
不过，\concept{Weinberg power counting theorem}保证了，当且仅当一张图及其子图的表观发散度都是小于零，它收敛。

为了保证尽可能多的图的表观发散度小于等于零，我们会要求
\begin{equation}
    d_i + b_i + \frac{3}{2} f_i - 4 \leq 0,
\end{equation}
因此比较安全的安排是，一个顶角最多有四条玻色子线、两条费米子线，否则有可能产生无穷多种发散的图，理论可能不能重整化。

\subsection{维数正规化}

注：经常用Wick转动来化简此处的积分，但是由于$p^0 > 0$时极点在下半平面而$p^0 < 0$时极点在上半平面，为了避免撞上奇点，Wick转动应该将积分路径顺时针旋转\SI{90}{\degree}，从而可以设$l = \ii l^\text{E}$。
TODO：这和我们后面做的将整个理论做Wick转动时用的记号似乎不一样？

将内线动量从$4$维扩充为$n$维度，外线动量保持不变。

让维数变化时，没有必要让$\gamma$矩阵的维数发生变化，因此对$\gamma$矩阵的乘积的迹计算无需做任何调整，即自旋指标不需要做任何调整，而对坐标指标（$\mu$这种）的迹计算（如$\gamma^\mu \gamma_\mu$）则需要调整。

\subsection{骨架图的修正}

重整化条件：
\begin{itemize}
    \item 在修正后的单粒子格林函数的极点处，有质量粒子的自能修正对$p^2$（玻色子）或者$\slashed{p}$（费米子）的一阶导数为零；无质量粒子的自能修正为零。
    这是为了确保没有场强重整化。
    动量远离单粒子格林函数极点时它们当然可以不是零；本应如此，否则圈图修正无法体现。
    \item 在修正后的单粒子格林函数的极点处，极点给出的质量（通过$p^2=m^2$解出）就是我们设定的物理质量；在显式引入自能修正时，有质量粒子的自能修正为零。
    这是为了确保质量的修正为零。
    \item 顶角函数和物理相互作用强度相同，这是为了确保顶角修正为零。
    具体什么是“物理相互作用强度”取决于探测方式，如量子电动力学中通常是使用静电学方法测定电磁相互作用的强度，于是我们要求顶角函数在光子动量为零时和静电学方法测得的电磁相互作用强度（其实就是元电荷）相同。
    其它时候顶角函数可以有偏离，以展现高阶过程的修正。
\end{itemize}

\section{单位制，指标记号和度规选取}

\subsection{度规的圣战}

时间在整个四维矢量中的位置，一些人取为$x^0$，一些人取为$x^4$。

\subsubsection{$-+++$和$+---$}

在以上所有的讨论中，我们都在使用度规$+---$。度规$-+++$在一些文献中也是常用的，并且在做Wick转动时更加方便（见下一节）。

概述：两种度规的协变矢量保持一致，点乘差一个负号。

\subsubsection{Wick转动}

为了免去洛伦兹度规的麻烦，一些人会做Wick转动，即令$\tau=\ii t$，这样就不需要区分逆变协变了，并且很多积分的性质会变得良好。
为了尽可能减少需要改动的地方，最方便的做法是在Wick转动后的理论（“欧氏空间度规理论”）和$-+++$度规之间切换，需要时再切换到$+---$度规。

如果单纯是做替换$\tau = \ii t$，那么没有太多可说，但实际上其它物理量也需要变化，而这些变化有很多自由发挥的空间。
例如，原本在相对论性量子场论中含有傅里叶变换的表达式在做完Wick转动之后是否需要修改为拉普拉斯变换？
格林函数的定义是否需要更动？这些都是需要指定的。

我们于是施加以下条件：
\begin{itemize}
    \item Wick转动后的理论，如果将时间的积分区域设为实数，应该给出原理论对应的有限温度场论。
    这就是说，对应关系$\tau \leftrightarrow \ii t$和$\ii \omega_n \leftrightarrow \omega$应当可以在Wick转动的过程中找到，虽然由于$t$和$\omega$区分逆变和协变，有待进一步澄清以上关系式中的$t$和$\omega$指的是什么。
    \item Wick转动前后标量尽可能不变。
    \item Wick转动将原本的傅里叶变换映射为$\ee^{\ii k_i x_i}$形式的欧氏空间傅里叶变换。
    \item 闵氏时空下，矢量的欧氏部分的协变分量和欧氏四维空间中对应的分量需要完全一样，从而我们无需在$(x^\text{M})^i$和$x^\text{E}_i$之间做任何区分。这里上标M和E分别表示闵氏时空和欧氏四维空间，下同。
\end{itemize}

我们来看一下这些条件意味着什么。首先，第二个和第三个条件意味着应有
\[
    (x^\text{M})^0 p^\text{M}_0 + (x^\text{M})^1 p^\text{M}_1 + (x^\text{M})^2 p^\text{M}_2 + (x^\text{M})^3 p^\text{M}_3 = x^\text{E}_0 p^\text{E}_0 + x^\text{E}_1 p^\text{E}_1 + x^\text{E}_2 p^\text{E}_2 + x^\text{E}_3 p^\text{E}_3,
\]
因为我们有
\[
    \ee^{\ii k^M \cdot x^M} = \ee^{\ii k^E \cdot x^E}.
\]
请注意在$-+++$度规下$p_i$和$p^i$并无差别，于是按照第四个条件，我们有
\[
    (x^\text{M})^1 p^\text{M}_1 + (x^\text{M})^2 p^\text{M}_2 + (x^\text{M})^3 p^\text{M}_3 = x^\text{E}_1 p^\text{E}_1 + x^\text{E}_2 p^\text{E}_2 + x^\text{E}_3 p^\text{E}_3,
\]
即
\[
    (x^\text{M})^0 p^\text{M}_0 = x^\text{E}_0 p^\text{E}_0.
\]
在相对论性量子场论中我们通常认为$t$就是$x^0$而$\omega$就是$p^0$，它和$p_0$正好差了一个负号，而显然我们应该指定$\tau=\ii t$为$x^\text{E}_0$，因此就有
\[
    p_0^\text{E} = \ii \omega,
\]
即应有
\begin{equation}
    p_0^\text{E} = - \omega_n = \ii \omega, \quad x^\text{E}_0 = \tau = \ii t.
\end{equation}
换句话说，四维欧氏空间中的$p^\text{E}$的时间分量和松原频率差了一个负号。
这其实是正确的，因为在凝聚态场论中有
\[
    \phi(\tau) \propto \sum_n \ee^{-\ii \omega_n \tau} \phi_n,
\]
加入动量之后就是
\[
    \phi(\tau, \vb*{x}) \propto \sum_n \int \dd[3]{\vb*{p}} \phi_n(\vb*{p}) \ee^{-\ii \omega_n \tau + \ii \vb*{p} \cdot \vb*{x}} , 
\]
考虑到$\omega_n \tau = \omega t$，做了反Wick转动之后这正好就是$-+++$度规，即使用$\omega_n$表示的傅里叶变换的$\ee$指数本身遵循$-+++$度规而不是$++++$度规，自然会导致$\omega_n$和$p^\text{E}_0$差一个负号。

任何使用爱因斯坦求和得到的洛伦兹标量在Wick转动后形式均不变，因为Wick转动相当于做了一次坐标变换，而满足上下同指标求和规则的量在坐标变换下形式不变。
由于Wick转动后是欧氏度规，我们不必再区分逆变和协变。
需要修改的主要是积分测度，即需要加上或减少一个因子$\ii$。
因此以上给出的关于坐标和频率的Wick转动足够让我们完成标量场论的配分函数的Wick转动。
对矢量场只需要对$A^0$做代换即可，即取
\begin{equation}
    A^\text{E}_0 = (A^\text{E})^0 = \ii (A^\text{M})^0.
\end{equation}

在完成配分函数的Wick转动之后还需要注意格林函数也需要做一些调整。
从闵可夫斯基时空的理论中得到关联函数的方式是做变分导数$\fdv*{Z}{(\ii J)}$，$J$是在以
\[
    \exp(\ii \int \dd[4]{x} J \phi)
\]
形式引入的。在Wick转动后，以上激励项变成了
\[
    \exp(\int \dd[4]{x} J \phi).
\]
在此过程中场$J$和$\phi$没有发生任何变化，所以用四维欧氏时空计算闵氏时空中的格林函数，只需要先计算$\fdv*{Z^\text{E}}{(\ii J)}$然后做反Wick转动即可。
然而，需要注意一件事：四维欧氏时空中本身也定义有格林函数，即所谓虚时间格林函数，而当激励项以
\[
    \exp(\int \dd[4]{x} J \phi)
\]
形式给出时，计算虚时间格林函数使用的泛函导数是$\fdv*{Z^\text{E}}{J}$，没有$\ii$。（这和松原格林函数又差了一个负号）
在四维欧氏时空中计算虚时间格林函数，使用Wick定理，画费曼图等使用的都是$\fdv*{Z^\text{E}}{J}$方法求出的格林函数，但是最后切换回$-+++$度规的闵氏时空时需要把$\ii$加回去，格林函数中涉及几个场加几个。
例如，对二体格林函数，四维欧氏时空中的虚时间格林函数计算出来之后，需要做反Wick转动（在此过程中由于$\tau = \ii t$，闵氏时空格林函数的分子上会多出$-\ii$），然后加上一个负号（由于泛函导数而导致的$\ii$有两个，因为有两个场，而$\ii^2=-1$），才能得到$-+++$度规的闵氏时空中的格林函数。

对旋量场，事情略微复杂一些，因为$\gamma$矩阵也需要做同样的变换——当然其实可以不做任何变换，但是这样很多公式会看起来很奇怪。
考虑配分函数：
\[
    \begin{aligned}
        Z &= \int \fd{\psi} \int \fd{\bar{\psi}} \exp(\ii \int \dd[4]{x} \bar{\psi} (\ii \gamma^\mu \partial_\mu - m) \psi) \\
        &= \int \fd{\psi} \int \fd{\bar{\psi}} \exp(\int \dd{\tau} \int \dd[3]{\vb*{x}} \bar{\psi} (\ii \gamma^\mu \partial_\mu - m) \psi) \\
        &= \int \fd{\psi} \int \fd{\bar{\psi}} \exp(\int \dd{\tau} \int \dd[3]{\vb*{x}} \bar{\psi} (- \gamma^0 \pdv{\tau} + \ii \gamma^i \partial_i - m) \psi).
    \end{aligned}
\]
如果我们做变换
\begin{equation}
    (\gamma^\text{M})^0 = (\gamma^\text{E})^0, \quad - \ii (\gamma^\text{M})^i = (\gamma^\text{E})^i,
\end{equation}
并且，由于到了欧氏空间中，不再区分上下标，就得到
\begin{equation}
    Z = \int \fd{\psi} \int \fd{\bar{\psi}} \exp(- \int \dd[4]{x^\text{E}} \bar{\psi} (\gamma^\text{E}_\mu \partial_\mu^\text{E} + m) \psi)
\end{equation}
这就是旋量场的Wick转动。相应的$\gamma$矩阵的代数需要做调整，但是旋量本身并不需要做调整（除了用$-\ii \tau$代替$t$以外）。
$\gamma$矩阵的变动意味着，$\gamma^\mu a_\mu$形式的量即$\slashed{a}$虽然看起来像是点乘，但是在Wick转动下会发生变化：$a_0^\text{E}$相比于$(a^\text{M})^0$多出来了一个$\ii$，而$\gamma_i^\text{E}$相比于$(\gamma^\text{M})^i$多出来了一个$-\ii$，再加上度规从$-+++$变成了$++++$，我们就得到
\begin{equation}
    \gamma^\text{E}_\mu a^\text{E}_\mu = \slashed{a}^\text{E} = - \ii \slashed{a}^\text{M} = -\ii {\gamma^\text{M}}^\mu a^\text{M}_\mu.
\end{equation}


\end{document}