\part{线性介质}

\chapter{线性介质与经典麦克斯韦方程}

\section{有介质情况下的麦克斯韦方程}

真空中的麦克斯韦方程组为我们熟知的形式：
\begin{equation}
    \begin{bigcase}
        \div{\vb*{E}} &= \frac{\rho}{\epsilon_0} \\
        \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t} \\
        \div{\vb*{B}} &= 0 \\
        \curl{\vb*{B}} &= \mu_0 \vb*{j} + \mu_0 \epsilon_0 \pdv{\vb*{E}}{t}
    \end{bigcase}
    \label{eq:original-maxwell}
\end{equation}
介质的存在事实上在微观层面不会改变\eqref{eq:original-maxwell}的形式。
介质起作用的方式是，其内部已经有一个电荷分布，当外加电场的时候电荷重新排列、发生运动，在此过程中产生额外的电流、电场、磁场。
于是假定电荷和电流可以做以下分解：
\[
    \begin{bigcase}
        &\vb*{j} = \vb*{j}_\text{f} + \vb*{j}_\text{r}, \quad \rho = \rho_\text{f} + \rho_\text{r}, \\
        &\pdv{\rho_\text{f}}{t} + \div{\vb*{j}_\text{f}} = 0, \\
        &\pdv{\rho_\text{r}}{t} + \div{\vb*{j}_\text{r}} = 0
    \end{bigcase}
\]
其中$\vb*{j}_\text{f}$是所谓的自由电流，而$\vb*{j}_\text{r}$是介质的响应。但是这种二分法实际上很大程度上是任意的。
例如，金属能导电，因为其内部含有大量几乎是自由的电子——那么，外加电场产生的金属中的电流就应该是自由电流了；
但是分析金属的光学属性的时候，这些由于外加电场产生的电流又无疑是介质的响应。
因此$\vb*{j}_\text{f}$和$\vb*{j}_\text{r}$只是辅助量，没有特殊的物理含义。

为了能够将$\vb*{j}_\text{f}$和$\vb*{j}_\text{r}$整合进两个形式上和电场和磁感应强度很像的辅助量，
从而在形式上让\eqref{eq:original-maxwell}变成一个只和自由电荷和自由电流有关的方程组，我们进一步做下面的分解：
\[
    \vb*{j}_\text{r} = \vb*{j}_\text{s} + \vb*{j}_\text{c}
\]
且$\vb*{j}_\text{c}$是一个有旋无源场。光有这个条件不足以在给定$\vb*{j}_\text{r}$时唯一地确定下$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$，
因此还可以引入一个假设而不至于让$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$无解。
为了让\eqref{eq:original-maxwell}中第一式的右边只剩下自由电荷，假定
\[
    \rho_\text{r} = - \div{\vb*{P}}
\]
这个假设\concept{没有}缩小$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$的选择范围，因为任意给定性质足够良好的$\rho_\text{r}$，相对应的$\vb*{P}$总是存在的（而且显然不唯一）。
同时由于$\vb*{j}_\text{c}$是一个有旋无源场，可以再引进一个辅助量$\vb*{M}$使
\[
    \vb*{j}_\text{c} = \curl{\vb*{M}}
\]
此时$\rho_\text{r}$的输运方程成为
\[
    \pdv{\rho_\text{r}}{t} + \div{\vb*{j}_\text{s}} = 0
\]
因为$\curl{\vb*{j}_\text{c}}$的散度为零。这个式子又可以写成
\[
    \div{\left(\vb*{j}_\text{s}-\pdv{\vb*{P}}{t}\right)} = 0
\]
受到这个式子的启发，我们\concept{假设}（不是推出，因为光有上式不能定解，而先前我们只对$\vb*{j}_\text{c}$做过假设而没有对$\vb*{j}_\text{s}$做过假设，因此后者的取值仍然是任意的）有
\[
    \vb*{j}_\text{s} = \pdv{\vb*{P}}{t}
\]
这个假设不会让$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$无解。

将以上引入的所有物理量代入\eqref{eq:original-maxwell}，得到
\[
    \begin{bigcase}
        \epsilon_0 \div{\vb*{E}} &= \rho_\text{f} - \div{\vb*{P}}, \\
        \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\frac{\vb*{B}}{\mu_0}} &= \vb*{j}_\text{f} + \curl{\vb*{M}} + \pdv{\vb*{P}}{t} + \epsilon_0 \pdv{\vb*{E}}{t}
    \end{bigcase}
\]
引入辅助量
\[
    \vb*{D} = \epsilon_0 \vb*{E} + \vb*{P}, \quad \vb*{H} = \frac{\vb*{B}}{\mu_0} - \vb*{M}
\]
就得到了
\begin{equation}
    \begin{bigcase}
        \div{\vb*{D}} &= \rho_\text{f}, \\
        \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\vb*{H}} &= \vb*{j}_\text{f} + \pdv{\vb*{D}}{t}
    \end{bigcase}
    \label{eq:maxwell-material}
\end{equation}

方程组\eqref{eq:maxwell-material}除去了\eqref{eq:original-maxwell}中由于介质产生的电荷密度和电流密度，形式上更加简洁，
但是即使在自由电荷密度和电流密度已经给定的情况下，只靠\eqref{eq:maxwell-material}本身也没有办法定解，因为未知数太多了。
考虑到从$\vb*{E}, \vb*{B}$到$\vb*{D}, \vb*{H}$的变换是线性的，
这就意味着\eqref{eq:original-maxwell}在自由电荷密度和电流密度已经给定的情况下其实也不能定解。
这是理所当然的。

下面的问题是，在自由电荷密度和电流密度已经给定的情况下，增加什么方程能够让\eqref{eq:maxwell-material}定解？
当然，只要知道了从$\vb*{E}, \vb*{B}$到$\vb*{D}, \vb*{H}$的变换的具体计算式（而不是显含$\vb*{j}_\text{r}$的定义式）
就能够定解。
更进一步，在什么都不知道，只有初始条件和边界条件的情况下，怎样能够让\eqref{eq:maxwell-material}定解？
只需要增补$\vb*{j}_\text{f}$和$\vb*{E}$的显式关系，以及输运方程
\begin{equation}
    \pdv{\rho_\text{f}}{t} + \div{\vb*{j}_\text{f}} = 0
    \label{eq:transportation}
\end{equation}
就能够定解。

因此要求解出介质中的电磁场变化情况，首先需要\concept{物理方程}\eqref{eq:maxwell-material}，
然后是\concept{本构关系}也就是$\vb*{D}$，$\vb*{H}$，$\vb*{j}_\text{f}$关于其他量的表达式，最后是\concept{几何关系}\eqref{eq:transportation}，
再加上适当的\concept{边界条件}和\concept{初始条件}，就能够定解。

关于本构关系实际上有一个问题，就是从$\vb*{E}$，$\vb*{B}$，$\vb*{j}_\text{f}$到$\vb*{D}$和$\vb*{H}$是不是真的有一个函数关系。
如果相同的$\vb*{E}$，$\vb*{B}$，$\vb*{j}_\text{f}$实际上对应着不同的系统状态，那就糟糕了。
但是在经典电动力学中确实只需要$\vb*{E}$，$\vb*{B}$是仅有的场，
而如果对$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$加上足够的限制，总是可以使用$\vb*{j}_\text{f}$确定下整个$\vb*{j}$的分布，从而$\rho$的分布，
因此$\vb*{E}$，$\vb*{B}$，$\vb*{j}_\text{f}$能够完全确定系统状态，从而本构关系总是可以写出来的。

\section{线性介质假设到光学方程}

\subsection{单色波解}

现在我们认为不存在自由电流和自由电荷，从而\eqref{eq:maxwell-material}成为
\begin{equation}
    \begin{bigcase}
        \div{\vb*{D}} &= 0, \\
        \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\vb*{H}} &= \pdv{\vb*{D}}{t}
    \end{bigcase}
    \label{eq:no-free-charge}
\end{equation}
并且假定所有本构关系都是线性的（这里由于自由电荷被认为是零，不再需要考虑关于$\vb*{j}_\text{f}$的本构关系），
且$\vb*{D}$只和$\vb*{E}$有关，$\vb*{H}$只和$\vb*{B}$有关。
这样就可以写出一般的本构关系
\[
    \begin{aligned}
        \vb*{D}(\vb*{r}, t) &= \int K_E(\vb*{r} - \vb*{r}', t - t') \vb*{E}(\vb*{r}', t') \dd^3 \vb*{r}' \dd t', \\
        \vb*{H}(\vb*{r}, t) &= \int K_B(\vb*{r} - \vb*{r}', t - t') \vb*{B}(\vb*{r}', t') \dd^3 \vb*{r}' \dd t'
    \end{aligned}
\]
其中的$K_E$和$K_B$都是张量。我们再要求本构关系是局部的，则应有%
\footnote{在本节中$K_E$和$K_B$代表不同的常（张）量，其值在不同地方可能不同}
\[
    \begin{aligned}
        \vb*{D}(\vb*{r}, t) &= \int K_E(\vb*{r}, t-t') \vb*{E}(\vb*{r}, t') \dd t', \\
        \vb*{H}(\vb*{r}, t) &= \int K_B(\vb*{r}, t-t') \vb*{B}(\vb*{r}, t') \dd t'
    \end{aligned}
\]
这是一个时间上的卷积运算。由傅里叶变换，我们只需要讨论平面波的本构关系就可以了，因为其它所有形式的场都能够写成平面波的叠加，既然\eqref{eq:no-free-charge}是线性齐次的（这就是假定没有自由电荷的好处！）。于是，不失一般性的，假设所有的场都取
\[
    \vb*{A}(\vb*{r}) \ee^{-\ii \omega t}
\]
的形式，其中$\vb*{A}(\vb*{r})$可以有虚部，但是一定能够写成某个实矢量乘以$\ee^{\ii \phi}$的形式%
\footnote{在这个条件下，可能的$\vb*{A}$并不能覆盖整个$\complexes^3$，但附加这个条件并不会失去一般性，因为允许$\vb*{A}$有虚部是为了表示$\vb*{A}_0 \cos (\omega t + \phi)$这样的函数，而这一点在限制$\vb*{A}(\vb*{r})$取某个实矢量乘以$\ee^{\ii \phi}$的形式时足以满足。这是三维下的实函数的傅里叶变换的一个特点。}
，则只需要形如
\begin{equation}
    \vb*{D}(\vb*{r}) = K_E(\vb*{r}, \omega) \vb*{E}(\vb*{r}), \quad \vb*{H}(\vb*{r}) = K_B(\vb*{r}, \omega) \vb*{B}(\vb*{r})
    \label{eq:linear-constitutive}
\end{equation}
的本构关系就可以了。\eqref{eq:linear-constitutive}中的所有变量可以取它们完整的表达式，也可以取它们的振幅。注意这些量可以是复数（用以表示相位）。
此时的麦克斯韦方程组成为
\begin{equation}
    \begin{bigcase}
        \div{\vb*{D}} &= 0, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\vb*{H}} &= - \ii \omega \vb*{D}
    \end{bigcase}
    \label{eq:sin-wave-eqs}
\end{equation}

现在转而讨论有自由电流和自由电荷的情况。我们认为自由电流正比于电场，即服从\concept{欧姆定律}。
同样不失一般性地设所有的场都可以写成一个复振幅乘以$\ee^{- \ii \omega t}$的形式。
使用导出$\vb*{D}$和$\vb*{E}$的关系、$\vb*{H}$和$\vb*{B}$的关系同样的方法，有
\begin{equation}
    \vb*{j}_\text{f}(\vb*{r}) = \sigma(\vb*{r}, \omega) \vb*{E}(\vb*{r})
    \label{eq:ohm-law-sin-wave}
\end{equation}
那么从\eqref{eq:maxwell-material}和\eqref{eq:transportation}可以得到
\[
    \begin{bigcase}
        \div{\vb*{D}} &= \rho_\text{f}, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\vb*{H}} &= \vb*{j}_\text{f} - \ii \omega \vb*{D}, \\
        - \ii \omega \rho_\text{f} + \div{\vb*{j}_\text{f}} &= 0,
    \end{bigcase}
\]
我们希望能够消去$\rho_\text{f}$和$\vb*{j}_\text{f}$，为此反复使用输运方程得到
\[
    \begin{bigcase}
        \div{\left( \vb*{D} - \frac{\vb*{j}_\text{f}}{\ii \omega} \right)   } &= 0, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}, \\
        \curl{\vb*{H}} &=  - \ii \omega \left( \vb*{D} - \frac{\vb*{j}_\text{f}}{\ii \omega} \right)
    \end{bigcase}
\]
代入本构关系\eqref{eq:ohm-law-sin-wave}得到
\[
    \begin{bigcase}
        \div{\left( \vb*{D} - \frac{\sigma \vb*{E}}{\ii \omega} \right)   } &= 0, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}, \\
        \curl{\vb*{H}} &=  - \ii \omega \left( \vb*{D} - \frac{\sigma \vb*{E}}{\ii \omega} \right)
    \end{bigcase}
\]
注意到$\vb*{D}$和$\vb*{E}$、$\vb*{H}$和$\vb*{B}$之间的关系（见\eqref{eq:linear-constitutive}），做下面的替换
\[
    \vb*{D} - \frac{\sigma \vb*{E}}{\ii \omega} \longrightarrow \vb*{D}, \quad K_E - \frac{\sigma}{\ii \omega} \longrightarrow K_E
\]
得到的方程和\eqref{eq:sin-wave-eqs}形式完全一致，本构关系的形式也还是\eqref{eq:linear-constitutive}。
唯一的不同是，$K_E$和$K_B$都是复数，并且
\begin{equation}
    \Im K_E = \frac{\sigma}{\omega}
\end{equation}

\subsection{各向同性介质中的亥姆霍兹方程}

我们特别感兴趣的是\eqref{eq:linear-constitutive}中$K_E$和$K_B$都是标量（不一定是实数）的情况，
也就是说，\eqref{eq:linear-constitutive}中给出的响应是\concept{各向同性}的。
此时有
\begin{equation}
    \vb*{D}(\vb*{r}) = \epsilon(\vb*{r}, \omega) \vb*{E}(\vb*{r}), \quad \vb*{H}(\vb*{r}) = \frac{1}{\mu(\vb*{r}, \omega)} \vb*{B}(\vb*{r})
    \label{eq:scalar-constitutive}
\end{equation}
第二个公式的比例系数特意被放到了分母中，以达到和\eqref{eq:original-maxwell}相同的形式。
将\eqref{eq:scalar-constitutive}代入\eqref{eq:sin-wave-eqs}中，得到
\begin{equation}
    \begin{bigcase}
        \div{(\epsilon \vb*{E})} &= 0, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\left(\frac{\vb*{B}}{\mu}\right)} &= - \ii \omega \epsilon \vb*{E}
    \end{bigcase}
    \label{eq:scalar-cons-maxwell-e-and-b}
\end{equation}
上式中第三式可以通过第二式推导而来；将第二式表示出的$\vb*{B}$代入第四式可以消去$\vb*{B}$。于是将\eqref{eq:scalar-cons-maxwell-e-and-b}简化为
\begin{equation}
    \begin{bigcase}
        \div{(\epsilon \vb*{E})} &= 0, \\
        \curl{ \left(\frac{1}{\mu} \curl{\vb*{E}} \right) } &= \omega^2 \epsilon \vb*{E}, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}
    \end{bigcase}
    \label{eq:e-in-material}
\end{equation}
这个方程关于电场的部分等价于
\[
    \begin{bigcase}
        \div{(\epsilon \vb*{E})} &= 0, \\
        \laplacian \vb*{E} + \mu \epsilon \omega^2 \vb*{E} &= - \frac{1}{\epsilon} \grad{(\vb*{E} \cdot \grad{\epsilon})} - \frac{1}{\mu} \grad{\mu} \cross (\curl{\vb*{E}})
    \end{bigcase}
\]
以上方程是基于$\vb*{E}$的，也可以写出基于$\vb*{H}$的类似的方程，遵从同样的步骤，可以得到
\begin{equation}
    \begin{bigcase}
        \div{\mu \vb*{H}} &= 0, \\
        \curl{\left( \frac{1}{\epsilon} \curl{\vb*{H}} \right)} &=  \mu \omega^2 \vb*{H}, \\
        \curl{\vb*{E}} &= \ii \omega \mu \vb*{H}.
    \end{bigcase}
    \label{eq:h-in-material}
\end{equation}
\eqref{eq:e-in-material}或\eqref{eq:h-in-material}称为\concept{主方程}。

特别的，在$\epsilon, \mu$在空间中处处相等或者变化得比较缓慢时，有
\begin{equation}
    \laplacian \vb*{E} + \frac{\omega^2}{c^2} \vb*{E} = 0, \quad c^2 = \frac{1}{\epsilon \mu}
    \label{eq:halmholtz-eq}
\end{equation}
\eqref{eq:halmholtz-eq}就是所谓的\concept{亥姆霍兹方程}，求解出它就求解出了整个\eqref{eq:e-in-material}。
需要注意的是并不是所有\eqref{eq:halmholtz-eq}的解都是\eqref{eq:e-in-material}的解，因为\eqref{eq:halmholtz-eq}没有包含\eqref{eq:e-in-material}的第一式。当然这个信息可以在求解\eqref{eq:halmholtz-eq}的时候使用一些边界条件加上去。
这里占用了$c$表示介质中光速，相对应地，设真空中光速为$c_0$，
其值为$1/\sqrt{\epsilon_0 \mu_0}$，因为简单地令$\epsilon=\epsilon_0$，$\mu = \mu_0$，
\eqref{eq:scalar-cons-maxwell-e-and-b}就退化到了真空的情况。

需要注意的是由于$\mu$和$\epsilon$可能有虚部（对应着吸收等情况），$c^2$不一定是实数。这就产生了一个问题：开根号在复平面上是多值的，那么$c$应该取哪一个值呢？

当$c$在某区域中基本上可以看成常的实数时，它就对应着平面波传播的速度。\eqref{eq:halmholtz-eq}有下面的平面波解
\begin{equation}
    \vb*{E} = \vb*{E}_0 \ee^{\ii(\vb*{k} \cdot \vb*{r} - \omega t)}, \quad k = \frac{\omega}{c}
    \label{eq:plane-wave}
\end{equation}
其中$\vb*{k}$是实矢量。
由空间中的傅里叶变换，\eqref{eq:halmholtz-eq}的所有解都可以写成不同$\vb*{k}$的平面波的叠加。

以上完成了关于介质中的控制方程的探讨。下面考虑界面上的衔接条件。最自然的想法，由\eqref{eq:scalar-cons-maxwell-e-and-b}，可以写出自然边界条件
\[
    \begin{bigcase}
        \vb*{n} \cdot (\epsilon_i \vb*{E}_1 - \epsilon_t \vb*{E}_2) &= 0, \\
        \vb*{n} \times (\vb*{E}_1 - \vb*{E}_2) &= 0, \\
        \vb*{n} \cdot (\vb*{B}_1 - \vb*{B}_2) &= 0, \\
        \vb*{n} \times \left( \frac{\vb*{B}_1}{\mu_1} - \frac{\vb*{B}_2}{\mu_2} \right) &= 0
    \end{bigcase}
\]
但是正如\eqref{eq:scalar-cons-maxwell-e-and-b}实际上有冗余一样，上式也有方程是多余的。实际上，由\eqref{eq:e-in-material}可以得出的关于电场的相互独立的边界条件为
\begin{equation}
    \left\{\quad
        \begin{aligned}
            \epsilon_1 \vb*{n} \cdot \vb*{E}_1 = \epsilon_2 \vb*{n} \cdot \vb*{E}_2, \\
            \vb*{n} \times \vb*{E}_1 = \vb*{n} \times \vb*{E}_2, \\
            \vb*{n} \times \left( \frac{1}{\mu_1} \curl{\vb*{E}_1} \right) = \vb*{n} \times \left(\frac{1}{\mu_2} \curl{\vb*{E}_2} \right)
        \end{aligned}
    \right.
    \label{eq:e-bound-condition}
\end{equation}
只需要这些边界条件结合\eqref{eq:e-in-material}就能够定解。

\subsection{电各向异性光学介质}

现在考虑一种稍为推广的情况。很多介质——比如晶体——都具有空间上的各向异性，这是因为从不同的方向施加电场可以导致不同强度的极化。
在几乎所有常见的情况中，各向异性仅限于$\vb*{D}$和$\vb*{E}$的关系中，于是\eqref{eq:scalar-constitutive}修正为
\begin{equation}
    \vb*{D}(\vb*{r}) = \vb*{\epsilon}(\vb*{r}, \omega) \vb*{E}(\vb*{r}), \quad \vb*{H}(\vb*{r}) = \frac{1}{\mu(\vb*{r}, \omega)} \vb*{B}(\vb*{r})
    \label{eq:e-tensor-constitutive}
\end{equation}
相应的，\eqref{eq:e-in-material}修改为
\begin{equation}
    \begin{bigcase}
        \div{(\vb*{\epsilon} \cdot \vb*{E})} &= 0, \\
        \curl{ \left(\frac{1}{\mu} \curl{\vb*{E}} \right) } &= \omega^2 \vb*{\epsilon} \cdot \vb*{E}, \\
        \curl{\vb*{E}} &= \ii \omega \vb*{B}
    \end{bigcase}
    \label{eq:e-in-tensor-material}
\end{equation}

我们要研究$\mu$和$\vb*{\epsilon}$变化不大时\eqref{eq:e-in-tensor-material}的平面波解。
此时关于电场的全部方程为
\[
    \begin{aligned}
        \div{\vb*{\epsilon} \cdot \vb*{E}} = 0, \\
        \grad{(\div{\vb*{E}})} - \laplacian{\vb*{E}} = \omega^2 \mu \vb*{\epsilon} \cdot \vb*{E}
    \end{aligned}
\]
不过不难注意到第一个方程可以从第二个方程推导出来，因此方程
\begin{equation}
    \grad{(\div{\vb*{E}})} - \laplacian{\vb*{E}} = \omega^2 \mu \vb*{\epsilon} \cdot \vb*{E}
    \label{eq:anisotropy}
\end{equation}
如果$\vb*{E}$是一个波矢为$\vb*{k}$，频率为$\omega$的单色波，那么这两个方程就推出
\[
    \begin{aligned}
        - (\vb*{k} \cdot \vb*{E}) \vb*{k} + k^2 \vb*{E} = \omega^2 \mu \vb*{\epsilon} \cdot \vb*{E}, \\
    (\vb*{k} \cdot \vb*{\epsilon}) \cdot \vb*{E} = 0
    \end{aligned}
\]
但是这两个方程不是相互独立的——在第一个方程两边点乘$\vb*{k}$就可以推出第二个。
顺带提一句：第二个方程表明，在介质是电各向异性的情况下，波矢$\vb*{k}$并不垂直于电场，而是垂直于$\vb*{D}$。

那么电各向异性光学介质中的平面波就完全地被下式描写：
\[
    k^2 \vb*{E} - (\vb*{k} \cdot \vb*{E}) \vb*{k} - \omega^2 \mu \vb*{\epsilon} \cdot \vb*{E} = 0
\]
也就是说
\begin{equation}
    \left( k^2 \vb*{\delta} - \vb*{k} \vb*{k} - \omega^2 \mu \vb*{\epsilon} \right) \cdot \vb*{E} = 0
    \label{eq:plain-wave-in-anistrophy}
\end{equation}
其中$\vb*{\delta}$为单位张量。

\eqref{eq:plain-wave-in-anistrophy}将电场的方向和波矢的方向联系了起来。要观察波矢自己要满足什么条件，只需要求解
\begin{equation}
    \det \left( k^2 \vb*{\delta} - \vb*{k} \vb*{k} - \omega^2 \mu \vb*{\epsilon} \right) = 0
    \label{eq:k-det}
\end{equation}
即可。

直接处理矢量形式的方程会比较棘手。但是注意到由于能量守恒的原因，$\vb*{D}$不可能和$\vb*{E}$反向，也就是
\[
    \vb*{D} \cdot \vb*{E} = \vb*{E} \cdot \vb*{\epsilon} \cdot \vb*{E} > 0
\]
那么我们可以确定$\vb*{\epsilon}$是正定的（TODO：有虚部时怎么办？）另一方面，晶体的空间对称性意味着$\vb*{\epsilon}$一定可以对角化，因此我们总是可以找到一个坐标系（未必是正交坐标系），在其中$\vb*{\epsilon}$被对角化，且对角元均为正数。
这个坐标系就是所谓的\concept{主轴系}。

\section{介质中的能流}

为了讨论能量，这一节我们再次引入自由电荷的概念，用于讨论场中有实物粒子的情况。（如果实物粒子不带电荷，那么它就不参与电磁相互作用，此时不方便从牛顿力学出发讨论能量）
我们只追踪自由电荷的能量，而不追踪所有电荷的能量。
于是，使用\eqref{eq:maxwell-material}以及洛伦兹力公式
\[
    \vb*{f} = q \vb*{E} + q \vb*{v} \times \vb*{B}
\]
可以得到
\[
    \vb*{f} \cdot \vb*{v} = - \div{(\vb*{E} \times \vb*{H})} - \vb*{H} \cdot \pdv{\vb*{B}}{t} - \vb*{E} \cdot \pdv{\vb*{D}}{t}
\]
则可以选取最简单的电磁能量密度和电磁能流为
\begin{equation}
    \begin{bigcase}
        \vb*{S} &= \vb*{E} \times \vb*{H}, \\
        \pdv{w}{t} &= \vb*{E} \cdot \pdv{\vb*{D}}{t} + \vb*{H} \cdot \pdv{\vb*{B}}{t}
    \end{bigcase}
    \label{eq:energy-in-material}
\end{equation}
其中的$\vb*{S}$就是\concept{坡印廷矢量}。公式\eqref{eq:energy-in-material}的导出没有使用线性介质假设。

在已知$\vb*{D}$和$\vb*{E}$的关系线性、$\vb*{H}$和$\vb*{B}$的关系也是线性的情况下，有
\begin{equation}
    w = \frac{1}{2} (\vb*{E} \cdot \vb*{D} + \vb*{H} \cdot \vb*{B})
    \label{eq:energy-density-linear-material}
\end{equation}

需要注意的是\eqref{eq:energy-in-material}和\eqref{eq:energy-density-linear-material}都不是线性的，
因此在这些公式中不能让各个场有虚部。

在稳态时各个场做正弦变化，这也是本文关注的主要场景。首先讨论介质中只有一个单色波的情况。不失一般性地认为$\vb*{E}$的相位零点在$t=0$处，则有
\[
    \vb*{S} = \vb*{E}_0 \times \vb*{H}_0 \cos(\omega t) \cos(\omega t + \phi)
\]
其中$\phi$是两者的相位差，$\vb*{E}_0, \vb*{H}_0$分别是振幅，这三者均只有实部。我们更加关心一段时间内的平均能流，则有
\[
    \expval*{\vb*{S}} = \frac{1}{2} \vb*{E}_0 \times \vb*{H}_0 \cos \phi
\]
现在考虑含有虚部的$\vb*{E}, \vb*{H}$表达式
\[
    \vb*{E} = \vb*{E}_0 \ee^{\ii \omega t}, \vb*{H} = \vb*{H}_0 \ee^{\ii \phi} \ee^{\ii \omega t}
\]
我们会发现一个有趣的结果：
\[
    \Re \vb*{E}^* \times \vb*{H} = \expval*{\vb*{S}}
\]
直观地看，可以将$\vb*{E}^* \times \vb*{H}$的实部看成“有功分量”，虚部看作“无功分量”。
这样可以定义\concept{实数版本的辐照度}
\begin{equation}
    \vb*{I} = \expval*{\vb*{S}} = \frac{1}{2} \vb*{E}_0 \times \vb*{H}_0 \cos \phi
    \label{eq:radiation-real}
\end{equation}
也可以定义\concept{复数版本的辐照度}
\begin{equation}
    \vb*{I} = \frac{1}{2} \Re \vb*{E}^* \times \vb*{H}
    \label{eq:radiation-complex}
\end{equation}
\eqref{eq:radiation-complex}的实部就是\eqref{eq:radiation-real}。

接着再讨论平面波的能量密度。由于
% \[
%     \vb*{k} \cdot \vb*{B} = 0, \quad \vb*{D} = - \frac{\vb*{k}}{\omega} \cross \vb*{H},
% \]
% 我们有
% \[
%     D^2 = \frac{k^2}{\mu^2 \omega^2} B^2
% \]
% 则
% \[
%     \frac{1}{2} \vb*{H} \cdot \vb*{B} = \frac{\mu \omega^2}{2 k^2} D^2, 
% \]
% \[
%     \frac{1}{2} \vb*{E} \cdot \vb*{D} = \frac{1}{2} \vb*{E} \cdot \vb*{\epsilon} \cdot \vb*{E}
% \]
% 于是
% \begin{equation}
%     w = w_E + w_B = \frac{1}{2} \vb*{E} \cdot \vb*{\epsilon} \cdot \vb*{E} + \frac{\mu \omega^2}{2 k^2} D^2
%     \label{eq:energy-density}
% \end{equation}
\[
    w = w_E + w_B,
\]
分别化简两项，有
\[
    w_E = \frac{1}{2} \vb*{E} \cdot \vb*{D} 
        = \frac{1}{2} \vb*{E} \cdot \left( - \frac{\vb*{k}}{\omega} \times \vb*{H} \right) 
        = \frac{1}{2} \frac{\vb*{k}}{\omega} \cdot (\vb*{E} \times \vb*{H}),
\]
且
\[
    w_B = \frac{1}{2} \vb*{H} \cdot \vb*{B} 
        = \frac{1}{2} \vb*{H} \cdot \left( \frac{\vb*{k}}{\omega} \cdot \vb*{E} \right) 
        = \frac{1}{2} \frac{\vb*{k}}{\omega} \cdot (\vb*{E} \times \vb*{H}),
\]
因此电场能和磁场能各占总能量的一半，且
\begin{equation}
    w = \frac{\vb*{k}}{\omega} \cdot (\vb*{E} \times \vb*{H}) = \frac{k S}{\omega} \cos \alpha
    \label{eq:energy-density-and-s}
\end{equation}
其中$\alpha$是$\vb*{k}$和$\vb*{S}$的夹角。
相应的，能量传递的速度为
\begin{equation}
    \vb*{v} = \frac{\vb*{S}}{w} = \frac{\omega}{k}  \cos \alpha \vu*{S}
\end{equation}


\chapter{线性介质的光学性能的微观原理}

\section{线性极化}

\subsection{经典谐振子模型}

\subsubsection{洛伦兹模型}

我们现在转而考虑存在阻尼的谐振子，有
\begin{equation}
    m \ddot{\vb*{r}} = - m \gamma \dot {\vb*{r}} + q (\vb*{E} + \vb*{v} \times \vb*{B}),
\end{equation}
以$\vb*{B}$的指向为$z$轴，则$\vb*{E}$一定在$xy$平面内，则上式成为% TODO
\begin{equation}
    v_x = \frac{q}{m} \tau E_x + \omega_\text{L} \tau v_y,
\end{equation}
其中
\begin{equation}
    \omega_\text{L} = \frac{qB}{m}
\end{equation}
为\concept{拉莫频率}，而
\begin{equation}
    \tau = \frac{1}{\gamma}.
\end{equation}

\chapter{均匀线性介质中的电磁波}

\section{各向同性线性介质中的平面波}\label{sec:light-propagate}

光无非是成束的电磁场，因此接下来可以通过求解\eqref{eq:e-in-material}获得光的传播情况。
在光学中常见的介质或者是性能变化比较均匀的，或者是性能变化非常剧烈的（也就是介质界面附近，例如水和空间交界处）。
前者中的

\subsection{均匀介质内部光的传播}\label{sec:in-interior-uniform}

在均匀介质内部光的传播情况由\eqref{eq:halmholtz-eq}控制。
当介质内部的$\epsilon$和$\mu$都是实数时可以直接使用平面波解\eqref{eq:plane-wave}。而当$\epsilon$和$\mu$含有虚部——也就是说，介质含有吸收等性质——那么根据解析延拓的原理，\eqref{eq:plane-wave}的形式应该得到保持，但是$\vb*{k}$需要有虚部。%
\footnote{从积分变换的角度来看，$\epsilon\mu$含有虚部意味着有关的方程难以直接通过傅里叶展开化简，因为傅里叶展开在实函数上比较简单。为此我们将$\vb*{k}$推广到复数的情况，实际上就是从空间傅里叶变换推广到了空间拉普拉斯变换。}
实际上，即使是$\epsilon$和$\mu$都取实数值的时候，\eqref{eq:plane-wave}中的$\vb*{k}$也可以有虚部。当然，此时的电场不再是一个基本解了，因为它可以使用若干个实数$\vb*{k}$的真正的平面波叠加出来。

在最一般的、$\epsilon$和$\mu$是否有虚部不知道的情况下，将\eqref{eq:plane-wave}代入\eqref{eq:halmholtz-eq}得到
\[
    - (\Re \vb*{k} + \Im \vb*{k})^2 + \omega^2 \epsilon\mu = 0
\]
化简，由于交叉项是纯虚数而其他项都是纯实数，可得
\[
    \begin{bigcase}
        (\Re \vb*{k})^2 - (\Im \vb*{k})^2 &= \omega^2\Re \epsilon\mu, \\
        2 (\Re \vb*{k}) \cdot (\Im \vb*{\vb*{k}}) &= \omega^2\Im \epsilon\mu.
    \end{bigcase}
\]
因此，在一个$\epsilon$和$\mu$都没有虚部的介质中，有
\[
    (\Re \vb*{k}) \cdot (\Im \vb*{\vb*{k}}) = 0
\]
还有\eqref{eq:e-in-material}的第一式没有使用。它意味着
\[
    \vb*{k} \cdot \vb*{E} = (\Re \vb*{k} + \ii \Im \vb*{k}) \cdot \vb*{E} = 0
\]

这样一来我们得出结论：在均匀的、可能有吸收等因素，从而使$c^2$有虚部的介质中，有形如下式的解：
\begin{equation}
    \left\{
        \begin{aligned}
            &\vb*{E} = \vb*{E}_0 \ee^{\ii (\vb*{k} \cdot \vb*{r} - \omega t)}, \\
            &(\Re \vb*{k})^2 - (\Im \vb*{k})^2 = \omega^2 \Re \epsilon\mu, \\
            &2 (\Re \vb*{k}) \cdot (\Im \vb*{\vb*{k}}) = \omega^2 \Im \epsilon\mu, \\
            &\vb*{k} \cdot \vb*{E} = 0
        \end{aligned}
    \right.
    \label{eq:uniform-wave}
\end{equation}

在$\epsilon\mu$完全就是实数的时候\eqref{eq:uniform-wave}意味着$\vb*{k}$的实部、虚部相互正交（电场的方向和$\vb*{k}$的实部、虚部没有特别明显的关系）。
这种情况只有可能发生在界面附近，并且要求$\Re \vb*{k}$平行于界面而$\Im \vb*{k}$要垂直于界面且方向从界面指向介质内部，
否则电场会在远处发散到无穷大，不是物理解。%
\footnote{关于物理解有必要说明这一点：实际上，平面波本身也不是真正具有物理意义的波，因为不可能让电场充满整个空间，且同时只具有一个频率。
然而，实际的光的分布满足的特定边界条件意味着我们确实没有必要讨论所有可能的平面波——只需要讨论满足这些边界条件的平面波即可。
例如，光通常是从一个光源打出来的，这就暗示了两个边界条件：
首先，某个平面（也就是光源所在的平面）上的场强是给定的，需要计算的是这个平面某一侧的场强，另一侧的场强没有意义（因为它在光源之后）；
其次，光源两侧无穷远处的场强应趋于零。
这就意味着，组合成这个光的平面波在垂直于$\Re \vb*{k}$的方向上不能发散，在与$\Re\vb*{k}$相反的方向上可以发散，在与$\Re\vb*{k}$同向的方向上不能发散。
这就是我们使用的“物理解”的条件。
}
我们将在\ref{sec:total-reflect}节看到这种解的一个例子。
而当$\epsilon\mu$含有虚部时，可以做下面的分解：
\[
    \Im \vb*{k} = \vb*{k}_\parallel + \vb*{k}_\bot
\]
使$\vb*{k}_\parallel$平行于$\Re\vb*{k}$，$\vb*{k}_\bot$垂直于$\Re\vb*{k}$。
这两个分量当然都会让电场在远处发散到无穷大，但是物理解的要求意味着$\vb*{k}_\parallel$与$\Re \vb*{k}$同向，
而如果$\vb*{k}_\bot$非零，那么必定有$\Re \vb*{k}$（从而$\vb*{k}_\parallel$）平行于界面而$\vb*{k}_\bot$要垂直于界面且方向从界面指向介质内部。

既然$\vb*{k}_\parallel$和$\Re \vb*{k}$总是同向，我们有理由认为这两者可以看成同一个对象的实部和虚部。
因此，在\ref{sec:light-propagate}节的剩下部分，我们用$\vb*{k}$代替原本的$\Re \vb*{k} + \ii \vb*{k}_\parallel$，
而使用$\vb*{\beta}$代替原本的$\vb*{k}_\bot$，这样\eqref{eq:uniform-wave}就需要改写为
\begin{equation}
    \left\{\quad
        \begin{aligned}
            \vb*{E} = \vb*{E}_0 \ee^{- \vb*{\beta} \cdot \vb*{r}} \ee^{\ii (\vb*{k} \cdot \vb*{r} - \omega t)}, \\
            \vb*{k}^2 - \vb*{\beta}^2 = \mu\epsilon\omega^2, \quad \vb*{k} \cdot \vb*{\beta} = 0, \\
            (\vb*{k} + \ii \vb*{\beta}) \cdot \vb*{E} = 0
        \end{aligned}
    \right.
    \label{eq:beta-k-uniform-wave}
\end{equation}
其中$\vb*{k}$与波前传播方向同向。$\vb*{k}$，$\vb*{\beta}$，$\vb*{E}$三者相互垂直，$\vb*{k}$可以有虚部而$\vb*{\beta}$没有。
无论$\vb*{k}$有没有虚部，它都可以写成一个复数乘以一个实矢量的形式，因此可以非常良好地定义$\vb*{k}$方向上的单位矢量$\hat{\vb*{k}}$。
反之，在\eqref{eq:uniform-wave}中，由于没有将$\vb*{k}$做适当的分解，可能难以良定义一个单位矢量，因为此时不同基向量上的分量可能具有不成比例的实部和虚部。

同样，为了让解是物理解，应当有$\vb*{\beta}$垂直于某个界面且方向从界面指向介质内部，否则解会发散。

特别的，在$\vb*{\beta}$为零的时候，我们有
\begin{equation}
    \left\{
        \begin{aligned}
            \vb*{E} = \vb*{E}_0 \ee^{\ii(\vb*{k} \cdot \vb*{r} - \omega t)}, \\
            \vb*{k}^2 = \mu\epsilon \omega^2, \\
            \vb*{k} \cdot \vb*{E} = 0.
        \end{aligned}
    \right.
    \label{eq:beta-zero-uniform-wave}
\end{equation}

关于$\vb*{k}$的取值需要额外的注记。我们设$\vb*{k}=k \hat{\vb*{k}}$，其中$\hat{\vb*{k}}$正是\eqref{eq:uniform-wave}中的那个$\Re\vb*{k}$（和\eqref{eq:beta-k-uniform-wave}中的$\vb*{k}$同向但是不相同）的单位向量。
那么从\eqref{eq:beta-k-uniform-wave}就可以得出
\begin{equation}
    k^2 - \beta^2 = \mu \epsilon \omega^2
\end{equation}
其中$\beta$的取值通常和边界条件有关，确定了$\beta$就能够得到$k$。
但是还有一个额外的问题：$\mu \epsilon$含有虚部，因此下面的表达式
\[
    k = \sqrt{\beta^2 + \mu \epsilon \omega^2}
\]
就是多值的。具体取哪一个值需要根据物理条件确定。在能够确定具体取那个值的时候，我们规定\concept{折射率}为
\begin{equation}
    n(\omega) = c_0 \sqrt{\epsilon(\omega) \mu(\omega)}, 
    \label{eq:refractivity}
\end{equation}
这时就有
\begin{equation}
    \quad \frac{\omega}{k} = \frac{c_0}{n} \equiv c
    \label{eq:k-and-omega-and-n}
\end{equation}
在$n$没有虚部时$c$就是介质中\eqref{eq:beta-k-uniform-wave}的波前传播速度。

\subsection{两种透明均匀介质界面上的折射和反射}\label{sec:two-isotrophy-surface}

所谓透明介质指的是折射率完全为实数的介质。在这种介质中，
如图\ref{fig:ray-onto-flat-surface}所示，我们假定有两个几乎无限大的介质以一个完全平坦的界面隔开。
\begin{figure}
    \centering
    \begin{tikzpicture}
        % 两种介质
        \node[above] at (-4, 2) {$n_i$};
        \node[above] at (-4, -3) {$n_t$};
        % 介质界面
        \draw (-4,0) -- (4,0);
        \node[above] at (-3.5,0) {\small 介质界面};
        % 法线
        \draw[dash pattern=on5pt off3pt] (0,4) -- (0,-4);
        % 入射光线
        \draw[ray] (130:5.2) -- (0,0);
        \node[] at (-2,3) {$\vb*{k}_i$};
        \draw (0,1) arc (90:130:1);
        \node[] at (110:1.4) {$\theta_i$};
    \end{tikzpicture}
    \caption{光入射平整表面}
    \label{fig:ray-onto-flat-surface}
\end{figure}
现在让一束光照射到这个界面上。为了方便起见，假定在我们感兴趣的尺度内光强\concept{处处相同}，也就是入射光形式为
\[
    \vb*{E}_i = \vb*{E}_{i0} \ee^{\ii(\vb*{k}_i \cdot \vb*{r} - \omega t)}
\]
（图\ref{fig:ray-onto-flat-surface}中的实线只是代表波的传播方向，不代表光束。）

\begin{figure}
    \centering
    \begin{tikzpicture}
        \draw [-{Stealth}] (-1, 1) -- (1, -1);
        \node[above] at (0,-1) {$\vb*{k}$};
        \draw [-{Stealth}, thick] (0.5,0.5) -- (1.5,1.5);
        \node at (0.4,1) {$\vb*{E}_p$};
        \node at (1.5, 0) {$\odot$};
        \node at (2, 0) {$\vb*{E}_s$};
    \end{tikzpicture}
    \caption{电场的分解}
    \label{fig:decomposition-of-e}
\end{figure}

同时为了将矢量方程\eqref{eq:e-bound-condition}标量化，将电场按照图\ref{fig:decomposition-of-e}的方式做分解。
我们没有给出平行于$\vb*{k}$的电场分量，因为按照\eqref{eq:beta-k-uniform-wave}，这个电场分量不存在。

\subsubsection{有透射光的情况}

\begin{figure}
    \centering
    \begin{tikzpicture}
        % 两种介质
        \node[above] at (-4, 2) {$n_i$};
        \node[above] at (-4, -3) {$n_t$};
        % 介质界面
        \draw (-4,0) -- (4,0);
        \node[above] at (-3.5,0) {\small 介质界面};
        % 法线
        \draw[dash pattern=on5pt off3pt] (0,4) -- (0,-4);
        \draw [-{Stealth}, thick] (0,0) -- (0,2);
        \node [above] at (0.3, 2.1) {$\vb*{n}$};
        % 入射光线
        \draw[ray] (130:5.2) -- (0,0);
        \node[] at (-2,3) {$\vb*{k}_i$};
        \draw (0,1) arc (90:130:1);
        \node[] at (110:1.4) {$\theta_i$};
        % 反射光线
        \draw[ray] (0,0) -- (50:5.2) ;
        \node[] at (2,3) {$\vb*{k}_r$};
        \draw (0,1.2) arc (90:50:1.2);
        \node[] at (70:1.4) {$\theta_r$};
        % 折射光线
        \draw[ray] (0,0) -- (-70:4.5);
        \node[] at (1.5,-3) {$\vb*{k}_t$};
        \draw (0,-1.1) arc (-90:-70:1.1);
        \node[] at (-80:1.4) {$\theta_t$};
    \end{tikzpicture}
    \caption{光入射平整表面之后发生反射和折射}
    \label{fig:ray-refraction}
\end{figure}

凭借经验，我们会认为入射波$\vb*{E}_i$会导致两个平面波，分别称为\concept{反射波}和\concept{折射波}，图示为图\ref{fig:ray-refraction}，形式如下：
\[
    \begin{aligned}
        \vb*{E}_r &= \vb*{E}_{r0} \ee^{\ii(\vb*{k}_r \cdot \vb*{r} - \omega t)}, \\
        \vb*{E}_t &= \vb*{E}_{t0} \ee^{\ii(\vb*{k}_t \cdot \vb*{r} - \omega t)}
    \end{aligned}
\]

这样在介质1中和在介质2中分别有
\[
    \begin{aligned}
        \vb*{E}_1 = \vb*{E}_{i0} \ee^{\ii(\vb*{k}_i \cdot \vb*{r} - \omega t)} +  \vb*{E}_{r0} \ee^{\ii(\vb*{k}_r \cdot \vb*{r} - \omega t)}, \\
        \vb*{E}_2 = \vb*{E}_{t0} \ee^{\ii(\vb*{k}_t \cdot \vb*{r} - \omega t)}
    \end{aligned}
\]
使用\eqref{eq:e-bound-condition}，可以得到形如下式的结果：
\[
    \text{something } \ee^{\ii(\vb*{k}_i \cdot \vb*{r} - \omega t)} + \text{something } \ee^{\ii(\vb*{k}_r \cdot \vb*{r} - \omega t)} = \text{something } \ee^{\ii(\vb*{k}_t \cdot \vb*{r} - \omega t)}
\]
从而必须有
\[
    (\vb*{k}_i - \vb*{k}_r) \cdot \vb*{r} = \const, \quad (\vb*{k}_i - \vb*{k}_t) \cdot \vb*{r} = \const
\]
考虑到这些方程描写了一个平面，而它们都在界面（一个平面）上恒成立，有%
\footnote{能够导出这个结果是因为$\ee^{\ii \vb*{k} \cdot \vb*{r}}$是函数基。上面的方程在界面上恒成立，因此在界面上$\vb*{k}_i$，$\vb*{k}_r$，$\vb*{k}_t$的投影，也就是$\vb*{n} \times \vb*{k}$都一样。}
\begin{equation}
    \vb*{n} \times (\vb*{k}_i - \vb*{k}_r) = \vb*{n} \times (\vb*{k}_i - \vb*{k}_t) = 0
    \label{eq:k-and-n}
\end{equation}

假设入射波、反射波、折射波\concept{它们自己}都能够成为\eqref{eq:e-in-material}的解。
考虑到介质被认为是均匀的，假设这三个波都能够写成\eqref{eq:uniform-wave}的形式。
进一步，假设这三个波均没有\eqref{eq:beta-k-uniform-wave}中的$\vb*{\beta}$。
这些假设是太多了，我们将发现它们只能够在一部分场景下成立。

在这种情况下，三个波的$\vb*{k}$都可以写成一个复数乘以一个实矢量的形式，因此可以良好地定义“波前前进的方向”。
于是就有
\[
    \vb*{k}_i = k_i \hat{\vb*{k}}_i, \; \vb*{k}_r = k_r \hat{\vb*{k}}_r, \; \vb*{k}_t = k_t \hat{\vb*{k}}_t
\]
由于入射波和反射波都位于介质1中，我们确定$k_i=k_r$。

按照图\ref{fig:ray-refraction}中展示的方式标记角度。
（注意$\vb*{k}_i$和法向量的夹角为$\pi-\theta_i$）
\eqref{eq:k-and-n}可以写作
\[
    k_i \vb*{n} \times \vu*{k}_i = k_r \vb*{n} \times \vu*{k}_r, \quad k_i \vb*{n} \times \vu*{k}_i = k_t \vb*{n} \times \vu*{k}_t
\]

\begin{equation}
    \theta_i = \theta_r, \quad \frac{\sin \theta_i}{\sin \theta_t} = \frac{n_t}{n_i}
    \label{eq:snell}
\end{equation}

最终得到\concept{菲涅尔公式}
\begin{equation}
    \begin{bigcase}
        r_\bot &= \frac{E_{rs}}{E_{is}} = 
        \frac{\frac{n_i}{\mu_i} \cos \theta_i - \frac{n_t}{\mu_t} \cos \theta_t}{\frac{n_i}{\mu_i} \cos \theta_i + \frac{n_t}{\mu_t} \cos \theta_t}, \\
        t_\bot &= \frac{E_{ts}}{E_{is}} = 
        \frac{2 \frac{n_i}{\mu_i} \cos \theta_i}{\frac{n_i}{\mu_i} \cos \theta_i + \frac{n_t}{\mu_t} \cos \theta_t}, \\
        r_\parallel &= \frac{E_{rp}}{E_{ip}} = 
        \frac{\frac{n_t}{\mu_t} \cos \theta_i - \frac{n_i}{\mu_i} \cos \theta_t}{\frac{n_i}{\mu_i} \cos \theta_t + \frac{n_t}{\mu_t} \cos \theta_i}, \\
        t_\parallel &= \frac{E_{tp}}{E_{ip}} =
        \frac{2 \frac{n_i}{\mu_i} \cos \theta_i}{\frac{n_i}{\mu_i} \cos \theta_t + \frac{n_t}{\mu_t} \cos \theta_i}
    \end{bigcase}
    \label{eq:fresnel-formulas}
\end{equation}

当$\theta_i \to 0$，也就是入射光垂直于界面时，我们有
\begin{equation}
    r_\bot = \frac{n_i / \mu_i - n_t / \mu_t}{n_i / \mu_i + n_t / \mu_t}, \quad 
    r_\parallel = \frac{n_t / \mu_t - n_i / \mu_i}{n_i / \mu_i + n_t / \mu_t}
\end{equation}
看起来这样很奇怪，因为此时不能区分p光和s光，而两者的反射系数却差了一个负号。
但实际上这是错觉。回顾图\ref{fig:decomposition-of-e}，我们会发现入射和反射的p光的基矢量在$\theta \to 0$时是反向的，而入射和反射s光的基矢量在$\theta \to 0$时同向，因此反射系数就应该差一个负号——最后无论将入射光当成p光还是当成s光，都能够得到同样的反射光矢量，于是可以写出
\begin{equation}
    \vb*{E}_r = \frac{n_i / \mu_i - n_t / \mu_t}{n_i / \mu_i + n_t / \mu_t} \vb*{E}_i
\end{equation}

关于能量有下面的等式：
\begin{equation}
    T = \left( \frac{n_t \cos \theta_t / \mu_t}{n_i \cos \theta_i / \mu_i} \right) t^2, \quad R = r^2
\end{equation}

\subsubsection{全反射}\label{sec:total-reflect}

TODO:隐逝波的方向不完全

当$n_i > n_t$而
\[
    \theta_i > \arcsin \frac{n_t}{n_i}
\]
时，先前做的“入射波产生反射波和折射波，这三个波都是平面波”的假设就失效了，因为这个假设导致方程组\eqref{eq:e-bound-condition}无解。
为了在这种情况下求解\eqref{eq:e-bound-condition}，尝试放松一个假设。
实验上，在全反射发生的时候没有观察到折射波，因此假定折射波在边界处快速衰减了。因此此时我们假定反射波、折射波采取下面的形式：
\[
    \begin{aligned}
        \vb*{E}_r &= \vb*{E}_{r0} \ee^{\ii (\vb*{k}_r \cdot \vb*{r} - \omega t)}, \\
        \vb*{E}_t &= \vb*{E}_{t0} \ee^{-\vb*{\beta} \cdot \vb*{r}} \ee^{\ii (\vb*{k}_t \cdot \vb*{r} - \omega t)}
    \end{aligned}
\]
其中$\vb*{\beta}$垂直于界面。所有的参量都是实的。

此时在边界上会有类似于这样的表达式：
\[
    \mathrm{something} \; \ee^{\ii (\vb*{k}_r \cdot \vb*{r} - \omega t)} + \mathrm{something} \; \ee^{\ii (\vb*{k}_r \cdot \vb*{r} - \omega t)} = \mathrm{something} \; \ee^{-\vb*{\beta} \cdot \vb*{r}} \ee^{\ii (\vb*{k}_t \cdot \vb*{r} - \omega t)}
\]

\subsubsection{公式形式的统一处理}

\subsection{各向同性介质中平面波的能量}

由于在各向同性介质中

\section{各向异性线性介质中的平面波}

以上讨论的都是各向同性介质中光的传播，也就是说，$\vb*{D}$和$\vb*{E}$、$\vb*{H}$和$\vb*{B}$之间的联系都是标量倍数。
现在稍微放松这个假设，假定$\vb*{E}$和之间的联系是一个张量，也就是说，
\[
    \vb*{D} = \vb*{\epsilon} \cdot \vb*{E}
\]
其中$\vb*{\epsilon}$是一个张量，或者也可以写成
\[
    D_i = \epsilon_{ij} E_j
\]

\subsection{单光轴透明介质内部的平面波}\label{sec:one-axis-transparent}

首先讨论一种最简单的情况。此时介质有一个对称轴，绕着这个对称轴有旋转不变性。
这就意味着$\vb*{\epsilon}$有两个特征值，其中一个对应着一个唯一的特征向量，另一个对应着两个特征向量，
且后面两个特征向量垂直于前一个特征向量（否则不能保证旋转不变性）。
% TODO：群论
此时可以将$\vb*{\epsilon}$正交对角化。
于是，可以找到一个直角坐标系$x,y,z$，使$z$方向对应着前一个特征向量，$x,y$方向对应着后两个特征向量（需要对它们做正交化）
此时没有必要区分逆变协变，可以直接写出矩阵形式
\begin{equation}
    [\mu \epsilon_{ij}]_{ij} = \frac{1}{c_0^2} \bmqty{\dmat{n_o^2,n_o^2,n_e^2}}
    \label{eq:one-axis-matrix}
\end{equation}
其中$n_e, n_o > 0$。我们下这个断言是因为介质对外加电场产生的响应不可能使总电场和外加电场方向相反，也就是说，如果$\vb*{E}$取某个适当的方向使$\vb*{E}$和$\vb*{D}$之间只差一个标量倍数，那么这个标量倍数一定大于零，因此这个倍数一定有正的平方根，从而，$\vb*{\epsilon}$的特征值一定大于零。

此时\eqref{eq:k-det}等价于
\[
    \mdet{
        k_y^2 + k_z^2 - \frac{\omega^2}{c_0^2} n_o^2 & -k_x k_y & - k_x k_z \\
        - k_x k_y & k_x^2 + k_z^2 - \frac{\omega^2}{c_0^2} n_o^2 & -k_y k_z \\
        -k_x k_z & -k_y k_z & k_x^2 + k_y^2 - \frac{\omega^2}{c_0^2} n_e^2
    } = 0
\]
化简得到
\begin{equation}
    \left( \frac{k_x^2}{n_o^2} + \frac{k_y^2}{n_o^2} + \frac{k_z^2}{n_o^2} - \frac{\omega^2}{c_0^2} \right) \left( \frac{k_x^2}{n_e^2} + \frac{k_y^2}{n_e^2} + \frac{k_z^2}{n_o^2} - \frac{\omega^2}{c_0^2} \right) = 0
    \label{eq:uniaxial-crystal}
\end{equation}
因此，$\vb*{k}$只需要让其中的一个因式为零，就是可能的解。

下面讨论\eqref{eq:uniaxial-crystal}的两个解。第一种情况是
\[
    \frac{k_x^2}{n_o^2} + \frac{k_y^2}{n_o^2} + \frac{k_z^2}{n_o^2} - \frac{\omega^2}{c_0^2} = 0
\]
我们称此时的波为\concept{o光}。o光的波矢需要且只需要满足
\[
    \abs{\vb*{k}_o} = \frac{n_o \omega}{c_0}
\]
o光的电场方向需要满足什么条件？可以将\eqref{eq:plain-wave-in-anistrophy}写成
\[
    \bmqty{
        k_y^2 + k_z^2 - \frac{\omega^2}{c_0^2} n_e^2 & -k_x k_y & - k_x k_z \\
        - k_x k_y & k_x^2 + k_z^2 - \frac{\omega^2}{c_0^2} n_e^2 & -k_y k_z \\
        -k_x k_z & -k_y k_z & k_x^2 + k_y^2 - \frac{\omega^2}{c_0^2} n_o^2
    }
    \bmqty{
        E_x \\ E_y \\ E_z
    } = 0
\]
在球坐标系中写出
\[
    k_x = \frac{n_o \omega}{c_0} \sin \varphi \cos \theta, 
    \quad k_y = \frac{n_o \omega}{c_0} \sin \varphi \sin \theta, \quad k_z = \frac{n_o \omega}{c_0} \cos \varphi
\]
然后代入上面的矩阵表达式，经过一系列初等变换得到
\[
    \bmqty{
        \sin \varphi \cos \theta & \sin \varphi \sin \theta & \cos \varphi \\
        0 & 0 & 1
    }
    \bmqty{E_x \\ E_y \\ E_z} = 0
\]
于是得到了o光需要（且只需要）满足的条件：
\begin{equation}
    \abs{\vb*{k}_o} = \frac{n_o \omega}{c_0}, \quad\vb*{e}_z \cdot \vb*{E}_o = \vb*{k}_o \cdot \vb*{E}_o = 0
    \label{eq:o-light}
\end{equation}
因此，除了o光永远不会有平行于光轴的分量以外，o光在介质中的传播方式和各向同性介质中的光完全一样：$\vb*{k}$和$\vb*{E}, \vb*{D}$均垂直（并且可以验证$\vb*{D}$和$\vb*{E}$平行），且$k$和$\omega$之间的关系就是普通的折射率确定的关系。

第二种情况是
\[
    \frac{k_x^2}{n_e^2} + \frac{k_y^2}{n_e^2} + \frac{k_z^2}{n_o^2} - \frac{\omega^2}{c_0^2} = 0
\]
称此时的波为\concept{e光}。使用和上面相同的方法，写出椭球坐标之下的$\vb*{k}_e$表达式
\[
    k_x = \frac{n_e \omega}{c_0} \sin \theta \cos \varphi, \quad k_y = \frac{n_e \omega}{c_0} \sin \theta \sin \varphi, \quad k_z = \frac{n_o \omega}{c_0} \cos \theta
\]
将\eqref{eq:plain-wave-in-anistrophy}写成矩阵形式之后代入椭球坐标下的$\vb*{k}_e$表达式，然后做初等变换，得到
\[
    \bmqty{
        n_0 \sin \theta \cos \varphi & n_0 \sin \theta \sin \varphi & n_e \cos \theta \\
        -\sin \varphi & \cos \varphi & 0
    }
    \bmqty{E_x \\ E_y \\ E_z} = 0
\]
这是一个有两个方程组成的方程组。
容易验证，在本坐标系中$\bmqty{n_0 \sin \theta \cos \varphi & n_0 \sin \theta \sin \varphi & n_e \cos \theta}$
和$\vb*{k} \cdot \vb*{\epsilon}$共线，$\bmqty{-\sin \varphi & \cos \varphi & 0}$与$\vb*{e}_z \times \vb*{k}$共线。
因此e光需要且只需要满足的方程为
\begin{equation}
    \frac{k_{ex}^2}{n_e^2} + \frac{k_{ey}^2}{n_e^2} + \frac{k_{ez}^2}{n_o^2} =
    \frac{\omega^2}{c_0^2}, \quad \vb*{k}_e \cdot \vb*{\epsilon} \cdot \vb*{E}_e = 0, \quad (\vb*{e}_z \times \vb*{k}_e) \cdot \vb*{E}_e = 0
    \label{eq:e-light}
\end{equation}
因此，e光的振动方向被限制在了光轴和波矢确定的平面上。
此时通过$k$和$\omega$之间的关系仍然可以定义等效的折射率，它是
\begin{equation}
    n = \frac{c_0 \abs*{\vb*{k}_e}}{\omega} , \quad \frac{1}{n^2} = \frac{\sin^2 \theta}{n_e^2} + \frac{\cos^2 \theta}{n_o^2}.
    \label{eq:e-light-effective-index}
\end{equation}

e光被认为是“反常的”，因为它具有许多各向同性介质中的光完全不显示的性质。

注意到\eqref{eq:o-light}和\eqref{eq:e-light}中关于$\vb*{k}$的方程无论$\vb*{k}$的方向是什么样都是有解的，而且有唯一解。
因此，一旦$\vb*{k}$的方向确定了，e光和o光的$\vb*{k}$以及可能的振动方向也就完全确定了。

总之，各向异性线性介质中的光一般来说是满足\eqref{eq:o-light}的o光和满足\eqref{eq:e-light}的e光的叠加。

% TODO：走移角

\subsection{双光轴透明介质内部的平面波}

\subsubsection{菲涅尔法线方程}

当我们试图将\ref{sec:one-axis-transparent}节中的方法原封不动地推广到一般的各向异性介质中时，会遇到一个严重的困难：无法得到像\eqref{eq:uniaxial-crystal}这样的因式分解好了的关于$\vb*{k}$的方程。

设介质中有一列平面波，记\concept{这一列波的折射率}为
\begin{equation}
    n = \frac{k c_0}{\omega} = \frac{k}{\omega} \frac{1}{\sqrt{\mu_0 \epsilon_0}}
\end{equation}
那么就有
\[
    \vb*{k} = n \omega \sqrt{\mu_o \epsilon_0} \vu*{k}
\]
由\eqref{eq:k-det}，可以得到
\[
    \det \left( n^2 \omega^2 \epsilon_0 \mu_0 (\vb*{\delta} - \vu*{k} \vu*{k}) - \omega^2 \mu \vb*{\epsilon} \right) = 0
\]
\[
    \det \left( \vb*{\delta} - \vu*{k} \vu*{k} - \frac{\mu_r \vb*{\epsilon}_r}{n^2} \right) = 0
\]
然后求解这个方程。由于此时$\vu*{k}$已经是给定的了，我们将使用$\vu*{k}, \mu_r, \vb*{\epsilon}_r$表示出$n$。
在主轴坐标系中表示$\vb*{k}$和其它矢量，并且设对角化之后%
\footnote{
    所谓对角化，在这里指的是写成
    \[
        \vb*{\epsilon}_r = \epsilon_{r \underline{i}} \vb*{g}_i \vb*{g}^i
    \]
    的形式。
}%
的$\vb*{\epsilon}_r$的三个元素为$\epsilon_{rx}, \epsilon_{ry}, \epsilon_{rz}$
则有
\begin{equation}
    \frac{k_x k^x}{\frac{1}{n^2} - \frac{1}{\mu_r \epsilon_{rx}}} + \frac{k_y k^y}{\frac{1}{n^2} - \frac{1}{\mu_r \epsilon_{ry}}} + \frac{k_z k^z}{\frac{1}{n^2} - \frac{1}{\mu_r \epsilon_{rz}}} = 0
    \label{eq:fresnel-k-n}
\end{equation}
将\eqref{eq:fresnel-k-n}展开为$1/n$的多项式之后会发现这是一个关于$1/n^2$的二次多项式，且在实数域内有解，因此\eqref{eq:fresnel-k-n}有两个正根两个负根。
仅考虑物理解，能够得到两个正根。
这表明了任意的各向异性介质的特点：给定一个$\vb*{k}$，可以有两种相位传播速度不同的波。

若设$\vb*{\epsilon}$在主轴系中被对角化为
\begin{equation}
    c_0^2 [\mu \epsilon_{ij}]_{ij} = [\mu_r \epsilon_{r\;ij}]_{ij} = \bmqty{\dmat{n_x^2, n_y^2, n_z^2}}
    \label{eq:diag-two-axis}
\end{equation}
则有
\begin{equation}
    \frac{k_x k^x}{\frac{1}{n^2} - \frac{1}{n_x^2}} + \frac{k_y k^y}{\frac{1}{n^2} - \frac{1}{n_y^2}} + \frac{k_z k^z}{\frac{1}{n^2} - \frac{1}{n_z^2}} = 0
\end{equation}
这个方程称为\concept{菲涅尔法线方程}。虽然我们使用$\vb*{k}$的各个分量写出了它，由于其齐次性，完全可以将所有$\vb*{k}$的分量替换为$\vu*{k}$的分量。

需要注意的是对应于$n$的两个根的波的振动方向并不是任意的。使用本节的记号，可以将\eqref{eq:plain-wave-in-anistrophy}写成
\begin{equation}
    \left(\vb*{\delta} - \vu*{k}\vu*{k} - \frac{\mu_r \vb*{\epsilon}_r}{n^2} \right) \cdot \vb*{E} = 0
\end{equation}
它意味着：首先，$n$应当被适当地选定，让方程左边的张量的行列式为零，这等价于\eqref{eq:fresnel-k-n}；其次，$n$被确定后，$\vb*{E}$可能的方向也被确定了下来。$\vb*{E}$可能的取值就是$\vb*{\delta} - \vu*{k}\vu*{k} - \mu_r \vb*{\epsilon}_r / n^2$的零空间。

一个可能的问题：在已经选定了$\vu*{k}$之后，我们能够得到两个$n$，从而两个$\vb*{E}$振动的方向，那么为什么不是三个方向？
原因在于我们有约束$\vb*{k} \cdot \vb*{D} = \vb*{k} \cdot \vb*{\epsilon} \cdot \vb*{E} = 0$，因此实际能够取的$\vb*{E}$（或者$\vb*{D}$）分布在一个二维的空间中，而不是三维的空间。

此外，注意到相速度$v_\text{p}$就是$c_0 / n$，因此在波矢方向已经给定的情况下从\eqref{eq:fresnel-k-n}可以解出两个相速度。当然，这就是对应于两个$n$的平面波的传播速度。

\subsubsection{折射率椭球}

% TODO：各向异性是不是还是电场能和磁场能各占一半？
现在考虑区域内电场能量密度
\[
    w_E = \frac{1}{2} \vb*{E} \cdot \vb*{D} = \frac{1}{2} (E^x D_x + E^y D_y + E^z D_z),
\]
同样在主轴坐标系当中工作，由于
\[
    D^x = \epsilon_0 \epsilon_{rx} E^x, \quad D^y = \epsilon_0 \epsilon_{ry} E^y, \quad D^z = \epsilon_0 \epsilon_{rz} E^z
\]
我们有
\begin{equation}
    \frac{2 \epsilon_0 w_E}{\mu_r} = \frac{D_x D^x}{n_x^2} + \frac{D_y D^y}{n_y^2} + \frac{D_z D^z}{n_z^2}
\end{equation}
因此如果固定电磁能密度不变，那么这一点的$\vb*{D}$扫过一个椭球面。这个椭球面称为\concept{折射率椭球}。

\subsubsection{各矢量方向的分析}

首先，下面三个方程还是成立的，正如在各向同性介质中一样：
\[
    \vb*{k} \cdot \vb*{D} = 0, \quad \vb*{k} \cdot \vb*{H} = 0, \quad \vb*{k} \times \vb*{H} = - \omega \vb*{D}
\]
这意味着$\vb*{D}, \vb*{H}, \vb*{k}$构成一组右手系。$\vb*{B}$的方向和$\vb*{H}$完全一致，因此无需单独讨论其方向。

反之，由于$\vb*{\epsilon}$的各向异性，$\vb*{E}$的方向需要特别注意。
由于
\[
    \vb*{k} \times \vb*{E} = \omega \vb*{B}, \quad \vb*{k} \times \vb*{H} = - \omega \vb*{D}
\]
可以导出下面的方程
\begin{equation}
    \vb*{D} = \mu_r \epsilon_0 n^2 (\vb*{E} - (\vu*{k} \cdot \vb*{E}) \vu*{k}) = \mu_r \epsilon_0 n^2 \vb*{E}_{\bot}
    \label{eq:first-crystal-eq}
\end{equation}
即所谓\concept{晶体光学第一方程}，其中$\bot$表示在垂直于$\vb*{k}$的方向上做投影。实际上，通过将$\vb*{D} = \vb*{\epsilon} \cdot \vb*{E}$代入上式，也能够导出菲涅尔法线方程\eqref{eq:fresnel-k-n}。

% TODO：画图
\eqref{eq:first-crystal-eq}使用$\vb*{E}$表示了$\vb*{D}$；我们也可以反过来尝试使用$\vb*{D}$表示$\vb*{E}$。注意到$\vb*{E}$虽然和$\vb*{D}$未必重合，但是它一定落在垂直于$\vb*{H}$的平面内；而$\vu*{k} \propto \vb*{D} \times \vb*{H}$，$\vu*{S} \propto \vb*{E} \times \vb*{H}$，于是几何观察告诉我们，将$\vu*{D},\vu*{k}$做一个旋转角为$\alpha$（它正是\eqref{eq:energy-density-and-s}中的那个$\alpha$），在垂直于$\vb*{H}$的平面上的旋转就得到了$\vu*{E}, \vu*{S}$。
于是记
\begin{equation}
    n_r = n \cos \alpha,
\end{equation}
就得到了
\begin{equation}
    \vb*{E} = \frac{1}{\mu_r \epsilon_0 n_r^2} (\vb*{D} - (\vu*{S} \cdot \vb*{D}) \vu*{S})
    \label{eq:second-crystal-eq}
\end{equation}
即所谓的\concept{晶体光学第二方程}。

联立这两个方程\eqref{eq:first-crystal-eq}和\eqref{eq:second-crystal-eq}中的其中一个和本构关系$\vb*{D} = \vb*{\epsilon} \vb*{E}$，
可以得到仅仅关于$\vb*{E}$或仅仅关于$\vb*{D}$的方程。
仅仅关于$\vb*{E}$的方程已经被建立了，它就是\eqref{eq:plain-wave-in-anistrophy}，它有非零解的条件就是\eqref{eq:fresnel-k-n}。
联立晶体光学第二方程\eqref{eq:second-crystal-eq}和本构关系，尝试得到仅仅关于$\vb*{D}$的方程。
在主轴系下进行计算，此时本构关系为\eqref{eq:diag-two-axis}，
就得到
\begin{equation}
    \frac{S_x S^x}{n_x^2 - \mu_r n_r^2} + \frac{S_y S^y}{n_y^2 - \mu_r n_r^2} + \frac{S_z S^z}{n_z^2 - \mu_r n_r^2} = 0
\end{equation}
它是使用$\vb*{S}$和$n_r$表示的\eqref{eq:fresnel-k-n}的对应物。
定义

\subsubsection{能量和能流}

