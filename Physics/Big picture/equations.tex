\documentclass[UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}

\geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=2.5cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\newenvironment{bigcase}{\left\{ \quad \begin{aligned}}{\end{aligned}\right.}
\newcommand*{\res}{\mathrm{res}\;}
\newcommand*{\natnums}{\mathbb{N}}
\newcommand*{\reals}{\mathbb{R}}
\newcommand*{\complexes}{\mathbb{C}}
\newcommand*{\taylor}[1]{\sum_{#1 = 0}^\infty}
\newcommand*{\taylorfrom}[2]{\sum_{#1=#2}^\infty}
\newcommand*{\laurent}[1]{\sum_{#1=-\infty}^\infty}
\DeclareMathOperator{\gammafunc}{\Gamma}
\DeclareMathOperator{\betafunc}{B}
\DeclareMathOperator{\legpoly}{P}
\renewenvironment{itemize}{\begin{compactitem}}{\end{compactitem}}
\renewenvironment{enumerate}{\begin{compactenum}}{\end{compactenum}}
\newcommand*{\diff}{\mathop{}\!\mathrm{d}}
\newcommand*{\argmax}{\mathrm{arg}\max}
\newcommand*{\argmin}{\mathrm{arg}\min}
\newcommand*{\st}{\quad \text{s.t.} \quad}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}

\title{物理中的方程}
\author{wujinq}
\date{\today}

\begin{document}
\maketitle
    
\section{导出方程}

\subsection{变分原理}

\subsubsection{无约束变分原理}
设底流形$D$上有坐标$x$，且定义泛函
\begin{equation}
    I(f) = \int_D F(f(x), f'(x), x) \dd x
\end{equation}
它在$f$改变时取极值，当且仅当，
\begin{equation}
    \pdv{F}{f} - \dv{x} \pdv{F}{f'} = 0
    \label{eq:el}
\end{equation}
需要注意的是，这里的$x$的选取独立于$f$。如果$x$和$f$的具体值有关，那么\textbf{不能}使用\eqref{eq:el}来求解$I$的极值问题。

\subsubsection{无约束，积分变量和场有关的变分原理}

泛函
\begin{equation}
    \int V(\vb*{r}(s)) \dd s
\end{equation}
的极值条件为
\begin{equation}
    \grad V = \dv{s} \left( V(\vb*{r}(s)) \dv{\vb*{r}}{s} \right)
\end{equation}

\subsubsection{约束}
一个典型的例子：需要最小化势场中一条悬链的重力势能，也就是求
\[
    \argmin_{\boldsymbol{r}} \int_0^{s_0} V(\boldsymbol{r}(s)) \dd s
\]
如果尝试写出\eqref{eq:el}，就会发现它一般地不能满足所有边界条件。这是因为参数$s$和$\boldsymbol{r}$是有关的，
所以不可能变动$\boldsymbol{r}$而保持$s$不变。要解决这种问题比较好的方法是加入一个参数$t$然后求解
\[
    \argmin_{\boldsymbol{r}} \int_0^1 V(\boldsymbol{r}(s(t))) \dv{s}{t} \dd t = 0 \st \int_0^1 \dv{s}{t} \dd t = s_0
\]

\subsection{动力系统}



\section{方程变形}
同一个物理现象很多时候对应着不同的方程，这些方程之间可以相互转化。

\subsection{勒让德变换}
首先引入勒让德变换的定义。
\paragraph{勒让德变换的定义} 设一元函数$f$的二阶导数大于零，则规定
\[
    g(k) = \max_x (kx - f(x))
\]
由于$f$下凸的性质，显然
\[
    g(k) = \eval{kx - f(x)}_{f'(x)=k}
\]
$f'$是单调的，因此可以找到一个$h$使得
\[
    f'(x)=k \Rightarrow x = h(k)
\]
那么就有
\[
    g(k) = k h(k) - f(h(k))
\]
现在再定义
\[
    p = f'(x)
\]
并且使用$f^*$表示$g$，我们就得到了勒让德变换：
\begin{equation}
    x, f(x) \longrightarrow p, f^*(p), \\
    f^*(p) = p h(p) - f(g(p)), \quad p = f'(x), \quad g=(f')^{-1}
\end{equation}

也就是说，将$x$变成了$f$的斜率。

勒让德变换是对合的，也就是说对$x, f(x)$做两次勒让德变换得到的就是原来的$x, f(x)$。

似乎还有一种所谓的勒让德变换就是
\[
    x \dd y = \dd (xy) - y \dd x
\]

\subsection{分离变量法}

\subsection{激励与基本解}

\subsection{函数基底}
我们要求在函数空间$S$中解线性方程$Lu=0$。设$v(k)$是一系列依赖$k$的函数（$k$也许不是一个实数而是一整个函数！），
并且$Lv(k)=0$有解，并且不同的$k$对应的$v(k)$彼此线性无关，则$u$可以展开为所有满足$Lv(k)=0$的$k$对应的$v(k)$的线性组合。

\subsection{散射}
考虑下面形式的问题：
\begin{equation}
    \begin{aligned}
        L u &= f_0 + f_1, \\
        f_1 &= f_1 (u)
    \end{aligned}
    \label{eq:scatter-problem}
\end{equation}
其中$f_1$可以是一个泛函，而且不见得是线性的。$f_0$是已知量。

为了解决这个问题，首先设$Lu_0=f_0$。由于$L$的格林函数可以写出，我们能够直接解出$u_0$。做分解$u=u_0+u_1$，使
\[
    L u_0 = f_0, \; L u_1 = f_1(u)
\]
这样就有
\[
    u_1(\boldsymbol{r}) = \int f_1(u)(\boldsymbol{r}') G(\boldsymbol{r};\boldsymbol{r}') \diff V'
\]
从而方程\eqref{eq:scatter-problem}转化为
\begin{equation}
    u(\boldsymbol{r}) = u_0(\boldsymbol{r}) + \int f_1(u)(\boldsymbol{r}')G(\boldsymbol{r};\boldsymbol{r}') \diff V'
    \label{eq:scatter-form}
\end{equation}

我们可以将$u_0$看成入射波，把方程右边其余的项看成反射波，因此这样的处理方法可以称作散射问题；
还有一种观点是，把$u_0$看成某个外加的驱动项，这时$u$可以看成是系统对驱动做出的响应。

\subsection{关联函数}

\subsubsection{时间演变算符}
在系统是线性时变连续系统的时候我们能够写出
\begin{equation}
    \dv{x(t)}{t} = A(t) x(t) + B(t) u(t)
\end{equation}

其中$A$是一个算符，$x$是函数或者向量之类可以求导的东西。可以看到系统中有一个外加激励$u(t)$。
可以使用通常的做法将上面的问题分解成求解一个齐次方程的通解和一个非齐次方程的特解。

\subsection{响应}
形式上我们写出
\begin{equation}
    v = L u
\end{equation}
其中$L$是一个线性算符，其形式可能知道也可能不知道。$u$称为系统的\textbf{输入}，$v$称为系统的\textbf{输出}。
已知$u$，需要计算$v$。

$L$的形式可能非常复杂，甚至不能写出显式表达式
（例如想象系统是一个反射表面，$u$为入射光，$v$为出射光，直接解麦克斯韦方程只能够得到\eqref{eq:scatter-form}这种形式）
但是我们可以采取一个简化的手段。设$u(k)$是一组以$k$为参数的函数，如果能够计算出
\[
    L u(k) = R(k) u(k)
\]
并且证明$u(k)$构成了我们感兴趣的函数空间（比如，稳态问题中的周期函数）的一组完备基，
那么我们就能够使用响应$R(k)$将$v$写出来。也就是，若
\begin{equation}
    u = \int I(k) u(k) \dd k
\end{equation}
那么就有
\begin{equation}
    v = \int I(k) R(k) u(k) \dd k
\end{equation}
很容易看出这就是在对$L$做特征分解。

原则上，一切函数都可以被当成$u(k)$来使用。但是如果算符$L$不显含坐标，那么可以证明，指数函数就是它的本征函数。
因此物理上几乎总是使用指数函数，无论是虚的还是实的。
即使我们讨论的问题完全在实数上也没有问题——$L$的线性性意味着，如果$u = \Re u'$，那么$\Re (L u')$就是我们需要的$v$。
因此完全可以只讨论复数问题，直到需要最终结果或者需要讨论非线性的运算（比如说平方来计算能量）的时候才切换到实数。

在$u$缓慢变化时，只有很小的$k$上$u(k)$才不为零，于是近似有
\[
    v(k) = G(k) u(k) \approx G(0) u(k),
\] 
得到
\[
    v = G(0) u.
\]

\subsubsection{各向同性问题}
实际工作中的问题通常不能够写成$v=Lu$的形式。因此我们考虑下面的一般问题。
如同前述，我们假定这是$n$维复空间上的\textbf{各向同性}问题。$L$是不显含坐标的线性算符，$R$未必是。
\begin{equation}
    L v = u, \quad R v = 0
    \label{eq:response}
\end{equation}
为了保证能够做傅里叶变换，我们要求\textbf{第一式成立在全空间上}。
对$L v = u$整体做多重傅里叶变换（这里规定正变换的系数为$1/(2\pi)^n$，从而反变换前的系数为1）%
\footnote{这么规定是为了确保
\[
    v(\vb*{x}) = \int \ee^{\ii \vb*{k} \cdot \vb*{x}} \tilde{v}(\vb*{k}) \dd^n \vb*{k}
\]
实际上整个过程并没有真的用到傅里叶变换的具体形式——傅里叶变换只是保证了上面的分解的存在性。
}%
，得到
\[
    \tilde{L}(\vb*{k}) \tilde{v}(\vb*(k)) = \tilde{u}(\vb*{k})
\]
\textbf{复函数}（而不是算符）$\tilde{L}$的形式不难写出：它满足
\begin{equation}
    L \ee^{\ii \vb*{k} \cdot \vb*{x}} = \tilde{L}(\vb*{k}) \ee^{\ii \vb*{k} \cdot \vb*{x}}
\end{equation}

若取$v(\vb*{x})=\delta(\vb*{x} - \vb*{x}')$，就得到$L$的格林函数
\begin{equation}
    G(\vb*{x};\vb*{x}') = \frac{1}{(2\pi)^n} \int \frac{\ee^{ - \ii \vb*{k} \cdot \vb*{x}}}{\tilde{L}(\vb*{k})} \dd \vb*{k}^n
    \label{eq:green-response}
\end{equation}

从而我们得到\eqref{eq:response}的另一种形式：
\begin{equation}
    \begin{aligned}
        v(\vb*{x}) &= \int G(\vb*{x};\vb*{x}') u(\vb*{x}') \dd \vb*{x}^n 
        + \int_{\tilde{L}(\vb*{k})=0} c(\vb*{k}) \ee^{\ii \vb*{k} \cdot \vb*{x}}, \\
        R v &= 0
    \end{aligned}
\end{equation}

上式中的$c(\vb*{k})$是一些微分形式，其取值由条件$Rv=0$确定。
$c$项对应着$u$为零的时候齐次方程$Lu=0$的通解。
$\tilde{L}(\vb*{k})=0$的这些位置是格林函数表达式\eqref{eq:green-response}的奇点，也就是说，一个无穷小的策动就能产生有限大的响应。

注意到\eqref{eq:green-response}中，积分路径可能扫过奇点（也就是$\tilde{L}$的零点）。为了解决这个问题，通常需要让积分路径在奇点一侧停止前进，绕奇点以半径$\epsilon$绕半圈，然后继续前进，最后让$\epsilon \to 0$。可以证明，这样相当于在表达式中引入了一个无穷小虚部。不同的绕过奇点的方式对应了不同的边界条件。

\subsection{微分算子法}

\section{近似方法}

椭圆型方程和其它一些描述静态问题的方程通常具有这样的性质：在求解区域足够大时边界条件的具体形式几乎不影响远离边界的解，会影响远离边界的解的只是通过边界条件引入的载荷（即变分形式中和因变量相乘的函数）。
动态问题有时不具有这些性质，例如自由边界不会导致波包散射而固定边界会。涉及非常薄的求解区域的问题有时也不具有这些性质。

\subsubsection{$Lu=f(u)$型方程}
考虑
\[
    Lu = f(u),
\]
其中$L$是线性算符。

\paragraph{迭代法}可以通过这样的过程得到一个近似解：
\begin{equation}
    Lu_0 = 0, \quad Lu_{n+1} = f(u_n).
\end{equation}

这样子的分析似乎在很多地方都很有用。
举个例子：一根细杆上挂载两个质量不均匀的配重，然后让细杆垂直着固定在另外一根杆子上转动。当然，作为转轴的那根杆子肯定会有晃动的。在这里
\[
    I\frac{\mathrm{d}^2\theta}{\mathrm{d}t^2} + K \theta 
\]
是$L$，而$f$对应着转轴晃动在运动方程中引入的项。
然后我们可以先假定转轴不动，计算出转轴承载的力，然后根据转轴承载的力计算出转轴晃动的强度，代入到细杆的运动方程中获得修正后的细杆运动情况，如此往复。

\end{document}