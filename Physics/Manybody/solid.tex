\documentclass[hyperref, UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tikz}
\usepackage{tikz-feynhand}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\comment}{\paragraph{注记}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\newrefformat{fig}{图\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

\renewcommand{\emph}[1]{\textbf{#1}}
\newcommand*{\concept}[1]{\underline{\textbf{#1}}}

\title{固体理论}
\author{吴何友}

\begin{document}

\maketitle

记号约定：费米子的产生湮灭算符为$\hat{c}^\dagger$和$\hat{c}$，而如果是关于位置的产生湮灭算符，则为$\hat{\psi}^\dagger$和$\hat{\psi}$。
本文提到的费米子主要是电子，使用一个三维坐标$\vb*{r}$（或者三位动量$\vb*{p}$），以及只有向上和向下两种选择的自旋就可以描述一个电子。
单电子自旋算符为
\[
    \hat{\vb*{S}} = \sum_{\alpha, \beta} \ket{\alpha} \vb*{\sigma}_{\alpha \beta} \bra{\beta},
\]
其中$\alpha$和$\beta$取遍$\uparrow$和$\downarrow$，$\sigma$为泡利矩阵。

由于本文不涉及相对论性过程，设$\vb*{a}$为一个矢量，则使用$a$表示其模长。

本文取普朗克单位制，即认为$\hbar=c=1$，且$4\pi\epsilon_0=1$，$k_B=1$。

$\text{h.c.}$表示厄米共轭，$\text{c.c.}$表示复共轭。

对离散格点系统，使用$\pair{i, j}$表示最接近的一对格点。（只求和一次，即认为$\pair{i, j}$和$\pair{j, i}$相同）

在不涉及自旋-轨道耦合的场合，在书写哈密顿量时我们直接略去自旋的下标，这是合理的，因为只需要把不考虑自旋的哈密顿量中的各个产生湮灭算符根据自旋守恒的性质机械地加上自旋下标再求和就能够得到完整的哈密顿量。
在需要实际计算粒子数时就不能这么做了；需要计算总能量时当然也不能这么做。

若无特殊说明，$f(z)$定义为近独立费米子的分布函数，即
\[
    f(z) = \frac{1}{\ee^{\beta z} + 1}.
\]

\section{电子气模型}

\subsection{有限温下的开放物质系统}

\subsubsection{第一性原理}

普通的固体、液体、气体由一系列原子组成。通过实验和计算可以发现，原子的最外层电子在各种过程中容易发生重新排列，称为\concept{价电子}；内层电子和原子核（合称为\concept{离子实}）则通常保持为一个整体，也即，其内部状态发生变化的物理过程的描述需要使用QCD，其涉及的能标远高于价电子发生变化涉及的能标。

本文基本上只分析涉及价电子低能运动的物理过程，即只讨论非相对论极限下的电荷-电磁场耦合系统，而忽略强相互作用、弱相互作用和引力。
此时，带电粒子由薛定谔场完全描述，系统具有$U(1)$规范对称性且无粒子数生灭，有确定的粒子数，于是可以原则上实物粒子部分可以直接用单粒子量子力学描述。
进一步，我们假定系统中没有变化特别快的电磁场，这意味着实际上我们可以积掉电磁场并且得到一个延迟不明显的相互作用，那就是说，我们可以把所有电磁相互作用都用静电学和静磁学处理。由于无论是电子还是离子实都是非相对论性的，电子-电子相互作用、电子-离子实相互作用、离子实-离子实相互作用几乎完全是库伦相互作用。

这样，设有$N_e$个价电子，$N_i$个离子实（i表示离子），固体的不考虑外界扰动的一次量子化哈密顿量为
\begin{equation}
    \hat{H} = \hat{H}_\text{e} + \hat{H}_\text{i} + \hat{H}_\text{ei},
    \label{eq:many-body-hamiltonian}
\end{equation}
其中$\hat{H}_\text{e}$表示仅涉及价电子的哈密顿量，$\hat{H}_\text{i}$表示仅涉及离子实的哈密顿量，最后一项则是两者的相互作用，所有相互作用是库仑相互作用。
诸价电子组成的系统就好像由电子组成的气体，称为\concept{相互作用电子气}。单体哈密顿量为电子的动能项加上单体势能项。在物质不受外界作用时当然不应该有单体势能项，于是
\[
    \hat{H}_\text{e1} = \frac{\hat{\vb*{p}}^2}{2m},
\]
在坐标表象下它就是
\[
    \hat{H}_\text{e1} = - \frac{\laplacian}{2m}.
\]
二体哈密顿量为电子两两作用而产生的库伦势能是
\[
    \hat{H}_\text{e2} = \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}},
\]
从而价电子本身的能量以及它们之间发生库伦相互作用的能量就是
\begin{equation}
    \hat{H}_\text{e} = \sum_{i=1}^{N_\text{e}} \frac{\hat{p}_i^2}{2m_\text{e}} + \frac{1}{2} \sum_{i\neq j} \frac{e^2}{\abs{\vb*{r}_i - \vb*{r}_j}}.
\end{equation}
使用类似的方法，离子实的组成的系统（如果是晶体那就是晶格）的哈密顿量为
\begin{equation}
    \hat{H}_\text{i} = \sum_{\alpha=1}^{N_\text{i}} \frac{\hat{p}_\alpha^2}{2m_i} + \frac{1}{2} \sum_{\alpha\neq\beta} V(\vb*{R}_\alpha-\vb*{R}_\beta).
\end{equation}
由于离子实中的内层电子结构复杂，离子实之间的相互作用能写不出特别简单的表达式（我们相当于把内层电子的自由度也积掉了）。请注意这个相互作用能是平移不变的，这是当然的，因为QED是平移不变的；但是实际的固体在短距离上并不是平移不变的，因为在低能下有对称性自发破缺。
离子实和价电子的相互作用则是
\begin{equation}
    \hat{H}_\text{ei} = \sum_{\alpha, i} V_\text{ei}(\vb*{r}_i-\vb*{R}_\alpha). 
\end{equation}
分别使用$i$表示价电子，用$\alpha$表示离子实；由于价电子和离子实不全同，不需要加上$1/2$系数。
同样我们还是假定了相互作用本身的平移不变性。
本文仅仅讨论固体（实际上主要是晶体）的物理，因此我们将假定离子实的位移始终局限在非常小的范围内。

在大部分过程中，由于原子核的质量比电子的质量大至少三个数量级，涉及价电子的过程通常比涉及离子实的过程发生得快很多，从而在价电子的时间尺度上，诸离子实的位置可以看成是给定的。
从而，在分析价电子时我们可以将$\hat{H}_i$项直接略去，而将$\hat{H}_\text{ei}(\vb*{r}_i-\vb*{R}_\alpha)$项对$\vb*{R}_\alpha$求和得到$V_\text{ext}(\vb*{r}_i)$（使用ext为下标是因为离子实相当于是给相互作用电子气施加了一个外场）。这个近似称为\concept{玻恩–奥本海默近似}。这样一来相互作用电子气的一次量子化哈密顿量在坐标表象下就是
\begin{equation}
    \hat{H} = \sum_{i=1}^{N_\text{e}} \left( - \frac{\laplacian}{2m_\text{e}} + V_\text{ext}(\vb*{r}_i)\right) + \frac{1}{2} \sum_{i\neq j} \frac{e^2}{\abs{\vb*{r}_i - \vb*{r}_j}},
    \label{eq:electron-gas-hamiltonian}
\end{equation}
从而二次量子化哈密顿量为
\begin{equation}
    \begin{aligned}
        \hat{H} = &\sum_{\sigma} \int \dd[3]{\vb*{r}} \hat{\psi}_\sigma^\dagger(\vb*{r}) \left( - \frac{\laplacian}{2m} + V_\text{ext}(\vb*{r}) \right) \hat{\psi}_\sigma(\vb*{r}) \\
        &+ \frac{1}{2} \sum_{\alpha, \beta} \int \dd[3]{\vb*{r}_1} \int \dd[3]{\vb*{r}_2} 
        \hat{\psi}_\alpha^\dagger (\vb*{r}_1) \hat{\psi}_\beta^\dagger (\vb*{r}_2) \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}} \hat{\psi}_\beta (\vb*{r}_2) \hat{\psi}_\alpha (\vb*{r}_1). 
    \end{aligned}
    \label{eq:electron-gas-hamiltonian-sq}
\end{equation}
其中$\hat{\psi}^\dagger(\vb*{r})$是薛定谔场的场算符，它也是在位置为$\vb*{r}$的位置产生一个电子的产生算符。这个哈密顿量当然也可以通过QED的低能近似得到，但并没有必要这么做。请注意电子是费米子。
\eqref{eq:electron-gas-hamiltonian-sq}实际上不是对角的，因为它的单粒子项涉及一个梯度算符。

需要注意的是实际上仍然可能有电子和离子实的相互作用（即电子-声子相互作用），因此波恩-奥本海默近似中的电子质量和电子-电子相互作用的具体形式可能出现和该相互作用相关的跑动，此时\eqref{eq:electron-gas-hamiltonian-sq}中的所谓“电子”已经是一种准粒子了。

最后我们指出，由于固体始终可以和外界交换电子——外界的电子可以进入固体，固体中的电子可以溢出——固体中电子气本身的哈密顿量\eqref{eq:electron-gas-hamiltonian-sq}不足以充分描述系统。
本文将只研究近平衡系统，因此这种与外界的相互作用可以使用化学势描述，即我们需要在\eqref{eq:electron-gas-hamiltonian-sq}中加入一项$-\mu \hat{\psi}^\dagger(\vb*{r}) \hat{\psi}(\vb*{r})$，这样得到的哈密顿量才是完整的。
换而言之，电子气完整的哈密顿量形如
\begin{equation}
    \begin{aligned}
        \hat{H} &= \sum_{\vb*{k}, \sigma} \Big( \underbrace{\frac{\vb*{k}^2}{2m}}_{\epsilon_{\vb*{k}}} - \mu \Big) \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k} \sigma} 
        + \int \dd[3]{\vb*{r}} V_\text{ext}(\vb*{r}) \hat{\psi}^\dagger(\vb*{r}) \hat{\psi}(\vb*{r}) \\ 
        &+ \frac{1}{2} \sum_{\alpha, \beta} \int \dd[3]{\vb*{r}_1} \int \dd[3]{\vb*{r}_2} 
        \hat{\psi}_\alpha^\dagger (\vb*{r}_1) \hat{\psi}_\beta^\dagger (\vb*{r}_2) \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}} \hat{\psi}_\beta (\vb*{r}_2) \hat{\psi}_\alpha (\vb*{r}_1).
    \end{aligned}
    \label{eq:full-electron-gas-hamiltonian}
\end{equation}
在有些模型中有时也将外势场并入$\epsilon_{\vb*{k}}$项。
为了简便起见，通常用$\xi$表示扣除了化学势的单电子能量，即
\begin{equation}
    \xi_{\vb*{k}} = \epsilon_{\vb*{k}} - \mu.
\end{equation}

\subsubsection{哈密顿量的一般形式}

以上我们都是将库伦相互作用加入薛定谔场中，可以说是给出了第一性原理计算需要的哈密顿量（虽然实际上从高能物理的角度这远非第一性原理，但对凝聚态理论来说通常已经够用了）。
但实际上还有以下机制没有考虑：
\begin{itemize}
    \item 作用在单体上的外场的束缚，离子实的束缚已经被计入考虑了，但是还有其它外场，比如说或许会有一个磁场，然后哈密顿量中将会有一项$-\vb*{\mu} \cdot \vb*{B}$；无论如何这会是一个二体算符。
    \item 电子-声子相互作用（见\autoref{sec:phonon}）会引入一个二电子和一个声子发生相互作用的顶角，积掉声子自由度之后会留下一个等效的电子-电子相互作用，这会让\eqref{eq:full-electron-gas-hamiltonian}中电子-电子相互作用的系数发生变化，不再是严格的库伦排斥。
\end{itemize}
于是我们写出一般形式的相互作用电子气的二次量子化哈密顿量：
\begin{equation}
    \hat{H} = \sum_{\vb*{k}, \sigma} (T_{\vb*{k}} - \mu) \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k} \sigma} 
    + \sum_{\vb*{k}_1, \vb*{k}_2, \sigma} V^\text{ext}_{\vb*{k}_1 \vb*{k}_2 \sigma} \hat{c}^\dagger_{\vb*{k}_1 \sigma} \hat{c}_{\vb*{k}_2 \sigma}
    + \sum_{\vb*{k}_1, \vb*{k}_2, \vb*{q}, \alpha, \beta} \hat{c}^\dagger_{\vb*{k}_1+\vb*{q}, \alpha} \hat{c}^\dagger_{\vb*{k}_2-\vb*{q}, \beta} V_{\vb*{q}} \hat{c}_{\vb*{k}_2 \beta} \hat{c}_{\vb*{k}_1 \alpha}. 
\end{equation}
相应的，热力学作用量为
\begin{equation}
    S = \sum_n \left( 
        \sum_{\vb*{k}, \sigma} (-\ii \omega_n + T_{\vb*{k}} - \mu) \bar{c}_{\vb*{k} \sigma} c_{\vb*{k} \sigma} 
        + \sum_{\vb*{k}_1, \vb*{k}_2, \sigma} V^\text{ext}_{\vb*{k}_1 \vb*{k}_2 \sigma} \bar{c}_{\vb*{k}_1 \sigma} c_{\vb*{k}_2 \sigma} 
        + \sum_{\vb*{k}_1, \vb*{k}_2, \vb*{q}, \sigma} \bar{c}_{\vb*{k}_1+\vb*{q}, \sigma} \bar{c}_{\vb*{k}_2-\vb*{q}, \sigma} V_{\vb*{q}} c_{\vb*{k}_2 \sigma} c_{\vb*{k}_1 \sigma} \right). 
\end{equation}
上式中的动能项和相互作用项的形式由对称性确定，具体系数可以暂时不设置具体值（因为直接从\eqref{eq:full-electron-gas-hamiltonian}出发做重整化群计算显然是非常困难的）。
处理这类模型的常用方法包括：
\begin{itemize}
    \item 直接做费曼图计算（需要注意由于库伦相互作用是瞬时的，通常将库仑相互作用顶角写成用虚线连接的两个顶角，每个顶角有一个电子入射和一个电子出射，虚线可以携带动量），由于相互作用是二体的，在相互作用较弱时计算一到二圈图就可以得到很好的效果，不过实际上相互作用并不总是那么弱，此时需要一些其它近似手段；
    \item 由于相互作用项是四阶的，可以使用Hubbard-Stratonovich变换引入一个辅助场，通过适当选取辅助场（通常要和某个有趣的序参量具有同样的对称性）并积掉电子自由度，则接近临界点时，辅助场满足的场论就给出了长程自由度；
    \item 做平均场计算并与实验或数值计算作比较（可以对原来的模型做平均场也可以对Hubbard-Stratonovich变换之后的辅助场做平均场）；
    \item 在定性论证出来一些现象后考虑其上的涨落，获得一个关于平均值附近涨落的理论（可以和平均场一起使用）；
    \item 近似处理，如忽略一部分动能（即忽略一部分电子跃迁项），或者简化相互作用形式。
\end{itemize}
无论如何，凝聚态模型通常都足够复杂，且可能有很强的相互作用，以至于分析方法多种多样，但是没有哪一种能够占有支配地位。

\subsubsection{外加电磁场}

现在讨论外加电磁场导致的哈密顿量变化，或者说“辐射和物质相互作用”导致的哈密顿量变化。
一般的，设系统被放置在电磁场$(\varphi, \vb*{A})$中，则一次量子化哈密顿量（使用一次量子化哈密顿量是为了和经典的“一群电子定向移动”的物理图像对应上）为
\begin{equation}
    \hat{H} = \frac{1}{2m} \sum_i (\hat{\vb*{p}_i} - q_i \vb*{A}(\hat{\vb*{r}_i}))^2 + \sum_i q_i \varphi(\hat{\vb*{r}}_i) + \hat{H}_\text{int},
    \label{eq:hamiltonian-with-eb-original}
\end{equation}
其中$\vb*{p}$是正则动量，$\hat{H}_\text{int}$表示粒子间相互作用。
本文仅考虑外加电磁场产生的线性响应，于是考虑辐射场不很强以至于$\vb*{A}^2$可以忽略的情况，也即，仅保留单光子过程，忽略一切$\vb*{A}^2$项。
实际上，当辐射场强到非线性效应开始产生时，是不是应该单独列出来一个$\hat{H}_\text{int}$然后将物质和辐射做$U(1)$极小耦合已经很成问题了：
哈密顿量中电子间的库伦排斥能和辐射场引入的能量简单相加相当于将$(\hat{\vb*{p}} - q \vb*{A})^2$括号打开，丢弃$\vb*{A}$的平方项，然后积掉\emph{一部分}光子，将剩下的光子诠释为辐射场。
因此我们的确只应该讨论电磁场产生的线性响应，因为当需要考虑非线性响应时，本节的模型已经失效了。

对电子系统，$q=-e$，那么就有
\begin{equation}
    \begin{aligned}
        \hat{H} &= \frac{1}{2m} \sum_i (\hat{\vb*{p}_i} + e \vb*{A}(\hat{\vb*{r}_i}))^2 - e \sum_i \varphi(\hat{\vb*{r}}_i) + \hat{H}_\text{int} \\ 
        &= - \frac{1}{2m} \sum_i (\grad + \ii e \vb*{A}(\hat{\vb*{r}_i}))^2 - e \sum_i \varphi(\hat{\vb*{r}}_i) + \hat{H}_\text{int}.
    \end{aligned}
\end{equation}
设$\Omega$是某个空间区域，电流密度为$\vb*{J}$，则
\begin{equation}
    \int_\Omega \dd[3]{\vb*{r}} \hat{\vb*{J}} = - \sum_i e \hat{\vb*{v}}_i,
\end{equation}
其中$\vb*{v}_i$是电子移动的速度，满足
\begin{equation}
    \hat{\vb*{v}}_i = \pdv{H}{\vb*{r}_i} = \frac{\hat{\vb*{p}}_i + e \vb*{A}(\hat{\vb*{r}}_i)}{m}.
\end{equation}
考虑到$\Omega$的任意性，我们就有以下近似表达式：
\begin{equation}
    \hat{\vb*{J}} = \underbrace{- \frac{e}{m} \sum_i ( \delta(\vb*{r} - \hat{\vb*{r}}_i) \hat{\vb*{p}} + \hat{\vb*{p}} \delta(\vb*{r} - \hat{\vb*{r}}_i) )}_{\hat{\vb*{j}}} \underbrace{- \frac{e^2}{m} \hat{n}_\text{e}}_{\hat{\vb*{j}}_\text{D}} \vb*{A}.
\end{equation}
$\hat{\vb*{j}}$项特意被写成了厄米的形式；$\hat{\vb*{j}}_\text{D}$已经做了一遍粗粒化了，将诸$\vb*{A}_i$平均了一遍。
通常这是合理的，因为电磁波的波长通常不会特别小，从而不会有很大的空间起伏。（而如果有很大的空间起伏，我们就会使用cQED而不是经典电动力学讨论问题了）

现在写出略去高阶项的哈密顿量的形式。选取库伦规范，并认为$\varphi=0$，此时会发现，实际上我们有
\[
    \hat{H} = \frac{1}{2m} \sum_i \hat{\vb*{p}}_i^2 + \hat{H}_\text{int} + \frac{e}{m} \sum_i \hat{\vb*{p}}_i \cdot \vb*{A}(\hat{\vb*{r}}_i) - e \sum_i \varphi(\hat{\vb*{r}_i}),
\]
$\vb*{A}(\hat{\vb*{r}}_i)$和$\hat{\vb*{p}}_i$本来是不对易的，但是库伦规范下它们对易。
代入$\hat{\vb*{J}}$的表达式并再次略去高阶项，就有
\[
    \hat{H} = \frac{1}{2m} \sum_i \hat{\vb*{p}}_i^2 + \hat{H}_\text{int} - \int \dd[3]{\vb*{r}} \hat{\vb*{J}} \cdot \vb*{A} - e \sum_i \varphi(\hat{\vb*{r}_i}).
\]
至于含有电势的那一项，注意到电荷密度为
\[
    \hat{\rho} = - e \sum_{i} \delta(\hat{\vb*{r}}_i - \vb*{r}),
\]
于是最后得到
\begin{equation}
    \hat{H} = \frac{1}{2m} \sum_i \hat{\vb*{p}}_i^2 + \hat{H}_\text{int} + \int \dd[3]{\vb*{r}} \varphi \hat{\rho} - \int \dd[3]{\vb*{r}} \hat{\vb*{J}} \cdot \vb*{A}.
\end{equation}
虽然物质本身的哈密顿量不是洛伦兹协变的（因为取了非相对论近似），但是物质和辐射的相互作用项却是洛伦兹协变的——对电磁场的描述一般都是如此。
以上哈密顿量实际上仅仅讨论了轨道部分，电子还有自旋磁矩
\[
    \hat{H}_{\text{spin}} = \sum_i \hat{\vb*{\mu}}_i \cdot \vb*{B}(\hat{\vb*{r}}_i),
\]
我们可以如法炮制地将它写成
\[
    \hat{H}_{\text{spin}} = \int \dd[3]{\vb*{r}} \hat{\vb*{\mu}} \cdot \vb*{B}.
\]
因此完整的哈密顿量实际上是
\begin{equation}
    \hat{H} = - \frac{1}{2m} \sum_i \hat{\vb*{p}}_i^2 + \hat{H}_\text{int} + \int \dd[3]{\vb*{r}} \varphi \hat{\rho} - \int \dd[3]{\vb*{r}} \hat{\vb*{J}} \cdot \vb*{A} + \int \dd[3]{\vb*{r}} \hat{\vb*{\mu}} \cdot \vb*{B}.
    \label{eq:hamiltonian-with-eb}
\end{equation}
所有和单粒子携带的电荷数量有关的量全部被藏在电荷密度和电流密度中了，上式在电荷正反变换下不变。

\eqref{eq:hamiltonian-with-eb}当然也可以非常容易地写成二次量子化的形式。
薛定谔场满足$U(1)$对称性，因此通过诺特定理可以得到守恒荷（当然就是电荷）
\begin{equation}
    \rho = - e \sum_\sigma \hat{\psi}^\dagger_\sigma \hat{\psi}_\sigma = - e \hat{n}_\text{e},
\end{equation}
守恒流（也即电流密度）
\begin{equation}
    \hat{\vb*{j}} = - \frac{\ii e}{2m} \sum_\sigma (\hat{\psi}_\sigma^\dagger(\vb*{r}) \grad{\hat{\psi}_\sigma}(\vb*{r}) - (\grad{\hat{\psi}_\sigma^\dagger}(\vb*{r})) \hat{\psi}_\sigma(\vb*{r})) - \frac{e^2}{m} \vb*{A}(\vb*{r}) \sum_\sigma \hat{\psi}^\dagger_\sigma(\vb*{r}) \hat{\psi}_\sigma(\vb*{r}),
\end{equation}
而另一方面自旋磁矩为
\begin{equation}
    \hat{\vb*{\mu}} = \hat{\psi}^\dagger_\alpha \vb*{\sigma}_{\alpha \beta} \hat{\psi}_\beta.
\end{equation}
这样就把三个对外加电磁场的线性响应全部写成二次量子化的形式了；我们可以用推迟格林函数计算出有关的响应大小。

由线性响应理论，我们有
\[
    \begin{aligned}
        \expval*{\hat{J}_i}_A (t) &= \expval*{\hat{J}_i}_0 + \ii \int \dd{t} \int \dd[3]{\vb*{r}'} \theta(t-t') \expval*{\comm*{\hat{J}_i(\vb*{r}, t)}{\hat{J}_j(\vb*{r}', t')}} A_j(\vb*{r}', t') \\
        &= - \frac{e^2}{m} \expval*{\hat{n}_\text{e}} A_i + \ii \int \dd{t} \int \dd[3]{\vb*{r}'} \theta(t-t') \expval*{\comm*{\hat{j}_i(\vb*{r}, t)}{\hat{j}_j(\vb*{r}', t')}} A_j(\vb*{r}', t').
    \end{aligned}
\]
这里的$i, j$为维度脚标，并不表示粒子编号，且使用爱因斯坦求和约定；下标$A$表示有外场$\vb*{A}$时的期望值；$\hat{j}_i$的无外场期望是零，这是对称性的结果。

实际上，电阻率定义为%
\footnote{$\vb*{A}(\vb*{r}, t)$完全可以不是时间、空间平移不变的，但是既然我们将$\vb*{A}$当成扰动，只需要无扰动的系统的动力学时间、空间平移不变即可。}%
\begin{equation}
    J_i(\vb*{r}, t) = \int \dd[3]{\vb*{r}'} \int_{-\infty}^t \sigma_{ij}(\vb*{r}-\vb*{r}', t - t') E_j(\vb*{r}', t'),
\end{equation}
于是为了避免繁琐的时间上的微积分我们切换到频域上，有
% TODO:确认记号问题

现在我们回到二次量子化的框架下，考虑怎么计算有关的推迟格林函数。

在虚时间路径积分中不能简单地将\eqref{eq:hamiltonian-with-eb-original}（从而，\eqref{eq:hamiltonian-with-eb}）做勒让德变换。
在这两个哈密顿量中有一个$U(1)$规范场$(\varphi, \vb*{A})$，由于规范对称性的存在，实际上只有$\vb*{A}$是独立的自由度，因此不能保证在Wick转动中含有$\varphi$的项是不变的。
最简单的从\eqref{eq:hamiltonian-with-eb-original}推导出虚时间路径积分的方法是最小耦合。我们知道$\varphi \rho$项会出现本质上是因为加入$U(1)$规范场之后需要将导数替换为协变导数，而可以验证以下替换
\begin{equation}
    \partial_\tau \longrightarrow \partial_\tau - \ii e \varphi, \quad - \ii \grad \longrightarrow - \ii \grad + e \vb*{A} 
\end{equation}
给出了虚时间场论中的协变导数，于是在自由理论中做这个替换就得到了与电磁场发生相互作用的电子场的虚时间配分函数。

这样会带来一个疑难，就是Wick转动后电势前面多出来了一个负号；但是凝聚态理论中电子可以被放在一个势场中，显然Wick转动后势场前面不需要多出来一个负号。
这个疑难的解答是，含有$\ii e \varphi \rho$项的理论描述了一个电子场和一个电磁场的耦合，而“电子置于势场中”的模型中电磁场已经被积掉了。
如果将电磁场积掉，按照高斯积分的原理，$e \varphi \rho$项前面会多一个负号，并且要乘以系数$i$的平方，于是我们发现Wick转动后前面不需要多出来一个负号的势场出现了。

在以上的推导中，我们均取$e>0$为正的元电荷；在分析电子系统时，一个更加常见的记号是取$e<0$，令$\abs*{e}$为元电荷。
这样可以让电子系统的配分函数看起来更像是直接从$U(1)$规范不变性得到的，从而看起来更加接近高能物理中的记号。

\subsubsection{力学和热学性质}

固体系统常见的可测量量（这里不是指可观察量算符，而是指真的做量子测量能够测出来的物理量，比如说期望，等等）除了前一节提到的各种电学和磁学性质以外还包括热学性质和力学性质。

我们来计算
 
\subsection{近独立电子气}

\subsubsection{哈密顿量、分布和格林函数}

很难一上手就处理带有复杂相互作用的电子气，因此我们首先处理\concept{近独立电子气}，也就是电子之间近似没有相互作用的电子气。此时我们可以单独考虑每个电子的哈密顿量
\begin{equation}
    \hat{H} = \frac{\hat{\vb*{p}}^2}{2m_\text{e}} + V(\vb*{r}).
    \label{eq:single-electron-hamiltonian}
\end{equation}
整团电子气的哈密顿量是关于各个电子的哈密顿量之和。
上式中的$V(\vb*{r})$未必就是物理意义明确（比如由原子核施加的库伦能）的势能，而有可能是相互作用电子气在一定情况下产生的等效势能。
实际上，对任何一个相互作用系统，都可以找到赝势$V(\vb*{r})$使得其能量近似可以写成\eqref{eq:single-electron-hamiltonian}的形式，但如果相互作用很强，即使往系统中放入一个电子，赝势$V(\vb*{r})$的形式也会发生很大改变，因此将强关联系统看成近独立电子气并无意义。
本节主要讨论$V(\vb*{r})$的形式基本上固定的情况，即电子间相互作用比较弱，与此同时电子数涨落不大的情况。

近独立电子气的基态是什么？使用巨正则系综%
\footnote{当然，我们认为系统能够达到统计平衡，就意味着电子之间不可能真的完全没有相互作用，否则能量无法传递。}%
，对很大的近独立费米子系统，处在能量本征态$\ket{n}$上的粒子数的平均值为%
\footnote{以下使用$\epsilon$表示单个电子的能量而使用$E$表示系统总能量。}%
\begin{equation}
    \expval*{\hat{n}_n} = f(\epsilon_n) = \frac{1}{\ee^{\beta (\epsilon_n-\mu)} + 1}.
    \label{eq:fermi-dirac-distribution}
\end{equation}
我们让能量尽可能低，那就是要让$T\to 0$，也就是让$\beta\to \infty$，此时就有
\begin{equation}
    \expval*{\hat{n}_n} = \begin{cases}
        1, \quad \epsilon_i \leq \mu, \\
        0, \quad \epsilon_i > \mu.
    \end{cases}
\end{equation}
这意味着，$T=0$时电子占据的所有状态就是
\begin{equation}
    \epsilon_i = \mu
\end{equation}
以内的所有能量本征态（这部分能量本征态称为\concept{费米海}）。在动量空间中这就是一个曲面，称为\concept{费米面}。位于费米面上的所有能量本征态共同组成了一个能量正好是零温化学势的能级，称为\concept{费米能级}，其能量称为\concept{费米能量}。与费米能级对应的动量称为\concept{费米动量}。
基态的表达式就是一个乘积态，为
\begin{equation}
    \ket{\Psi} = \prod_{\abs{\vb*{k}} < k_\text{F}} \hat{c}^\dagger_{\vb*{k}} \ket{0}.
    \label{eq:ground-state}
\end{equation}

统计物理的论证只能把我们带到这里。具体化学势是多少需要根据
\begin{equation}
    \mu_i = \pdv{U}{N_i}
\end{equation}
计算。当然，化学势和粒子数、温度等因素都有关系。在$T=0$且电子数$N$给定时，常用的做法是显式地写出所有能量本征态，从小到大排列$N$个电子，从而计算出费米能量，然后我们就知道了$T=0$时的化学势。

不同粒子数对应的费米能量是不同的；并且，在分析有限温问题时，化学势不再是费米能量。然而，在温度不很高、粒子数很大时，不同粒子数对应的费米能量相差不大，并且化学势和费米能量（也就是$T=0$时的化学势）相差不大，因此有时会使用费米能量近似作为化学势。%
\footnote{关于本节的论述要着重指出一点：虽然我们采用了统计物理的论证来表明必然存在着一个费米面，从而有对应的费米能量，但统计物理的论证仅仅为我们提供了系统基态的性质，而无论系统是不是需要使用平衡态系综描述，它一定有一个基态。因此，费米面、费米能级等概念在任何情况下——无论是平衡态还是非平衡态、纯态还是混合态——全部是适用的。这些概念并不依赖统计物理的框架！}%
化学势的大小由系统中的电子数决定，或者也可以反过来说，化学势的高度决定了系统基态中哪些位置被电子填充。这个对应关系形象地展示如\autoref{fig:chemical-potential}，化学势越高，被描黑的态——也就是基态有电子填充的态——就越多。
再次强调，这个“电子能量形式固定，改变化学势往系统中填充电子”的物理图像不适用于强关联系统，因为在那里等效的电子能量形式\eqref{eq:single-electron-hamiltonian}随着电子填入会发生剧烈变化；相应的，从这个物理图像衍生出来的理论，如能带理论（见\autoref{sec:energy-band}）也不再适用。

\begin{figure}
    \centering
    \subfigure[$\xi_{\vb*{k}}$和$\vb*{k}$的关系]{
        \begin{tikzpicture}
        
            % 动量横轴
            \draw[->] (-3,0) -- (3,0) node[right] {$\vb*{k}$};
            % 动能纵轴
            \draw[->] (0,-1.5) -- (0,2.5) node[above] {$\xi_{\vb*{k}}$};
            
            % 画出$\xi_{\vb*{k}}$曲线
            \draw[samples=50, smooth, domain=-3:3] plot(\x,{0.25*(\x*\x)-1});
            % 描黑被占据的部分
            \draw[samples=50, smooth, thick, domain=-2:2] plot(\x,{0.25*(\x*\x)-1});
    
            % 标出带底
            \draw[dash pattern=on5pt off3pt] (-2.5, -1) -- (2.5,-1) node[right] {$-\mu$};
    
            % 标出费米点
            \node[dot, label=above:$\vb*{k}_\text{F}$] at (2, 0) {};
            \node[dot, label=above:$-\vb*{k}_\text{F}$] at (-2, 0) {};
    
        \end{tikzpicture}
    }
    \subfigure[$\epsilon_{\vb*{k}}$和$\vb*{k}$的关系]{
        \begin{tikzpicture}
        
            % 动量横轴
            \draw[->] (-3,0) -- (3,0) node[right] {$\vb*{k}$};
            % 动能纵轴
            \draw[->] (0,-1.5) -- (0,2.5) node[above] {$\epsilon_{\vb*{k}}$};
            
            % 画出$\epsilon_{\vb*{k}}$曲线
            \draw[samples=50, smooth, domain=-3:3] plot(\x,{0.25*(\x*\x)});
            % 描黑被占据的部分
            \draw[samples=50, smooth, thick, domain=-2:2] plot(\x,{0.25*(\x*\x)});
    
            % 标出费米面
            \draw[dash pattern=on5pt off3pt] (-2.5, 1) -- (2.5,1) node[right] {$\mu$};

            % 标出满带
            \draw[dash pattern=on5pt off3pt] (2, 0) -- (2,1);
            \draw[dash pattern=on5pt off3pt] (-2, 0) -- (-2,1);
    
            % 标出费米点
            \node[dot, label=below:$\vb*{k}_\text{F}$] at (2, 0) {};
            \node[dot, label=below:$-\vb*{k}_\text{F}$] at (-2, 0) {};
    
        \end{tikzpicture}
    }
    \caption{化学势和电子填充，描黑的态有电子填充}
    \label{fig:chemical-potential}
\end{figure}

近独立电子气的格林函数和它的谱函数如下。谱函数为
\begin{equation}
    A(\vb*{k}, \omega) = \delta(\omega - \epsilon_{\vb*{k}}),
\end{equation}
推迟格林函数为
\begin{equation}
    G^\text{ret}(\vb*{k}, \omega) = \frac{1}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}
这些都和单电子计算出来的结果完全一样，当然也毫不意外。

\subsubsection{空穴}

虽然多电子态是将场算符作用在真空态上得到的，但由于本文讨论的电子都由薛定谔场描述，在任何一个物理过程中电子数都是守恒的。
换而言之，设有一个$N$电子的系统，这个系统实际可能具有的态矢量只是态空间的一小部分，即保持电子数为$N$的部分。
这个$N$电子空间$\mathcal{H}_N$当然可以使用一次量子化理论来描述，但能否使用二次量子化的语言描述？
费米子的特性让这一点成为可能。请注意由于泡利不相容原理，
\[
    \hat{c}^\dagger_{\vb*{k}} \ket{\Psi} = 0, \quad k < k_\text{F},
\]
而由产生湮灭算符的性质显然有
\[
    \hat{c}_{\vb*{k}} \ket{\Psi} = 0, \quad k > k_\text{F},
\]
因此如果定义%
\footnote{费米面上的态相对来说非常少，因此忽略。}%
\begin{equation}
    \hat{b}^\dagger_{\vb*{k}} = \begin{cases}
        \hat{c}_{\vb*{k}}, \quad k < k_\text{F}, \\
        \hat{c}_{\vb*{k}}^\dagger, \quad k > k_\text{F},
    \end{cases}
\end{equation}
那么基态$\ket{\Psi}$实际上是$\hat{b}^\dagger$产生的准粒子的真空态。$\hat{b}^\dagger$产生的是什么？当$k>k_\text{F}$时它产生的就是费米面以上的电子，而$k<k_\text{F}$时它产生的是费米海之内的空穴。
空穴的动量就是它占据的态如果有电子的话，这个电子的动量。
使用$\hat{b}^\dagger$写出的哈密顿量在省略一个无关紧要的常数之后为
\[
    \hat{H} = \sum_{k > k_\text{F}} \xi_{\vb*{k}} \hat{b}^\dagger_{\vb*{k}} \hat{b}_{\vb*{k}} - \sum_{k < k_\text{F}} \xi_{\vb*{k}} \hat{b}^\dagger_{\vb*{k}} \hat{b}_{\vb*{k}},
\]
因此一个空穴的能量为$-\epsilon_{\vb*{k}}$。以上的哈密顿量不是正定的，但这不会导致负能量疑难，因为费米海虽然很大，但大小有限，因此不会出现能量无限下降的问题。

使用$\hat{b}^\dagger$的结果是，保持电子数不变的相互作用需要被看成粒子数可变的，例如一个费米海中的电子被激发到费米海之上就意味着产生了一个电子-空穴对。

\subsubsection{自由电子气}

现在我们讨论最为简单的电子气，也就是$V(\vb*{r})$在物体内部为常数（可以看成零）的情况。此时可以将价电子一个个分开处理，既然它们之间没有相互作用。

我们在坐标表象下处理问题。计算单个电子的波函数：
\[
    - \frac{\laplacian}{2m_\text{e}} \psi(\vb*{r}) = \epsilon \psi(\vb*{r}),
\]
这种方程的解当然是平面波解的线性组合。一个这样的平面波解形如
\[
    \psi(\vb*{r}) \propto \ee^{\ii \vb*{k} \cdot \vb*{r}}.
\]
只能保证这个式子在物体内部成立，因为物体边界处$V(\vb*{r})$不可能是常数。
然后我们归一化这些平面波。电子可以自发地溢出物体，但是这样的概率并不大，所以我们可以简单地认为电子只会出现在物体内部（也即，物体被放置在一个无限深势陷当中）。设物体体积为$V$，就有
\[
    \int \dd[3]{\vb*{r}} \abs{\psi(\vb*{r})}^2 = 1,
\]
于是
\[
    \psi (\vb*{r}) = \frac{1}{\sqrt{V}} \ee^{\ii \vb*{k} \cdot \vb*{r}}, \quad \epsilon = \frac{k^2}{2m_\text{e}}.
\]
很容易看出这些波函数实际上是动量算符的本征态，$\vb*{k}$实际上就是动量。另一方面，这些波函数定义在坐标空间中，坐标空间中的一切都和自旋算符对易，因此这些波函数也是自旋本征态。于是动量和自旋的一组共同正交本征函数为
\begin{equation}
    \psi_{\vb*{k},\sigma} (\vb*{r}) = \frac{1}{\sqrt{V}} \ee^{\ii \vb*{k} \cdot \vb*{r}}, \quad \epsilon_{\vb*{k},\sigma} = \frac{k^2}{2m_\text{e}}.
\end{equation}
% 真的是这个名字吗？这些波函数称为\concept{布洛赫波函数}。
$\vb*{k}$能够取什么值取决于边界条件。由于物体通常比较大，具体取什么样的边界条件对物体内部的过程毫无影响。

自由电子气的费米面是球状的（即\concept{费米球}）。对三维系统，态密度为
\[
    \dd{N} = 2 \frac{\dd[3]{\vb*{r}} \dd[3]{\vb*{k}}}{(2\pi)^3},
\]
因子$2$是因为电子有两个自旋。积掉无用的坐标自由度和动量角自由度之后得到
\[
    \dd{N} = \frac{V k^2 \dd{k}}{\pi^2}.
\]
由于
\[
    \epsilon = \frac{k^2}{2m},
\]
可以推导出
\[
    \dd{N} = \frac{V (2m)^{3/2} \sqrt{\epsilon} \dd{\epsilon}}{2 \pi^2}.
\]
这样就可以计算出总粒子数和费米能（即零温化学势）之间的关系：
\begin{equation}
    N = \int_{\epsilon=0}^{\epsilon_{\text{F}}} \dd{N} = \frac{V (2m)^{3/2}}{3 \pi^2} \epsilon_\text{F}^{3/2},
\end{equation}
以及总能量
\begin{equation}
    E = \int_{\epsilon=0}^{\epsilon_{\text{F}}} \epsilon \dd{N} = \frac{V (2m)^{3/2}}{5 \pi^2} \epsilon_\text{F}^{5/2} = \frac{3}{5} N \epsilon_{\text{F}}.
\end{equation}
对二维或者一维的自由电子气也可以使用类似的方法得到系数不同的结论。

\section{理想晶体的晶格结构}

所谓晶体指的是一种在三个独立的空间方向上具有离散的平移不变性且并没有连续平移不变性的物体。\eqref{eq:many-body-hamiltonian}显然具有连续的平移不变性，因此晶体的形成必然经历了对称性自发破缺，且在较高的能量下原本的晶体一定会相变成某种更加均匀的东西。

本节讨论\concept{理想晶体}，即非常大，以至于其表面的情况几乎不会影响内部电子运动的晶体。

\subsection{晶格的几何形状}

\subsubsection{晶格、晶胞和格点坐标}

我们采取玻恩–奥本海默近似，将离子实看成一个背景，而忽略其中的自由度（既然这些自由度在价电子的物理过程的时间尺度上基本上不参加相互作用）。这样一来离散的平移不变性只应该来自$V(\vb*{r})$。
我们于是看到了形成晶体的对称性自发破缺的来源：低能下离子实自发地排成了比较规则的序列，从而虽然晶体服从的物理规律实际上确实是连续平移不变的，近似定律\eqref{eq:electron-gas-hamiltonian}却由于离子实排列成了空间重复的序列而只有离散平移不变性而没有连续平移不变性。
我们称这种离子实周期性排列形成的结构为\concept{晶格}。

既然晶格具有空间周期性，只要知道了一个离子实的位置以及空间周期性的方向（晶体的空间指向）就可以知道所有离子实的位置。任意两个离子实之间的位置矢量形如
\begin{equation}
    \vb*{R}_n = n_1 \vb*{a}_1 + n_2 \vb*{a}_2 + n_3 \vb*{a}_3, \quad n = (n_1, n_2, n_3) \in \mathbb{N}^3.
\end{equation}
这些位置矢量构造了一架三维网格，这个网格称为\concept{布拉维格子}，这些矢量称为\concept{布拉维格矢}，$\{\vb*{a}_i\}$称为\concept{晶格常数}，$n$称为\concept{格点坐标}。

布拉维格子的\concept{原胞}（也就是空间周期性结构的最小单位）有许多划分方法。可以以$\vb*{a}_1, \vb*{a}_2, \vb*{a}_3$张成的长方体为一个原胞，称为\concept{初基原胞}。
另一种原胞是\concept{维格纳-赛兹原胞}，它是空间中与某个特定格点的距离小于与任何其它格点的距离的点的轨迹，或者等价地说，它是某个特定格点与相邻格点的连线的垂直平分面包围出的立体。
维格纳-赛兹原胞的特别之处在于，任意一个空间矢量都可以写成维格纳-赛兹原胞中的一个矢量加上一个布拉维格矢，这可以使用非常直观的方式证明。

\subsubsection{晶格分类}

% TODO：群论

\subsection{晶格中的傅里叶变换}

\subsubsection{倒格子}

有关晶体的所有可观察物理量均具有和布拉维格矢一样的对称性，也即，它们在三个方向上以$\vb*{a}_1,\vb*{a}_2,\vb*{a}_3$为周期。
回顾傅里叶级数的公式，我们有
\[
    f(x) = \frac{1}{T} \sum_{m=-\infty}^\infty \ee^{\ii \frac{2\pi m x}{T}} \left(\int \dd{t} f(t) \ee^{-\ii \frac{2\pi m t}{T}}\right) ,
\]
其三维形式就是
\[
    f(\vb*{r}) = \frac{1}{V} \sum_{m=-\infty}^\infty \ee^{\ii \vb*{G}_m \cdot \vb*{r}} \int_V \dd[3]{\vb*{r}'} f(\vb*{r}') \ee^{- \ii \vb*{G}_m \cdot \vb*{r}}, \quad \vb*{G}_m \cdot \vb*{a}_i = 2\pi N_i, \quad N_i \in \mathbb{N},
\]
其中$V$指的是单位晶胞的大小。
$\vb*{G}_m$满足的条件等价于，对任意的布拉维格矢都有
\begin{equation}
    \vb*{G}_m \cdot \vb*{R}_n = 2\pi N, \quad N \in \mathbb{N},
\end{equation}
这又等价于，
\begin{equation}
    \vb*{G}_m = G_1 \vb*{b}_1 + G_2 \vb*{b}_2 + G_3 \vb*{b}_3, \quad \vb*{a}_i \cdot \vb*{b}_j = 2 \pi \delta_{ij}.
\end{equation}
因此诸$\vb*{G}_m$也构成一个布拉维格子，我们称它为\concept{倒格子}，与$\vb*{R}_n$构成的空间网格（称为\concept{正格子}）相区分，同样，称$\vb*{r}$所在的三维空间为\concept{实空间}，$\vb*{G}$所在的空间为\concept{倒空间}。倒格子的基矢量和正格子的基矢量互为共轭基矢量。
两种格子的基矢量可以通过下式
\begin{equation}
    \frac{1}{2\pi} \vb*{b}_1 = \frac{\vb*{a}_2 \times \vb*{a}_3}{\vb*{a}_1 \cdot (\vb*{b}_2 \times \vb*{b}_3)}
\end{equation}
及其轮换相互换算。
在写出倒格子的显式表达式之后，晶体中具有正格子的周期性的物理量的傅里叶变换就是
\begin{equation}
    F(\vb*{r}) = \sum_{\vb*{g}} \tilde{F}(\vb*{g}) \ee^{\ii \vb*{g} \cdot \vb*{r}},
\end{equation}
其中$\vb*{g}$是布拉维格矢，且
\begin{equation}
    \tilde{F}(\vb*{g}) = \frac{1}{V} \int_V \dd[3]{\vb*{r}} F(\vb*{r}) \ee^{-\ii \vb*{g} \cdot \vb*{r}}.
\end{equation}

倒格子的维格纳-赛兹原胞称为\concept{第一布里渊区}，相应的，某格点和它所有次近邻格点的垂直平分面包围成的区域称为\concept{第二布里渊区}，等等。
显然，倒格子所在的整个动量空间可以被划分为不相交的一系列第一布里渊区。
引入第一布里渊区这个概念的原因在于它实际上是定义在正格子上的函数的傅里叶变换的动量取值范围。
使用$i=(i_1, i_2, i_3)$表示格点坐标，则
\begin{equation}
    \frac{1}{N} \sum_{\vb*{a}_i} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{a}_i} = \sum_{\vb*{g}} \delta(\vb*{k} - \vb*{k}' + \vb*{g}),
\end{equation}
其中$\vb*{a}_i$指的是$i$对应的位矢，$N$是晶格中总离子数，$\vb*{g}$扫过整个倒格子。$\delta(\vb*{k} - \vb*{k}')$实际上应该是离散$\delta$函数，但是为了和连续动量的情况保持一致我们还是使用这个记号。
可以看到方程右边是周期性的，如果限制$\vb*{k}$在第一布里渊区中，那么就有非常简单的形式：
\begin{equation}
    \frac{1}{N} \sum_{\vb*{a}_i} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{a}_i} = \delta_{\vb*{k} \vb*{k}'},
\end{equation}
从而得到与之对偶的
\[
    \frac{1}{N} \sum_{\vb*{k}} \ee^{\ii (\vb*{a}_i - \vb*{a}_j) \cdot \vb*{k}} = \delta_{ij},
\]
其中$\vb*{k}$扫过
这又意味着第一布里渊区内的动量取值数目可以认为是$N$个，当然这是正确的，因为实空间中的$N$点离散信号做离散傅里叶变换之后会得到倒空间中的周期性离散信号，其周期正好是$N$，第一布里渊区正好是一个周期。

并非所有晶体中的物理量具有正格子的周期性（有的周期性强于正格子，有的也许弱于正格子），它们的傅里叶变换中的动量不局限在倒格子上。

\subsubsection{有限大小的晶体}

晶格对电子的吸引比较明显，因此电子自发溢出晶格的概率并不大，从而可以将晶格表面看成一个势阱。
晶格表面的形状以及势阱的高度无疑会影响电子气的行为，但由于晶体非常大，这种影响对稍微远离表面的电子都是非常微弱的。（接近表面的电子可能参与表面态，此时关于晶体表面的信息就非常重要了）
因此我们认为晶体是长宽高各为$L$的大正方体，$L$相对电子、原子的尺度都是非常大的；同时我们简单地施加一个周期性边界条件来表示势阱的存在，即认为
\begin{equation}
    \psi(\vb*{r}) = \psi(\vb*{r} + L \vb*{e}_i), \quad i = 1, 2, 3.
    \label{eq:periodic-boundary}
\end{equation}
同时我们暂时忽略在晶体外找到电子的概率，因为它相对于在晶体内部找到电子的概率是非常小的。

由于晶体是有限大小的，$\vb*{k}$的取值是离散化的，因为波函数必须满足\eqref{eq:periodic-boundary}，为了尽可能让$u$容纳较多信息，我们用$\vb*{k}$来满足这个要求，即
\[
    \ee^{\ii \vb*{k} \cdot \vb*{r}} = \ee^{\ii \vb*{k} \cdot (\vb*{r} + L \vb*{e}_i)}, \quad i = 1, 2, 3,
\]
这样$\vb*{k}$的取值范围就是一个晶格常数为$2\pi / L$的三维点阵。%
\footnote{这个点阵不是倒格子：倒格子的晶格常数和实际的物理结构——也就是晶格的结构——有关，而此处的点阵的晶格常数完全是我们强加的，且总是趋于零，使得格点动量看起来几乎是连续的，因此可以被划分成连续的布里渊区，等等。
}%
这个三维点阵正是局限在晶体内部的任何函数做空间傅里叶变换得到的波矢的取值范围，且有如下归一化条件：
\begin{equation}
    \frac{1}{V} \int \dd[3]{\vb*{r}} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{r}} = \delta_{\vb*{k}\vb*{k}'}.
\end{equation}

\subsubsection{三种动量空间和对应的傅里叶变换}

现在我们有三种动量空间，这三种动量空间、它们适用于什么样的函数以及它们对应的傅里叶变换列举如下。

\begin{enumerate}
    \item 晶格常数为$2\pi / L$的三维点阵是被限制在边长为$L$的实空间方盒中的函数的傅里叶变换的动量取值范围，由于$L$通常很大，这个点阵要比倒格子密得多，在倒格子的尺度上工作时没有必要考虑晶格常数为$2\pi / L$的三维点阵是离散的这一事实。
    该三维点阵动量空间虽然是离散的，却是无限大的，因为它实际上给出的是一个箱子中所有可能的平面波的波矢，而这当然可以取到无限大。
    与这个动量空间相关的傅里叶变换的归一化表达式为
    \begin{equation}
        \frac{1}{V} \int_V \dd[3]{\vb*{r}} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{r}} = \delta_{\vb*{k} \vb*{k}'}, \quad \frac{1}{V} \sum_{\vb*{k}} \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}')} = \delta(\vb*{r} - \vb*{r}'),
    \end{equation}
    第二个表达式中的$\delta$函数就是动量空间无限大的一个结果。于是通常如此定义傅里叶变换：
    \begin{equation}
        f(\vb*{k}) = \frac{1}{\sqrt{V}} \int \dd[3]{\vb*{r}} \ee^{- \ii \vb*{k} \cdot \vb*{r}} f(\vb*{r}), \quad f(\vb*{r}) = \frac{1}{\sqrt{V}} \sum_{\vb*{k}} \ee^{\ii \vb*{k} \cdot \vb*{r}} f(\vb*{r}).
    \end{equation}
    这样定义的好处在于，我们知道$\hat{\psi}^\dagger(\vb*{r})$和$\hat{c}^\dagger_{\vb*{k}}$彼此为傅里叶变换，而如果采用上式的傅里叶变换定义，那么从
    \[
        \acomm*{\hat{\psi}_\alpha(\vb*{r})}{\hat{\psi}^\dagger_\beta(\vb*{r}')} = \delta(\vb*{r}-\vb*{r}') \delta_{\alpha \beta}
    \]
    可以得到
    \[
        \acomm*{\hat{c}_{\vb*{k}\alpha}}{\hat{c}^\dagger_{\vb*{k}' \beta}} = \delta_{\vb*{k} \vb*{k}'} \delta_{\alpha \beta},
    \]
    于是动量表象下的产生湮灭算符关系也是非常简单的。
    有时会需要调整归一化常数，下同。在$V$很大时，考虑到点阵的晶格常数为$2\pi / L$，可以做替换
    \begin{equation}
        \frac{1}{V} \sum_{\vb*{k}} \longrightarrow \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3}.
    \end{equation}
    \item 倒格子是具有和晶格一样的周期性的连续函数的傅里叶变换的动量取值范围。与之相关的归一化表达式为
    \begin{equation}
        \frac{1}{V_\text{u.c.}} \int_{V_\text{u.c.}} \dd[3]{\vb*{r}} \ee^{\ii \vb*{r} \cdot (\vb*{k} - \vb*{k}')} = \delta_{\vb*{k} \vb*{k}'}, \quad \frac{1}{V_\text{u.c.}} \sum_{\vb*{k}} \ee^{\ii \vb*{r} \cdot (\vb*{k} - \vb*{k}')} = \delta(\vb*{r} - \vb*{r}'), 
        \label{eq:normalization-periodic}
    \end{equation}
    其中$\vb*{k}$取遍整个倒格子而$\vb*{r}$取遍一个正格子晶胞内部的所有点（因为仅讨论周期函数）。这里我们使用$V_\text{u.c.}$表示一个正格子晶胞的大小，来和整块晶体的大小区分开。相应的，傅里叶变换为
    \begin{equation}
        f(\vb*{k}) = \frac{1}{\sqrt{V_\text{u.c.}}} \int \dd[3]{\vb*{r}} \ee^{- \ii \vb*{k} \cdot \vb*{r}} f(\vb*{r}), \quad f(\vb*{r}) = \frac{1}{\sqrt{V_\text{u.c.}}} \sum_{\vb*{k}} \ee^{\ii \vb*{k} \cdot \vb*{r}} f(\vb*{r}).
    \end{equation}
    倒格子是无限大的，因此以上展示的傅里叶变换的动量空间同样是无限大的。
    \item 第一布里渊区是定义在正格子上的函数的傅里叶变换的动量取值范围。归一化表达式为
    \begin{equation}
        \frac{1}{N} \sum_{\vb*{a}_i} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{a}_i} = \delta_{\vb*{k} \vb*{k}'}, \quad \frac{1}{N} \sum_{\vb*{k}} \ee^{\ii (\vb*{a}_i - \vb*{a}_j)} = \delta_{ij}.
    \end{equation}
    第二个表达式表明对定义在正格子上的函数，它在动量空间中在第一布里渊区中的动量取值有$N$个。傅里叶变换为
    \begin{equation}
        f(\vb*{k}) = \frac{1}{\sqrt{N}} \sum_{i} \ee^{- \ii \vb*{k} \cdot \vb*{a}_i} f(i), \quad f(i) = \frac{1}{\sqrt{N}} \sum_{\vb*{k}} \ee^{\ii \vb*{k} \cdot \vb*{a}_i} f(\vb*{k}).
    \end{equation}
    与前两种情况不同，上式中的动量空间中只有有限个（共$N$个）动量。实际上容易验证，这$N$个动量恰恰是一个第一布里渊区中容纳的全部来自晶格常数为$2\pi / L$的点阵的格点。
    这样，我们就有
    \[
        N = \frac{2\pi / V_\text{u.c.}}{2\pi / V},
    \]
    即
    \begin{equation}
        V = N V_\text{u.c.},
    \end{equation}
    正好是预期中的结果。
\end{enumerate}

\subsection{近独立电子气和能带理论}\label{sec:energy-band}

\subsubsection{布洛赫电子}

现在尝试求解理想晶体中的电子气。由于晶格具有离散平移不变性，\eqref{eq:electron-gas-hamiltonian}也具有（而且只有）离散平移不变性，从而波函数也具有这样的不变性。我们有
\[
    \psi(\vb*{r}+\vb*{R}_n) = \ee^{\ii \alpha} \psi(\vb*{r}).
\]
请注意波函数的对称性可以略微低于哈密顿量，只要由它计算出的物理量的对称性和哈密顿量一致就可以，因此我们加上了复数因子。由于平移运算构成群，且$n$是群参数，有
\[
    R_{n_1+n_2} = R(n_1) R(n_2),
\]
波函数的形式只能是
\begin{equation}
    \psi(\vb*{r}+\vb*{R}_n) = \ee^{\ii \vb*{k} \cdot \vb*{R}_n} \psi(\vb*{r})
    \label{eq:periodic-wavefunction}
\end{equation}
及其线性组合。因此\eqref{eq:periodic-wavefunction}构成晶体中电子气中单个电子的态空间的一组基，且$\vb*{k}$是一个好量子数，称为\concept{格点动量}或者\concept{准动量}。它的性质类似动量，但并不是动量。
$\vb*{k}$是坐标系无关的真正的矢量。\eqref{eq:periodic-wavefunction}又说明，我们可以设
\begin{equation}
    \psi_{\vb*{k}}(\vb*{r}) = \ee^{\ii \vb*{k} \cdot \vb*{r}} u_{\vb*{k}}(\vb*{r}), \quad u_{\vb*{k}}(\vb*{r}+\vb*{a}_i) = u_{\vb*{k}}(\vb*{r}), \quad i = 1, 2, 3.
    \label{eq:bloch-wavefunction}
\end{equation}
因此，晶体中的波函数是一个受到一个周期为$\vb*{a}_1,\vb*{a}_2, \vb*{a}_3$的振幅调制的平面波。
\eqref{eq:bloch-wavefunction}称为\concept{布洛赫波函数}，处于这种状态的电子称为\concept{布洛赫电子}。

由于指数函数的周期性，设$\vb*{G}$是一个任意的倒格子格矢，那么就有
\[
    \psi_{\vb*{k}}(\vb*{r}) = \psi_{\vb*{k}+\vb*{G}}(\vb*{r}).
\]
因此，没有必要让$\vb*{k}$取遍整个空间。由维格纳-赛兹原胞的性质，对任何一个$\vb*{k}$，都存在一个第一布里渊区内部的$\vb*{k}'$，使得
\[
    \psi_{\vb*{k}}(\vb*{r}) = \psi_{\vb*{k}'}(\vb*{r}).
\]
另一方面，第一布里渊区内部的矢量彼此的差值不可能达到一个倒格子格矢的大小，因此第一布里渊区内部的$\vb*{k}$不会导致重复的波函数。于是不失一般性地我们可以要求$\vb*{k}$在第一布里渊区内部。

\subsubsection{布洛赫波函数和能带}

波函数表达式\eqref{eq:bloch-wavefunction}没有时间演化，所以现在我们讨论布洛赫电子的动力学。即使使用了波恩-奥本海姆近似，\eqref{eq:electron-gas-hamiltonian}仍然要求把系统内所有的电子均考虑进去。
我们假定系统可以使用近独立电子气描述——也许是通过一个平均场理论，也许是更加完整的费米液体计算——于是只需要考虑单个电子的薛定谔方程即可。
于是布洛赫电子的动力学等价于求解形如\eqref{eq:bloch-wavefunction}的波函数在某个势场下的束缚态解。将\eqref{eq:bloch-wavefunction}代入
\[
    -\frac{\laplacian}{2m_\text{e}} \psi(\vb*{r}) + V(\vb*{r}) \psi(\vb*{r}) = \epsilon \psi(\vb*{r}),
\]
得到
\begin{equation}
    \left( - \frac{(\grad+\vb*{k})^2}{2m_\text{e}} + V(\vb*{r}) \right) u_{\vb*{k}}(\vb*{r}) = \epsilon u_{\vb*{k}}(\vb*{r}).
    \label{eq:block-energy-problem}
\end{equation}
在$\vb*{k}$已知的情况下求解该本征值问题，可以得到一组$u$以及对应的$E$。由于先前要求$u(\vb*{r})$是周期函数，该本征值问题必定给出离散谱，也即，我们会获得一组$(\psi_{n \vb*{k}}, \epsilon_{n \vb*{k}})$，使得
\begin{equation}
    \left( - \frac{(\grad+\vb*{k})^2}{2m_\text{e}} + V(\vb*{r}) \right) u_{n \vb*{k}}(\vb*{r}) = \epsilon_{n \vb*{k}} u_{n \vb*{k}}(\vb*{r}).
\end{equation}
显然，$n$是另一个（离散的）好量子数。一旦$\vb*{k}$和$n$给定，布洛赫波函数及其时间演化就完全求解出来了，从而$\vb*{k}$和$n$是坐标空间中的布洛赫波函数的全部好量子数。我们称取不同$n$值的电子处于不同的\concept{能带}上，$n$为能带标记。%
\footnote{注意到，能带的导出实际上并未用到太多晶体的性质（空间周期性等），因此非晶体很多时候也有能带。}%
能带中的电子在空间上非常不定域，它们实际上是一系列格点上的定域态叠加而成的结果。也可以这么理解这一点：写出一个格点上的哈密顿量之后为了计算能带能量肯定要做对角化，对角化得到的本征向量肯定是把一系列格点上的定域态都线性组合起来了。
总之，能带中的布洛赫电子常常称为\concept{巡游电子}。

由于晶体近似在一个无限深势阱中，波函数在晶体边界处快速衰减为零。这就意味着$\vb*{k}$实际上是离散的。然而，由于晶体的尺度通常远大于原子的尺度，$\vb*{k}$近似可认为是连续的。于是可以写出函数
\[
    \epsilon = \epsilon_n(\vb*{k}),
\]
由于$\vb*{k}$加上任何一个倒格矢之后给出同样的布洛赫波函数，$E$相对于$\vb*{k}$应该具有周期性，那么它必定是有界的。
这就是“能带”这个名称的来源：穷举第一布里渊区内部的所有$\vb*{k}$，得到的所有能量组成一条有限宽的条带。

还可以从另一个角度理解为什么会出现多条能带。自由电子的能谱是抛物线，既然是在晶体内，动量加上一个倒格矢之后描述的物理状态没变，于是可以通过将任意一个动量平移一个倒格矢，使所有动量约束在第一布里渊区内部。
这个过程等价于将单电子能谱平移任意一个倒格矢，然后将第一布里渊区以外的部分全部抹除掉。
单电子能谱$\epsilon_{\vb*{k}}$穿过第一布里渊区边界而折返回来，这样在布里渊区边界反复和自我交叉。
现在加上相互作用，相互作用会抹去奇异性，从而交叉点退开，自我交叉的单一能带分离成一系列不相交的波浪线，这就得到了一系列不同的能带。
此时我们说，相互作用在能带之间\concept{打开了能隙}，让原本交叉的能带之间出现了间隙。

\begin{figure}
    \centering
    \subfigure[自由空间中的单电子能谱]{
        \begin{tikzpicture}
        
            % 动量横轴
            \draw[->] (-3,0) -- (3,0) node[right] {$\vb*{k}$};
            % 动能纵轴
            \draw[->] (0,-0.25) -- (0,6) node[above] {$\epsilon_{\vb*{k}}$};
            
            % 画出$\epsilon_{\vb*{k}}$曲线
            \draw[samples=50, smooth, domain=-3:3] plot(\x,{0.5*(\x*\x)});
    
        \end{tikzpicture}
    }
    \subfigure[由于晶格的周期性，能谱在第一布里渊区中折返]{
        \begin{tikzpicture}
        
            % 动量横轴
            \draw[->] (-3,0) -- (3,0) node[right] {$\vb*{k}$};
            % 动能纵轴
            \draw[->] (0,-0.25) -- (0,6) node[above] {$\epsilon_{\vb*{k}}$};

            % 布里渊区边界
            \draw[dash pattern=on5pt off3pt, thick] (-1, 0) -- (-1, 6);
            \draw[dash pattern=on5pt off3pt, thick] (1, 0) -- (1, 6);
            
            % 画出布里渊区以外的能谱
            
            \draw[dash pattern=on5pt off3pt,samples=50, smooth, domain=-3:1.46] plot(\x,{0.5*((\x+2)*(\x+2))});
            \draw[dash pattern=on5pt off3pt,samples=50, smooth, domain=-3:3] plot(\x,{0.5*((\x)*(\x))});
            \draw[dash pattern=on5pt off3pt,samples=50, smooth, domain=-1.46:3] plot(\x,{0.5*((\x-2)*(\x-2))});
            \draw[dash pattern=on5pt off3pt,samples=50, smooth, domain=0.52:3] plot(\x,{0.5*((\x-4)*(\x-4))});
            \draw[dash pattern=on5pt off3pt,samples=50, smooth, domain=-3:-0.52] plot(\x,{0.5*((\x+4)*(\x+4))});

            % 画出布里渊区内部的$\epsilon_{\vb*{k}}$曲线，以及由于晶格周期性而导致的能谱平移
            \draw[samples=50, smooth, domain=-1:1] plot(\x,{0.5*(\x*\x)});
            \draw[samples=50, smooth, domain=-1:1] plot(\x,{0.5*((\x-2)*(\x-2))});
            \draw[samples=50, smooth, domain=-1:1] plot(\x,{0.5*((\x+2)*(\x+2))});
            \draw[samples=50, smooth, domain=0.52:1] plot(\x,{0.5*((\x-4)*(\x-4))});
            \draw[samples=50, smooth, domain=-1:-0.52] plot(\x,{0.5*((\x+4)*(\x+4))});
    
        \end{tikzpicture}
        
    }
    \subfigure[相互作用打开能隙，形成分离的能带]{
        \begin{tikzpicture}
        
            % 动量横轴
            \draw[->] (-3,0) -- (1.5,0) node[right] {$\vb*{k}$};
            % 动能纵轴
            \draw[->] (0,-0.25) -- (0,6) node[above] {$\epsilon_{\vb*{k}}$};

            % 布里渊区边界
            \draw[dash pattern=on5pt off3pt, thick] (-1, 0) -- (-1, 6);
            \draw[dash pattern=on5pt off3pt, thick] (1, 0) -- (1, 6);
            
            % 画出布里渊区内部的$\epsilon_{\vb*{k}}$曲线，以及由于晶格周期性而导致的能谱平移
            \draw[samples=50, smooth, domain=-1:1] plot(\x,{0.25-0.25*cos(3.14*\x r)});
            \draw[samples=50, smooth, domain=-1:1] plot(\x,{2.5+1.6*sin(1.57*\x r)});
            \draw[samples=50, smooth, domain=-1:1] plot(\x,{2.5-1.6*sin(1.57*\x r)});
            \draw[samples=50, smooth, domain=0.39:1] plot(\x,{4.5+4*(\x-1)*(\x-1)});
            \draw[samples=50, smooth, domain=-1:-0.39] plot(\x,{4.5+4*(\x+1)*(\x+1)});

            % 标记能带和带隙
            \foreach \hei in {0.5, 0.9, 4.1, 4.5}
                \draw[dash pattern=on5pt off3pt] (-1,\hei) -- (-3, \hei);
    
        \end{tikzpicture}
        
    }
    \caption{能带结构}
    \label{fig:bloch-energy-band}
\end{figure}

两条不同的能带之间的间隙提供了一个自然的能量截断，因此在我们已经知道了系统的能带之后，如果需要一个低能有效理论，可以只考虑能量较低的能带，而将粒子跃迁到能量较高的能带再跃迁回来作为微扰，进行能量修正，即可以很自然地将高能能带积掉。

最后我们指定波函数的归一化方式。可以在积分号前面加上一个系数，即
\begin{equation}
    \frac{1}{V} \int \dd[3]{\vb*{r}} \psi_{n\vb*{k}}^*(\vb*{r}) \psi_{m\vb*{k}'}(\vb*{r}) = \delta_{mn} \delta(\vb*{k}-\vb*{k}'),
    \label{eq:bloch-is-basis}
\end{equation}
从而让简单的平面波$\exp(\ii \vb*{k} \cdot \vb*{r})$不需要乘上归一化因子就能够成为归一化本征态。
设$V_\text{u.c.}$是单个晶胞的大小，则
\[
    V = N V_\text{u.c.},
\]
从而可以得到
\begin{equation}
    \frac{1}{V_\text{u.c.}} \int_\text{u.c.} \dd[3]{\vb*{r}} u_{m\vb*{k}}^*(\vb*{r}) u_{n\vb*{k}}(\vb*{r}) = \delta_{mn}.
\end{equation}
只需要求解出一组满足以上条件的$\{u_{n\vb*{k}}\}$，就得到了一组正交归一化波函数$\{\psi_{n\vb*{k}}\}$。
归一化系数使用$V_\text{u.c.}$是非常合理的，因为如\eqref{eq:normalization-periodic}所示这正是具有正格子的周期性的函数通常使用的归一化系数。

\eqref{eq:bloch-is-basis}意味着布洛赫波函数是正交归一化波函数且对应的积分测度为
\[
    \frac{1}{\sqrt{V}} \int \dd[3]{\vb*{r}},
\]
记$\hat{c}_{n\vb*{k}}^\dagger$为位于能带$n$、格点动量为$\vb*{k}$的布洛赫电子的产生算符，那么%
\footnote{其中的$1/\sqrt{V}$的因子是因为二次量子化场算符通常使用全空间的积分为内积的定义，在此定义下，归一化的波函数是$\psi_{n\vb*{k}} / \sqrt{V}$而不是$\psi_{n\vb*{k}}$。}%
\begin{equation}
    \hat{c}_{n \vb*{k}}^\dagger = \frac{1}{\sqrt{V}} \int \dd[3]{\vb*{r}} \psi_{n \vb*{k}}(\vb*{r}) \hat{\psi}^\dagger(\vb*{r}),
\end{equation}
哈密顿量在这一组基下是对角化的，于是写出二次量子化哈密顿量（已经加入化学势项）
\begin{equation}
    \hat{H} = \sum_{n, \vb*{k}} (\epsilon_{n\vb*{k}} - \mu) \hat{c}^\dagger_{n\vb*{k}} \hat{c}_{n\vb*{k}}.
    \label{eq:bloch-band-hamiltonian}
\end{equation}
$\vb*{k}$的取值局限在第一布里渊区内部，作为对比，不考虑周期势的边长为$L$的正方体势阱中的电子的$\vb*{k}$可以取遍所有位于那个边长为$2\pi / L$的格点。
但实际上两者的自由度是一样的，因为我们还有$n$标记各个能带，也即，我们相当于把所有能带中的动量都移动到了第一布里渊区内部。

\subsubsection{Wannier波函数}

布洛赫波函数是格点动量空间中的波函数，我们当然可以在坐标空间中讨论问题，对应的波函数基底称为\concept{Wannier波函数}。两者之间差一个（离散傅里叶）变换。
定义在格点上的函数以第一布里渊区为动量空间。我们使用$i, j, \ldots$表示格点坐标，$m, n, \ldots$表示能带编号，$\vb*{r}_i$表示$i$处的格点的位矢，则
\[
    w_{ni}(\vb*{r}) \propto \sum_{\vb*{k}} \psi_{n\vb*{k}}(\vb*{r}) \ee^{- \ii \vb*{k} \cdot \vb*{r}_i},
\]
上式前面的归一化系数尚未选定。在归一化布洛赫波函数时我们使用了积分测度
\[
    \frac{1}{V} \int \dd[3]{\vb*{r}},
\]
从而导致归一化条件中出现了关于整块晶体的参数$V$。对布洛赫波函数这是合理的，因为它的好量子数是动量，因此是非常不定域的波函数，但Wannier波函数使用格点坐标标记，因此是非常定域的波包，因此我们希望Wannier波函数的归一化因子应该是一个常数而不包含任何关于系统大小的信息。
容易计算出
\[
    \frac{1}{V} \int \dd[3]{\vb*{r}} \frac{1}{N} \left( \sum_{\vb*{k}} \psi^*_{n\vb*{k}}(\vb*{r}) \ee^{\ii \vb*{k} \cdot \vb*{r}_i} \right) \left( \sum_{\vb*{k}} \psi_{m\vb*{k}}(\vb*{r}) \ee^{- \ii \vb*{k} \cdot \vb*{r}_j} \right) = \delta_{mn} \delta_{ij},
\]
取
\begin{equation}
    w_{ni}(\vb*{r}) = \frac{1}{N} \sum_{\vb*{k}} \psi_{n\vb*{k}}(\vb*{r}) \ee^{-\ii \vb*{k} \cdot \vb*{r}_i}, \quad \psi_{n\vb*{k}} = \sum_{\vb*{r}_i} \ee^{\ii \vb*{k} \cdot \vb*{r}_i} w_{ni}(\vb*{r}),
\end{equation}
这样归一化条件就是
\begin{equation}
    \frac{1}{V_\text{u.c.}} \int \dd[3]{\vb*{r}} \abs{w_{ni}(\vb*{r})}^2 = 1.
\end{equation}
归一化常数是一个局域的晶胞体积，符合我们的要求。

现在来分析Wannier波函数在实空间中的具体形状。考虑到$u_{n\vb*{k}}$的周期性，我们有
\[
    u_{n\vb*{k}} (\vb*{r}) = u_{n\vb*{k}} (\vb*{r} - \vb*{r}_i),
\]
于是
\begin{equation}
    w_{ni}(\vb*{r}) = \frac{1}{N} \sum_{\vb*{k}} u_{n\vb*{k}} (\vb*{r} - \vb*{r}_i) \ee^{\ii \vb*{k} (\vb*{r} - \vb*{r}_i)},
\end{equation}
这表明Wannier波函数实际上是$\vb*{r} - \vb*{r}_i$的函数，可以写成
\begin{equation}
    w_{ni}(\vb*{r}) = w_{n}(\vb*{r} - \vb*{r}_i),
\end{equation}
这当然是正确的，因为晶格中绝对位置$\vb*{r}$并无意义。
在$\vb*{r}$远离$\vb*{r}_i$时，指数因子快速振荡，导致整个求和基本上为零，因此Wannier函数只在$\vb*{r}_i$附加有较明显的值，因此它定域在格点$\vb*{r}_i$附近。

同样，Wannier波函数既然是一组正交归一化基底，就可以定义对应的二次量子化算符，即
\begin{equation}
    \hat{c}^\dagger_{ni} = \frac{1}{\sqrt{V_\text{u.c.}}} \int \dd[3]{\vb*{r}} w_{ni}^*(\vb*{r}) \hat{\psi}^\dagger(\vb*{r}).
\end{equation}

总之，晶格中的电子的波函数可以以高度定域在格点附近的一组波函数为基底，并且以对应的格点为一个量子数。

\subsubsection{Wannier基下的哈密顿量和紧束缚模型}

我们用\eqref{eq:bloch-band-hamiltonian}给出了布洛赫基下的能带理论哈密顿量。现在来看同样的理论在Wannier基下会呈现什么形式。
设能带理论下单电子哈密顿量为$\hat{h}$，则可以做表象变换
\[
    \hat{H} = \sum_{mi, nj} \hat{c}^\dagger_{mi} \mel{mi}{\hat{h}}{nj} \hat{c}_{nj},
\]
其中我们令
\begin{equation}
    - t_{mi, nj} = \mel{mi}{\hat{h}}{nj} = \frac{1}{V_\text{u.c.}} \int \dd[3]{\vb*{r}} w_m^*(\vb*{r} - \vb*{r}_i + \vb*{r}_j) \hat{h} w_n(\vb*{r}),
\end{equation}
则
\[
    \hat{H} = - \sum_{mi, nj} t_{mi, nj} \hat{c}^\dagger_{mi} \hat{c}_{nj}.
\]
记号$\{mi, nj\}$表示对一组顺序不限的$\{mi, nj\}$组合只求和一次，就得到
\begin{equation}
    \hat{H} = - \sum_{\{mi, nj\}} (t_{mi, nj} \hat{c}_{mi}^\dagger \hat{c}_{nj} + \text{h.c.}).
    \label{eq:hamiltonian-in-wannier}
\end{equation}
我们得到了一个非对角化的哈密顿量，这当然是正确的，因为系统显然应该在动量基——即布洛赫基——下对角化。
但\eqref{eq:hamiltonian-in-wannier}提供了非常清晰的物理图像：电子会从一个格点跃迁到另一个格点。

最后我们考虑一个极限情况。假定晶格的吸引作用是如此之强，以至于电子是高度定域的，这样只有最近邻的格点之间才会跃迁。
进一步，考虑一个单能带的低能有效理论，就得到
\begin{equation}
    \hat{H} = - \sum_{\pair{i, j}} (t_{ij} \hat{c}^\dagger_i \hat{c}_j + \text{h.c.}).
\end{equation}
这称为\concept{紧束缚模型}。如果满足平移不变性，就有
\begin{equation}
    \hat{H} = - \sum_{\pair{i, j}} (t \hat{c}^\dagger_i \hat{c}_j + \text{h.c.}).
\end{equation}

\section{晶格运动和声子}\label{sec:phonon}

\subsection{自由声子}

\subsubsection{离子实位移的正则量子化}

实际上，离子实也会运动，于是我们得到一个定义在正格子上的场，这个场的激发就是\concept{声子}。晶体中一定会出现这样的激发，且这是一个Goldstone模式，因为晶体的形成实际上破缺了连续平移对称性，那么必然有一种零质量激发产生。
离子实的哈密顿量大致如下：（使用大写字母以和电子区分）
\begin{equation}
    \hat{H} = \sum_n \frac{\hat{P}_n^2}{2M_n} + \frac{1}{2} \sum_{\pair{m, n}} \omega_{mn}^2 (\hat{X}_{m} - \hat{X}_{n})^2 + \cdots, 
\end{equation}
其中$n$指的是晶格坐标，也就是三元组$(n_1, n_2, n_3)$，
\[
    \vb*{X} = \vb*{R} - \vb*{R}_0
\]
为某个离子实的位移。
正则量子化之后，哈密顿量中的前两项给出一个自由场，而离子实之间的非线性相互作用则给出声子-声子散射过程。
由于坐标-动量关系是对易关系而不是反对易关系，声子是玻色子。

离子实和电子的相互作用通常取这样的形式：
\[
    H_\text{ei} = \sum_{n, i} V_\text{ei}(\vb*{r}_i - \vb*{R}_n) = \sum_{n, i} (\vb*{R}_n - \vb*{R}_{n}^0) \cdot \grad{V_\text{ei}}(\vb*{R}_n^0 - \vb*{r}_i) + \cdots,
\]
其中$R^0_n$指的是离子实$n$未发生移动时的位置，即$n$号正格子的位置。
对位移场$\vb*{X}$做正则量子化，并将关于电子的部分做二次量子化，得到
\[
    \hat{H}_{\text{ei}} = \sum_{n, i} V_\text{ei}(\vb*{r}_i - \vb*{R}_n) = \sum_{n} \int \dd[3]{\vb*{r}} \hat{\vb*{X}} \cdot \hat{\psi}^\dagger(\vb*{r}) \grad{V_\text{ei}}(\vb*{R}_n^0 - \vb*{r}) \hat{\psi}(\vb*{r}) + \cdots,
\]
这就是电子-声子相互作用。可以看出以上哈密顿量对$\hat{\vb*{X}}$不具有$U(1)$对称性，因此声子一般来说不是守恒的。

声子和电子的量子化过程很不一样。对电子，我们首先写出一个多体一次量子化哈密顿量，然后做二次量子化；而对声子，我们实际上把使用格点坐标标记的离子实位移和动量当成了场算符（离散的场），然后直接对这两个场算符做正则量子化。
换而言之，没有声子的一次量子化：定义声子时我们的理论就是二次量子化的。

\subsubsection{一维简谐振子链}

首先考虑一个一维的、均质的晶格，并假定非线性效应很微弱，即不存在声子-声子散射，从而
\begin{equation}
    \hat{H} = \sum_n \frac{\hat{P}_n^2}{2 M} + \frac{M}{2} \sum_{n} \omega^2 (\hat{X}_{n+1} - \hat{X}_{n})^2.
    \label{eq:one-dim-osc-hamiltonian}
\end{equation}
记晶格常数为$a$，做傅里叶变换
\[
    \hat{P}_n = \frac{1}{\sqrt{N}} \sum_{k} \ee^{\ii k n a} \hat{P}_k, \quad \hat{X}_n = \frac{1}{\sqrt{N}} \sum_{k} \ee^{\ii k n a} \hat{X}_k,
\]
由于$\vb*{X}$和$\vb*{P}$都是实场，将$k$换成$-k$只会导致共轭转置。
可以计算出对易关系
\begin{equation}
    \comm*{\hat{X}_{k}}{\hat{P}_{k'}} = \ii \delta_{k+k', 0}, \quad \comm*{\hat{X}_{k}}{\hat{X}_{k'}} = \comm*{\hat{P}_{k}}{\hat{P}_{k'}} = 0,
\end{equation}
并将哈密顿量写成
\[
    \hat{H} = \frac{1}{2M} \sum_{k} \hat{P}_{-k} \hat{P}_{k} + \sum_k \frac{M \omega_{k}}{2} \hat{X}_{-k} \hat{X}_k,
\]
其中
\begin{equation}
    \omega_k^2 = 2 (1 - \cos k a) \omega_0^2.
\end{equation}
做变换
\begin{equation}
    \hat{b}_{k} = \sqrt{\frac{M \omega_k}{2}} \hat{X}_k + \ii \frac{1}{\sqrt{2 M \omega_k}} P_k, \quad \hat{b}^\dagger_{k} = \sqrt{\frac{M \omega_k}{2}} \hat{X}_k - \ii \frac{1}{\sqrt{2 M \omega_k}} P_k,
\end{equation}
则有
\begin{equation}
    \hat{H} = \sum_k \omega_k \left(\hat{b}^\dagger_k \hat{b}_k + \frac{1}{2}\right).
\end{equation}
这样就得到了声子。

\subsubsection{三维单成分正方晶格}

现在想象一个三维的正方晶格，各个离子实还是一模一样的。用下标标记晶格坐标，用上标标记矢量的分量，得到\eqref{eq:one-dim-osc-hamiltonian}的三维版本（已经略去了一个无关紧要的基态能量$V_0$）：
\begin{equation}
    \hat{H} = \frac{1}{2 M} \sum_n \hat{P}_n^2 + \frac{1}{2} \sum_{\pair{m, n}} \pdv{V}{R^a}{R^b} (X_m^a - X_n^a) (X_m^b - X_m^b).
\end{equation}
将$\vb*{X}_n$和$\vb*{P}_n$做如下展开：
\begin{equation}
    \vb*{X}_n = \frac{1}{\sqrt{N}} \sum_{\vb*{k}, \lambda} \vb*{\lambda} X_{n \lambda} \ee^{\ii \vb*{k} \cdot \vb*{R}_n^0}, \quad \vb*{P}_n = \frac{1}{\sqrt{N}} \sum_{\vb*{k}, \lambda} \vb*{\lambda} P_{n \lambda} \ee^{\ii \vb*{k} \cdot \vb*{R}_n^0},
\end{equation}
其中$\vb*{\lambda}$是对称矩阵$\pdv{V}{R^a}{R^b}$的特征方向，我们用它表示不同的偏振方向（由于$\vb*{X}$是矢量，声子会有一个额外的偏振自由度）。
在系统对称性比较好的时候，无论$\vb*{k}$方向如何，都可以找到三个合适的$\vb*{\lambda}$，一个平行于$\vb*{k}$，两个垂直于$\vb*{k}$，即可以区分出明确的纵波模式和横波模式，从而可以对不同的$\vb*{k}$选取不同的$\vb*{\lambda}$，记作$\vb*{\lambda}_{\vb*{k}}$。
这样，哈密顿量就是
\begin{equation}
    \hat{H} = \frac{1}{2 M} \sum_{\vb*{k}, \lambda} \hat{P}_{-\vb*{k} \lambda} \hat{P}_{\vb*{k}\lambda} + \frac{M}{2} \sum_{\vb*{k}, \lambda} \omega_{\vb*{k} \lambda}^2 \hat{X}_{-\vb*{k} \lambda} \hat{X}_{\vb*{k} \lambda}.
\end{equation}
容易看出，由于$\hat{H}$的厄米性，$\omega_{\vb*{k}\vb*{\lambda}} = \omega_{-\vb*{k} \vb*{\lambda}}$。做变换
\begin{equation}
    \hat{b}_{\vb*{k} \lambda} = \sqrt{\frac{M \omega_{\vb*{k} \lambda}}{2}} \hat{X}_{\vb*{k} \lambda} + \ii \frac{1}{\sqrt{2 M \omega_{\vb*{k} \lambda}}} P_{\vb*{k} \lambda}, \quad \hat{b}^\dagger_{\vb*{k} \lambda} = \sqrt{\frac{M \omega_{\vb*{k} \lambda}}{2}} \hat{X}_{- \vb*{k} \lambda} - \ii \frac{1}{\sqrt{2 M \omega_{\vb*{k} \lambda}}} P_{- \vb*{k} \lambda},
    \label{eq:transform-b-pq}
\end{equation}
哈密顿量就成为
\begin{equation}
    \hat{H} = \sum_{\vb*{k}, \lambda} \omega_{\vb*{k} \lambda} \left( \hat{b}^\dagger_{\vb*{k} \lambda} \hat{b}_{\vb*{k} \lambda} + \frac{1}{2} \right).
\end{equation}

\subsubsection{声学声子和光学声子}

如果晶格中实际上有好多种离子实，那么$\vb*{X}$需要两个量子数来标记，其一是格点坐标，其二是表明它是哪种离子实的位移的一个标签。
这样，如果晶格有$n_\text{i}$好多种离子实，那么它就有$n_\text{i}$种不同的声子模式。

\subsection{相互作用}

\subsubsection{声子-声子散射}

由于实际上，晶格中的离子实之间的相互作用并不是线性的，哈密顿量中会有诸如$\vb*{X}$和$\vb*{P}$的高阶项，从而会会有$\hat{b}, \hat{b}^\dagger$的高于二次的项，也就是说，出现了声子-声子相互作用。

不同类型的晶格中，声子-声子相互作用可能有很大的不同。

\subsubsection{电子-声子耦合}

电子-声子耦合是因为电子在晶格产生的库伦势中运动。显然我们有
\[
    V \sim \int \dd[3]{\vb*{r}} \rho_\text{e}(\vb*{r}) V_\text{ion}(\vb*{r}),
\]
我们取最低阶的近似，认为$V_\text{ion}(\vb*{r})$正比于$\vb*{r}$点的离子实数密度，由于离子实并非一个理想的正电荷，而是受核外电子屏蔽的一个正电荷，离子实产生的电势随着距离上升指数衰减，因此这样假设是合理的。
于是
\[
    V \sim \int \dd[3]{\vb*{r}} \rho_\text{e}(\vb*{r}) \rho_\text{ion}(\vb*{r}).
\]
如果$\{\vb*{X}_n\}$完全没有偏离理想晶格，即晶格没有发生任何形变，那么上式实际上给出了电子质量的一个修正，可以归入电子质量项。
当晶格发生形变，但是形变很小时，根据输运方程我们有
\[
    \Delta \rho_\text{ion} \sim \div{\vb*{X}},
\]
这里我们将原本定义在格子上的$\vb*{X}$做了一个延拓，假定它在空间中是连续变化的，这是将离散的、一个一个尖峰的离子实密度连续化的常用方法。
于是，扣除了背景项（背景项导致了电子质量的修正）之后，相互作用为
\[
    V \sim \int \dd[3]{\vb*{r}} \rho_\text{e}(\vb*{r}) \div{\vb*{X}}.
\]
我们可以直接把上式量子化，并注意到$\hat{\vb*{X}}$实际上是$\hat{b}, \hat{b}^\dagger$的线性组合，例如对三维单成分正方晶格，我们根据\eqref{eq:transform-b-pq}，得到
\begin{equation}
    \hat{H}_\text{int} = \gamma \sum_{\vb*{q}, \lambda} \frac{\ii q_\lambda}{\sqrt{2 M \omega_{\vb*{q} \lambda}}} (\hat{b}_{\vb*{q} \vb*{\lambda}} + \hat{b}^\dagger_{-\vb*{q} \vb*{\lambda}}) \underbrace{\sum_{\vb*{k}, \sigma} \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k} \sigma}}_{\hat{\rho}_{\text{e} \vb*{q}}}.
    \label{eq:simple-phonon-electron-int}
\end{equation}
于是我们就得到了二电子、一声子的相互作用，在费曼图中体现为一个二电子线一进一出、一声子线的顶角。

\subsubsection{声子格林函数和路径积分}

首先做从哈密顿量到拉格朗日量的勒让德变换：
\[
    \dot{X}_{\vb*{q} \lambda} = \frac{P_{\vb*{q} \lambda}}{M},
\]
于是
\begin{equation}
    Z = \int \mathcal{D} Q_{\vb*{q} \lambda} \mathcal{D} Q^*_{\vb*{q} \lambda} \exp(- \int \dd{\tau} \sum_{\vb*{q}, \lambda} \frac{M}{2} \abs{\dv{Q_{\vb*{k} \lambda}}{\tau}}^2 + \frac{M \omega_{\vb*{q} \lambda}^2}{2} \abs{Q_{\vb*{q} \lambda}}^2 ).
\end{equation}
在虚频率空间中做计算，我们有
\begin{equation}
    Z = \int \prod_{\omega_n} \dd{Q_{\vb*{q} \lambda}^*(\omega_n)} \dd{Q_{\vb*{q} \lambda}(\omega_n)} \exp(- \sum_{\vb*{q}, \lambda, \omega_n} \frac{M}{2} (\omega_n^2 + \omega_{\vb*{q} \lambda}^2) \abs*{Q_{\vb*{q} \lambda}(\omega_n)}^2).
\end{equation}
我们故意省去了积分上限$\beta$以及它导致的离散的松原频率，因为这里是在用虚时间技术算零温格林函数。

总之，固体中，晶格可以起到两种作用：一种是提供一个周期性势场，一个是晶格的畸变；前者属于电子的单体哈密顿量，可以通过求解自由模型被考虑在内；后者则导致声子。
这样，解出电子的自由理论（如紧束缚模型）、声子的自由理论之后再加入电子、声子间的相互作用，我们就可以用电子和声子组成的相互作用气体完整描述晶体的行为，而不需要再显式考虑晶格的存在。
例如，在计算热容等变量时，完全可以认为热容是声子和电子（实际上是费米液体或者别的什么系统中的准粒子）提供的，而不是（裸的）电子和晶格提供的。

\section{外加杂质}

本节讨论对晶体引入小的外界扰动——通常是某种形式的掺杂——会导致的结果。响应可能是微小的，也可能是巨大的。

\subsection{外加电荷和屏蔽}\label{sec:ext-charge}

\subsubsection{托马斯-费米静态屏蔽势}

本节讨论一个足够稀疏，从而可以忽略交换作用的电子气系统。
由于可以忽略交换作用，可以完全照搬经典静电学，即认为一个电子的全部能量是其动能加上电势能，而不考虑任何交换能或者关联能。
想象我们在一个满足托马斯-费米近似的近独立电子气当中放入一个电荷。显然，异号电荷会移动到前者附近而产生一个屏蔽效应。
在电子气规模很大时（我们所研究的固体总是在热力学极限之下，因此这是成立的），屏蔽效应很强，这让外加电荷对电子气的扰动实际上局限在外加电荷的一个小邻域内。
不管怎么说求解外加电荷的影响就是求解以下自洽问题：
\begin{enumerate}
    \item 外加电荷导致外加电势能
    \begin{equation}
        \phi_\text{ext} = \frac{Q}{r},
    \end{equation}
    \item 外加电势与屏蔽电荷形成的电势$\var{\phi}$叠加，导致总的电势变化为
    \begin{equation}
        \phi_\text{eff} = \phi_\text{ext} + \var{\phi},
    \end{equation}
    \item 总电势变化$\phi_\text{eff}$导致了电荷密度变化$\var{n}$，电荷密度变化给出屏蔽电势$\var{\phi}$。
\end{enumerate}
自洽求解以上问题就可以确定所有物理量。

以上自洽求解步骤还需要一个方程：$V_\text{eff}$是怎么影响电荷密度的。
$V_\text{eff}$改变粒子排布的方式是这样的：单电子的能量$\epsilon_{\vb*{k}}$会由于$V_\text{eff}$的引入发生一个小的变化，且这个小的变化在不同位置通常是不一样的。
由于托马斯-费米近似成立，我们认为每个$\vb*{r}$位置附近的诸电子都可以认为是组成了一个正则系综%
\footnote{这么做总是可以的，因为我们讨论近平衡态理论，确实允许电荷密度在空间上出现分布，虽然完全的平衡态电子气应该是均匀的。}%
，且$\vb*{k}$和$\vb*{r}$可以同时确定，于是
\[
    n(\vb*{r}) = \sum_{\vb*{k}, \sigma} \frac{1}{1 + \ee^{\beta (\epsilon_{\vb*{k}}(\vb*{r}) - \mu)}} = 2 \sum_{\vb*{k}} \frac{1}{1 + \ee^{\beta (\epsilon_{\vb*{k}}(\vb*{r}) - \mu)}}, \quad \epsilon_{\vb*{k}}(\vb*{r}) = \epsilon_{\vb*{k}}^0 + V_\text{eff}(\vb*{r}),
\]
由于体系足够大，屏蔽作用让外加电荷的作用几乎是局域的，则$\var{n}(\vb*{r})$可以写成$V_\text{eff}(\vb*{r})$的函数而不涉及长程相互作用。
而由于外加电荷很小，可以采取线性近似，于是（第二个等号是因为费米-狄拉克分布的形式）
\[
    \var{n} = \dv{n}{V_\text{eff}} V_\text{eff} = \sum_{\vb*{k}} \pdv{n}{\epsilon_{\vb*{k}}} V_\text{eff} = - \pdv{n}{\mu} V_\text{eff},
\]
关于能量的态密度（即单位$\dd{\epsilon}$、单位体积中有多少可能的态）为
\begin{equation}
    N(\mu' - \mu) = \pdv{n\big|_{\mu \to \mu'}}{\mu'},
\end{equation}
其中能量从费米面量起，且我们将$n$的表达式中的$\mu$换成了变量$\mu'$，而使用$\mu$表示实际系统的化学势。使用该记号，则
\begin{equation}
    \var{n}(\vb*{r}) = - N(0) V_\text{eff}(\vb*{r}).
    \label{eq:from-veff-to-varn}
\end{equation}
这就是从$V_\text{eff}$计算$\var{n}$的方法。通过$\var{n}$计算$\var{\phi}$的方程为泊松方程
\[
    - \laplacian \phi_\text{eff} = 4 \pi \left( Q \delta(\vb*{r}) - e \var{n}(\vb*{r}) \right),
\]
其中我们不失一般性地将外加电荷放在原点上。使用傅里叶变换并且使用$\var{n}$和$V_\text{eff}$之间的线性关系\eqref{eq:from-veff-to-varn}，可以得到
\[
    k^2 V_\text{eff}(\vb*{k}) = - 4\pi e Q - 4 \pi e^2 N(0) V_\text{eff}(\vb*{k}),
\]
解出$V_\text{eff}(\vb*{k})$为
\[
    V_\text{eff}(\vb*{k}) = - \frac{4 \pi e Q}{k^2 + \kappa
    _\text{TF}^2},
\]
做傅里叶逆变换得到
\begin{equation}
    V_\text{eff}(\vb*{r}) = - \frac{eQ}{r} \ee^{- \kappa_\text{TF} r},
    \label{eq:thomas-fermi-potential}
\end{equation}
其中
\begin{equation}
    \kappa_\text{TF}^2 = 4 \pi e^2 N(0).
\end{equation}
这个结果就是\concept{托马斯-费米屏蔽}。

\subsubsection{RPA近似下的动态屏蔽响应}

托马斯-费米屏蔽是静态的。现在考虑一般的近独立电子气的线性响应。
外加电势导致如下的相互作用哈密顿量：
\[
    \hat{H}_\text{ext} = \int \dd[3]{\vb*{r}} \hat{n}(\vb*{r}, t) V_\text{ext} (\vb*{r}, t),
\]
则它对电子数密度的影响可以使用（各向同性不含时体系的）推迟格林函数
\[
    G^\text{ret}_{nn}(\vb*{r}-\vb*{r}', t-t') = - \ii \theta(t-t') \expval*{\comm{\var{\hat{n}}(\vb*{r}, t)}{\var{\hat{n}}(\vb*{r}', t')}}
\]
描述，而响应就是%
\footnote{我们没有将$V_\text{ext}$写进$\hat{H}$中而是把它看成了外界扰动，这样电子气本身的哈密顿量仍然是空间平移不变的。}%
\begin{equation}
    \expval*{\var{\hat{n}}(\vb*{r}, t)} = \int \dd{t'} G^\text{ret}_{nn}(\vb*{r}-\vb*{r}', t-t') V_\text{ext}(\vb*{r}', t'),
\end{equation}
在频域中就是
\begin{equation}
    \expval*{\var{\hat{n}}(\vb*{k}, \omega)} = G^\text{ret}_{nn}(\vb*{k}, \omega) V_\text{ext}(\vb*{k}, \omega).
    \label{eq:green-function-electro-shielding}
\end{equation}
当然，在系统的构成已知的情况下，可以直接用费曼图计算出格林函数$G^\text{ret}_{nn}$，但是本节不这么处理问题。
但如果真的这么做很快就会遇到数学上的困难：费曼图求和需要经过一些特殊的重求和步骤才能够给出有意义的结果。
因此本节只是做一个近似，将最为奇异的那部分费曼图做一个求和，然后发现它确实能够给出有意义的结果。

为简化问题我们做\concept{RPA（Random Phase Approximation）近似}%
\footnote{这个名称最早来自核物理，在那里它是通过对某个随机相位的求和得到的。}%
，这个近似要求以下两点：
\begin{itemize}
    \item $\var{\hat{n}}$和$V_\text{eff}$之间的响应函数近似是自由电子的$\var{\hat{n}}$-$\var{\hat{n}}$格林函数，即我们认为$V_\text{eff}$中来自电子屏蔽的部分在其它电子上的作用和一个外加势场完全没有区别；
    \item 只考虑经典静电能，即将电子数密度期望当成经典电子数密度，忽略所有交换能或关联能。
\end{itemize}
RPA近似看起来似乎没有什么明确的意义，但它实际上把最为奇异剧烈效应考虑在内，并且给出了定性上正确的屏蔽库伦势（从一个长程的相互作用变成了一个短程的相互作用）。如果RPA近似不准，只需要多算几个微扰就可以。
这样，自洽方程可以通过下面的方法给出。
\begin{enumerate}
    \item 外加电荷引入外加电势能，
    \item 外加电势能加上屏蔽电荷产生的电势能等于总的电势能变化$V_\text{ext}$，
    \item 总的电势能变化可以反推出屏蔽电荷。
\end{enumerate}

粒子数的平均值近似为一个经典的数密度，从而$\var{V}$可以使用泊松方程写成
\[
    - \laplacian \var{V}(\vb*{r}, t) = - 4\pi e^2 \expval*{\var{\hat{n}}(\vb*{r}, t)},
\]
也即
\begin{equation}
    k^2 \var{V}(\vb*{k}, \omega) = 4\pi e^2 \expval*{\var{\hat{n}}(\vb*{k}, \omega)}.
\end{equation}
于是第二步完成了。

第三步通过RPA近似的基本假设得到。这里我们用$G^\text{0, ret}_{nn} (\vb*{k}, \omega)$作为$G^\text{0, ret}_{\var{n}\var{n}} (\vb*{k}, \omega)$的简写：
\begin{equation}
    \expval*{\var{\hat{n}}(\vb*{k}, \omega)} = G^\text{0, ret}_{nn} (\vb*{k}, \omega) V_\text{eff} (\vb*{k}, \omega).
    \label{eq:rpa-approximation}
\end{equation}
这样就得到自洽方程
\[
    V_\text{ext}(\vb*{k}, \omega) + \frac{4\pi e^2}{k^2} \expval*{\var{\hat{n}}(\vb*{k}, \omega)} = (G^\text{0, ret}_{nn} (\vb*{k}, \omega))^{-1} \expval*{\var{\hat{n}}(\vb*{k}, \omega)},
\]
从而
\begin{equation}
    G^\text{ret}_{nn}(\vb*{k}, \omega) = \frac{G^\text{0, ret}_{nn}(\vb*{k}, \omega)}{1 - \frac{4\pi e^2}{k^2} G^\text{0, ret}_{nn}(\vb*{k}, \omega)} = \frac{G^\text{0, ret}_{nn}(\vb*{k}, \omega)}{\epsilon(\vb*{k}, \omega)},
    \label{eq:ext-electron-ret-nn}
\end{equation}
其中$\epsilon(\vb*{k}, \omega)$是介电常数。
这样，计算出自由电子的密度-密度格林函数之后问题就完全解决了。

实际上从\eqref{eq:ext-electron-ret-nn}就可以看出RPA近似的实质。将\eqref{eq:ext-electron-ret-nn}做级数展开，我们有
\[
    G^\text{ret}_{nn}(\vb*{k}, \omega) = G^\text{0, ret}_{nn}(\vb*{k}, \omega) + G^\text{0, ret}_{nn}(\vb*{k}, \omega) \frac{4\pi e^2}{k^2} G^\text{0, ret}_{nn}(\vb*{k}, \omega) + \cdots,
\]
上式两边加上电子数密度平方，并注意到$G^\text{0, ret}_{nn}(\vb*{k}, \omega)$就是电子-空穴组成的环的贡献——依照定义，自由电子的密度-密度格林函数为
\[
    \begin{aligned}
        G_{nn}^\text{0}(\vb*{r}-\vb*{r}', \tau-\tau') &= - T_\tau \expval*{\var{\hat{n}}(\vb*{r}, \tau) \var{\hat{n}}(\vb*{r}', \tau')} \\
        &= - T_\tau \expval*{{\hat{n}}(\vb*{r}, \tau) {\hat{n}}(\vb*{r}', \tau')} + \expval*{\hat{n}(\vb*{r}, \tau)} \expval*{\hat{n}(\vb*{r}', \tau')} \\
        &= \sum_{\sigma, \sigma'} T_\tau \expval*{\hat{\psi}_{\sigma'}(\vb*{r}', \tau') \hat{\psi}^\dagger_\sigma(\vb*{r}, \tau)} T_\tau \expval*{ \hat{\psi}_\sigma(\vb*{r}, \tau) \hat{\psi}^\dagger_{\sigma'}(\vb*{r}', \tau') } ,
    \end{aligned}
\]
其中最后一个等号用到了Wick定理——我们就发现\eqref{eq:ext-electron-ret-nn}实际上就是环形图近似。
\eqref{eq:ext-electron-ret-nn}实际上给出了$G^\text{ret}_{nn}$中最为奇异的部分，因为环形图会产生次数非常高的$1/k^n$型的项，从而发散得最厉害；但是将所有这些发散的图求和起来却能够得到一个收敛的结果。
环形图近似的成立条件是粒子数密度很高，从而主要的相互作用形式是电子通过库仑相互作用，激发出一些电子-空穴对（即环形图中的环），即主要的相互作用是环形图。
也可以从另一个角度理解这件事：粒子数密度较高意味着屏蔽作用很强，所以$1/k^n$发散得不那么厉害的那些项没有什么贡献。

由于自旋守恒性，只有$\sigma = \sigma'$的项才非零，我们得到
\[
    G_{nn}^\text{0}(\vb*{r}-\vb*{r}', \tau-\tau') = \sum_\sigma G_\sigma(\vb*{r}' - \vb*{r}, \tau' - \tau) G_\sigma(\vb*{r} - \vb*{r}', \tau - \tau').
\]
上式具有卷积的形式，切换到频谱，就是
\[
    G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) = \sum_{\sigma} \sum_{\vb*{k}} \frac{1}{\beta} \sum_{\nu_n} G_\sigma(\vb*{q}, \ii \nu_n) G_\sigma(\vb*{k} + \vb*{q}, \ii (\omega_n + \nu_n)),
\]
其中
\[
    \nu_n = \frac{\pi(2n+1)}{\beta}, \quad \omega_n = \frac{2\pi n}{\beta},
\]
前者是费米子的松原频率，后者则是玻色子的，因为电子配对形成玻色子。自由费米子的谱函数为
\[
    A(\vb*{k}, \omega) = \delta(\omega - \xi_{\vb*{k}}), \quad \xi_{\vb*{k}} = \frac{\vb*{k}^2}{2m} - \mu,
\]
格林函数为
\[
    G_\sigma(\vb*{r}, \ii \omega_n) = \frac{1}{\ii \omega_n - \xi_{\vb*{k}}}.
\]
于是，有
\[
    G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \frac{1}{\beta} \sum_{\nu_n} \frac{1}{\ii \nu_n - \xi_{\vb*{k}}} \frac{1}{\ii \omega_n + \ii \nu_n - \xi_{\vb*{k}+\vb*{q}}}.
\]
要计算上式，常用的一个技巧是将求和转化为围道积分。注意到$\{\ii \nu_n\}$正是$f(z)$的全部极点，而且这些极点都是一阶极点。
容易看出这些极点的留数都是$-1/\beta$，于是对一个在虚轴上解析的函数$F(z)$，有
\[
    \frac{1}{\beta} \sum_{\nu_n} F(\ii \nu_n) = - \oint \frac{\dd{z}}{2\pi \ii} f(z) F(z),
\]
于是设围绕虚轴的环路为$C$，它实际上就是从$-\ii \infty + 0^+$到$\ii \infty + 0^+$，再从$\ii \infty - 0^+$到$-\ii \infty - 0^+$，
有
\[
    \begin{aligned}
        G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) &= - 2 \sum_{\vb*{k}} \oint_C \frac{\dd{z}}{2\pi \ii} f(z) \frac{1}{z - \xi_{\vb*{k}}} \frac{1}{z +  \ii \omega_n - \xi_{\vb*{k}+\vb*{q}}} \\
        &= 2 \sum_{\vb*{k}} \left( \frac{f(\xi_{\vb*{k}})}{\xi_{\vb*{k}} + \ii \omega_n - \xi_{\vb*{k} + \vb*{q}}} + \frac{f(\xi_{\vb*{k} + \vb*{q}} - \ii \omega_n)}{\xi_{\vb*{k} + \vb*{q}} - \ii \omega_n - \xi_{\vb*{k}}} \right).
    \end{aligned}
\]
负号消失了是因为绕极点$z=\xi_{\vb*{k}}$和$z = \xi_{\vb*{k} + \vb*{q}} - \ii \omega_n$是顺时针而不是留数定理通常是的逆时针。
由$\{\omega_n\}$的定义，$f(\xi_{\vb*{k} + \vb*{q}} - \ii \omega_n)$就是$f(\xi_{\vb*{k} + \vb*{q}})$，于是得到松原格林函数
\begin{equation}
    G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \frac{f(\xi_{\vb*{k}}) - f(\xi_{\vb*{k} + \vb*{q}})}{\ii \omega_n + \xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}}}.
\end{equation}
做解析延拓就得到推迟格林函数
\begin{equation}
    G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \frac{f(\xi_{\vb*{k}}) - f(\xi_{\vb*{k} + \vb*{q}})}{\omega + \xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}} + \ii 0^+}.
    \label{eq:ext-electron-retarded-green-function}
\end{equation}
介电常数为
\begin{equation}
    \epsilon(\vb*{k}, \omega) = \frac{V_\text{ext}}{V_\text{eff}} = 1 - \frac{4 \pi e^2}{k^2} G^\text{ret, 0}_{nn}(\vb*{k}, \omega)
\end{equation}

\eqref{eq:ext-electron-retarded-green-function}可以推导出托马斯-费米屏蔽。
在$V_\text{eff}$在时间和空间上都变化非常缓慢时，只需要考虑$\vb*{q}$接近零的那部分傅里叶分量。
让$\omega$和$\vb*{q}$趋于零，我们有
\[
    G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \dv{f(\xi_{\vb*{k}})}{\xi_{\vb*{k}}} = - 2 \sum_{\vb*{k}} \dv{f(\xi_{\vb*{k}})}{\mu} = - \pdv{n}{\mu} = - N(0),
\]
这正是我们在托马斯-费米屏蔽中做的近似。这也表明RPA近似至少在低频下是合理的。

\subsubsection{等离子体和等离激元}

考虑$\omega$非常高的极限，此时做展开
\[
    \frac{1}{\omega + \xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}} + \ii 0^+} = \frac{1}{\omega} - \frac{\xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}}}{\omega^2} + \cdots,
\]
展开到前两阶，代入\eqref{eq:ext-electron-retarded-green-function}，得到
\[
    \begin{aligned}
        G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) &= - \frac{2}{\omega^2} \sum_{\vb*{k}} (f(\xi_{\vb*{k}}) - f(\xi_{\vb*{k} + \vb*{q}})) (\xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}}) \\
        &= \frac{2 q^2}{m \omega^2} \sum_{\vb*{k}} f(\xi_{\vb*{k}}), 
    \end{aligned}
\]
于是就得到
\begin{equation}
    G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) = \frac{q^2 n_\text{e}}{m \omega^2},
\end{equation}
相应的，
\[
    \epsilon(\vb*{k}, \omega \to 0) = 1 - \frac{4 \pi e^2 n_\text{e}}{m \omega^2},
\]
定义
\begin{equation}
    \omega_\text{p}^2 = \frac{4 \pi e^2 n_\text{e}}{m},
\end{equation}
就得到
\begin{equation}
    \epsilon(\vb*{k}, \omega \to 0) = 1 - \frac{\omega_\text{p}^2}{\omega^2}.
\end{equation}
考虑到\eqref{eq:ext-electron-ret-nn}，当$\omega = \omega_\text{p}$时格林函数出现奇点，即此处有集体激发。实际上，这正是\concept{等离激元}。
$G^\text{ret}_{nn}(\vb*{k}, \omega)$是一个密度-密度格林函数，对任意的动量，在$\omega = \omega_\text{p}$处都有一个密度波的集体激发模式。
这个集体激发的频谱是平的，这当然是因为我们假定光速无穷大，完全使用库伦相互作用。如果考虑到光速有限，使用麦克斯韦方程可以推出
\begin{equation}
    \omega_{\vb*{k}}^2 = \omega_\text{p}^2 + c^2 k^2,
\end{equation}
即光子的一个模式和固体发生耦合，打开了一个能隙。在假定光速无限时，丢弃不可见、恒定的无穷大项（相当于将元激发的产生湮灭算符的时间演化加上一个因子$\ee^{\ii c k t}$）就得到
\[
    \omega_{\vb*{k}} = \omega_\text{p},
\]
即我们算出的结果。

\subsection{单杂质与局域磁矩}

\subsubsection{Anderson模型}\label{sec:anderson-model}

考虑一个无相互作用的体系，我们在其中引入一个杂质，并且假定该杂质能够将电子紧密地约束在其周围。
这样一来我们就有了两套能级：一套是原本的费米液体，还有一套是一个单独的能级，处于这个能级的电子被束缚在杂质周围。
需要使用晶格动量和自旋标记前者（仅考虑能量最低的能带），称为\concept{巡游电子}，因为它的波函数是布洛赫波函数，并不定域；后者是定域的，只需要使用自旋即可标记后者，称为\concept{d电子}（因为很多时候这个轨道是杂质的d轨道）。
前者和后者可以自然地转化，即两者之间有\concept{杂化}，于是描述它们的模型就是以下\concept{单杂质的Anderson模型}：
\begin{equation}
    \hat{H} = \sum_{\vb*{k}, \sigma} (\epsilon_{\vb*{k}} - \mu) \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.} + U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}.
    \label{eq:impurity-anderson}
\end{equation}
不失一般性地认为$V_{\vb*{k} \text{d}}$都是实数，如果它不是实数，那总是可以通过重新定义$\hat{c}_{\vb*{k} \text{d}}$（乘上一个复数因子）来让它变成实数。
最后一项是因为同处于d能级的两个电子之间会有库伦排斥作用，这一项实际上是唯一的真正的相互作用，因为前三项都是二次型。请注意这一项具有自选旋转不变性，这也是合理的。

d电子的相互作用项意味着d轨道上出现两个电子会大大增大能量，如果费米面位于d轨道出现一个电子和d轨道出现两个电子的能量之间，那么巡游电子总会填充d轨道，而且填充一个电子，其结果就是产生杂质附近的局域磁矩。
实际上，这样会导致一个低能有效理论，见\autoref{sec:kondo-effect}。
本节则主要观察什么时候会出现一个局域磁矩，即什么时候会出现对称性自发破缺。

在展开计算之前，首先尝试做一些定性的分析。记能谱展宽为$\Delta$，则由费米黄金法则，
\[
    \Delta \propto \frac{1}{\tau} \propto \sum_{\vb*{k}} \abs{V_{\vb*{k} \text{d}}}^2 N(\epsilon_\text{d}).
\]
只有$U$很大时才能够产生局域磁矩，否则d轨道可以很容易地填满。
当$U \gg \epsilon_\text{d} \gg \Delta$时，d电子能谱发生弱展宽，但仍然有清晰的能级，并且会有一个良定义的局域磁矩。
而当$U \gg \Delta \gg \epsilon_\text{d}$时能级已经很不清楚，d电子可以和费米海中大范围的电子发生相互作用，因此虽然d轨道上只有一个电子，但它会频繁地发生自旋翻转，因此不会有局域磁矩。

\subsubsection{平均场近似}

相互作用项为
\[
    U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow} = U \hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow} \hat{c}^\dagger_{\text{d} \downarrow} \hat{c}_{\text{d} \downarrow},
\]
现在尝试应用平均场近似。假定体系近似自由，我们有
\[
    \begin{aligned}
        \expval{U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}} &= U \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow} \hat{c}^\dagger_{\text{d} \downarrow} \hat{c}_{\text{d} \downarrow}} \\
        &= U ( \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow}} \expval*{\hat{c}_{\text{d} \downarrow}^\dagger \hat{c}_{\text{d} \downarrow}} + \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \downarrow}} \expval*{\hat{c}_{\text{d} \uparrow} \hat{c}^\dagger_{\text{d} \downarrow}} ),
    \end{aligned}
\]
第二项如果有非零值，$z$方向上的自旋旋转对称性就破缺了。
确实有这样的可能，就是系统基态有对称性自发破缺，但这里暂时假定没有这种情况。%
\footnote{从这里也可以看到平均场近似总是倾向于高估系统的对称性破缺，因为我们完全可以假定$z$方向上的自旋旋转对称性真的破缺了，从而得到一个$z$方向上自选旋转对称性真的破缺的平均场理论。
}%
这样就有
\[
    \expval{U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}} = U \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow}} \expval*{\hat{c}_{\text{d} \downarrow}^\dagger \hat{c}_{\text{d} \downarrow}},
\]
这又告诉我们，我们有
\[
    \expval{U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}} = \expval{ U \hat{n}_{\text{d} \uparrow} \expval*{\hat{n}_{\text{d} \downarrow}} + U \expval*{\hat{n}_{\text{d} \uparrow}} \hat{n}_{\text{d} \downarrow} - U \expval*{\hat{n}_{\text{d} \uparrow}} \expval*{\hat{n}_{\text{d} \downarrow}} },
\]
那么如果相互作用哈密顿量适用平均场近似我们就有
\begin{equation}
    U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow} \approx U \hat{n}_{\text{d} \uparrow} \expval*{\hat{n}_{\text{d} \downarrow}} + U \expval*{\hat{n}_{\text{d} \uparrow}} \hat{n}_{\text{d} \downarrow} - U \expval*{\hat{n}_{\text{d} \uparrow}} \expval*{\hat{n}_{\text{d} \downarrow}}.
\end{equation}
当然，这只是一种可能的平均场分解——没有理由认为这就是最理想的近似，但实际上使用变分计算可以确定这确实是最理想的近似。
忽略仅改变能量零点的常数项，得到平均场哈密顿量
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \sigma} \xi_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.} + U \hat{n}_{\text{d} \uparrow} \expval*{\hat{n}_{\text{d} \downarrow}} + U \expval*{\hat{n}_{\text{d} \uparrow}} \hat{n}_{\text{d} \downarrow}.
    \label{eq:anderson-mf}
\end{equation}
这是一个二次型哈密顿量。\eqref{eq:anderson-mf}含有不确定的参数$\expval*{\hat{n}_{\text{d} \uparrow}}$和$\expval*{\hat{n}_{\text{d} \downarrow}}$（这两个参数实际上是序参量，它们的差给出了$z$轴上的磁矩），但是可以将它们当成参数，求解出$\hat{n}_{\text{d} \uparrow}$和$\hat{n}_{\text{d} \downarrow}$之后回代，从而形成自洽方程。

求解\eqref{eq:anderson-mf}，在适当的条件上我们会看到$\expval*{\hat{n}_{\text{d} \uparrow}} - \expval*{\hat{n}_{\text{d} \downarrow}}$不等于零，即出现了一个自发磁矩。
虽然出现了一个局域磁矩，但这和我们的假定——$z$方向上自选旋转不变——并不矛盾，因为$z$方向上的自旋破缺的是$x$或$y$方向的自旋旋转不变性。
换而言之，以上我们证明的结论是：平均场理论下，$x, y, z$三个方向上的自选旋转不变性不可能全部保留，保留$z$轴的自旋旋转不变性就必定破坏其它两个方向的自选旋转不变性。

可以对\eqref{eq:anderson-mf}做对角化。定义
\begin{equation}
    E_{\text{d} \sigma} = \epsilon_\text{d} + U \expval*{\hat{n}_{\text{d} (-\sigma)}},
    \label{eq:energy-d-sigma}
\end{equation}
则
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \sigma} \xi_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma E_{\text{d} \sigma} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.}
\end{equation}
下面要对角化该哈密顿量。设已有对角化形式
\[
    \hat{H}_\text{MF} = \sum_{n, \sigma} \epsilon_{n \sigma} \hat{c}^\dagger_{n\sigma} \hat{c}_{n\sigma},
\]
其中$n$是某个未知的量子数，$\hat{c}_{n \sigma}$可以写成$\hat{c}_{\vb*{k} \sigma}$和$\hat{c}_{\text{d} \sigma}$的幺正变换，通过要求对易关系一致（或者别的什么技巧）就得到方程组
\begin{equation}
    \begin{aligned}
        \epsilon_{n\sigma} \braket{\vb*{k}\sigma}{n \sigma} &= \braket{\vb*{k} \sigma}{n \sigma} \xi_{\vb*{k}} + \braket{\text{d} \sigma}{n \sigma} V_{\vb*{k} \text{d}}, \\
        \epsilon_{n \sigma} \braket{\text{d} \sigma}{n \sigma} &= \braket{\text{d} \sigma}{n \sigma} E_{\text{d} \sigma} + \sum_{\vb*{k}} \braket{\vb*{k} \sigma}{n \sigma} V_{\vb*{k} \sigma}.
    \end{aligned}
\end{equation}
求解此方程组，并加入幺正性条件，就可以完成对角化。

\subsubsection{平均场近似下的格林函数}

由于系统自旋守恒，两个自旋不同的算符的格林函数为零，因此可以使用$G_{\text{dd}, \sigma}$标记d轨道电子的格林函数，用$G_{\vb*{k} \text{d}, \sigma}$标记从$\vb*{k}$动量的巡游电子跃迁为d电子的格林函数。
从一个巡游电子到另一个巡游电子的过程动量守恒（因为相当于积掉了d电子自由度），用$G_{\vb*{k}\sigma}$标记这个过程的格林函数。
我们并不会计算这些格林函数，于是首先考虑$n$-$\sigma$表象下的格林函数，然后再使用表象变换得到d电子或者别的什么东西的格林函数。
要计算d点子格林函数是为了计算$\expval*{\hat{n}_{\text{d}\uparrow}}$和$\expval*{\hat{n}_{\text{d}\downarrow}}$。

在$n$-$\sigma$表象下哈密顿量对角，于是使用$G_{n\sigma}$标记$n$表象电子的格林函数。
首先考虑松原格林函数，考虑到$n$表象下系统是自由的，有
\begin{equation}
    G_{n\sigma} (\omega_n) = \frac{1}{\ii \omega_n - \epsilon_n},
\end{equation}
请注意这里有两种$n$：$\omega_n$中的$n$标记频率，$\epsilon_n$和$G$的下标中的$n$则是量子数。
虚频单电子格林算符定义为
\[
    (\ii \omega_n - \hat{h}_\text{MF}) \hat{G}(\omega_n) = 1,
\]
使用$G_{n \sigma}$，单电子格林算符就是
\begin{equation}
    \hat{G}(\omega_n) = \sum_{n, \sigma} \frac{\dyad{n\sigma}}{\ii \omega_n - \epsilon_n} = \frac{1}{\ii \omega_n - \hat{h}_\text{MF}},
\end{equation}
其中$\hat{h}_\text{MF}$就是单体哈密顿量，为
\begin{equation}
    \hat{h}_\text{MF} = \sum_{\vb*{k}, \sigma} \xi_{\vb*{k}} \dyad{\vb*{k} \sigma} + \sum_\sigma E_{\text{d} \sigma} \dyad{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} ( \ket{\vb*{k} \sigma} \bra{\text{d} \sigma} + \text{h.c.} ).
    \label{eq:anderson-green-operator}
\end{equation}
格林算符在不同表象下的矩阵元就给出了全部的单电子格林函数（或者说二算符格林函数）。

计算\eqref{eq:anderson-green-operator}在$\vb*{k}, \text{d}$表象下的不同矩阵元，可以得到$G_{\text{dd}, \sigma}$，$G_{\vb*{k} \text{d}, \sigma}$和$G_{\vb*{k}, \sigma}$之间的关系。
可以预期$G_{\vb*{k}, \sigma}$和自由情况不会差太多，因为巡游电子远远多于d电子。
d电子的格林函数相对自由电子格林函数则会有较大的修正，具体而言，是
\begin{equation}
    (G_{\text{dd}, \sigma}(\omega_n))^{-1} = \ii \omega_n - E_{\text{d}\sigma} - \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\ii \omega_n - \epsilon_{\vb*{k}}}.
\end{equation}
相应的推迟格林函数是
\begin{equation}
    (G_{\text{dd}, \sigma}^\text{ret}(\omega))^{-1} = \omega - E_{\text{d}\sigma} - \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}
自能修正为
\begin{equation}
    \Sigma_{\text{d} \sigma}^\text{ret} = \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+} = \frac{V}{(2\pi)^3} \int \dd[3]{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}
它来自d电子通过和巡游电子作用，间接地“自己和自己相互作用”。它的实部带来能级修正，它的虚部就是能级展宽的量级。
实部是通常的柯西积分主值
\[
    \Re \Sigma_{\text{d} \sigma}^\text{ret} = \frac{V}{(2\pi)^3} \primevalue \int \dd[3]{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+},
\]
虚部为
\[
    \Im \Sigma_{\text{d} \sigma}^\text{ret} = - \sum_{\vb*{k}} \delta(\omega - \epsilon_{\vb*{k}}) V_{\vb*{k} \text{d}}^2, 
\]
Anderson模型中的巡游电子只有一个能带，这个能带通常在费米面附近，于是我们有
\[
    \Im \Sigma_{\text{d} \sigma}^\text{ret} = - \pi \expval*{V_{\vb*{k} \text{d}}^2}_\text{FS} N(\omega).
\]
费米子谱函数为
\[
    A_{\text{d} \sigma} = -\frac{1}{\pi} \Im G_{\text{d} \sigma}^\text{ret},
\]
它在$\omega = E_{\text{d} \sigma}$附近有峰，其它位置接近零。
由于通常能级展宽很小，在计算谱函数时假定自能中的$\omega$始终取$E_{\text{d} \sigma}$，同时将自能修正归入$E_{\text{d} \sigma}$。（$E_{\text{d} \sigma}$是做过重整化的，所以它到底取什么值根本就不知道，因此将自能实部也归入其中是合理的）
以自能虚部绝对值为能级展宽量级，记作
\begin{equation}
    \Delta = \pi \expval*{V_{\vb*{k} \text{d}}^2}_\text{FS} N(\omega),
\end{equation}
谱函数就是
\begin{equation}
    A_{\text{d}\sigma} = \frac{1}{\pi} \frac{\Delta}{(\omega-E_{\text{d}\sigma})^2 + \Delta^2}.
    \label{eq:anderson-spectral}
\end{equation}

\subsubsection{平均场自洽计算}

我们现在完成平均场计算的最后一步，即获得关于平均场序参量$\expval*{\hat{n}_{\text{d} \uparrow}}$和$\expval*{\hat{n}_{\text{d} \downarrow}}$的自洽方程。
由谱函数的性质可以计算出
\[
    \expval*{\hat{n}_{\text{d} \sigma}} = \int \dd{\omega} A_{\text{d} \sigma} f(\omega),
\]
上式与\eqref{eq:energy-d-sigma}和\eqref{eq:anderson-spectral}联立，就得到自洽方程
\begin{equation}
    \begin{aligned}
        \expval*{\hat{n}_{\text{d} \sigma}} &= \int \dd{\omega} \frac{1}{\pi} \frac{\Delta}{(\omega-E_{\text{d}\sigma})^2 + \Delta^2} f(\omega), \\
        E_{\text{d} \sigma} &= \epsilon_\text{d} + U \expval*{\hat{n}_{\text{d} (-\sigma)}}.
    \end{aligned}
\end{equation}
例如，在零温情况下，就得到自洽方程
\begin{equation}
    \expval*{\hat{n}_{\text{d} \sigma}} = \frac{1}{\pi} \arccot \left( \frac{\epsilon_{\text{d}} + U \expval*{\hat{n}_{\text{d} (-\sigma)}}}{\Delta} \right).
    \label{eq:anderson-zero-temperature-sc}
\end{equation}
这个三角超越方程难以写出解析解。为了观察它能否给出自发局域磁矩，考虑$\epsilon_{\text{d}} = - U / 2$的情况（此时实际上有电子-空穴对称性），且基态d轨道总占据数应该是1，这样
\[
    \expval*{\hat{n}_{\text{d} \uparrow}} + \expval*{\hat{n}_{\text{d} \downarrow}} = 1,
\]
我们设
\[
    \expval*{\hat{n}_{\text{d} \uparrow, \downarrow}} = \frac{1}{2} \pm x,
\]
若出现自发磁矩则$x$不为零。此时\eqref{eq:anderson-zero-temperature-sc}为
\[
    x = \frac{1}{\pi} \arctan \left( \frac{U}{\Delta} x \right).
\]
$x=0$是平凡解；当
\[
    \frac{\pi \Delta}{U} < 1
\]
时，有三个解，也即会有沿着$z$轴的局域磁矩。这是符合直觉的，因为当$\Delta$比较大，即$V_{\vb*{k} \text{d}}$比较大时，巡游电子和d轨道电子不停发生相互作用，d轨道电子的自旋会不断上下翻转，因此不应该有局域磁矩。
这和\autoref{sec:anderson-model}中的分析一致。

\subsection{Kondo效应}\label{sec:kondo-effect}

\subsubsection{Anderson单杂质模型的低能有效理论}

在\eqref{eq:impurity-anderson}中$U > \abs{\epsilon_\text{d}} \gg V$时，d轨道上通常会有单个电子，从而导致一个局域磁矩。
我们使用平均场近似得到了一些定性的结果，本节则讨论在此基础上的涨落。平均场使用相互作用的平均值代替它本身，但是在这个平均值上还有热涨落和量子涨落。
$U > \abs{\epsilon_\text{d}}$意味着空的d轨道、半满的d轨道、全满的d轨道分得非常开，因此我们只讨论仅涉及单满的d轨道的一个低能有效模型，为此需要把空的d轨道、全满的d轨道这两个态积掉，而只保留低能子空间，即半满d轨道。

使用二阶微扰论处理这个问题，此时我们的任务是找到$\hat{H}$在二阶微扰下的本征值（本征矢并不重要）。如下将Anderson模型分成两部分：
\[
    \hat{H} = \underbrace{\sum_{\vb*{k}, \sigma} (\epsilon_{\vb*{k}} - \mu) \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}}_{\hat{H}_0} + \underbrace{\sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.}}_{\hat{H}_1}.
\]
$\hat{H}_0$中巡游电子和d电子是完全解耦的。
$\hat{H}_1$会让半满的d轨道变成全满，或者让半满的d轨道变成全空，因此其一阶效应对低能有效模型没有影响。
计算到二阶微扰，使用$n$标记高能的自由度，使用希腊字母标记低能自由度，有
\[
    \mel{\alpha}{\hat{H}_\text{eff}^{(2)}}{\beta} = \sum_n \mel{\alpha}{\hat{H}_1}{n} \mel{n}{\hat{H}_1}{\beta} \frac{1}{2} \left( \frac{1}{E_\alpha - E_n} + \frac{1}{E_\beta - E_n} \right),
\]
其中等式左边的$\ket{\alpha}$、$\ket{\beta}$是微扰之后的本征态，右边的$\ket{\alpha}$和$\ket{\beta}$是微扰之前的。
画费曼图可以得到两个初末态都在低能子空间中的二阶过程：%
\footnote{由于$\hat{H}_1$给出的都是二体散射，这是非连通图，但是由于这并不是在计算散射振幅，非连通图不能随意丢弃。}%
\begin{enumerate}
    \item 自旋为$\sigma'$的d电子转化为动量为$\vb*{k}'$的巡游电子（此时d轨道空了），然后动量为$\vb*{k}$，自旋为$\sigma$的巡游电子转化为d电子；
    \item 动量为$\vb*{k}'$，自旋为$\sigma'$的巡游电子转化为d电子（于是就有了两个d电子），自旋为$\sigma$的d电子转化为动量为$\vb*{k}$的巡游电子。
\end{enumerate}
实际上还有一些初末态完全一致的过程，但它们只会给哈密顿量加上一个常数，故略去。
我们尝试写出这两个过程带来的修正。积掉高能自由度之后应该得到一个巡游电子-d电子之间的有效相互作用，这个相互作用的形式为%
\footnote{需要强调会得到巡游电子-d电子相互作用，且这是二体相互作用，是因为使用微扰论时原则上应当考虑所有可能的初态$\ket{\alpha}$和末态$\ket{\beta}$，计算出能量修正，但这样非常繁琐。
如果我们能够确定积掉高能自由度之后的有效哈密顿量中只会出现二体的巡游电子-d电子相互作用，就只需要讨论各含一个d电子和巡游电子的初末态就可以了，从而大大简化计算。
}%
\[
    \hat{H}_\text{eff int} \sim \hat{c}^\dagger_{\text{d}} \hat{c}^\dagger_{\vb*{k}} \hat{c}_{\vb*{k}} \hat{c}_{\text{d}},
\]
于是通过计算微扰后能量修正，得到过程1对应的哈密顿量修正为
\[
    \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} V_{\vb*{k}' \text{d}} V^*_{\vb*{k} \text{d}} 
    \hat{c}_{\text{d} \sigma}^\dagger \hat{c}^\dagger_{\vb*{k}' \sigma'} 
    \frac{1}{2} \left( 
        \frac{1}{(\epsilon_{\vb*{k}} + \epsilon_\text{d}) - (\epsilon_{\vb*{k}} + \epsilon_{\vb*{k}'})} + \frac{1}{(\epsilon_{\vb*{k}'} + \epsilon_\text{d}) - (\epsilon_{\vb*{k}} + \epsilon_{\vb*{k}'})} 
    \right)
    \hat{c}_{\text{d} \sigma'} \hat{c}_{\vb*{k} \sigma} ,
\]
过程2对应的哈密顿量为
\[
    \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} V_{\vb*{k} \text{d}} V_{\vb*{k}' \text{d}}^*
    \hat{c}^\dagger_{\text{d} \sigma'} \hat{c}^\dagger_{\vb*{k} \sigma}
    \frac{1}{2} \left(
        \frac{1}{(\epsilon_\text{d} + \epsilon_{\vb*{k}}) - (U + 2 \epsilon_{\text{d}})} + \frac{1}{(\epsilon_\text{d} + \epsilon_{\vb*{k}'}) - (U + 2 \epsilon_{\text{d}})}
    \right)
    \hat{c}_{\text{d} \sigma} \hat{c}_{\vb*{k}' \sigma'},
\]
于是最后有效哈密顿量为
\begin{equation}
    \begin{aligned}
        \hat{H}_\text{eff} &= \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} \\
        & + \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} V_{\vb*{k}' \text{d}}^* V_{\vb*{k} \text{d}} \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k}' \sigma'} \hat{c}^\dagger_{\text{d} \sigma'} \hat{c}_{\text{d} \sigma} 
        \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}}- \epsilon_\text{d}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_\text{d}} + \frac{1}{U + \epsilon_\text{d} - \epsilon_{\vb*{k}}} + \frac{1}{U + \epsilon_\text{d} - \epsilon_{\vb*{k}'}} \right).
    \end{aligned}
    \label{eq:effective-anderson}
\end{equation}

\eqref{eq:effective-anderson}看起来非常复杂，但实际上通过对称性的论证可以发现它可以化简为非常简单的形式。
首先d轨道电子的自旋角动量显然是
\[
    \hat{\vb*{S}}_\text{d} = \frac{1}{2} \hat{c}_{\text{d} \alpha}^\dagger \vb*{\sigma}_{\alpha \beta} \hat{c}_{\text{d} \beta},
\]
而巡游电子的自旋角动量在动量表象下，是
\[
    \hat{\vb*{S}}_{\vb*{k} \vb*{k}'} = \frac{1}{2} \hat{c}^\dagger_{\vb*{k} \alpha} \vb*{\sigma}_{\alpha \alpha'} \hat{c}_{\vb*{k}' \alpha'}.
\]
这里我们已经使用了爱因斯坦求和规则，$\alpha$和$\beta$标记了$\uparrow$和$\downarrow$两种自旋。
有效哈密顿量\eqref{eq:effective-anderson}是自旋对称的，显然它的相互作用部分只能是下面的自旋标量的函数：
\[
    \sum_{\vb*{k}, \vb*{k}'} J_{\vb*{k} \vb*{k}'} \hat{\vb*{S}}_{\vb*{k} \vb*{k}'} \cdot \hat{\vb*{S}}_\text{d},
\]
而\eqref{eq:effective-anderson}中
\[
    \hat{H}_I \sim \hat{c}^\dagger_{\vb*{k} \alpha} \hat{c}^\dagger_{\text{d} \beta} \hat{c}_{\vb*{k}' \beta} \hat{c}_{\text{d} \alpha},
\]
因此必须有
\[
    \hat{H}_I = \sum_{\vb*{k}, \vb*{k}'} J_{\vb*{k} \vb*{k}'} \hat{\vb*{S}}_{\vb*{k} \vb*{k}'} \cdot \hat{\vb*{S}}_\text{d}.
\]
泡利矩阵的点乘有下面的有用结果：
\[
    \vb*{\sigma}_{\alpha \beta} \cdot \vb*{\sigma}_{\alpha' \beta'} = 2 \delta_{\alpha \beta'} \delta_{\beta \alpha'} - \delta_{\alpha \beta} \delta_{\alpha' \beta'},
\]
于是可以计算出
\[
    \hat{\vb*{S}}_{\vb*{k} \vb*{k}'} \cdot \hat{\vb*{S}}_\text{d} = \frac{1}{2} \hat{c}^\dagger_{\vb*{k} \alpha} \hat{c}^\dagger_{\vb*{k}' \beta} \hat{c}_{\text{d} \beta} \hat{c}_{\text{d} \alpha} - \frac{1}{4} \hat{c}^\dagger_{\vb*{k} \alpha} \hat{c}_{\vb*{k}' \alpha} \hat{c}^\dagger_{\text{d} \beta} \hat{c}_{\text{d} \beta}.
\]
由于我们要考虑的是低能有效理论，在其中$\hat{c}^\dagger_{\text{d} \beta} \hat{c}_{\text{d} \beta}$几乎不变，因此它只会对$\epsilon_{\vb*{k}}$有一个常数修正。
于是我们预期，费米面附近，有效哈密顿量应该是
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \frac{1}{2} \sum_{\vb*{k}, \vb*{k}'} J_{\vb*{k} \vb*{k}'} \hat{c}^\dagger_{\vb*{k} \alpha} \hat{c}^\dagger_{\vb*{k}' \beta} \hat{c}_{\text{d} \beta} \hat{c}_{\text{d} \alpha}.
    \label{eq:kondo-from-symmetry}
\end{equation}
事实上，在费米面附近，$\epsilon_{\vb*{k}}$几乎就是化学势，于是\eqref{eq:effective-anderson}可以化成
\[
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} 
    + \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} \left( \frac{1}{\mu - \epsilon_\text{d}} + \frac{1}{U + \epsilon_\text{d} - \mu} \right) V_{\vb*{k}' \text{d}}^* V_{\vb*{k} \text{d}} \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k}' \sigma'} \hat{c}^\dagger_{\text{d} \sigma'} \hat{c}_{\text{d} \sigma}.
\]
这和我们通过对称性分析得到的\eqref{eq:kondo-from-symmetry}的形式完全一致。

实际上，在很多情况下，在坐标空间中只有两个电子足够接近才能发生相互作用，换而言之坐标空间中的相互作用系数几乎是一个$\delta$函数，于是动量空间中的相互作用系数随$\vb*{k}$的变化不大，于是可以把它看成常数。
这个常数是反比于系统体积$V$的，因为参与傅里叶变换的有两个$\hat{c}_{\vb*{k}}$，于是会加入一个$(1/\sqrt{V})^2$的因子。
这样就得到一个非常简单的有效理论：
\[
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \frac{J_0}{2V} \sum_{\vb*{k}, \vb*{k}'} \hat{c}^\dagger_{\vb*{k} \alpha} \vb*{\sigma}_{\alpha \beta} \hat{c}_{\vb*{k}' \beta} \cdot \hat{\vb*{S}}_\text{d}.
\]
其中特意保留了一个$1/2$因子是为了强调电子的自旋是$1/2$；我们已经重新定义了单粒子能量，即不失一般性地取化学势为$0$。% TODO:什么时候可以这么做？？
由于低能有效理论中d电子始终只有一个，$\epsilon_\text{d}$项是常数，故略去，就得到
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \frac{J_0}{2V} \sum_{\vb*{k}, \vb*{k}'} \hat{c}^\dagger_{\vb*{k} \alpha} \vb*{\sigma}_{\alpha \beta} \hat{c}_{\vb*{k}' \beta} \cdot \hat{\vb*{S}_\text{d}}.
\end{equation}
这就是所谓的\concept{Kondo模型}。注意Kondo模型中还是有d电子的，这个自由度没有被完全积掉（因为它提供的自旋和巡游电子的自旋之间有相互作用），但是始终只有一个d电子，它唯一可变的参数是自旋。

\subsubsection{低温下电子的散射和电阻}

在低温下，杂质对电子的散射会导致电阻随着温度下降而增加，这种反常性称为\concept{Kondo效应}。正常情况下电子的散射主要来自电子热运动，因此本来应该是越热电阻率越大。
照惯例将d电子在$x$和$y$方向上的自旋算符组合成升降算符：
\begin{equation}
    \hat{S}_\text{d}^{\pm} = \hat{S}_\text{d}^x \pm \ii \hat{S}_\text{d}^y,
\end{equation}
则Kondo模型可以改写为
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k} \sigma} + \frac{J_0}{2V} \sum_{\vb*{k}, \vb*{k}'} (
        \hat{S}_\text{d}^z (\hat{c}^\dagger_{\vb*{k} \uparrow} \hat{c}_{\vb*{k}' \uparrow} - \hat{c}^\dagger_{\vb*{k} \downarrow} \hat{c}_{\vb*{k}' \downarrow})
        + \hat{S}^+_\text{d} \hat{c}^\dagger_{\vb*{k} \downarrow} \hat{c}_{\vb*{k}' \uparrow}
        + \hat{S}^-_\text{d} \hat{c}^\dagger_{\vb*{k} \uparrow} \hat{c}_{\vb*{k}' \downarrow}
    ).
    \label{eq:kondo-spin-up-down}
\end{equation}
$\hat{S}^+_\text{d}$和$\hat{S}^-_\text{d}$项分别表示$z$方向上的自旋角动量从巡游电子传递给了d电子，或者从d电子传递给了巡游电子。

下面根据\eqref{eq:kondo-spin-up-down}计算一些散射振幅。我们需要的是跃迁概率，因此需要计算$\hat{T}$矩阵的矩阵元。以下记d电子自旋为$m_s$。
% TODO：费曼图绘制
不失一般性地假定入射巡游电子的自旋为$\uparrow$。一阶过程包括两个图，一个是入射电子自旋没有发生翻转的，一个是入射电子自旋发生了翻转的，它们展示如\autoref{fig:first-order-kondo}。
\begin{figure}
    \centering
    \subfigure[无自旋翻转]{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (o) at (0, 0);
                \node[below] at (0, 0) {$\hat{S}^z_\text{d}$};
                \vertex (b) at (2.5, 0);
                \vertex (c) at (-2.5, 2.5);
                \vertex (d) at (2.5, 2.5);
                \propag[fer] (a) to [edge label={$m$}] (o);
                \propag[fer] (o) to [edge label={$m$}] (b);
                \propag[fer] (c) to [edge label={$\vb*{k}\uparrow$}] (o);
                \propag[fer] (o) to [edge label={$\vb*{k}' \uparrow$}] (d);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure[有自旋翻转]{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (o) at (0, 0);
                \node[below] at (0, 0) {$\hat{S}^+_\text{d}$};
                \vertex (b) at (2.5, 0);
                \vertex (c) at (-2.5, 2.5);
                \vertex (d) at (2.5, 2.5);
                \propag[fer] (a) to [edge label={$m$}] (o);
                \propag[fer] (o) to [edge label={$m+1$}] (b);
                \propag[fer] (c) to [edge label={$\vb*{k}\uparrow$}] (o);
                \propag[fer] (o) to [edge label={$\vb*{k}' \downarrow$}] (d);
            \end{feynhand}
        \end{tikzpicture}
    }
    \caption{一阶Kondo散射}
    \label{fig:first-order-kondo}
\end{figure}
它们的跃迁矩阵元分别是
\begin{equation}
    T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \uparrow} = \frac{J_0 m_s}{2V}, \quad T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \downarrow} = \frac{J_0}{2V} \sqrt{\frac{3}{4} - m_s (m_s+1)}. 
\end{equation}
以上两式中没有出现任何温度依赖，因此仅考虑一阶过程得不到Kondo效应。这是合理的，因为一阶过程中没有传播子，而对温度的依赖是通过传播子引入的。
于是仅考虑一阶过程，$m_s$给定时，散射率为
\begin{equation}
    \begin{aligned}
        \Gamma(m_s) &= 2\pi \sum_{\vb*{k}'} \delta(\epsilon_{\vb*{k}'} - \epsilon_{\vb*{k}}) (\abs*{T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \uparrow}}^2 + \abs*{T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \downarrow}}^2) \\
        &= \frac{\pi N(0)}{2 V} J_0^2 \left( \frac{3}{4} - m_s \right).
    \end{aligned}
\end{equation}
第二个等号实际上做了近似：我们假定$\vb*{k}$总是出现在费米面附近，从而$\epsilon_{\vb*{k}}$就是化学势。
总的散射率就是将不同的$m_s$对应的$\Gamma$加起来。

现在考虑二阶过程。容易验证初末自旋翻转的图有4个，不翻转的图也有4个。
初末态自旋无翻转的图如\autoref{fig:second-order-no-flip-kondo}所示，初末态自旋有翻转的图如\autoref{fig:second-order-flip-kondo}所示。
\autoref{fig:second-order-no-flip-kondo}和\autoref{fig:second-order-flip-kondo}中的每一个图都有一个巡游电子/空穴传播子（d电子传播子由于d电子已经被积掉，无需考虑），由于是有限温度，巡游电子传播子带有一个因子$1-f_{\vb*{q}}$而空穴传播子带有一个因子$f_{\vb*{q}}$，直观地说，就是中间过程产生的巡游电子必须被激发到一个尚未被占据的态，而中间过程产生的空穴必须是一个已经被占据的态上的电子被打掉以后产生的。
\autoref{fig:second-order-no-flip-kondo}对应的$T$矩阵元为%
\footnote{虽然在这里费米子线组成了一个圈，但我们并没有加上一个负号。这是因为我们使用的模型中，在无相互作用时不存在d电子和巡游电子的转化，因此d电子和巡游电子可以当成两种不同的粒子，从而可以认为没有出现闭合的巡游电子线，所以不用加入负号。}%
\begin{equation}
    T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \uparrow} = \sum_{\vb*{q}} \left( \frac{J_0}{2V} \right)^2 \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}} - \epsilon_{\vb*{q}}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_{\vb*{q}}} \right) \left( \frac{3}{4} - m_s + 2 m_s f_{\vb*{q}} \right).
    \label{eq:t-2-k-temp}
\end{equation}
注意到，虽然\autoref{fig:second-order-no-flip-kondo}的前两个图的因子$f_{\vb*{q}}$和$1-f_{\vb*{q}}$相互抵消了，后两个图由于自旋变化，并不能抵消。这就引入了温度依赖。
由于我们关注低温下的散射行为，以下均假定$\vb*{k}$和$\vb*{k}'$在费米面附近，且$f_{\vb*{q}}$是简单的阶跃函数。对$\vb*{q}$的求和可以转化为积分，于是
\[
    \begin{aligned}
        \frac{1}{V} \sum_{\vb*{q}} \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}} - \epsilon_{\vb*{q}}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_{\vb*{q}}} \right) &= \int \frac{\dd[3]{\vb*{q}}}{(2\pi)^3} m \left( \frac{1}{k^2 - q^2} + \frac{1}{k'^2 - q^2} \right) \\
        &= \frac{m}{2\pi^2} \int q^2 \dd{q} \left( \frac{1}{k^2 - q^2} + \frac{1}{k'^2 - q^2} \right),
    \end{aligned}
\]
然后我们会发现\eqref{eq:t-2-k-temp}右边最后一个括号中前两项是发散的，但这是因为$J_0$实际上会随着$\vb*{k}$变化而变化；最后一项对$T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \uparrow}$的贡献就是
\[
    \begin{aligned}
        &\quad \frac{J_0^2 m m_s}{4\pi^2 V} \int_0^{k_\text{F}} q^2 \dd{q} \left( \frac{1}{k^2 - q^2} + \frac{1}{k'^2 - q^2} \right) \\
        &= \frac{J_0^2 m m_s}{4\pi^2 V} \left( - 2 k_\text{F} - \frac{k}{2} \ln \abs{\frac{k-k_\text{F}}{k+k_\text{F}}} - \frac{k'}{2} \ln \abs{\frac{k'-k_\text{F}}{k'+k_\text{F}}} \right),
    \end{aligned}
\]
严格计算所有东西太过繁琐，我们就做一个简单的数量级估计。由于是低温极限，$\epsilon_{\vb*{k}}$和$\epsilon_{\vb*{k}'}$分布在费米面附近一个厚度大体上正比于$T$的区域内，则
\[
    \abs{\frac{k^2}{2m} - \frac{k_\text{F}^2}{2m}} \sim T,
\]
于是\eqref{eq:t-2-k-temp}中的最后一项的贡献就是
\[
    \begin{aligned}
        & \sim - \frac{J_0^2 m m_s}{4\pi^2 V} k_\text{F} \ln \left( \frac{m T}{2 k_\text{F}^2} \right) \\
        & \sim N(0) \ln(\frac{T_\text{F}}{T}).
    \end{aligned}
\]
在低温下上式对数发散，因此除此以外的$T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \uparrow}$的部分都可以忽略。
类似地可以计算出
\begin{equation}
    T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \downarrow} = \sum_{\vb*{q}} \left( \frac{J_0}{2V} \right)^2 \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}} - \epsilon_{\vb*{q}}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_{\vb*{q}}} \right) (2 m_s + 1) \sqrt{\frac{3}{4} - m_s (m_s + 1)},
\end{equation}
这里没有温度依赖。

\begin{figure}
    \centering
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^z_\text{d}$};
                \node[below] at (c) {$\hat{S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s$}] (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \uparrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \uparrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^z_\text{d}$};
                \node[below] at (c) {$\hat{S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \uparrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \uparrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^+_\text{d}$};
                \node[below] at (c) {$\hat{S}^-_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s+1$}] (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \downarrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \uparrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^-_\text{d}$};
                \node[below] at (c) {$\hat{S}^+_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \downarrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s-1$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \uparrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \caption{初末态自旋无翻转的二阶过程}
    \label{fig:second-order-no-flip-kondo}
\end{figure}

\begin{figure}
    \centering
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^+_\text{d}$};
                \node[below] at (c) {$\hat{S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s+1$}] (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \downarrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \downarrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^+_\text{d}$};
                \node[below] at (c) {$\hat{S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \uparrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s+1$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \downarrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^z_\text{d}$};
                \node[below] at (c) {$\hat{S}^+_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s$}] (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \uparrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \downarrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {$\hat{S}^z_\text{d}$};
                \node[below] at (c) {$\hat{S}^+_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \downarrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \downarrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \caption{初末态自旋有翻转的二阶过程}
    \label{fig:second-order-flip-kondo}
\end{figure}

这样，$T$矩阵形如
\[
    T \sim T_0 \left( 1 + J_0 N(0) \ln(\frac{T_\text{F}}{T}) + \cdots \right),
\]
从而散射率在低温下的的数量级就是
\begin{equation}
    \Gamma \sim \Gamma_0 \left(1 + 2 J_0 N(0) \ln \frac{T_\text{F}}{T} + \cdots \right).
\end{equation}
考虑到电阻率正比于散射率，我们这就导出了低温下电阻率反常对数发散的现象。
需要注意的是，上式实际上意味着当温度非常低时算到二阶的微扰论是错误的，因为此时散射概率会超过1。
会出现这种现象的原因在于当温度变小时有效的$J_{0}^\text{eff}$实际上会变大，从而破坏微扰论的基础。
显然，只要
\begin{equation}
    J_0 N(0) \ln \frac{T_\text{F}}{T} \sim 1,
\end{equation}
那么微扰论就不再适用。对应的温度尺度
\begin{equation}
    T_\text{K} = T_\text{F} \ee^{- \frac{4}{3J_0 N(0)}}
\end{equation}
称为\concept{Kondo温度}（$3/4$的因子是更严格计算导致的）。当温度大于Kondo温度时微扰论适用，而对小于Kondo温度的系统，d电子和巡游电子强烈的自旋-自旋相互作用会导致一个巡游电子和d电子紧密地结合起来，形成一个自旋单态，从而屏蔽d电子对巡游电子的扰动，这就是所谓的\concept{Kondo屏蔽}。

\subsubsection{重整化群}

上一节中我们提到，随着温度下降——或者说随着能标下降——相互作用会增强。本节相对严格地证明这一点。
我们并不做完整的重整化群计算，而是采用一个称为\concept{Poor man's scaling}的方法。
我们将始终假定相互作用非常弱（这其实是没有道理的，因为我们想要的是相互作用如何变强，那么肯定要涉及相互作用比较强的区域；这就是poor man一词的来历——它只是一个非常粗略的结果），从而自由理论的能带宽度$2 D$标记了能标；温度$T$也标记了能标，于是我们有$T \propto D$。
当$T=T_\text{F}$时Kondo散射观察不到，实际上我们关注的问题通常都远远低于费米温度，因此可以用它做重整化群计算的起点，即
\begin{equation}
    \frac{T}{T_\text{F}} = \frac{D}{D_0}.
\end{equation}
由于假定了相互作用非常弱，我们将只计算具有如下形式的二阶费曼图：一个低能电子经过一次d电子散射，产生一个高能中间电子，然后再经过一次d电子散射产生一个低能电子。

\eqref{eq:kondo-spin-up-down}中，三个相互作用项都具有完全一样的耦合常数，这是因为我们导出\eqref{eq:kondo-spin-up-down}使用的Anderson模型是各向同性的。
本节讨论一个稍微一般一些的模型，即如下的各向异性Kondo模型：
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}^\dagger_{\vb*{k} \sigma} \hat{c}_{\vb*{k} \sigma} + \frac{1}{2V} \sum_{\vb*{k}, \vb*{k}'} (
        J_z \hat{S}_\text{d}^z (\hat{c}^\dagger_{\vb*{k} \uparrow} \hat{c}_{\vb*{k}' \uparrow} - \hat{c}^\dagger_{\vb*{k} \downarrow} \hat{c}_{\vb*{k}' \downarrow})
        + J_+ \hat{S}^+_\text{d} \hat{c}^\dagger_{\vb*{k} \downarrow} \hat{c}_{\vb*{k}' \uparrow}
        + J_- \hat{S}^-_\text{d} \hat{c}^\dagger_{\vb*{k} \uparrow} \hat{c}_{\vb*{k}' \downarrow}
    ),
\end{equation}
其中我们强行要求
\begin{equation}
    J_+ = J_- = J_\pm,
\end{equation}
从而保留有一个自旋的$\mathbb{Z}_2$对称性，即将自旋上下颠倒则什么也没有发生。于是在重整化群作用下，$\hat{c}^\dagger_\uparrow \hat{c}_\uparrow$项和$\hat{c}^\dagger_\downarrow \hat{c}_\downarrow$项的系数始终只差了一个负号，从而在讨论耦合常数变化时可以只讨论入射电子自旋向上的情况。

% TODO：化学势
现在开始积掉从$D-\abs{\var{D}}$到$D$这么多的能带中的电子自由度，以及从$-D$到$-D+\abs{\var{D}}$这么多的能带中的电子自由度。
我们考虑$J_z$的变化情况，$\var{J_z}$对应所有入射、出射电子自旋均向上的图之和，从而我们有


如果我们以\eqref{eq:kondo-spin-up-down}为起点做重整化群计算，那么无论参数如何跑动，$J_z$, $J_+$和$J_-$总是相等的。
于是参数跑动就是
\begin{equation}
    \dv{J}{\ln D} = N(0) J^2.
\end{equation}

\subsection{Anderson局域化}

\subsubsection{固体中的无序}

本节将介绍一种现象：当固体中出现无序，即平移对称性破缺时，电子会倾向于留在原地而不发生长距离跃迁。
这种现象称为\concept{Anderson局域化}。无序可以来自掺杂，也可以来自离子实实际上并没有构成晶体这一事实。
例如可以写出这样的一个带有格点无序的紧束缚模型：
\begin{equation}
    \hat{H} = - t \sum_{\pair{i, j}} (\hat{c}_i^\dagger \hat{c}_j + \text{h.c.}) + \sum_i \epsilon_i \hat{c}_i^\dagger \hat{c}_i,
    \label{eq:tight-binding-with-disorder}
\end{equation}
其中$\epsilon_i$是一个随机变量。接下来考虑这样的特例：
\begin{equation}
    \expval*{\epsilon_i} = 0, \quad \expval*{\epsilon_i^2} = W^2 \neq 0.
\end{equation}
这样，$W/t$就表征了无序的大小。在$W/t=0$时就得到一个普通的能带，而如果$W/t \gg 1$，即无序很强，则体系的哈密顿量近似为
\[
    \hat{H} = \sum_i \epsilon_i \hat{c}_i^\dagger \hat{c}_i,
\]
这样电子倾向于固定在原地，即出现局域化。另一方面，完全没有随机扰动时，电子可以自由地移动，那么随着$W/t$的增大，一定发生了某些事情，让电子从高度非定域的状态转变为高度定域的状态。

\eqref{eq:tight-binding-with-disorder}是自由理论，因此是严格可解的。通常我们会计算所谓的无序平均，即对每个可能的$\{\epsilon_i\}$构型，计算出某个物理量$O$（此处不是指可观察量算符，而是真的实行观测测得的量，如$\epsilon$给定后，某算符的期望值、方差，格林函数等），然后求出平均值$\expval*{O}$。
对一个热力学系统，如果$O$是关于系统全局的，则$O$和无序平均$\expval*{O}$大概率是非常接近的，这是等概率原理的空间版本。
例如如果我们要计算两点格林函数，就有
\[
    G^{-1}_{ij}(\omega) = \omega + t_{ij} - \epsilon_i \delta_{ij},
\]
做微扰展开（虽然是自由系统但微扰展开总是合法的），就有
\[
    G_{ij}(\omega) = \frac{1}{\omega + t_{ij}} + (- \epsilon_i \delta_{ij}) \frac{1}{\omega + t_{ij}} (- \epsilon_i \delta_{ij}) + \cdots,
\]
用格林函数计算出各种可以观测的物理量，对$\{\epsilon_i\}$求平均即可。

\subsubsection{弱局域化}

上一节并没有解释为何当无序越来越强时到底发生了什么才导致局域化。本节将提供一些物理图像。

系统中总是有大量热涨落，因此电子在长距离运动时会出现退相干。
设$l$为电子的相干长度，则参数
\begin{equation}
    \gamma = \frac{1}{\pi k_\text{F} l}
\end{equation}
表征了长距离相干性。在$\gamma$非常小时，两个杂质的间距远大于电子相关长度，因此可以使用经典模型处理问题。
这样，我们认为电子以费米速度运动，并与杂质发生弹性碰撞。于是可以认为电子在做一个随机行走，两步之间没有任何关联。
这样，两条路径之间不可能

现在假定虽然$\gamma$很小，但相干的散射还是可能的。这样两点之间的跃迁概率就会出现超越经典模型的修正。
从一个点出发经过一系列点然后又回来的路径会因为相干叠加而获得很大概率（经典概率的两倍）。

电子运动情况的空间系综平均等价于一个随机行走
% TODO
\[
    \expval*{r^2}(t) = D_0 t = \frac{l^2}{\tau} t = v_\text{F}^2 \tau t.
\]
在时间$t$内，电子经典情况下可以到达的体积为
\[
    V(t) \sim (\sqrt{D_0 t})^d = (D_0 t)^{d/2},
\]
如果其体积在一个大小为
\[
    \sim \lambda_\text{F}^{d-1} v_\text{F} \dd{t}
\]
的圆柱体中，那么在$t$到$t+\dd{t}$时间内它就可以回到原点。这样
\[
    P_{a \to a} \sim \int \frac{\lambda_\text{F}^{d-1} v_\text{F} \dd{t}}{(D_0 t)^{d/2}} 
\]
积分下限的数量级为$\tau$，因为在比这更小的时间尺度上，电子的运动只是布朗运动，不是较连续的扩散。
积分上限为退相干时间$\tau_\phi$，它也许来自电子和热化的声子的相互作用或是电子电子相互作用，无论如何都涉及一些有限温的机制。
\[
    \frac{\var{\sigma}}{\sigma_0} = - \lambda_\text{d} \begin{cases}
        \sqrt{\frac{\tau_\phi}{\tau}}, \quad &d = 1, \\
        \ln(\frac{\tau_\phi}{\tau}) , \quad &d = 2, \\
        \sqrt{\frac{\tau}{\tau_\phi}} , \quad &d = 3.
    \end{cases}
\]
当$T\to 0$时，$d=1, 2$的情况给出了缺乏物理意义的结果：电导率趋向负无穷。这意味着此时出现了局域化，并且不能使用微扰论讨论。
$d=3$时随着温度降低，电导降至零。

\subsubsection{Thouless论证和重整化群}

由于$d=1, 2$的情况是超越微扰论的，需要使用重整化群的理论来分析问题。
记归一化无量纲电导为
\begin{equation}
    g = \frac{G}{e^2 / \hbar},
\end{equation}
其中$G$为电导，它和材料的长度尺度$L$有关。将$L$看成重整化群参数，$L$增大表示往宏观性质方向移动。
这样$\beta$函数定义为
\begin{equation}
    \beta(g(L)) = \dv{\ln g}{\ln L}.    
\end{equation}

对$g \gg 1$的情况，即良导体极限，由电阻定律
\[
    g = \sigma / (e^2 / \hbar) L^{d-2},
\]
则
\[
    \beta(g) = d - 2.
\]
实际上，无序的存在会让电阻变大，电导变小，即会让$\ln g$增长得没有那么快，于是对$g$比较大的情况，我们做一阶展开：
\begin{equation}
    \beta(g) = d - 2 - c \frac{1}{g},
    \label{eq:disorder-rg-large-g}
\end{equation}
其中$c$是一个大于零的常数。

对$g \ll 1$的情况即绝缘体的情况，电导会随着系统尺度快速衰减，通常是指数衰减：
\[
    g = g_0 \ee^{- L / \xi},
\]
于是
\begin{equation}
    \beta(g) = \ln(\frac{g}{g_0}).
    \label{eq:disorder-rg-small-g}
\end{equation}
实际的$\beta$函数应该在\eqref{eq:disorder-rg-large-g}和\eqref{eq:disorder-rg-small-g}之间。
绘图可知，对$d=1, 2$的情况，$\beta$函数始终小于零，因此在$L$增大时$g$会衰减到零。换而言之，这两个情况下含有无序的固体只有一个地能有效理论，就是完全的局域化。
三维系统的$\beta$函数有一个零点$g_\text{c}$，如果一开始$g < g_\text{c}$，那么$\beta$函数始终是负的，于是重整化之后$g=0$，得到一个绝缘体相；如果一开始$g > g_\text{c}$，那么$\beta$函数始终使正的，重整化之后得到一个导体相。
换而言之$g_\text{c}$是一个相变点。

对三维情况，在相变点附加将$\beta$函数线性化，有
\begin{equation}
    \beta(g) = s \left( \frac{g - g_\text{c}}{g_\text{c}} \right),
\end{equation}
计算得到
\begin{equation}
    \frac{g(L) - g_\text{c}}{g_\text{c}} = \left( \frac{L}{} \right)
\end{equation}

\section{集体行为和相变}

本节讨论的集体行为和相变均可以通过经典的金斯堡-朗道理论加以描述。
相变的出现是因为某个对称性被破缺了，然后我们可以使用某个序参量来描述相变，而序参量的涨落就给出了相变之后产生的元激发。
我们可以使用Hubbard-Stratonovich变换将二体相互作用解耦，适当选取Hubbard-Stratonovich参量使之和序参量对应，然后积掉电子自由度和声子自由度，这样就得到了元激发的有效理论。
无论如何，序参量应该是几个电子场算符的乘积或其线性组合，元激发是序参量的涨落，即元激发实际上是多个电子（或者也许还有声子或其他粒子）的集体行为。
这个意义上，我们可以将经典的金斯堡-朗道理论描述的相变称为\concept{粒子凝聚}。

应当指出的是这个图像并不能覆盖所有相变。例如在

\subsection{一维电子系统的玻色化}

任何电子系统都可以展现出密度波，即$\expval*{\hat{c}^\dagger \hat{c}}$的长程序。实际上，一维电子系统可以完全使用它的密度波和与之紧密相关的另一个场来描述。

\subsubsection{费米点附近的有效理论}

\begin{figure}
    \centering
    \begin{tikzpicture}
        
        % 动量横轴
        \draw[->] (-4,0) -- (4,0);
        \node[right] at (4, 0) {$k$};

        % 动量零点
        \draw[dash pattern=on5pt off3pt] (0,0.7) -- (0,-0.7);
        
        % 标黑费米球
        \draw[thick] (-1.5,0) -- (1.5,0);

        % 标出费米点
        \node[dot, label=above:$k_\text{F}$] at (1.5, 0) {};
        \node[dot, label=above:$-k_\text{F}$] at (-1.5, 0) {};

    \end{tikzpicture}
    \caption{一维系统的动量空间，描黑的部分是一维费米“球”}
    \label{fig:one-dim-moment-space}
\end{figure}

考虑一个一维近独立电子系统。
一维系统的动量只有一个可能的方向。因此，一维系统的费米面无非是两个\concept{费米点}。由对称性这两个点距离动量原点的位置是相同的。
动量空间的情况展示如\autoref{fig:one-dim-moment-space}，其中描黑的部分是一维费米“球”。

考虑费米点附近的能量，做线性近似，有
\begin{equation}
    \xi_{k} = \pm v_\text{F} (k - k_\text{F}).
\end{equation}
方程前面加正负号是因为色散关系是左右对称的，所以在两个费米点处的斜率互为相反数。
从费米面以下到费米面以上能量总是增加的，于是斜率为正表示$k>0$，斜率为负表示$k<0$。

我们将讨论费米点附近的低能有效理论，则晶格上的布洛赫产生湮灭算符中只有晶格动量集中在$\abs{k_\text{F}}$附近的部分是有意义的。
由于哈密顿量中不同动量的模式无耦合，可以直接弃去高动量模式，得到有效哈密顿量为
\[
    \hat{H}_\text{eff} = \sum_{\text{$k$ near $\pm k_\text{F}$}} \xi_k \hat{c}^\dagger_{k \sigma} \hat{c}_{k \sigma} = \sum_{\text{$k$ near $k_\text{F}$}} v_\text{F} (k - k_\text{F}) \hat{c}^\dagger_{k \sigma} \hat{c}_{k \sigma} + \sum_{\text{$k$ near $-k_\text{F}$}} v_\text{F} ( - k - k_\text{F}) \hat{c}^\dagger_{k \sigma} \hat{c}_{k \sigma}  ,
\]
为了简化，记
\begin{equation}
    p = \begin{cases}
        k - k_\text{F}, \quad k > 0, \\
        k + k_\text{F} , \quad k < 0,
    \end{cases}
\end{equation}
并使用$p$来标记布洛赫模式，则
\begin{equation}
    \begin{aligned}
        \hat{H}_\text{eff} &= \sum_{\abs{p} < \Lambda} (v_\text{F} \abs{p} \hat{c}^\dagger_{ \text{L} p\sigma} \hat{c}_{\text{L} p\sigma} + v_\text{F} \abs{p} \hat{c}^\dagger_{ \text{R} p\sigma} \hat{c}_{\text{R} p\sigma}) \\
        &= \sum_{\abs{p} < \Lambda} (v_\text{F} p \hat{c}^\dagger_{ \text{L} p\sigma} \hat{c}_{\text{L} p\sigma} - v_\text{F} p \hat{c}^\dagger_{ \text{R} p\sigma} \hat{c}_{\text{R} p\sigma}),
    \end{aligned}
\end{equation}
其中$\Lambda$是一个截断参量，R和L分别表示对应的模式在$k>0$处（称为\concept{右模式}），以及对应的模式在$k<0$处（称为\concept{左模式}）。
费米海以外的右模式的$p>0$，左模式的$p < 0$。（下面会看到，这么定义是为了让以$p$为动量的对$\hat{c}_{(\text{L}, \text{R}) \sigma}$的傅里叶逆变换能够给出物理意义明确的结果）
在自由哈密顿量中不同自旋之间完全解耦，暂时只考虑一个自旋取值，于是
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\abs{p} < \Lambda} (v_\text{F} p \hat{c}^\dagger_{\text{L} p} \hat{c}_{\text{L} p} - v_\text{F} p \hat{c}^\dagger_{\text{R} p} \hat{c}_{\text{R} p}).
    \label{eq:one-dimension-linear-model}
\end{equation}
若以$p$为动量，则$\hat{c}_{\text{R} p}$在坐标空间中对应着什么？容易发现，它对应的坐标空间中的湮灭算符正是$\hat{c}_{n\sigma}$以频率$\pm k_\text{F}$在空间上振荡的振幅，即
\begin{equation}
    \hat{c}_{n\sigma} = \ee^{\ii k_\text{F} na} \hat{c}_{\text{R} n \sigma } + \ee^{ - \ii k_\text{F} na} \hat{c}_{\text{L} n \sigma},
\end{equation}
它们在空间上是缓变的。% TODO：$\hat{\psi}_{\text{R}}(x)$？？

\subsubsection{玻色化}

首先考虑右模式的电子。
按照\eqref{eq:one-dimension-linear-model}，对一个能量本征态，将一个动量为$p$的右模式电子变为动量为$p+q$的右模式电子，则得到的结果仍然是一个能量本征态，且能量上升了$v_\text{F} q$。
而由于粒子数守恒，实际上任何一个能量本征态都可以通过“让费米海中的一些电子的动量增加”构造出来。这表明“将一个动量为$p$的右模式电子变为动量为$p+q$的右模式电子”是一个准粒子模式，其产生算符大体上如下：
\[
    \hat{b}_{\text{R} q}^\dagger \sim \sum_p \hat{c}^\dagger_{\text{R} (p+q)} \hat{c}_{\text{R} p} ,
\]
但是这样$p$可以取任何大的值，而低能有效理论\eqref{eq:one-dimension-linear-model}仅仅对比较小的$p$成立。
因此不出意外会产生一个发散的问题。例如，按照\eqref{eq:one-dimension-linear-model}费米海中实际上有无限多的电子，从而不受限制的对$p$求和会导致无穷大的结果。
可以在$\hat{b}_{\text{R} q}^\dagger$的表达式中引入一个截断，但是更好的做法实际上是使用正规排序，从而将无穷大的电子数期望值去掉。我们接下来讨论怎么做到这一点。
实空间的电子数密度算符为
\[
    \hat{\rho}_\text{R}(x) = \hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(x),
\]
它在动量空间的形式为%
\footnote{它不一定就是动量为$p$的电子数。}%
\[
    \hat{\rho}_\text{R}(p) = \frac{1}{\sqrt{L}} \int \dd{x} \ee^{-\ii p x} \hat{\rho}_\text{R}(x) = \frac{1}{\sqrt{L}} \sum_k \hat{c}^\dagger_{\text{R} (k - p)} \hat{c}_{\text{R} k}.
\]
可以看到这个表达式和$\hat{b}^\dagger_{\text{R} p}$之间有线性关系，既然电子数在没有截断时发散，$\hat{b}^\dagger_{\text{R} p}$必然也发散。
为了消除掉发散，我们将$\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(x)$的基态期望值减掉，得到下面的定义。这里使用了正规序的记号是因为这个步骤等价于以电子/空穴的产生算符为产生算符，换而言之，对费米面以下的电子，要把电子湮灭算符放在左边（或者说把空穴产生算符放在左边）：
\begin{equation}
    \hat{\rho}_\text{R}(x) = \normalorder{\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(x)}, \quad \hat{\rho}_\text{R}(p) = \frac{1}{\sqrt{L}} \sum_k \normalorder{\hat{c}^\dagger_{\text{R} (k - p)} \hat{c}_{\text{R} k}}.
\end{equation}
然后很容易验证，在基态（即所有电子都在费米海中的状态）下$\hat{\rho}_\text{R}(p)$为零，这样就避免了无穷大问题。
计算对易关系得到
\[
    \comm*{\hat{\rho}_\text{R}(- p)}{\hat{\rho}_\text{R}(p)} = \frac{1}{L} \sum_{k} (\hat{c}^\dagger_{\text{R} (k + p)} \hat{c}_{\text{R} (k + p)} - \hat{c}^\dagger_{\text{R} k} \hat{c}_{\text{R} k}),
\]
此时不能简单地做变量代换，因为求和实际上带有一个截断，做变量代换则截断也会发生变化。
考虑到
\[
    \normalorder{\hat{c}^\dagger_{\text{R} k} \hat{c}_{\text{R} k}} = \hat{c}^\dagger_{\text{R} k} \hat{c}_{\text{R} k} - \expval*{\hat{c}^\dagger_{\text{R} k} \hat{c}_{\text{R} k}}_\text{GS},
\]
而正规序无需截断（因为没有发散问题），可以推导出
\[
    \comm*{\hat{\rho}_\text{R}(- p)}{\hat{\rho}_\text{R}(p)} = \frac{1}{L} \sum_{k} (\expval*{\hat{c}^\dagger_{\text{R} (k + p)} \hat{c}_{\text{R} (k + p)}}_\text{GS} - \expval*{\hat{c}^\dagger_{\text{R} k} \hat{c}_{\text{R} k}}_\text{GS}),
\]
等式右边的求和号中非零部分满足
\[
    k < 0 < k + p,
\]
并做通常的求和化积分
\[
    \frac{1}{L} \sum_k \longrightarrow \int \frac{\dd{k}}{2\pi},
\]
就得到
\[
    \comm*{\hat{\rho}_\text{R}(- p)}{\hat{\rho}_\text{R}(p)} = - \frac{p}{2\pi}.
\]
而如果$p \neq p'$，应有
\[
    \comm*{\hat{\rho}_\text{R}(- p)}{\hat{\rho}_\text{R}(p')} = 0,
\]
因为依照上面的步骤会得到的真空期望值一定是零。于是得到
\begin{equation}
    \comm*{\hat{\rho}_\text{R}(- p)}{\hat{\rho}_\text{R}(p')} = - \frac{p}{2\pi} \delta_{pp'}.
\end{equation}
这几乎就是一个玻色子对易关系了。缩放一下，定义
\begin{equation}
    \hat{b}_{\text{R} p} = \sqrt{\frac{2\pi}{p}} \hat{\rho}_\text{R}(p), \quad \hat{b}^\dagger_{\text{R} p} = \sqrt{\frac{2\pi}{p}} \hat{\rho}_\text{R}(-p),
    \label{eq:one-dim-displacement-mode}
\end{equation}
就得到了一组玻色子产生湮灭算符，它们描述的玻色子就是“将一个动量为$q$的右模式电子变为动量为$p+q$的右模式电子”这种模式。

以上讨论的都是右模式。由于动量空间左右对称，在变换
\[
    p \longrightarrow -p, \quad \text{R} \longrightarrow \text{L}
\]
下物理规律不变，于是只需要在每个关于右模式的公式中做以上代换就得到了关于左模式的公式。

容易检验可以从基态不断作用\eqref{eq:one-dim-displacement-mode}中的产生算符而获得一组基矢量，从而哈密顿量可以改写成
\begin{equation}
    \hat{H} = \sum_{p > 0} v_\text{F} p \left(\hat{b}_{\text{R} p}^\dagger \hat{b}_{\text{R} p} + \hat{b}_{\text{L} -p}^\dagger \hat{b}_{\text{L} -p} \right),
    \label{eq:one-dim-displacement-hamiltonian}
\end{equation}
其中我们忽略了一个无关紧要的能量零点变化。

\subsubsection{玻色子场论}

现在我们需要反过来做正则量子化：在已经找到了一种准粒子的产生湮灭算符之后，分析这个准粒子满足怎么样的一个场论。
定义
\begin{equation}
    \hat{\phi}_\text{R}(p) = \frac{2\pi}{\ii p} \hat{\rho}_\text{R}(p),
    \label{eq:one-dim-phi}
\end{equation}
切换到坐标空间中就是
\[
    \hat{\rho}_\text{R}(x) = \frac{1}{2\pi} \grad \phi_\text{R}(x).
\]
如果用傅里叶变换证明这个关系，需要如下做傅里叶变换：
\begin{equation}
    \hat{\phi}_\text{R} (x) = \frac{1}{\sqrt{L}} \sum_p \ee^{- \alpha \abs{p} / 2} \phi_\text{R}(p) \ee^{\ii p x} = \frac{1}{\sqrt{L}} \sum_p \ee^{- \alpha \abs{p} / 2} \frac{2\pi}{\ii p} \hat{\rho}_\text{R}(p) \ee^{\ii p x},
    \label{eq:one-dim-phi-and-rho}
\end{equation}
其中$\alpha$为一个软截断。一维系统中的傅里叶变换有时会发散，需要手动压低。

定义
\begin{equation}
    \begin{cases}
        \hat{\phi}_\text{R} = \hat{\phi} + \hat{\theta}, \\
        \hat{\phi}_\text{L} = \hat{\phi} - \hat{\theta},
    \end{cases}
\end{equation}
通过傅里叶变换和$\hat{\rho}$的对易关系可以得到
\begin{equation}
    \comm*{\hat{\phi}(x')}{\grad \hat{\theta}(x)} = -\ii \pi \delta(x' - x).
\end{equation}
因此$\phi$和$- \grad{\theta} / \pi$是一对正则变量，可以尝试构造一个关于它们的场论。

回顾哈密顿量\eqref{eq:one-dim-displacement-hamiltonian}，将\eqref{eq:one-dim-phi}和\eqref{eq:one-dim-displacement-mode}代入其中，得到
\[
    \hat{H} = \pi v_\text{F} \sum_p \left( \hat{\rho}_\text{R}(-p) \hat{\rho}_\text{R}(p) + \hat{\rho}_\text{L}(-p) \hat{\rho}_\text{L}(p) \right).
\]
将\eqref{eq:one-dim-phi-and-rho}代入上式，得到
\begin{equation}
    H = \frac{v_\text{F}}{2\pi} \int \dd{x} \left( (\grad{\phi})^2 + (\grad{\theta})^2 \right).
\end{equation}
至此我们将一维自由系统的哈密顿量写成了关于连续玻色场$\phi$和$\theta$的形式，完成了玻色化。

实际上，一维系统中处理相互作用反而是比较容易的。事实上很大一类有相互作用的体系经过玻色化之后也会得到同样的表达式
\begin{equation}
    H = \frac{v_\text{F}}{2\pi} \int \dd{x} \left( \frac{1}{K} (\grad{\phi})^2 + K (\grad{\theta})^2 \right),
    \label{eq:one-dim-bosonization-hamiltonian}
\end{equation}
其中$K$称为Luttinger参数。

例如，考虑一个排斥性的密度-密度相互作用
\begin{equation}
    \hat{H}_\text{int} = \frac{U}{2} \int \dd[3]{\vb*{r}} (\hat{\rho}_\text{R}(\vb*{r}) + \hat{\rho}_\text{L}(\vb*{r})) (\hat{\rho}_\text{R}(\vb*{r}) + \hat{\rho}_\text{L}(\vb*{r})),
\end{equation}
考虑到\eqref{eq:one-dim-phi}，就得到
\begin{equation}
    \hat{H}_\text{int} = \frac{U}{2\pi^2} \int \dd[3]{\vb*{r}} (\grad{\phi})^2.
\end{equation}
做修正
\begin{equation}
    v_\text{F}' = v_\text{F} \sqrt{1 + \frac{U v_\text{F}}{\pi}}, \quad K = \left( 1 + \frac{U v_\text{F}}{\pi} \right)^{- \frac{1}{2}},
\end{equation}
就得到了\eqref{eq:one-dim-bosonization-hamiltonian}。这也可以看成重整化导致参数跑动的一个平凡的例子。
\eqref{eq:one-dim-bosonization-hamiltonian}描述的系统称为\concept{Luttinger液体}，它不是费米液体。
我们相信它不是费米液体的理由见下一节。

\subsubsection{路径积分表述}

对\eqref{eq:one-dim-bosonization-hamiltonian}做勒让德变换，在虚时间下做路径积分，得到
\[
    \begin{aligned}
        Z &= \int \fd{\theta} \fd{\phi} \exp(- \int \dd{\tau} \int \dd{x} \frac{1}{\ii} (- \grad{\theta} / \pi) \partial_\tau \phi + \frac{v_\text{F}}{2\pi} \left( \frac{1}{K} (\grad{\phi})^2 + K (\grad{\theta})^2 \right) ) \\
        &= \int \fd{\theta} \fd{\phi} \exp(- \int \dd{\tau} \int \dd{x} \frac{\ii}{\pi} \grad{\theta} \partial_\tau \phi + \frac{v_\text{F}}{2\pi} \left( \frac{1}{K} (\grad{\phi})^2 + K (\grad{\theta})^2 \right) ).
    \end{aligned}
\]
指数中的第一项实际上给出了一个Berry相。通过将指数中的内容配方，可以得到一个标准的高斯积分，将含$\theta$的部分积掉，得到（略去了积掉$\theta$之后剩下的一个常数因子）
\begin{equation}
    \mathcal{L} = \frac{1}{2\pi v_\text{F} K} \left( (\partial_\tau \phi)^2 + v_\text{F}^2 (\grad{\phi})^2 \right) , \quad Z = \int \fd{\phi} \exp(- \int \dd{\tau} \int \dd{x} \mathcal{L} ).
\end{equation}
做长度单位变换
\[
    \frac{x}{v_\text{F}} \longrightarrow x,
\]
就得到
\begin{equation}
    \mathcal{L} = \frac{1}{2\pi K} \left( (\partial_\tau \phi)^2 + (\grad{\phi})^2 \right).
    \label{eq:one-dim-scaleless-lag}
\end{equation}
实际上，$\theta$和$\phi$是对偶的，因为在变换
\[
    \phi \longleftrightarrow \theta, \quad K \longleftrightarrow \frac{1}{K}
\]
下系统不变。因此完全可以将$\phi$积掉而留下$\theta$。

考虑一个简单的例子来展示为什么Luttinger液体不是费米液体。
在长波极限下，有
\begin{equation}
    \hat{\psi}_\text{L} \sim \ee^{\ii \phi_\text{L}(x)}.
\end{equation}
容易验证至少上式两边和$\hat{\psi}^\dagger_\text{R}$的对易关系一致。
这样，
\[
    \expval*{\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(0)} = \expval*{\ee^{\ii (\hat{\theta}(0) + \hat{\phi}(0) - \hat{\theta}(x) - \hat{\phi}(x))}}.
\]
由于是自由场，通过Wick定理可以发现
\[
    \expval{\ee^{\hat{A}}} = \ee^{\frac{1}{2} \expval*{\hat{A}^2}},
\]
于是
\[
    \expval*{\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(0)} = \exp(- \frac{1}{2} \expval{(\hat{\theta}(0) + \hat{\phi}(0) - \hat{\theta}(x) - \hat{\phi}(x))^2}).
\]
不失一般性地认为$\tau=0$，并注意到系统在变换
\[
    \tau \longrightarrow - \tau, \quad \theta \longrightarrow -\theta
\]
下不变，于是
\[
    \expval*{\hat{\theta}(x, 0) \hat{\phi}(x, 0)} = \expval*{- \hat{\theta}(x, 0) \hat{\phi}(x, 0)},
\]
即
\[
    \expval*{\hat{\theta}(x, 0) \hat{\phi}(x, 0)} = 0.
\]
因此
\[
    \expval*{\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(0)} = \exp(- \frac{1}{2} \expval{(\hat{\theta}(0) - \hat{\theta}(x))^2}) \exp(- \frac{1}{2} \expval{(\hat{\phi}(0) - \hat{\phi}(x))^2}).
\]
我们考虑接近零温的情况，此时\eqref{eq:one-dim-scaleless-lag}可以写成
\[
    \mathcal{L} = \sum_{\omega_n, k} \frac{K}{2\pi} \theta^*(k, \omega_n) (\omega_n^2 + k^2) \theta(k, \omega_n) = \sum_{\omega_n, k} \frac{1}{2\pi K} \phi^*(k, \omega_n) (\omega_n^2 + k^2) \phi(k, \omega_n),
\]
于是
\[
    \expval*{\hat{\theta}^\dagger(k, \omega_n) \hat{\theta}(k, \omega_n)} = \frac{\pi}{K (\omega_n^2 + k^2)}, \quad \expval*{\hat{\phi}^\dagger(k, \omega_n) \hat{\phi}(k, \omega_n)} = \frac{\pi K}{\omega_n^2 + k^2}.
\]
通过傅里叶逆变换得到
\[
    \frac{1}{2} \expval{(\hat{\theta}(0) - \hat{\theta}(x))^2} = \frac{\pi}{k} \int \frac{\dd{k} \dd{\theta}}{(2\pi)^2} \frac{1 - \ee^{\ii k x \cos \theta}}{k} \sim \frac{1}{2K} \ln x, \quad \abs*{x} \gg 1.
\]
最后就可以得到
\[
    \expval*{\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(0)} \sim \abs*{x}^{-\frac{1}{2}(K + \frac{1}{K})}.
\]
做傅里叶逆变换，得到$k$很小时的动量分布函数
\[
    \expval{\hat{n}_k} \sim \abs*{k}^{\frac{1}{2}(K + \frac{1}{K}) - 1}.
\]
如果$K=1$，上式右边有一个奇异性，这是费米液体的特征，因为费米面处电子数有一个跳变；但$K \neq 1$时上式右边是光滑的。这就说明了有相互作用的一维电子系统不是费米液体。

\subsection{BCS超导}

本节介绍一种常见的超导机制，即交换声子导致电子出现有效吸引相互作用而产生的BCS超导。

\subsubsection{交换声子导致的有效电子吸引相互作用}\label{sec:phonon-caused-interaction}

电子-声子相互作用的顶角为一个电子入射，一个电子出射，产生/消灭一个声子。
现在尝试积掉声子。我们先将电子场当成给定的，则可以从\eqref{eq:simple-phonon-electron-int}写出声子场加上电子-声子相互作用的虚时间作用量。本节仅考虑晶格是简单正方晶格的情况，于是没有各向异性，我们有
\[
    S_\text{ph} + S_\text{int} = \sum_{\omega_n, \vb*{q}, \lambda} \Big(
        \bar{\phi}_{\vb*{q} \lambda} (- \ii \omega_n + \omega_q) \phi_{\vb*{q} \lambda}
        + \gamma \frac{\ii q_\lambda}{\sqrt{2 M \omega_q}} (\phi_{\vb*{q} \lambda} + \bar{\phi}_{-\vb*{q} \lambda}) \underbrace{\sum_{\vb*{k}, \sigma} \bar{\psi}_{(\vb*{k} + \vb*{q}) \sigma} \psi_{\vb*{k} \sigma}}_{\rho_{\vb*{q}}}
    \Big),
\]
其中$\phi$表示声子，$\psi$表示电子。使用处理自由场受到线性激励的方法，配平方并积掉二次方项，忽略产生的因子，得到
\begin{equation}
    \begin{aligned}
        S_\text{eff} &= - \sum_{\omega_n, \vb*{q}} \frac{\gamma^2 q^2 \rho_{\vb*{q}} \rho_{-\vb*{q}}}{2 M \omega_q (\omega_q - \ii \omega_n)} 
        = - \sum_{\omega_n, \vb*{q}} \frac{\gamma^2 q^2 \rho_{\vb*{q}} \rho_{-\vb*{q}}}{2 M (\omega_q^2 + \omega_n^2)} \\ 
        &= - \frac{\gamma^2}{2 M} \sum_{\omega_n} \sum_{\vb*{q}, \vb*{k}, \vb*{k}', \alpha, \beta} \frac{q^2}{\omega_n^2 + \omega_q^2} \bar{\psi}_{(\vb*{k}+\vb*{q}) \alpha} \bar{\psi}_{(\vb*{k}' - \vb*{q}) \beta} \psi_{\vb*{k}' \beta} \psi_{\vb*{k} \alpha} .
    \end{aligned}
    \label{eq:retarded-two-electron}
\end{equation}
第二个等号是考虑到每个$\omega_n$有一个对应的$-\omega_n$而得到的。总之，电子之间可以通过交换声子来产生一个四电子相互作用。
相互作用\eqref{eq:retarded-two-electron}是推迟相互作用，因此原则上不能够仅仅使用一个哈密顿量描述。
不过，在推迟不明显时我们还是可以近似写出一个哈密顿量。这里有一个微妙的地方：\eqref{eq:retarded-two-electron}是定义在虚时间下的，即算符的时间演化为$\ee^{\omega t}$，而我们需要一个实时间下的哈密顿量，所以需要首先做频率上的Wick转动$\omega = \ii \omega_n$，得到
\[
    S_\text{eff}^\text{real} = - \frac{\gamma^2}{2 M} \int \dd{\omega} \sum_{\vb*{q}, \vb*{k}, \vb*{k}', \alpha, \beta} \frac{q^2}{- \omega^2 + \omega_q^2} \bar{\psi}_{(\vb*{k}+\vb*{q}) \alpha} \bar{\psi}_{(\vb*{k}' - \vb*{q}) \beta} \psi_{\vb*{k}' \beta} \psi_{\vb*{k} \alpha}.
\]
上式中的所有$\psi$都是$\omega$的函数，可以将它们转换到时域；我们也知道，上式的无推迟近似是它的无时间变化的傅里叶分量。
因此实际上我们只需要简单地取
\begin{equation}
    \omega = \epsilon_{\vb*{k}} - \epsilon_{\vb*{k} + \vb*{q}},
    \label{eq:phonon-introduced-omega}
\end{equation}
就得到了无推迟的近似
\begin{equation}
    \begin{aligned}
        \hat{H} &= - \frac{\gamma^2}{2 M} \sum_{\vb*{q}, \vb*{k}, \vb*{k}', \alpha, \beta} \frac{q^2}{- \omega^2 + \omega_q^2} \hat{c}^\dagger_{(\vb*{k}+\vb*{q}) \alpha} \hat{c}^\dagger_{(\vb*{k}' - \vb*{q}) \beta} \hat{c}_{\vb*{k}' \beta} \hat{c}_{\vb*{k} \alpha} \\
        &= \frac{\gamma^2}{2 M} \sum_{\vb*{q}, \vb*{k}, \vb*{k}', \alpha, \beta} \frac{q^2}{(\epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}})^2 - \omega_q^2} \hat{c}^\dagger_{(\vb*{k}+\vb*{q}) \alpha} \hat{c}^\dagger_{(\vb*{k}' - \vb*{q}) \beta} \hat{c}_{\vb*{k}' \beta} \hat{c}_{\vb*{k} \alpha}.
    \end{aligned}
\end{equation}

我们写出以下更加一般的哈密顿量：
\begin{equation}
    \hat{H}_{4\text{e}} = \frac{1}{2N} \sum_{\vb*{k}, \vb*{k}', \vb*{q}'} \sum_{\alpha, \beta} \abs{M_{\vb*{q}}}^2 \frac{\omega_{\vb*{q}}}{(\epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}})^2 - \omega_{\vb*{q}}^2} \hat{c}^\dagger_{(\vb*{k}+\vb*{q}) \alpha} \hat{c}^\dagger_{(\vb*{k}'-\vb*{q}) \beta} \hat{c}_{\vb*{k}' \beta} \hat{c}_{\vb*{k} \alpha},
    \label{eq:4-electron-interaction-by-phonon}
\end{equation}
其中$\omega_{\vb*{q}}$表示声子能量。任何更复杂的含有声子的费曼图都可以化归为二电子和声子的相互作用和一些电子相互作用的组合，因此\eqref{eq:4-electron-interaction-by-phonon}就给出了完整的没有声子的有效理论。
\eqref{eq:4-electron-interaction-by-phonon}本身是瞬时的，但即使我们不知道它来自一个推迟相互作用，\eqref{eq:4-electron-interaction-by-phonon}含有电子能量差而\eqref{eq:phonon-introduced-omega}也有这一事实也暗示它有可能实际上代表一个推迟相互作用。
另一方面，库伦势则没有推迟（当然这实际上做了近似，我们只不过不考虑相对论效应而已，但是电磁相互作用的推迟远小于声子传递导致的推迟）。

现在考虑一个低能有效理论%
\footnote{这就是超导往往发生在低温下的原因：否则没法形成电子的有效吸引，四散排斥的电子会造成很大耗散。}%
，其中我们需要考虑的过程全部发生在费米面附近，入射电子和出射电子能量都接近于$\epsilon_\text{F}$。
费米面是球形的，通过几何关系可以看出$\vb*{k} + \vb*{k}' = 0$的过程是最重要的，此时发生相互作用前两个电子始终在费米面的两端，相互作用之后两个电子还是位于费米面的两端。
这样\eqref{eq:4-electron-interaction-by-phonon}就简化为
\begin{equation}
    \hat{H}_{4\text{e}} = \frac{1}{2N} \sum_{\vb*{k}, \vb*{q}'} \underbrace{\sum_{\alpha, \beta} \abs{M_{\vb*{q}}}^2 \frac{\omega_{\vb*{q}}}{(\epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}})^2 - \omega_{\vb*{q}}^2}}_{V(\vb*{q}, \epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}})} \hat{c}^\dagger_{(\vb*{k}+\vb*{q}) \alpha} \hat{c}^\dagger_{(-\vb*{k}-\vb*{q}) \beta} \hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha}.
    \label{eq:low-energy-4-electron}
\end{equation}
由于电子能量差非常小，显然
\[
    V(\vb*{q}, \epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}}) = \abs{M_{\vb*{q}}}^2 \frac{\omega_{\vb*{q}}}{(\epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}})^2 - \omega_{\vb*{q}}^2} < 0,
\]
因此这个声子中介的相互作用是吸引相互作用。

库伦相互作用是排斥的，电-声子相互作用是吸引的；绝对强度显然是前者强。
然而，实际上库伦相互作用很容易被屏蔽，因为把低能电子看成外加电荷，那么高能电子就会来屏蔽它（见\autoref{sec:ext-charge}），因此把高能电子积掉之后得到的屏蔽库仑相互作用并不强，因此在重整化下，库仑相互作用实际上只是对电子能带的修正（这和费米液体的想法很相似：渐染地加入一个不大的相互作用仅仅会导致电子自能修正而已）。
另一方面，电-声子相互作用是不容易屏蔽的，实际上推迟相互作用就是不容易屏蔽的。
因此，\eqref{eq:low-energy-4-electron}在重整化之后是主要的电子间相互作用。
还有一种看待这个问题的方式是，电-声子相互作用会导致有效的吸引，在重整化下一个吸引相互作用通常会导致粒子配对取代单粒子自由度成为主要的自由度，因此吸引相互作用不可能只是对能带的修正；库仑相互作用在这里是排斥的，不会造成粒子配对，因此正如Hartree-Fock近似中的那样，仅仅对电子能级产生了一个修正。

声子的频率只出现在0和德拜频率$\omega_\text{D}$之间，换而言之吸引相互作用只出现在
\[
    \omega = \abs{\epsilon_{\vb*{k}} - \epsilon_{\vb*{k}+\vb*{q}}} < \omega_\text{D}
\]
时。数值计算可以表明对超导现象而言最重要的是建立起电子之间的吸引相互作用，其具体形式并不重要，这是因为会参与超导的实际上只有费米面附近的非常小的一个能量范围内的电子，因此$V$的具体形式根本不重要，实际发挥作用的只有费米面上的$V$值。
这样我们设
\begin{equation}
    V(\vb*{q}, \omega) = \begin{cases}
        - V_0, \quad \omega < \omega_\text{D}, \\
        0, \quad \omega > \omega_\text{D}
    \end{cases}.
    \label{eq:superconductive-interaction-simplified}
\end{equation}
其中$\omega_\text{D}$是一个硬截断。这是一个非常粗糙的截断，但后面会发现它是合理的。
这样整个系统的哈密顿量就是
\begin{equation}
    \hat{H} = \sum_{\vb*{k}, \alpha} (\epsilon_{\vb*{k}} - \mu) \hat{c}_{\vb*{k} \alpha}^\dagger \hat{c}_{\vb*{k} \alpha} - \frac{V_0}{2} \sum_{\vb*{k}, \vb*{q}} \sum_{\alpha, \beta} \hat{c}^\dagger_{(\vb*{k} + \vb*{q}) \alpha} \hat{c}^\dagger_{( - \vb*{k} - \vb*{q}) \beta} \hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha}.
    \label{eq:simple-super-conductive-hamiltonian}
\end{equation}
$\vb*{k}$和$\vb*{k}+\vb*{q}$都在费米面附近。

\subsubsection{库伯对}

数值计算或者手算二体问题会发现可能出现\concept{库伯对}，即一对位于费米面上的电子配对。
这种配对写成算符形式就是$\hat{c}^\dagger \hat{c}^\dagger$的形式，或者等价的$\hat{c} \hat{c}$形式。
如果其期望值不为零，那么$U(1)$对称性就破缺了，即电荷守恒对称性被破缺了（物理图像是，一部分电荷被封存到了库伯对中，不再以独立电子的形式流动）。我们会看到电荷守恒的破缺实际上是低温超导中最重要的物理。
于是，库伯对序参量的一般形式显然是$\expval*{\hat{c}_{\vb*{k}\alpha} \hat{c}_{\vb*{k}' \beta}}$。

现在我们做对称性分析。注意到时间反演对称性要求
\[
    \epsilon_{\vb*{k} \uparrow} = \epsilon_{-\vb*{k} \downarrow},
\]
而\eqref{eq:simple-super-conductive-hamiltonian}中单电子能量和自旋无关，于是
\[
    \epsilon_{\vb*{k}} = \epsilon_{-\vb*{k}}.
\]
这样就容易验证\eqref{eq:simple-super-conductive-hamiltonian}在变换$\vb*{k} \longrightarrow -\vb*{k}$下不变，这个对称性没有被破缺掉，于是
\[
    \expval*{\hat{c}_{\vb*{k}\alpha} \hat{c}_{\vb*{k}' \beta}} \propto \delta(\vb*{k} + \vb*{k}').
\]
换而言之，我们只考虑总动量为零的配对$\expval*{\hat{c}_{\vb*{k} \alpha} \hat{c}_{- \vb*{k} \beta}}$。
此外还可以发现\eqref{eq:simple-super-conductive-hamiltonian}具有自旋旋转不变性，因此相应的序参量$\expval*{\hat{c}_{\vb*{k} \alpha} \hat{c}_{- \vb*{k} \beta}}$应该是一个二分量的自旋协变的对象。二粒子配对对应的$SU(2)$的表示为
\[
    \frac{1}{2} \otimes \frac{1}{2} = 0 \oplus 1,
\]
即可能有自旋单态也可能有自旋三重态。如果该库伯对是自旋单态，那么应该有
\[
    \expval*{\hat{c}_{\vb*{k} \alpha} \hat{c}_{- \vb*{k} \beta}} \propto \epsilon_{\alpha \beta} \propto \delta_{\alpha+\beta,0},
\]
其中$\epsilon$为所谓的旋量度规；而如果该库珀对为自旋三重态，那么就应该有
\[
    \expval*{\hat{c}_{\vb*{k} \alpha} \hat{c}_{- \vb*{k} \beta}} \propto \vb*{d} \cdot \vb*{\sigma}_{\alpha \beta}.
\]
% TODO:为什么？？
最后，由于没有自旋-轨道耦合，$\expval*{\hat{c}_{\vb*{k} \alpha} \hat{c}_{- \vb*{k} \beta}}$可以写成“动量部分乘以自旋部分”的形式。
这样我们设
\[
    \expval*{\hat{c}_{\vb*{k} \alpha} \hat{c}_{- \vb*{k} \beta}} \propto \Delta(\vb*{k}).
\]
如果该库伯对是自旋单态的，那么其自旋部分是反对称的，则其轨道部分就是对称的，也即
\[
    \Delta(\vb*{k}) = \Delta(-\vb*{k}),
\]
从而可以将$\Delta(\vb*{k})$展开成一系列s波、d波等对称球谐函数的线性组合；
而如果该库伯对是自旋三重态的，那么其自旋部分就是对称的，于是轨道部分满足
\[
    \Delta(\vb*{k}) = -\Delta(-\vb*{k}),
\]
此时$\Delta(\vb*{k})$是一系列反对称球谐函数的线性组合。
容易看出单态或者三重态的出现和费米面对称性的关系，比如如果费米面不对称，那么s波配对就不能产生。

\subsubsection{平均场近似和Bogoliubov变换}

对\eqref{eq:simple-super-conductive-hamiltonian}做平均场近似，有
\[
    \begin{aligned}
        & \quad \hat{c}^\dagger_{(\vb*{k} + \vb*{q}) \alpha} \hat{c}^\dagger_{( - \vb*{k} - \vb*{q}) \beta} \hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha} \\
        &\approx \expval*{\hat{c}^\dagger_{(\vb*{k} + \vb*{q}) \alpha} \hat{c}^\dagger_{( - \vb*{k} - \vb*{q}) \beta}} \hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha} + \hat{c}^\dagger_{(\vb*{k} + \vb*{q}) \alpha} \hat{c}^\dagger_{( - \vb*{k} - \vb*{q}) \beta} \expval*{\hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha}} - \expval*{\hat{c}^\dagger_{(\vb*{k} + \vb*{q}) \alpha} \hat{c}^\dagger_{( - \vb*{k} - \vb*{q}) \beta} \hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha}},
    \end{aligned}
\]
重新选定求和哑指标，并略去对体系动力学没有影响的常数项，得到
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \alpha} (\epsilon_{\vb*{k}} - \mu) \hat{c}_{\vb*{k} \alpha}^\dagger \hat{c}_{\vb*{k} \alpha} - \frac{V_0}{2} \sum_{\vb*{k}, \vb*{k}', \alpha, \beta} \left(
        \expval*{\hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha}} \hat{c}^\dagger_{\vb*{k}' \alpha} \hat{c}^\dagger_{- \vb*{k}' \beta} + \text{h.c.} 
    \right).
\end{equation}
的确，电荷守恒对称性被破缺了，原因是电子形成库伯对之后看起来就像被“冻结”了一样，因此不再被计入$\hat{c}^\dagger$自由度中，而是被计入序参量$\expval*{\hat{c}_{-\vb*{k} \beta} \hat{c}_{\vb*{k} \alpha}}$中。

现在我们考虑单态、s波的库伯对，这样发生配对的就是一个$\vb*{k}, \uparrow$态的电子和一个$-\vb*{k}, \downarrow$态的电子，或者做一个自旋旋转。总之，序参量可以选取为
\begin{equation}
    \Delta = - \frac{V_0}{2} \sum_{\vb*{k}} (
        \expval*{\hat{c}_{-\vb*{k}\uparrow} \hat{c}_{\vb*{k} \downarrow}} - \expval*{\hat{c}_{-\vb*{k} \downarrow} \hat{c}_{\vb*{k} \uparrow}}
    ) = -V_0 \sum_{\vb*{k}} \expval*{\hat{c}_{-\vb*{k}\uparrow} \hat{c}_{\vb*{k} \downarrow}} ,
    \label{eq:superconductive-order-parameter}
\end{equation}
则可以证明
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \alpha} \xi_{\vb*{k}} \hat{c}_{\vb*{k} \alpha}^\dagger \hat{c}_{\vb*{k} \alpha} 
    + \Delta \sum_{\vb*{k}} \hat{c}_{-\vb*{k} \downarrow}^\dagger \hat{c}^\dagger_{\vb*{k} \uparrow}
    + \Delta^* \sum_{\vb*{k}} \hat{c}_{\vb*{k} \uparrow} \hat{c}_{-\vb*{k} \downarrow}.
    \label{eq:s-wave-superconductive-hamiltonian}
\end{equation}

在\eqref{eq:s-wave-superconductive-hamiltonian}中总是可以对$\hat{c}$和$\hat{c}^\dagger$做一个幺正变换，让$\Delta$为实数，因此以下假定$\Delta$为实数。
用一个幺正变换重新定义一组准粒子（这就称为\concept{Bogoliubov变换}），使这组准粒子本身是费米子，并且能够让\eqref{eq:s-wave-superconductive-hamiltonian}对角化（从而这组准粒子的能谱就是\eqref{eq:s-wave-energy-band}）。
首先我们有费米子的对易关系
\[
    \acomm*{\hat{\gamma}_{\vb*{k}_1 \alpha}}{\hat{\gamma}^\dagger_{\vb*{k}_2 \beta}} = \delta_{\vb*{k}_1 \vb*{k}_2} \delta_{\alpha \beta}, \quad \acomm*{\hat{\gamma}_{\vb*{k}_1 \alpha}}{\hat{\gamma}_{\vb*{k}_2 \beta}} = 0,
\]
并且可以看到，以下正交变换
\[
    \pmqty{\hat{\gamma}_{\vb*{k} \uparrow} \\ \hat{\gamma}^\dagger_{-\vb*{k} \downarrow}} = \pmqty{u_{\vb*{k}} & -v_{\vb*{k}} \\ v_{\vb*{k}} & u_{\vb*{k}}} \pmqty{\hat{c}_{\vb*{k} \uparrow} \\ \hat{c}^\dagger_{-\vb*{k} \downarrow}},
    \quad u_{\vb*{k}}^2 + v_{\vb*{k}}^2 = 1
\]
能够给出正确的对易关系，则可以解出
\begin{equation}
    u_{\vb*{k}} = \sqrt{\frac{E_{\vb*{k}} + \xi_{\vb*{k}}}{2 E_{\vb*{k}}}}, \quad v_{\vb*{k}} = \sqrt{\frac{E_{\vb*{k}} - \xi_{\vb*{k}}}{2 E_{\vb*{k}}}}.
\end{equation}
这就得到了Bogoliubov变换的显式形式：
\begin{equation}
    \begin{cases}
        \hat{\gamma}_{\vb*{k} \uparrow} = u_{\vb*{k}} \hat{c}_{\vb*{k} \uparrow} - v_{\vb*{k}} \hat{c}_{-\vb*{k} \downarrow}^\dagger, \\
        \hat{\gamma}_{\vb*{k} \downarrow} = u_{\vb*{k}} \hat{c}_{\vb*{k} \downarrow} + v_{\vb*{k}} \hat{c}_{-\vb*{k} \uparrow}^\dagger,
    \end{cases}
    \label{eq:bogoliubov-transform}
\end{equation}
还有它的逆变换
\begin{equation}
    \begin{cases}
        \hat{c}_{\vb*{k} \uparrow} = u_{\vb*{k}} \hat{\gamma}_{\vb*{k} \uparrow} + v_{\vb*{k}} \hat{\gamma}_{-\vb*{k} \downarrow}^\dagger, \\
        \hat{c}_{\vb*{k} \downarrow} = u_{\vb*{k}} \hat{\gamma}_{\vb*{k} \downarrow} - v_{\vb*{k}} \hat{\gamma}_{-\vb*{k} \uparrow}^\dagger.
    \end{cases}
    \label{eq:inverse-bogoliubov-transform}
\end{equation}
由于从$\hat{c}$到$\hat{\gamma}$的线性变换是一个正交变换%
\footnote{这件事不是一般成立的，有时候真的要用一个非正交变换；关键在于对易关系必须正确，不是所有的线性变换形式都能够给出正确的对易关系。}%
，\eqref{eq:s-wave-superconductive-hamiltonian}的能谱可以通过对角化矩阵的方式求出。
求解之后会发现能带为
\begin{equation}
    E_{\vb*{k}} = \pm \sqrt{ \xi_{\vb*{k}}^2 + \abs{\Delta}^2 }.
    \label{eq:s-wave-energy-band}
\end{equation}
这个结果具有粒子-空穴对称性，但是这并不具有太多物理意义，因为它实际上是对角化时交换了一对产生湮灭算符，从而把一部分粒子自由度写成了空穴而已。
\eqref{eq:s-wave-energy-band}中，序参量$\Delta$把原本发生交叉的两条能带$E=\pm \xi_{\vb*{k}}$的交叉点分开了，即打开了一个能隙。

\subsubsection{平均场自洽计算}

得到平均场理论后我们来做自洽计算。将\eqref{eq:inverse-bogoliubov-transform}代入\eqref{eq:superconductive-order-parameter}，并利用近独立电子气的数目
\[
    \expval*{\hat{\gamma}_{\vb*{k} \alpha}^\dagger \hat{\gamma}_{\vb*{k} \alpha}} = n_\text{F}(E_{\vb*{k}}) =  \frac{1}{\ee^{\beta E_{\vb*{k}}} + 1},
\]
得到
\[
    \Delta = - V_0 \sum_{\vb*{k}} u_{\vb*{k}} v_{\vb*{k}} (2 n_\text{F}(E_{\vb*{k}}) - 1).
\]
可以验证，
\[
    u_{\vb*{k}} v_{\vb*{k}} = \frac{\Delta}{2 E_{\vb*{k}}},
\]
于是最终得到
\begin{equation}
    \Delta V_0 \sum_{\vb*{k}} \frac{1}{2 E_{\vb*{k}}} \frac{\ee^{\beta E_{\vb*{k}}} - 1}{\ee^{\beta E_{\vb*{k}}} + 1} = \Delta.
    \label{eq:superconductive-self-consistency}
\end{equation}
如果$\Delta$为零，即出现超导现象，就可以把$\Delta$消掉。$E_{\vb*{k}}$依赖于$\Delta$，于是给定一个温度就可以把$\Delta$解出。

例如，在$T=0$时，我们有
\[
    1 = V_0 \sum_{\vb*{k}} \frac{1}{2 E_{\vb*{k}}} = V_0 \int \dd{\epsilon} N(\epsilon) \frac{1}{2 \sqrt{\epsilon^2 + \Delta^2}},
\]
这里我们在对单个电子的能量做积分。当然由于电子能量过高时\autoref{sec:phonon-caused-interaction}中的机制不再适用，积分能量肯定有一个截断。
\eqref{eq:superconductive-interaction-simplified}给出了截断$\omega_\text{D}$。我们假定$\omega_\text{D}$相对费米能非常小，也即发生库伯配对的电子只是费米面附近非常小的一个能量范围内的，则近似有
\[
    1 = V_0 N(0) \int_{-\omega_\text{D}}^{\omega_\text{D}} \dd{\epsilon} \frac{1}{\sqrt{\epsilon^2 + \Delta^2}} = N(0) V_0 \sinh^{-1} \left( \frac{\omega_\text{D}}{\Delta} \right) \approx N(0) V_0 \ln \frac{2 \omega_\text{D}}{\Delta},
\]
于是
\begin{equation}
    \Delta = 2 \omega_\text{D} \exp(- \frac{1}{N(0) V_0}).
\end{equation}
显然，$\Delta$对$V_0$的依赖比对$\omega_\text{D}$的依赖要强得多。这是合理的，因为$\omega_\text{D}$实际上是一个非常粗糙的硬截断。
现在我们看到，硬截断\eqref{eq:superconductive-interaction-simplified}是合理的，因为截断只是给$\Delta$提供了一个能量尺度而已，不会影响更为复杂的行为。
我们也可以看出，只要有相互作用，不管多强，都会产生一个非零的$\Delta$，因此只要有相互作用就会出现超导转变，并打开能隙。
这意味着\eqref{eq:4-electron-interaction-by-phonon}具有非微扰行为。

\eqref{eq:superconductive-self-consistency}中总是有一个平庸解$\Delta = 0$，消掉因子$\Delta$之后得到的方程就不总是有解。
消掉因子$\Delta$之后得到的方程有没有解就区分了超导相和非超导相。
现在我们计算临界温度，即$\Delta$从非零的一侧趋于零时的温度：
\[
    \begin{aligned}
        1 &= \lim_{\Delta \to 0} V_0 \sum_{\vb*{k}} \frac{1}{2 E_{\vb*{k}}} \frac{\ee^{\beta E_{\vb*{k}}} - 1}{\ee^{\beta E_{\vb*{k}}} + 1} \\
        &= V_0 \sum_{\vb*{k}} \frac{1}{2 \xi_{\vb*{k}}} \frac{\ee^{\beta \xi_{\vb*{k}}} - 1}{\ee^{\beta \xi_{\vb*{k}}} + 1} \\
        &= V_0 \int_{-\omega_\text{D}}^{\omega_\text{D}} \dd{\epsilon} N(\epsilon) \frac{1}{2 \epsilon} \frac{\ee^{\beta \epsilon} - 1}{\ee^{\beta \epsilon} + 1} \\
        &\approx V_0 N(0) \int_{0}^{\omega_\text{D}} \dd{\epsilon} \frac{1}{\epsilon} \frac{\ee^{\beta \epsilon} - 1}{\ee^{\beta \epsilon} + 1}.
    \end{aligned}
\]
最后一个积分中的因子$(\ee^{\beta \epsilon} - 1) / (\ee^{\beta \epsilon} + 1)$的作用在于在$\epsilon$接近$0$时压低$1/\epsilon$的值从而避免发散，它是一个特征尺度为$\beta$的红外截断，于是
\[
    1 \sim V_0 N(0) \int_{\beta}^{\omega_\text{D}} \dd{\epsilon} \frac{1}{\epsilon},
\]
最后得到
\begin{equation}
    T_\text{c} \sim \frac{\omega_\text{D}}{k_\text{B}} \exp \left( - \frac{1}{N(0) V_0} \right).
\end{equation}
更为精确的计算会给出
\begin{equation}
    T_\text{c} = 1.14 \frac{\omega_\text{D}}{k_\text{B}} \exp \left( - \frac{1}{N(0) V_0} \right),
\end{equation}
不过实际上以上公式自身不大，因为首先很难精确计算$V_0$，其次$V_0$的微小变化会带来很大误差。
真正会在实验上验证的通常是
\begin{equation}
    \frac{2 \Delta(T=0)}{k_\text{B} T_\text{c}} = 3.5.
\end{equation}
如果实验测量出来的比值远离3.5，那就可以确定这个超导现象不来自BCS机制。

\subsubsection{朗道-金斯堡理论}

现在我们采取另一条路，尝试直接从$U(1)$对称性被破缺这件事来获得关于超导的一些解释。
设$\Phi$为库伯对序参量，我们知道它是一个复标量场。有时称它为超导波函数，虽然它并不是任何粒子的波函数，但它服从的方程和薛定谔方程形式一致。
我们假定超导相中仅有的重要的自由度是这个序参量，其他量（比如单个电子）全部不重要。%
\footnote{这个假设是整个理论中最需要物理直觉的部分，因为并非对全部体系都有这个结论，例如做一维电子的玻色化时就不能只用一个标量场，在分析二维正方晶格的自旋波时也需要同时考虑序参量和电子。
在讨论BCS系统时能用这个假设是因为如前所述，破缺的是$U(1)$对称性，而$U(1)$对称性被破缺是因为电子在低温下配对为库伯对。
这个机制才是最关键的，因为它表明没有必要考虑单个电子的行为，电子的全部行为都被库伯对反映了，因此只需要考虑库伯对序参量即可。}%
设外加一个大小为$\vb*{A}$的磁矢势，按照规范不变性我们写下一个理论
\begin{equation}
    F = \int \dd[3]{\vb*{r}} \left( \abs*{(\grad - \ii 2 e \vb*{A}) \Phi}^2 + r \abs{\Phi}^2 + u\abs{\Phi}^4 \right).
    \label{eq:gl-theory}
\end{equation}
这里我们已经使用协变导数代替了原有的导数；系数为$2e$是因为一个库伯对带有两个负电荷，或者更加数学地说，一个库伯对包含两个湮灭算符，因此做$U(1)$变换时会有两个复数因子而不只是一个。
\eqref{eq:gl-theory}在相变点附近保证成立，一方面，相变点附近库伯对序参量不大，可以级数展开取前几项，另一方面，通过量纲分析可以发现
\[
    [\Phi] \sim [L]^{-1/2},
\]
容易验证没有提到的项在重整化不动点附近全部是不相关的，在重整化群作用下会被压低。
我们遵从做朗道-金斯堡理论时的惯例，适当调节单位制来让梯度平方项前面的系数为1。

计算\eqref{eq:gl-theory}的极小值点，可以得到
\begin{equation}
    - \frac{(\grad - \ii e \vb*{A})^2}{4 m^*} \Phi + \alpha \Phi + \beta \abs{\Phi}^2 \Phi = 0.
\end{equation}
这个方程的形式和薛定谔方程非常接近，当然这更多是对称性带来的结果，即薛定谔场也具有$U(1)$对称性。

$U(1)$对称性给出的守恒流为
\begin{equation}
    \vb*{j} \propto \Phi^* \grad{\Phi} - \Phi \grad{\Phi^*},
\end{equation}
当然这就是电流。当然，由于我们只是在做对称性分析，并不能明确地得出式子右边的系数。
上式说明超导的电流来自序参量的梯度，这和通常导电的机制（电场下费米面发生移动）不同。由于序参量是复的，即使不存在振幅输运，仅仅靠不同点相位不同就足够产生持续电流。这是一个稳态解，所以不存在能量消耗。这也就是超导体唯象地看起来似乎有某种运动全然不会受到阻碍的“反常电子”的原因。

\subsection{二维正方晶格的反铁磁长程序}

\subsubsection{二维正方晶格上的自旋}

费米子体系中可以有各种各样的密度波：自旋密度波、电荷密度波、超导配对密度波等。所谓密度波实际上就是一种长程序，它在空间中有一种周期性振荡，可以是相位的振荡也可以是大小的振荡。
也即，这样的长程序对应的序参量形如%
\footnote{请注意这个序参量实际上是一种二电子集体运动模式，即相邻的两个电子的自旋总是保持一上一下的这种运动模式。
这暗示我们，如果需要超越平均场近似的理论，只需要把这种模式定义成一个新的（玻色）场就可以。
这个技巧和一维电子系统的玻色化很相似。}%
\begin{equation}
    \Delta(\vb*{r}) \sim \Delta_0 \ee^{\ii \vb*{Q} \cdot \vb*{r}}.
\end{equation}
当然它还可以是实场，那就要加上复共轭。

现在考虑一个二维正方晶格，假定它可以有一个反铁磁相，也即，相邻格点的自旋倾向于变得反平行，或者说形成一个自旋密度波。
设系统的哈密顿量为
\begin{equation}
    \hat{H} = \sum_{\vb*{k}, \alpha} \xi_{\vb*{k}} \hat{c}_{\vb*{k} \alpha}^\dagger \hat{c}_{\vb*{k} \alpha} + J \sum_{\pair{i, j}} \hat{\vb*{S}}_i \cdot \hat{\vb*{S}}_j,
    \label{eq:2dim-square-spin}
\end{equation}
其中
\begin{equation}
    \hat{\vb*{S}}_i = \sum_{\alpha, \beta} \hat{c}^\dagger_{i \alpha} \vb*{\sigma}_{\alpha \beta} \hat{c}_{i \beta}
    \label{eq:spin-wave-order-parameter}
\end{equation}
为格点$i$的自旋矢量。设反铁磁序的序参量为$\vb*{\phi}$，一个不错的选择是
\begin{equation}
    \expval*{\hat{\vb*{S}}_i} = (-1)^i \vb*{\phi},
\end{equation}
这里的$(-1)^i$实际上是一种滥用记号：它实际上是
\[
    (-1)^i = (-1)^{i_x + i_y}
\]
的简写。为了方便起见，我们把$(i_x + i_y)$为奇数的格点的全体记为$A$，将$(i_x + i_y)$为偶数的格点的全体记为$B$，于是$A$中任何一个格点的近邻格点都在$B$中，反之亦然。
如果$\vb*{\phi}$非零，那么显然$\expval*{\hat{\vb*{S}}_i}$在$i \in A$时和$\expval*{\hat{\vb*{S}}_i}$在$i \in B$时差一个负号，即相邻的自旋一定是反向的，正好意味着形成了反铁磁序。

不失一般性地令晶格常数为1，则第一布里渊区为$[-\pi, \pi)^2$。在形成了一个完整的反铁磁序之后序参量$\Delta$的周期应该是两个格点，于是应有$\vb*{Q}=(\pi, \pi)$。

\subsubsection{平均场近似}

在\eqref{eq:2dim-square-spin}中做平均场近似
\begin{equation}
    \vb*{\hat{S}}_i \cdot \vb*{\hat{S}}_j = \expval*{\vb*{\hat{S}}_i} \cdot \vb*{\hat{S}}_j + \vb*{\hat{S}}_i \cdot \expval*{\vb*{\hat{S}}_j} - \expval*{\vb*{\hat{S}}_i} \cdot \expval*{\vb*{\hat{S}}_j},
\end{equation}
忽略平均场近似引入的常数项（我们这里不做自洽计算而只是分析相变点具有的性质），自旋相互作用项为
\[
    \begin{aligned}
        \hat{H}_\text{int} = J \sum_{\pair{i, j}} \hat{\vb*{S}}_i \cdot \hat{\vb*{S}}_j &\sim J \sum_{\pair{i, j}} (\expval*{\vb*{\hat{S}}_i} \cdot \vb*{\hat{S}}_j + \vb*{\hat{S}}_i \cdot \expval*{\vb*{\hat{S}}_j}) \\
        &= 2 J \sum_{\pair{i, j}} \expval*{\vb*{\hat{S}}_j} \cdot \vb*{\hat{S}}_i \\
        &= J \sum_i \sum_{j \in \text{nn of } i} \expval*{\vb*{\hat{S}}_j} \cdot \vb*{\hat{S}}_i,
    \end{aligned}
\]
其中nn表示“最近邻”，第二个等号中因子2消失了是因为$\pair{i, j}$对一对近邻只求和一次，而第三行中一对近邻实际上被求和了两次。
代入\eqref{eq:spin-wave-order-parameter}，注意到两个相邻格点的$(-1)^i$差一个负号，有
\[
    \begin{aligned}
        \hat{H}_\text{int} &= J \sum_i \sum_{j \in \text{nn of } i} (-1)^j \vb*{\phi} \cdot \vb*{\hat{S}}_i \\
        &= - J \sum_i (-1)^{i} \sum_{j \in \text{nn of } i} \vb*{\phi} \cdot \vb*{\hat{S}}_i,
    \end{aligned}
\]
由于系统具有自旋旋转不变性，不失一般性地要求$\vb*{\phi}$指向$z$轴，并设
\begin{equation}
    \Delta = 4 J \phi,
\end{equation}
则
\begin{equation}
    \hat{H}_\text{int} = - \sum_i (-1)^i \hat{S}_i^z \Delta = - \sum_i (-1)^i \Delta (\hat{c}_{i\uparrow}^\dagger \hat{c}_{i \uparrow} - \hat{c}_{i \downarrow}^\dagger \hat{c}_{i \downarrow}).
\end{equation}
设$\vb*{Q}=(\pi, \pi)$，则相互作用哈密顿量可以写成以下傅里叶变换的形式： 
\begin{equation}
    \hat{H}_\text{int} = - \sum_i \ee^{\ii \vb*{Q} \cdot \vb*{r}_i} \Delta (\hat{c}_{i\uparrow}^\dagger \hat{c}_{i \uparrow} - \hat{c}_{i \downarrow}^\dagger \hat{c}_{i \downarrow}) 
    = - \Delta \sum_{\vb*{k}} (\hat{c}_{(\vb*{k} + \vb*{Q})\uparrow}^\dagger \hat{c}_{\vb*{k} \uparrow} - \hat{c}_{(\vb*{k}+\vb*{Q}) \downarrow}^\dagger \hat{c}_{\vb*{k} \downarrow}).
\end{equation}
于是最后平均场哈密顿量就是
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \alpha} (\xi_{\vb*{k}} \hat{c}_{\vb*{k} \alpha}^\dagger \hat{c}_{\vb*{k} \alpha} - \alpha \Delta \hat{c}_{(\vb*{k} + \vb*{Q}) \alpha}^\dagger \hat{c}_{\vb*{k} \alpha}).
    \label{eq:2dim-square-spin-mf}
\end{equation}
这里指定$\uparrow$对应$1$，$\downarrow$对应$-1$，虽然电子的自旋为$\pm 1/2$而不是$\pm 1$。
\eqref{eq:2dim-square-spin-mf}两边乘上2，并注意对$\vb*{k}$求和等价于对$\vb*{k}+Q$求和，且$\vb*{k}$等价于$\vb*{k}+2\vb*{Q}$，\eqref{eq:2dim-square-spin-mf}给出的能谱等价于以下矩阵
\[
    \pmqty{\xi_{\vb*{k}} & - \alpha \Delta \\ - \alpha \Delta & \xi_{\vb*{k} + \vb*{Q}}}
\]
的本征值，也就是
\begin{equation}
    E_{\vb*{k}} = \frac{\xi_{\vb*{k}} + \xi_{\vb*{k} + \vb*{Q}}}{2} \pm \sqrt{\frac{(\xi_{\vb*{k}} - \xi_{\vb*{k}+\vb*{Q}})^2}{4} + \alpha^2 \Delta^2}.
\end{equation}
这样可以得到两条能带，在$\Delta$为零时它们可以交叉，在$\Delta$不为零时能带交叉的部位就打开了一个能隙。

\subsubsection{“热点”和它附近的低能有效理论}

\eqref{eq:2dim-square-spin-mf}是\eqref{eq:2dim-square-spin}在反铁磁序相的一个有效理论。反铁磁序破缺了晶格上的平移不变性，因为反铁磁序状态中每个晶格和临近的晶格的自旋差一个负号。
反铁磁序还保留了一部分平移不变性：子格点$A$和$B$上仍有平移不变性，这两个子格点对应的倒格矢都是$\vb*{Q}$。
这样，\eqref{eq:2dim-square-spin-mf}的第一布里渊区是
\[
    \abs{k_x} + \abs{k_y} \leq \pi,
\]
这是\eqref{eq:2dim-square-spin}的第一布里渊区折叠之后得到的。
布里渊区变小当然是因为原胞变大了——从单个格点变成了一个$A$格点加上一个$B$格点。

% TODO：为什么？
布里渊区折叠了，费米面交叉处打开能隙，形成一系列小费米pocket。热点附近的$\vb*{k}$和$\vb*{k} + \vb*{Q}$都在热点附近。

接下来讨论在热点附近的低能有效理论，换而言之，我们开始讨论超越平均场的物理。
需要注意的是考虑超越平均场的物理意味着将原本被忽略的涨落重新加入，这可能改变热点的位置或者甚至让热点消失（在本问题中不可能因为涨落不大，但确实有这样的体系，涨落会让平均场理论中出现的现象——如相变——消失，比如一维伊辛模型）。
因此，下面讨论的热点附近的低能有效理论建立在三个基础上：
\begin{enumerate}
    \item 费米面上存在热点，这是通过平均场理论算出来的，我们假定这个现象确实存在，而不是像一维伊辛模型一样只是幻象；
    \item 热点附近的低能有效理论是\eqref{eq:2dim-square-spin}的低能有效理论，即相互作用项一定是自旋-自旋相互作用（这并非假设，而是必然的事实）；
    \item 低能自由度是低能电子和自旋波模式这两种场（实际上这是最重要的一个假设，因为低能自由度是什么通常难以直接计算得到）。
\end{enumerate}

\eqref{eq:2dim-square-spin}中的相互作用项是一个电子和一个自旋波模式（这是玻色子）发生散射，得到另一个电子，或者也可以说是自由电子的自旋和自旋波模式的相互作用。%
\footnote{自旋波模式是一部分形成了自旋波的电子被积掉之后得到的，和未形成自旋波长程序的电子是两群不同的电子。}%
因此低能有效理论的散射项形如%
\footnote{一个可能的问题是，为什么一定保留低能电子自由度和自旋波自由度？为什么不能是自旋波自由度和密度波自由度？不考虑自旋波-密度波自由度是因为没有明确的物理机制让这两个模式发生耦合，保留低能电子自由度是因为自旋算符和电子数算符对易，但和单个费米子算符并不对易，因此可能出现费米子自由度积不掉的情况。
这和BCS理论是不一样的，在BCS理论中大量电子参与配对，以至于哪怕电子自由度积不掉，它也不会产生太大作用。}%
\[
    \hat{\phi}_{\vb*{q}} \hat{c}^\dagger_{\vb*{k}+\vb*{q}\sigma} \hat{c}_{\vb*{k}\sigma'},
\]
由于是低能有效理论，我们认为形成了一个基本上稳定的反铁磁序，于是$\vb*{q}$接近$\vb*{Q}$，而电子能量$\epsilon_{\vb*{k}}$和$\epsilon_{\vb*{k}+\vb*{q}}$都在费米面附近。
这些条件只有在热点附近才能达到。
当然由于热点是费米面交叠之后打开能隙的位置，在这附近有低能有效理论是非常合理的。
这样，一个散射过程涉及两个热点。分别用1和2标记两个热点，记它们的动量为$\vb*{K}_1$和$\vb*{K}_2$，则有
\[
    \vb*{K}_2 = \vb*{K}_1 + \vb*{Q},
\]
并重新定义$\vb*{q}$和$\vb*{k}$为它们偏离$\vb*{Q}$和$\vb*{K}_1$的大小。这样，相互作用哈密顿量就是
\[
    \hat{\vb*{\phi}}_{\vb*{q}} \cdot (\sum_{\alpha, \beta} \hat{c}^\dagger_{1(\vb*{k} + \vb*{q})\alpha} \vb*{\sigma}_{\alpha \beta} \hat{c}_{2\vb*{k} \beta} + \text{h.c.}),
\]
这里任何一个散射过程中入射电子为热点1附加，出射电子在热点2附加或相反的原因是要保证所有电子的动量都在热点附加。于是完整的有效理论的哈密顿量为
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\vb*{k}, \sigma} (\xi_{1\vb*{k}} \hat{c}^\dagger_{1\vb*{k} \sigma} \hat{c}_{1 \vb*{k} \sigma} + \xi_{2\vb*{k}} \hat{c}^\dagger_{2\vb*{k} \sigma} \hat{c}_{2 \vb*{k} \sigma}) + \hat{H}[\vb*{\phi}] + \lambda \sum_{\vb*{q}} \hat{\vb*{\phi}}_{\vb*{q}} \cdot (\sum_{\alpha, \beta} \hat{c}^\dagger_{1(\vb*{k} + \vb*{q})\alpha} \vb*{\sigma}_{\alpha \beta} \hat{c}_{2\vb*{k} \beta} + \text{h.c.}).
    \label{eq:2dim-square-spin-eff}
\end{equation}
上式中没有明确提玻色场——也就是自旋波场——的自由哈密顿量。这个自由哈密顿量通常是通过对称性分析得出的。
进一步，由于是低能理论，将$\xi_{\vb*{k}}$在费米面附近做展开，仅保留一阶项，得到
\begin{equation}
    \xi_{1\vb*{k}} = \epsilon_{\vb*{k}} - \mu = \vb*{v}_1 \cdot \vb*{k}, \quad \xi_{2\vb*{k}} = \epsilon_{\vb*{k}} - \mu = \vb*{v}_2 \cdot \vb*{k}.
\end{equation}
使用$\vb*{v}_1$和$\vb*{v}_2$来标记$\grad_{\vb*{k}}{\xi_{\vb*{k}}}$是因为如果是自由电子气，那么它们就是费米速度。

\subsubsection{朗道阻尼}

现在我们尝试把电子完全积掉，只留下玻色型的自旋波模式。需要指出的是这个操作并不总是可行的：由于自旋波模式和电子都是低能自由度，简单地积掉其中一个自由度可能不能得到一个良定义的有效理论。
实际上，对二维体系的确会有这种棘手的细节。
下面的操作都是在默认确实可以积掉电子的前提下进行的。

从\eqref{eq:2dim-square-spin-eff}可以看出，一个自旋波模式可以衰变成一对电子空穴对，或者说一个自旋波模式可以将动量转移给一个电子而得到另一个电子，而自身湮灭。
因此自旋波模式是有有限的寿命的。由费米黄金法则，一个动量为$\vb*{q}$，能量为大于零的$\omega$的自旋波模式的寿命倒数为
\[
    \begin{aligned}
        \frac{1}{\tau} &\sim 2 \lambda^2 \int \frac{\dd[2]{\vb*{k}}}{(2\pi)^2} \delta(\omega + \epsilon_{1 \vb*{k}} - \epsilon_{2 (\vb*{k} + \vb*{q})}) \theta(- \epsilon_{1 \vb*{k}}) \theta(\epsilon_{2 (\vb*{k} + \vb*{q})}) \\
        &\sim \lambda^2 \int \frac{\dd{p_1} \dd{p_2}}{(2\pi)^2 \abs*{\vb*{v}_1 \times \vb*{v}_2}} \delta(\omega + p_1 - p_2) \theta(- p_1) \theta(p_2),
    \end{aligned}
\]
其中我们设
\[
    p_1 = \vb*{v}_1 \cdot \vb*{k}, \quad p_2 = \vb*{v}_2 \cdot (\vb*{k} + \vb*{q}),
\]
我们仅考虑低能理论，因此假定入射电子在费米面以下，出射电子在费米面以上。由几何关系，
\[
    \int \frac{\dd{p_1} \dd{p_2}}{\abs*{\vb*{v}_1 \times \vb*{v}_2}} \delta(\omega + p_1 - p_2) \theta(- p_1) \theta(p_2) = \sqrt{2} \omega,
\]
$\omega < 0$的情况也是一样的。总之最后自旋波模式的寿命为
\begin{equation}
    \frac{1}{\tau} \sim \frac{\lambda^2}{\abs*{\vb*{v}_1 \times \vb*{v}_2}} \abs*{\omega} = \gamma \abs*{\omega}.
\end{equation}
在格林函数中，衰变几率对应着自能修正，会直接反映在$\vb*{\phi}$的格林函数——从而有效作用量——中，也即，自旋波模式的推迟格林函数形如
\[
    G_{\vb*{\phi}}^{-1} = \ii \gamma \abs{\omega} + \cdots = \ii  \gamma \sgn(\omega) \omega + \cdots,
\]
相应的，松原格林函数形式为%
\footnote{这里的步骤是：先做Wick转动，即$\omega = \ii \omega_n$，}%
\[
    G_{\vb*{\phi}}^{-1} = \gamma \abs{\omega_n} + \cdots.
\]
这就意味着自旋波模式的有效热力学作用量为
\begin{equation}
    \begin{aligned}
        S_\text{eff} &= \sum_{\vb*{q}, \omega_n} \vb*{\phi}(-\vb*{q}, -\omega_n) \cdot (\gamma \abs{\omega_n} + \omega_n^2 + c^2 \vb*{q}^2 ) \vb*{\phi}(\vb*{q}, \omega_n) \\
        &= \sum_{\vb*{q}, \omega_n} \vb*{\phi}^*(\vb*{q}, \omega_n) \cdot (\gamma \abs{\omega_n} + \omega_n^2 + c^2 \vb*{q}^2) \vb*{\phi}(\vb*{q}, \omega_n).
    \end{aligned}
    \label{eq:effective-spin-action}
\end{equation}
第二个等号是因为$\vb*{\phi}$是实场，因为负的动量/频率等价于取复共轭。
$\omega_n^2$项和$\vb*{q}^2$项都是对称性分析加入的项，除此以外的项在低能有效理论中并不重要。%
$\omega_n^2$项和$\vb*{k}^2$项可以容易地切换到实空间，它们分别对应着时间导数平方项$(\partial_\tau \phi)^2$和梯度平方项$(\grad{\phi})^2$，但$\abs{\omega_n}$在实空间中没有简单的形式。
不过，一个正比于$\omega_n$的项意味着实空间中有某种阻尼，这也是正确的，因为自旋波模式如前所述会衰变。这种阻尼或者衰变称为\concept{朗道阻尼}。朗道阻尼指的是没有粒子之间的相互碰撞，仅仅粒子和波强烈耦合也能够产生阻尼。

还可以通过直接计算格林函数的方式来得到$\phi$的有效理论。
这个有效理论当然取
\[
    Z_\text{eff} = \int \mathcal{D}\vb*{\phi} \ee^{- \sum_{q, \omega_n} \vb*{\phi}^*(\vb*{q}, \omega_n) G^{-1}_{\vb*{\phi}}(\vb*{q}, \omega_n) \vb*{\phi}(\vb*{q}, \omega_n)}
\]
的形式。

\subsubsection{Hertz理论}

最后我们讨论上一节得到的低能有效理论的

\section{拓扑物态}

所谓“拓扑物态”指的是由拓扑性质而不是对称性描述的特殊物态。

\subsection{量子霍尔效应}

\subsubsection{经典霍尔效应}

首先考虑经典电动力学预言的霍尔效应。在有自由载流子的固体材料中电导率是一个张量。设我们在$y$方向施加一个电场$E_y$，并施加一个在$-z$方向的磁场$B$。
设载流子为电子，则稳态时电子应当朝左运动，且
\[
    \frac{e v B}{c} = e E_y,
\]
而电流方向朝右，大小为
\[
    j_x = - n_\text{e} e v = \frac{e c n_\text{e}}{B} E_y.
\]
我们将$\sigma_{xy}$这种横向的电导称为\concept{霍尔电导}，记为
\begin{equation}
    \sigma_\text{H} = \frac{ec}{B} n_\text{e}.
\end{equation}

定义\concept{磁通量子}（它是超导中磁通量量子化的单位乘以2）
\begin{equation}
    \Phi_0 = \frac{h c}{e},
\end{equation}
一个电子绕着磁通量子整数倍的一个磁通量转一圈，不会产生可观测的效果（因为Berry相的变化是$2\pi$的整数倍）。
磁通量子是体系磁通量的一个自然的尺度。相应地，定义归一化磁通密度为
\begin{equation}
    n_{\Phi} = \frac{B}{\Phi_0},
\end{equation}
这给出了一个自然的电子数尺度，于是定义
\begin{equation}
    \nu = \frac{n_\text{e}}{n_\Phi} = \frac{n_\text{e} h c}{B e}.
\end{equation}
使用以上归一化之后的物理量，就可以写出霍尔电导为
\begin{equation}
    \sigma_\text{H} = \nu \frac{e^2}{h}.
\end{equation}
当然，到这里，$\nu$其实还是可以连续取值的。

\subsubsection{二维电子气的朗道能级}

本节给出外加磁场的二维电子气的运动状况。我们采用\concept{对称规范}，设磁场方向为$z$方向，且设
\begin{equation}
    A_x = - \frac{1}{2} B y, \quad A_y = \frac{1}{2} B x,
\end{equation}
这样通过
\[
    \vb*{B} = \curl{\vb*{A}}
\]
就得到一个$z$方向上大小为$B$的磁场。系统的哈密顿量为
\begin{equation}
    \hat{H} = \frac{\hbar^2}{2m} \left( \grad - \frac{\ii e}{\hbar c} \vb*{A} \right)^2.
    \label{eq:magnetic-hamiltonian}
\end{equation}
我们把$\hbar$放回了定义中，因为本节将需要频繁地用到这个能量尺度。
\eqref{eq:magnetic-hamiltonian}中的导数被协变导数替代了，以满足$U(1)$对称性。
通过量纲分析可以发现\eqref{eq:magnetic-hamiltonian}中有一个特征长度
\begin{equation}
    l_0 = \sqrt{\frac{\hbar c}{e B}},
\end{equation}
同时可以看出磁通量子确实是磁通量的一个尺度：
\[
    \Phi_0 = \frac{h c}{e} \sim 2 B \pi l_0^2.
\]
这样，两个方向上的协变导数为
\begin{equation}
    D_x = \partial_x + \frac{\ii}{2l_0^2} y, \quad D_y = \partial_y - \frac{\ii}{2l_0^2}x.
\end{equation}
哈密顿量就转化为
\[
    \hat{H} = - \frac{\hbar^2}{2m} (D_x^2 + D_y^2).
\]
容易验证$D_x$和$D_y$之间具有对易关系
现在定义
\begin{equation}
    D^\pm = D_x \pm \ii D_y,
\end{equation}
并定义复变量$z$为
\begin{equation}
    z = x + \ii y,
\end{equation}
则可以得到
\begin{equation}
    \comm*{D^-}{D^+} = - \frac{2}{l_0^2}.
\end{equation}
这意味着它们差一个常数就是一对升降算符。定义
\begin{equation}
    \hat{a} = \ii \frac{l_0}{\sqrt{2}} D^-,
\end{equation}
就有
\begin{equation}
    \hat{H} = \frac{\hbar^2}{m l_0^2} \left(\hat{a}^\dagger \hat{a} + \frac{1}{2} \right).
\end{equation}
因此系统具有分立的能级，称为\concept{朗道能级（Landau Lowest Level, LLL）}。
回过头看，$\frac{\hbar^2}{m l_0^2}$实际上是经典图景中电子在磁场下做匀速圆周运动的圆频率。

实际上，朗道能级对应的波函数可以写成一个全纯函数乘以一个高斯因子。设$\Psi$是基态波函数，我们做拟设
\begin{equation}
    \Psi(x, y) = f(z, z^*) \ee^{- z z^* / 4l_0^2},
    \label{eq:landau-wave-packet}
\end{equation}
由于
\[
    D^- \Psi = 0,
\]
展开计算可以发现
\[
    \partial_{z^*} f = 0,
\]
这表明$f$一定是全纯函数，即得所求证。

现在讨论朗道能级的简并度。在严格计算之前，可以大致地做一些数量级估计。
\eqref{eq:landau-wave-packet}给出了一个特征长度为$l_0$的波包。当然，将一个波包做平移之后还是可以得到一个波包。两个波包如果不重叠，就是彼此正交的系统的本征态。
这样，设体系总面积为$S$，我们可以认为体系被分割成了一系列大小为$\pi l_0^2$的圆，于是简并度为
\[
    \frac{S}{\pi l_0^2} \sim S \frac{eB}{h c} = \frac{\Phi}{\Phi_0}.
\]
其中定义
\begin{equation}
    \Phi_0 = \frac{h c}{e}
\end{equation}
为\concept{磁通量子}。

注意到由于$\Psi(\vb*{r})$可以被恰当地归一化，它在电子气占据的范围内不应该有任何奇点，于是可以做泰勒展开
\[
    f(z) = c_0 + c_1 z + c_2 z^2 + \cdots,
\]
实际上可以证明，$\{z^m \ee^{- \abs{z}^2 / 4 l_0^2}\}$构成一组完备正交基。
现在寻找波函数幅值最大的位置，即计算
\[
    \pdv{\abs{\Psi_n(\vb*{r})}^2}{r} = 0
\]
的解，其解为
\[
    r_n = \sqrt{2n} l_0.
\]
换而言之我们得到了一组年轮一样的基矢量。设基态简并度为$n$则
\[
    S = \sqrt{2n} l_0,
\]
从而
\[
    n = S \cdot \frac{eB}{\hbar c} = \frac{\Phi}{\Phi_0}.
\]

\subsubsection{整数电导平台}

实际的体系中有杂质，因此朗道能级会出现展宽，并且两个朗道能级之间的态基本上是局域化态（朗道能级中的态则比较舒展）。
换而言之，朗道能级附近的电子可以自由移动，贡献电导，而两个朗道能级之间的电子高度定域，并不贡献电导。
因此，随着电子数上升，在填充延展态时电导线性上升，而在填充定域态时电导没有变化。这就形成了\concept{电导平台}。
相应的，平台处的霍尔电导为
\[
    \sigma_\text{H} = n \frac{e^2}{h}, \quad n = 0, 1, 2, \ldots,
\]
称为\concept{整数霍尔效应}。
总之，要形成量子霍尔效应，对电导有贡献的能级必须有能隙。

这就造成了一个非常矛盾的情况：要观察到电导平台，体系必须比较“脏”，这样才能够有明确的定域态，从而形成平台；但实际上，在体系很脏时朗道能级附近的延展态也被破坏了，因此太脏的体系展现不出太多平台。
因此明显的量子霍尔效应需要体系有些脏但又不太脏。

“对电导有贡献的能级必须有能隙”还产生了一个问题：既然有能隙，那么在化学势位于能隙之中时如何形成显著的电流？
唯一的可能是，体态有能隙，但边界态没有能隙，从而边界态导电。（这还意味着一件事：体态有能隙说明体态内部的关联长度有限，因此边界态和体态相对独立）
可以从一个经典图像看到这一点：在体态中电子可以不停做圆周运动，而在边界附近电子做完半个圆周运动后被反弹，而又往前做半个圆周运动。
因此，可以形成绕着整个边界运行的（手性的）电流。边界态上如果有杂质，电子可以潜到体态中，绕过杂质，形成一个新的边界态。因此边界态上的电流是无损耗的。

关于为什么霍尔电导取非常简洁的形式（通常的电导涉及关于材料的复杂性质），\concept{Laughlin论证}给出了一个解释。
设有一个半径为$L$的圆柱体，其体态有能隙而边界态导电。
沿着它的轴向加入一个磁场，总磁通量为$\Phi$。让$\Phi$缓慢地发生变化，从零变化到$\frac{h c}{e}$，则$\Phi$变化前后圆柱体均处于同样的状态，因为绕着大小为$\frac{h c}{e}$的磁通量转一圈什么也不会发生。
磁通量的变化会导致一个电场，在边界上，我们有
\[
    2 \pi L E = - \frac{1}{c} \dv{\Phi}{t},
\]
从而
\[
    E(t) = \frac{1}{2\pi L c} \dv{\Phi}{t}.
\]
边界上的电场方向垂直轴向，从而产生一个平行于轴向的霍尔电流
\[
    I = 2 \pi L j = 2 \pi L \sigma_\text{H} E = \frac{\sigma_\text{H}}{c} \dv{\Phi}{t}.
\]
这个电流造成的电荷量变化为
\[
    \Delta Q = \int \dd{t} I = \frac{\sigma_\text{H}}{c} \Delta \Phi = \sigma_\text{H} \frac{h}{e},
\]
而由于电荷由电子携带，有
\[
    \Delta Q = me, \quad m = 0, 1, 2, \ldots,
\]
于是
\[
    \sigma_\text{H} = m \frac{e^2}{h}, \quad m = 0, 1, 2, \ldots.
\]
这就是整数阶量子霍尔效应的来源：它和体系的结构完全无关，只要体系体态有能隙，就能够得出存在整数霍尔效应的结论。

\subsubsection{$1/m$型分数量子霍尔效应}

既然Laughlin论证只能够得到整数量子霍尔效应，我们要问，分数量子霍尔效应是怎么产生的。
显然，唯一的可能是，电子之间的相互作用产生了分数阶能级。
本节讨论
\[
    \nu = \frac{1}{m}, \quad m = 1, 3, 5, \ldots
\]
型的分数量子霍尔效应，这是最简单的情况。

Laughlin通过其天才的创造，一步到位地给出了能产生分数霍尔效应的波函数：
\begin{equation}
    \Phi(z_1, \ldots, z_N) = \prod_{i < j} (z_i - z_j)^{m} \ee^{- \sum_i \abs*{z_i}^2 / 4 l_0^2}, \quad m = 1, 3, 5, \ldots.
\end{equation}
容易验证以上波函数满足交换反对称性；当$z_i$趋于$z_j$时波函数趋于零，这是库伦排斥的结果。

\subsection{Toric-code模型}

\subsubsection{Toric-code哈密顿量与解析解}

Kitaev最早提出了一种模型，作为一种可能的量子计算纠错编码，他发现这个模型放在一个环面上可以有非常有趣的结果。
然而，事后发现这个模型实际上展现出了一个拓扑序。

考虑一个正方格点，在每条边（不是每个格点！）上放有一个自旋$1/2$的粒子——比如说电子。
哈密顿量为
\begin{equation}
    \hat{H} = - \sum_s \hat{A}_s - \sum_p \hat{B}_p,
    \label{eq:toric-code-hamiltonian}
\end{equation}
其中下标$s$表示格点，$\hat{A}_s$指的是格点$s$周围的四条边上的$x$方向上的自旋算符的乘积，即
\begin{equation}
    \hat{A}_s = \prod_{i\text{ near } s} \hat{\sigma}_i^x,
\end{equation}
而$p$表示格点中的一个最小正方形，$\hat{B}_p$指的是正方形$p$的四条边上的$z$方向上的自旋算符的乘积，即
\begin{equation}
    \hat{B}_p = \prod_\text{$i$ of $p$} \hat{\sigma}_i^z.
\end{equation}

\eqref{eq:toric-code-hamiltonian}是严格可解的。
首先可以验证$\{\hat{A}_s\}$和$\{\hat{B}_p\}$构成一组对易稳定子（即平方为1的一组彼此对易的厄米算符），这样就有
\begin{equation}
    \comm*{\hat{A}_s}{\hat{H}} = \comm*{\hat{B}_p}{\hat{H}} = 0.
\end{equation}
另一方面，平方为1的厄米算符的本征值是$\pm 1$，于是我们就可以用它们的本征值$A_s = \pm 1$和$B_p = \pm 1$标记体系的能量本征态。
实际上，在热力学极限下只需要$\{A_s\}$和$\{B_p\}$就可以唯一地标记体系的能量本征态。
这是因为设体系有$N$个格点，那么有$4N/2=2N$条边，于是体系的希尔伯特空间的维数为$2^{2N}$。
$s$和$p$均有$N$个，于是所有可能的$\{A_s\}$和$\{B_p\}$的组合总数为$2^N \cdot 2^N=2^{2N}$。
这样如果不考虑边界引入的微妙之处，只需要$\{A_s\}$和$\{B_p\}$就可以唯一地标记体系的能量本征态。
很容易看出体系的基态为所有$A_s$和$B_p$均为$1$的状态，于是我们可以把$A_s$和$B_p$为$-1$的情况看成激发态。这样我们就得到了\eqref{eq:toric-code-hamiltonian}的全部能量本征态，从而完全求解出了它。

\subsubsection{环面上的情况}

为了解析求解，我们施加一个周期性边界条件，这相当于把体系放在了一个二维环面上。
此时诸$\{A_s\}$和$\{B_p\}$实际上不是彼此独立的，因为此时显然有
\[
    \prod_s \hat{A}_s = 1,
\]
因为所有的$\{A_s\}$乘起来，每一条边被乘了两边，所以一定会得到$1$。类似的有
\[
    \prod_p \hat{B}_p = 1.
\]
这两个方程要求
\begin{equation}
    \prod_{s} A_s = \prod_{p} B_p = 1.
    \label{eq:toric-code-pair-condition}
\end{equation}
这就意味着$A_s$激发和$B_p$激发必须成对出现，否则乘积将会是$-1$。我们将$A_s$激发称为e粒子，而将$B_p$激发称为m粒子，因为在某种意义上可以将$A_s$激发类比为电荷而将$B_p$激发理解为磁通量子。
这两种粒子的性质和空间的拓扑结构显然关系很大，因此称它们为拓扑激发。

两种激发成对出现的事实意味着可以使用弦算符描述它们的产生和消灭。首先考虑由一条边连接的两个格点，这条边上的$\hat{\sigma}^z_i$算符可以将这条边上的$x$方向的自旋翻转，因此它可以做到以下三件事：
\begin{itemize}
    \item 如果两个格点上原本没有e粒子，那么在两个格点上同时产生e粒子；
    \item 如果两个格点上原本都有e粒子，那么在两个格点上同时消灭e粒子； 
    \item 如果两个格点一个有e粒子一个没有，那么该e粒子将被转移到原本没有e粒子的格点上。
\end{itemize}
这样设一系列首尾相连的边$\{i\}$连接了两个格点，则弦算符
\begin{equation}
    \hat{O}_\text{e} = \prod_{i} \hat{\sigma}_i^z
\end{equation}
同样可以做到以上三件事。
同样，将以上论述中的$\hat{\sigma}^z$换成$\hat{\sigma}^x$，“格点”换成“正方形格子”，“连接两个格点的边”换成“正方形格子共享的边”（我们可以在每个正方形格子中间放置一个点，从而m粒子也定义在一个格点上），同样可以定义弦算符
\begin{equation}
    \hat{O}_\text{m} = \prod_{i} \hat{\sigma}_i^x.
\end{equation}
以上讨论的都是开放的弦，闭合的弦的行为需要具体分析，且对闭弦有
\begin{equation}
    \hat{O}_\text{e} \ket{0} = \hat{O}_\text{m} \ket{0} = \ket{0}.
\end{equation}

通过弦算符可以检查e粒子和m粒子绕对方转一圈（实际上就是使用一个闭合的弦算符作用在一个有e粒子或者m粒子的格点上），都会多出来一个$\pi$的相位，这是因为如果一个m粒子闭弦和一个e粒子开弦有单个交点，那么它们反对易（因为同一个边上的$\hat{\sigma}^x$和$\hat{\sigma}^z$反对易）。
换而言之，e粒子和m粒子均为任意子激发：这是二维的特殊现象，因为二维的环路在二维平面上它围绕的区域被挖掉一个点之后就不可缩了，因此一个粒子转一圈之后可以有一个非零相位变化。
本节涉及的激发尚为阿贝尔统计，即转一圈之后得到的量子态和转之前只差一个$U(1)$变换；还有非阿贝尔统计，即转一圈可以转移到别的量子态上。

\subsubsection{任意子表}

现在的问题是，环面上的Toric-code模型中最多能够弄出来多少任意子？显然e粒子和m粒子都是任意子，虽然两者自己满足玻色统计，但它们之间有一个非平凡的相位。
我们下面将以拓扑性质分类激发，即，拓扑性质相同的激发算作一种。
可以用两个量来标记一种激发的拓扑性质：设$M_{ab}$为$b$绕着$a$转一圈导致的复数因子，$\theta_a$指的是交换两个$a$导致的复数因子（或者说一个$a$绕着另一个$a$转半圈导致的复数因子）。这样，有
\begin{equation}
    \theta_\mathrm{e} = \theta_\mathrm{m} = 1, \quad M_\mathrm{em} = - 1.
\end{equation}
除了e粒子和m粒子以外肯定还有一种$\mathrm{\epsilon}$粒子，它是一个e粒子和m粒子聚合%
\footnote{所谓聚合指的是将两个激发放得尽可能近，从而得到的复合激发。e粒子和m粒子定义在不同的格点上，因此一个e粒子和一个m粒子的聚合就是在一个正方格子中央放置一个m粒子，在它的某个角上放置一个e粒子之后得到的激发，从远处看这近似于一个粒子。}%
而成的粒子，即
\begin{equation}
    \mathrm{\epsilon} = \mathrm{e} \otimes \mathrm{m}.
\end{equation}
可以容易地验证
\begin{equation}
    M_\mathrm{e\epsilon} = M_\mathrm{m\epsilon} = -1, \quad \theta_\mathrm{\epsilon} = -1.
\end{equation}
e粒子、m粒子和$\mathrm{\epsilon}$粒子这三种拓扑激发都只能成对出现。
除了这三种激发以外还有一些平凡的激发，比如声子之类，将它们全部记为$\mathbbm{1}$。

实际上，e粒子、m粒子和$\epsilon$粒子和$\mathbbm{1}$就是全部拓扑激发。
由于$\mathbbm{1}$无论如何绕圈都不会产生附加的相位，就有
\[
    \mathbbm{1} \otimes a = a.
\]
两个e粒子放在一起，得到的就是某个边上的$\sigma^x$发生了翻转，这是一个普通的激发；m粒子和$\mathrm{\epsilon}$粒子也是如此，于是
\[
    \mathrm{e} \otimes \mathrm{e} = \mathrm{m} \otimes \mathrm{m} = \mathrm{\epsilon} \otimes \mathrm{\epsilon} = \mathbbm{1}.
\]
上式实际上说明了一个非常重要的事实：封闭流形上无论有多少拓扑激发，这个态都可以通过对基态作用一些产生算符得到，或者等价地说改变基态上某些格点的值得到，那么如果将这些拓扑激发聚合到一起，得到的只是基态上局域的一些点被改变了，也即得到了一个平凡的激发。
总之，封闭流形上所有的拓扑激发聚合在一起，只会得到平凡的激发。这就从另一个角度解释了为什么非平凡的拓扑激发一定成对出现。
$\mathrm{\epsilon}$和e粒子聚合，就相当于两个e粒子先聚合得到一个平凡的激发，剩下一个m粒子，$\mathrm{\epsilon}$粒子和m粒子聚合则会留下一个e粒子和一个平凡的激发，于是
\[
    \mathrm{\epsilon} \otimes \mathrm{e} = \mathrm{m}, \quad \mathrm{\epsilon} \otimes \mathrm{m} = \mathrm{e}.
\]
因此，e粒子、m粒子和$\epsilon$粒子和$\mathbbm{1}$在聚合运算$\otimes$下是封闭的。

\subsubsection{四重简并和Berry相}

回忆一下，体系的希尔伯特空间维数为$2^{2N}$。当$2N-2$个边的自旋已经确定之后，系统的状态实际上已经确定了，因为约束条件\eqref{eq:toric-code-pair-condition}会确定剩下两条边的自旋。
换而言之，实际物理的希尔伯特空间维数只有$2^{2N-2}$。
这就意味着总希尔伯特空间$2^{2N}$分裂成了4支，或者说每个状态都有四重简并。
这个事实——环面上的Toric-code模型会出现基态四重简并——是\eqref{eq:toric-code-pair-condition}决定的，而\eqref{eq:toric-code-pair-condition}本身又来自环面的拓扑性质。
如果我们在哈密顿量中引入一个局部的扰动，基态能量和基态波函数显然会发生扰动，但是由于$\hat{A}$和$\hat{B}$的定义没有变化，系统拓扑没有变化，\eqref{eq:toric-code-pair-condition}也是始终成立的。
换句话说，环面上基态的四重简并是\concept{受到拓扑保护}的，局域的扰动不能让它消失。

用什么标记这四重简并？容易想到，完全可以定义一种全局性的闭弦算符，它贯穿整个环面，而由周期性边界条件它是闭弦算符。
分别沿着$x$轴和$y$轴定义
\begin{equation}
    \hat{L}^x_\text{e} = \prod_{x} \hat{\sigma}^z_i, \quad \hat{L}^x_\text{m} = \prod_{x} \hat{\sigma}^x_i,
\end{equation}
并可以验证它们和哈密顿量是对易的，且它们构成一对对易稳定子。
这就意味着它们的本征值均为$\pm 1$，这就唯一地标记了四重简并。
以上两个弦算符显然形成了某种序，但是并不是金斯堡-朗道理论中的那种局域的序，而是一种\concept{拓扑序}；相应的激发为\concept{拓扑激发}。

$\hat{L}^x_\text{e}$和$\hat{L}^x_\text{m}$将e粒子绕着$x$轴转动一圈，因此它们的本征值实际上给出了x方向类似于磁通量的一个通量，这个通量导致了一个Berry相位。

类似地还可以定义$\hat{L}^y_\text{e}$和$\hat{L}^y_\text{m}$，并且
\begin{equation}
    \acomm*{\hat{L}^x_\text{e}}{\hat{L}^y_\text{m}} = 0.
\end{equation}
我们知道
\begin{equation}
    \ket{0} = \ket{L_\text{e}^y=1, L_\text{m}^y=1},
\end{equation}
而使用这些关系可以证明，
\begin{equation}
    \begin{aligned}
        \hat{L}^x_\text{e} \ket{0} &= \ket{L_\text{e}^y=1, L_\text{m}^y=-1}, \\
        \hat{L}^x_\text{m} \ket{0} &= \ket{L_\text{e}^y=-1, L_\text{m}^y=1}, \\
        \hat{L}^x_\text{m} \hat{L}^x_\text{e} \ket{0} &= \ket{L_\text{e}^y=-1, L_\text{m}^y=-1}.
    \end{aligned}
\end{equation}
我们发现四重简并和四种基本的任意子正好能够对应上。这是拓扑序的一般特征：基态简并和任意子有对应，基态简并数目就是任意子数目的亏格次方。
我们这里是在亏格（洞的数目）为1的环面上工作，因此基态简并的数目为$4^1=4$种。
如果在亏格为0的球面上，基态简并的数目就是$4^0=1$种。
还有另一种方法也可以推导出这个结果。设亏格为$g$，由欧拉公式
\[
    V - E + F = 2 - 2g,
\]
于是
\[
    E - (V + F - 2) = 2g.
\]
而$V$是$A_s$格点的数目，$F$是$B_p$格点的数目，再减去\eqref{eq:toric-code-pair-condition}造成的两个约束，则$V+F-2$是一个二维表面Toric-code态的自由度个数。
Toric-code模型总的自由度个数为$E$，因此有$2g$个自由度用于标记简并态，由于每个自由度有两个取值，简并度为
\[
    2^{2g} = 4^g.
\]

\subsection{一维拓扑超导体}

\subsubsection{Kitaev链及其解析解}

以下一维模型称为\concept{Kitaev链}：
\begin{equation}
    \hat{H} = - t \sum_i (\hat{c}_i^\dagger \hat{c}_{i+1} + \text{h.c.}) - \mu \sum_i \hat{c}_i^\dagger \hat{c}_i + \sum_i (\Delta \hat{c}_i \hat{c}_{i+1} + \text{h.c.} ).
    \label{eq:kitaev-chain-hamiltonian}
\end{equation}
\eqref{eq:kitaev-chain-hamiltonian}是一个p波超导模型，这个模型通常是这么来的：一个一维纳米线被放置在一个超导体上，两者的相互作用诱导前者也发生$U(1)$对称性破缺，然后我们使用平均场理论分析问题而引入一个$\Delta$参量。
\eqref{eq:kitaev-chain-hamiltonian}是一个紧束缚模型，
对\eqref{eq:kitaev-chain-hamiltonian}做傅里叶变换，可以得到
\begin{equation}
    \hat{H} = \frac{1}{2} \sum_{\vb*{k}} \underbrace{\pmqty{\hat{c}^\dagger_{\vb*{k}} & \hat{c}_{-\vb*{k}}}}_{\hat{\Psi}^\dagger} \pmqty{\epsilon_{\vb*{k}} - \mu & -2 \ii \Delta^* \sin k \\ 2 \ii \Delta \sin k & - \epsilon_{\vb*{k}} + \mu} \underbrace{\pmqty{\hat{c}_{\vb*{k}} \\ \hat{c}^\dagger_{-\vb*{k}}}}_{\hat{\Psi}},
\end{equation}
然后再做Bogoliubov变换，计算出以下能谱：
\begin{equation}
    E_{\vb*{k}} = \pm \sqrt{(2t \cos k - \mu)^2 + 4 \abs{\Delta}^2 \sin^2 k}.
\end{equation}

\eqref{eq:kitaev-chain-hamiltonian}具有粒子-空穴对称性。% TODO
总之就有一个约束就是设$P$为粒子空穴变换，我们有
\[
    P \hat{\Psi}_{\vb*{k}} P^{-1} = \tau^* \hat{\Psi}_{-\vb*{k}}^*
\]

Kitaev链不存在对称性自发破缺，但能隙可开可闭。当
\begin{equation}
    \mu = \pm 2t
    \label{eq:kitaev-gap-point}
\end{equation}
时，能隙会关闭。除此之外任何参数的变动都只会引起连续的变化。
因此，如果体系发生相变，那么只能是在\eqref{eq:kitaev-gap-point}处发生一个和对称性无关的相变。在化学势很低时，即$\mu$趋于负无穷时，根本就没有电子，因此从$-\infty$到$-2t$的部分肯定是平庸的。
化学势非常高时（大于$2t$时）电子全满，同样是平庸的。
因此有趣的行为集中在$-2t$到$2t$之间。下面会看到，当$\mu$越过\eqref{eq:kitaev-gap-point}这两个点时，会发生一个拓扑相变。

$W = \pm 1$，这是一个定义在立体中的量？

\subsubsection{Kitaev链中的拓扑不变量}

下面定义一个能带的拓扑不变量。

总之，当$\mu$扫过$\mu=-2t$时，我们有
\[
    \hat{c}_i = \frac{1}{2} (\hat{\gamma}_{i\text{A}} + \ii \hat{\gamma}_{i \text{B}}),
\]
容易验证均为
\begin{equation}
    \acomm*{\hat{\gamma}_\alpha}{\hat{\gamma}_\beta^\dagger} = 2 \delta_{\alpha \beta},
\end{equation}

\subsubsection{时间反演对称性保护的拓扑超导}

刚才描述的拓扑超导和对称性没有特别明确的对称性。当然可以说它有粒子-空穴对称性，但是这完全是一个数学上的处理。

\end{document}