\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
%\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
%\preauthor{\vspace{-10pt}\begin{center}}
%\postauthor{\par\end{center}}

% More compact lists 
\setlist[itemize]{
    itemindent=17pt, 
    leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}
\newtcbtheorem[number within=section]{info}{Info}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}

\newenvironment{shelldisplay}{\begin{lstlisting}}{\end{lstlisting}}

\title{Homework 3}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\paragraph{Problem 1} 

\paragraph{Solution} \begin{itemize}
\item[(a)] The conjugate momentum of $\theta$ is 
\begin{equation}
    p = \pdv{L}{\dot{\theta}}
    = V \left( \frac{\dot{\theta}}{U_0} - \frac{\mu}{U_0} \right),
\end{equation}
and therefore 
\begin{equation}
    \dot{\theta} = \frac{U_0}{V} p + \mu.
\end{equation}
The Hamiltonian is 
\begin{equation}
    \begin{aligned}
        H &= p \dot{\theta} - L \\
        &= p \left( \frac{U_0}{V} p + \mu \right) - 
        V \left( 
            \frac{1}{2U_0} \left( \frac{U_0}{V} p + \mu \right)^2 
            - \frac{\mu}{U_0} \left( \frac{U_0}{V} p + \mu \right) 
        \right) \\ 
        &= \frac{1}{2} \frac{U_0}{V} \left( p + \frac{\mu V}{U_0} \right)^2.
    \end{aligned}
\end{equation}
In Heisenberg's picture, the variance of $\theta$ can be evaluated in the follows.
We know 
\[
    \begin{aligned}
        \dv{\theta^2}{t} &= \frac{1}{\ii} \comm{\theta^2}{H} \\
        &= \frac{U_0}{2 \ii V} \comm{\theta^2}{\left( p + \frac{\mu V}{U_0} \right)^2} \\
        &= \frac{U_0}{V} \left(
            \theta \left( p + \frac{\mu V}{U_0} \right)
            + \left( p + \frac{\mu V}{U_0} \right) \theta
        \right),
    \end{aligned}
\]
and therefore 
\begin{equation}
    \begin{aligned}
        \dv[2]{\theta^2}{t} &= \frac{U_0}{V} \left(
            \dot{\theta} \left( p + \frac{\mu V}{U_0} \right)
            + \theta \dot{p} 
            + \dot{p} \theta + 
            \left(p + \frac{\mu V}{U_0}\right) \dot{\theta} 
        \right) \\
        &= \frac{2 U_0^2}{V^2} \left( p + \frac{\mu V}{U_0} \right)^2.
    \end{aligned}
    \label{eq:eom-sigma-op}
\end{equation}
Here we use the EOMs 
\begin{equation}
    \dot{\theta} = \frac{1}{\ii} \comm{\theta}{H} = \frac{U_0}{V} \left( p + \frac{\mu V}{U_0} \right),
    \quad \dot{p} = 0.
\end{equation}
From \eqref{eq:eom-sigma-op}, we have 
\begin{equation}
    \dv[2]{\sigma_\theta^2}{t} = 
    \dv[2]{t} (\expval*{\theta^2} - \expval*{\theta}^2) 
    = \frac{4 U_0}{V} E - \frac{2 U_0}{V} \expval*{\theta} \left( \expval*{p} + \frac{\mu V}{U_0} \right).
\end{equation}
Assuming the wave packet doesn't move,
we have 
\begin{equation}
    \dv[2]{\sigma_\theta^2}{t} = \frac{4 U_0}{V} E,
\end{equation}
and therefore 
\begin{equation}
    \sigma_\theta = \sqrt{ \frac{2 U_0}{V} E t^2 + \sigma_\theta^2(0) }.
\end{equation}
The speed sound is 
\begin{equation}
    v = \sqrt{\frac{\rho_0 U_0}{m}},
\end{equation}
so 
\begin{equation}
    \sigma_\theta = \sqrt{ \frac{2 U_0}{V} E t^2 + \sigma^2 } 
    = \sqrt{ \frac{2 E m v^2 t^2}{\rho_0 V} + \sigma^2 },
\end{equation}
and the time it takes to have $\sigma_\theta = 2 \pi$ is 
\begin{equation}
    t = \sqrt{\frac{\rho_0 V}{2 E mv^2} (4\pi^2 - \sigma^2 )}.
\end{equation}

\item[(b)] 

\end{itemize}

\paragraph{Problem 2} 

\paragraph{Solution} \begin{itemize}
\item[(a)] Repeating the procedure used in ordinary superfluid, we do the decomposition
\begin{equation}
    \varphi = \sqrt{\rho} \ee^{\ii \theta} = \sqrt{\rho_0 + \var{\rho}} \ee^{\ii \theta},
\end{equation}
and therefore 
\begin{equation}
    - \frac{\varphi^* \laplacian \varphi}{2m} = 
    \frac{\rho}{2m} (\grad{\theta})^2 + \frac{(\grad{\rho})^2}{8 \rho m} ,
\end{equation}
\begin{equation}
    \varphi^* \partial_\tau \varphi 
    = \underbrace{\frac{1}{2} \partial_\tau \rho}_{\text{time derivative, ignored}} + 
    \ii \rho \partial_\tau \theta,
\end{equation}
\begin{equation}
    \abs{\varphi(\vb*{x})} U(\vb*{x} - \vb*{y}) \abs{\varphi(\vb*{y})} = 
    \rho(\vb*{x}) U(\vb*{x} - \vb*{y}) \rho(\vb*{y}),
\end{equation}
the theory is now 
\begin{equation}
    S = \int \dd{\tau} \left(
        \int \dd[d]{\vb*{x}} \left(
            \ii \rho \partial_\tau \theta 
            + \frac{\rho}{2m} (\grad{\theta})^2 + \frac{(\grad{\rho})^2}{8 \rho m}
            - \mu \rho
        \right) + 
        \frac{1}{2} \int \dd[d]{\vb*{x}} \int \dd[d]{\vb*{y}}
        \rho(\vb*{x}) U(\vb*{x} - \vb*{y}) \rho(\vb*{y})
    \right).
\end{equation}
Around the ground state, we have 
(note that since we are around a saddle point,
the sum of all terms containing $\var{\rho}$ only is always zero;
the resulting theory has the form of $c_1 \var{\rho} \partial_\tau \theta + c_2 \var{\rho}^2$;
the chemical potential term is therefore missing in the theory around the saddle point)
\[
    \ii \rho \partial_\tau \theta = \underbrace{\ii \rho_0 \partial_\tau \theta}_{\text{time derivative}} 
    + \ii \var{\rho} \partial_\tau \theta,
\]
and since $\grad{\rho} = \grad{\var{\rho}}$,
we have 
\[
    \frac{(\grad{\rho})^2}{8 \rho m} \approx \frac{(\grad{\var{\rho}})^2}{8 \rho_0 m},
\]
ignoring the fluctuation of the $\rho$ in the denominator.
Similarly, since we are working on a low energy theory,
the fluctuation of $\theta$ shouldn't be large,
and we have 
\[
    \frac{\rho}{2m} (\grad{\theta})^2 \approx \frac{\rho_0}{2m} (\grad{\theta})^2.
\]
The theory is then 
\begin{equation}
    S = \int \dd[d+1]{x} \left(
        \frac{\rho_0}{2m} (\grad{\theta})^2 
        + \ii \var{\rho} \partial_\tau \theta  
        + \frac{(\grad{\var{\rho}})^2}{8 \rho_0 m} 
        + \frac{1}{2} \var{\rho}(\vb*{x}) \int \dd[d]{\vb*{y}} U(\vb*{x} - \vb*{y}) \var{\rho}(\vb*{y})
    \right) + S_{\text{saddle}}.
\end{equation}
Integrating out $\var{\rho}$, we get 
\begin{equation}
    \begin{aligned}
        S_{\text{eff}} &= \int \dd[d+1]{x} \frac{\rho_0}{2m} (\grad{\theta})^2 
        - \frac{1}{2} \int \dd{\tau} \int \dd[d]{\vb*{x}} \dd[d]{\vb*{y}} 
        \ii \partial_\tau \theta(\vb*{x}, \tau)
            \frac{1}{
                \int \dd[d]{\vb*{y}} U(\vb*{x} - \vb*{y}) - \frac{1}{4 \rho_0 m} \laplacian
            } \ii \partial_\tau \theta (\vb*{y}, \tau) \\
        &= \int \dd[d+1]{x} \frac{\rho_0}{2m} (\grad{\theta})^2 + 
        \frac{1}{2} \int \dd{\tau} \int \dd[d]{\vb*{x}} \dd[d]{\vb*{y}}
        \partial_\tau \theta(\vb*{x}, \tau) G(\vb*{x} - \vb*{y}) \partial_\tau \theta(\vb*{y}),
    \end{aligned}
\end{equation}
where 
\begin{equation}
    \int \dd[d]{\vb*{y}} U(\vb*{x} - \vb*{y}) G(\vb*{y} - \vb*{z}) 
    - \frac{1}{4 \rho_0 m} \laplacian_{\vb*{x}} G(\vb*{x} - \vb*{z})  = \delta(\vb*{x} - \vb*{z}).
\end{equation}
Similar to the procedure in dealing with ordinary superfluid,
since we are only interested in the long wave length behaviors of $\theta$,
the $\laplacian$ term can be thrown away,
and we have 
\[
    \begin{aligned}
        \int \frac{\dd[d]{\vb*{p}}}{(2\pi)^d} \ee^{\ii \vb*{p} \cdot (\vb*{x} - \vb*{z})}
        &= \int \frac{\dd[d]{\vb*{p}}}{(2\pi)^d} \int \dd[d]{\vb*{y}} U(\vb*{x} - \vb*{y}) 
        G(\vb*{p}) \ee^{\ii \vb*{p} \cdot (\vb*{y} - \vb*{z})} \\
        &= \int \frac{\dd[d]{\vb*{p}}}{(2\pi)^d} 
        \int \dd[d]{\vb*{r}} U(\vb*{r}) \ee^{- \ii \vb*{p} \cdot \vb*{r}} 
        G(\vb*{p}) \ee^{\ii \vb*{p} \cdot (\vb*{x} - \vb*{z})} \quad (\vb*{r} = \vb*{x} - \vb*{y}) ,
    \end{aligned}
\]
so 
\begin{equation}
    G(\vb*{r}) = \int \frac{\dd[d]{\vb*{p}}}{(2\pi)^d} \ee^{\ii \vb*{p} \cdot \vb*{r}} G(\vb*{p}), \quad 
    G(\vb*{p}) = \frac{1}{U(\vb*{p})} 
    = \frac{1}{\int \dd[d]{\vb*{r}} U(\vb*{r}) \ee^{- \ii \vb*{p} \cdot \vb*{r}}}.
\end{equation}
To evaluate $G(\vb*{p})$, we need to find 
\begin{equation}
    U(\vb*{p}) = \int_0^\infty \dd{r} \frac{2\pi^{d/2}}{\Gamma(d / 2)} r^{d-1} \frac{U_0}{r^{d - \epsilon}}
\end{equation}

\end{itemize}

\paragraph{Problem 3}

\paragraph{Solution} \begin{itemize}
\item[(a)] The energy now can be exactly evaluated ($N$ is the number of sites):
\begin{equation}
    E = \frac{U N}{2} (M^2 - M) - \mu NM
    = \frac{N}{2} (U M^2 - (U + 2\mu) M).
\end{equation}
At the ground state, $E$ is minimized.
If $M$ were continuous, we would have
\begin{equation}
    M = \frac{U + 2\mu}{2 U} = \frac{1}{2} + \frac{\mu}{U}, 
    \label{eq:continuous-m}
\end{equation}
but it's not. So we need to find the closest integer to \eqref{eq:continuous-m}.
Note that since
\[
    \frac{1}{2} \leq \frac{1}{2} + \frac{\mu}{U} - \floor*{\frac{\mu}{U}} < \frac{3}{2},
\]
the following $M$ is always a minimum point:
\begin{equation}
    M = \floor*{\frac{\mu}{U}} + 1.
\end{equation}
When $\mu / U$ is an integer, both 
\begin{equation}
    M = \frac{\mu}{U} 
\end{equation}
and 
\begin{equation}
    M = \floor*{\frac{\mu}{U}} + 1 = \frac{\mu}{U} + 1
\end{equation}
can be found in ground states.

The energy gap is 
\begin{equation}
    \begin{aligned}
        \Delta E &= E|_{n_i = M+1 \text{ on one site}} - E|_M  \\
        &= \frac{U}{2} ((M+1)^2 - (M+1)) - \mu (M+1)
        - \frac{U}{2} (M^2 - M) + \mu M \\
        &= UM - \mu
        = \begin{cases}
            0 \text{ or } U, \quad &\text{$\mu / U$ integer}, \\
            U,\quad &\text{otherwise}.
        \end{cases}
    \end{aligned}
\end{equation}
Since when $\mu$ changes we observe discontinuous change of $M$,
we may say when $\mu / U$ is an integer,
a phrase transition happens,
so we pick $\Delta E = 0$ when $\mu / U$ is an integer and get 
\begin{equation}
    \frac{\Delta E}{U} = M - \frac{\mu}{U}
    = \begin{cases}
        0, \quad \text{$\mu / U$ integer}, \\
        1, \quad \text{otherwise}. 
    \end{cases}
\end{equation}
The energy gap and the phase diagram are shown in \prettyref{fig:mott-phase}.

\begin{figure}
    \centering
    \input{phase/boson-mott-1.tex}
    \caption{Phase diagram when $t = 0$}
    \label{fig:mott-phase}
\end{figure}

\item[(b)] The gapless points in \prettyref{fig:mott-phase} can only be connected to the superfluid phase,
and therefore we get \prettyref{fig:boson-hubbard}.

\begin{figure}
    \centering
    \input{phase/boson-hubbard-1.tex}
    \caption{Schematic phase diagram of the boson Hubbard model}
    \label{fig:boson-hubbard}
\end{figure}

\item[(c)] We have 
\begin{equation}
    \mel{n_0 + k'}{a}{n_0 + k} = \sqrt{n_0 + k} \braket{n_0 + k'}{n_0 + k - 1} 
    = \sqrt{n_0 + k} \delta_{k', k-1},
\end{equation}
and 
\begin{equation}
    \mel{k'}{\ee^{- \ii \theta}}{k} 
    = \int_{0}^{2\pi} \frac{\dd{\theta}}{2\pi} \ee^{- \ii k' \theta} \ee^{- \ii \theta} \ee^{\ii k \theta}
    = \delta_{k', k - 1}.
\end{equation}
When $k \ll n_0$, we have 
\begin{equation}
    \mel{n_0 + k'}{a}{n_0 + k} \approx \sqrt{n_0} \mel{k'}{\ee^{- \ii \theta}}{k} \Rightarrow
    a \approx \sqrt{n_0} \ee^{- \ii \theta}.
\end{equation}
And similarly we have 
\begin{equation}
    \mel{n_0 + k'}{a^\dagger}{n_0 + k} = \sqrt{n_0 + k + 1} \delta_{k', k+1},
\end{equation}
and 
\begin{equation}
    \mel{k'}{\ee^{\ii \theta}}{k} 
    = \int_0^{2\pi} \frac{\dd{\theta}}{2\pi} \ee^{- \ii k \theta} \ee^{\ii \theta} \ee^{\ii k' \theta}
    = \delta_{k', k+1},
\end{equation}
and in the $k \ll n_0$ limit we have 
\begin{equation}
    a^{\dagger} \approx \sqrt{n_0} \ee^{\ii \theta}.
\end{equation}


\end{itemize}

\end{document}