\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{float}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\zexternaldocument*[solid-]{../solid/solid}[solid.pdf]
\zexternaldocument*[last-]{./2022-3-15}[2022-3-15.pdf]
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}

% More compact lists 
% \setlist[itemize]{itemindent=17pt, leftmargin=1pt}

% Math operators
\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}
\DeclareMathOperator{\id}{id}

% TikZ setting
\usetikzlibrary{decorations.text}
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

\DeclareMathOperator{\im}{im}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

\newcommand{\soliddoc}{\href{../solid/solid.pdf}{this note}}
\newcommand{\lastlec}{\href{./2022-3-15.pdf}{the last lecture}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}
\newtcbtheorem[number within=section]{info}{Info}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}

% Disable unsupported commands in bookmark titles 
\pdfstringdefDisableCommands{%
  \def\\{}%
  \def\texttt#1{<#1>}%
  \def\mathbb#1{#1}%
}
\pdfstringdefDisableCommands{\def\eqref#1{(\ref{#1})}}

\makeatletter
\pdfstringdefDisableCommands{\let\HyPsd@CatcodeWarning\@gobble}
\makeatother

\title{Chern insulators}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\section{The field theory of graphene}

\subsection{Tight-binding model}

Let's start from the tight-binding model of graphene.
A Chern insulator is by no means required to be realized in a graphene,
but the model of graphene helps us to see how Dirac cone appears 
and how emergent Dirac electrons appear in a condensed matter system.

\begin{figure}
    \centering
    \input{structure/graphene.tex}
    \caption{Tight-binding model of graphene (a) The real space lattice structure. 
    The distance between nearest A atom and B atom is $a$.
    (b) The momentum space, with first Brillouin zone derived from the real space primitive lattice vectors.
    (c) Hopping in a unit cell and between unit cells.
    We have $\abs{\vb*{b}_1} \abs{\vb*{a}_1} \cos \SI{30}{\degree} = 2\pi \Rightarrow \abs{\vb*{b}_1} = 4\pi / 3a$.
    (d) An effective theory of \emph{all} (not just one) Dirac cones 
    should cover two non-equivalent valleys (K and K') and two bands 
    (corresponding to the A sublattice and the B sublattice).}
    \label{fig:graphene}
\end{figure}

The lattice structure of graphene is shown in \prettyref{fig:graphene}.
Note that there are three bonds per unit cell (\prettyref{fig:graphene}(c)),
and the tight-binding Hamiltonian is 
\begin{equation}
    H = - t \sum_{\vb*{i}}(
        c^\dagger_{\vb*{i} \text{A}} c_{\vb*{i} \text{B}}
        + c^\dagger_{\vb*{i} + \vu*{x}, \text{A}} c_{\vb*{i} \text{B}}
        + c^\dagger_{\vb*{i} + \vu*{y}, \text{A}} c_{\vb*{i} \text{B}}
    ) + \text{h.c.}
\end{equation}
Here $\vb*{i}$ labels unit cells and not atoms.
The Fourier transformation is 
\begin{equation}
    c^\dagger_{\vb*{i} n} = \frac{1}{\sqrt{N}} \sum_{\vb*{k}} \ee^{- \ii \vb*{k} \cdot \vb*{R}_{\vb*{i}}} c^\dagger_{\vb*{k} n}, \quad 
    \vb*{R}_{\vb*{i}} = i_x \vb*{a}_1 + i_y \vb*{a}_2,
\end{equation}
and following the standard procedure to solve tight-binding models, we have 
\begin{equation}
    H = - t \sum_{\vb*{k}} 
    (1 + \ee^{- \ii \vb*{k} \cdot \vb*{a}_1} + \ee^{- \ii \vb*{k} \cdot \vb*{a}_2}) 
    c^\dagger_{\vb*{k} \text{A}} c_{\vb*{k} \text{B}} + \text{h.c.}
    \label{eq:full-tb-ham}
\end{equation}
Diagonalization of this Hamiltonian gives the familiar graphene band structure,
and at K abd K' points in \prettyref{fig:graphene}(b),
we have energy minimum and linear dispersion,
the so-called Dirac cones.

\subsection{Effective theories at K}

Now we derive the effective theory of \eqref{eq:full-tb-ham} near K points.
We rewrite it into 
\begin{equation}
    H = - t \sum_{\vb*{k}} \Psi^\dagger_{\vb*{k}} \pmqty{
        0 & f(\vb*{k}) \\ f^*(\vb*{k}) & 0
    } \Psi_{\vb*{k}}, \quad 
    f(\vb*{k}) = 1 + \ee^{- \ii \vb*{k} \cdot \vb*{a}_1} + \ee^{- \ii \vb*{k} \cdot \vb*{a}_2}, \quad 
    \Psi_{\vb*{k}} = (c_{\vb*{k} \text{A}}, c_{\vb*{k} \text{B}}).
\end{equation}
Let's do Taylor expansion of $f(\vb*{k})$ around, for example, the rightmost point in \prettyref{fig:graphene}(b),
that is
\begin{equation}
    \vb*{K} = \left( \frac{4\pi}{3\sqrt{3} a}, 0 \right).
\end{equation}
It gives 
\begin{equation}
    \begin{aligned}
        f(\vb*{K} + \vb*{k}) &= 
        1 + \ee^{- \ii \frac{2\pi}{3} - \ii \vb*{k} \cdot \vb*{a}_1} 
        + \ee^{\ii \frac{2\pi}{3} - \ii \vb*{k} \cdot \vb*{a}_2} \\
        &= 1 + \left( - \frac{1}{2} - \frac{\sqrt{3}}{2} \ii \right) (1 - \ii \vb*{k} \cdot \vb*{a}_1 + \cdots)
        + \left( - \frac{1}{2} + \frac{\sqrt{3}}{2} \ii \right) (1 - \ii \vb*{k} \cdot \vb*{a}_2 + \cdots) \\
        &= - \frac{3}{2} a k_x + \ii \frac{3}{2} a k_y,
    \end{aligned}
    \label{eq:f-func}
\end{equation}
and therefore we get the effective theory around the Dirac cone:
\begin{equation}
    H = v \sum_{\vb*{k}} \Psi^\dagger_{\vb*{K} + \vb*{k}}
    \pmqty{
        0 & a k_x - \ii a k_y \\
        a k_x + \ii a k_y & 0
    } \Psi_{\vb*{K} + \vb*{k}}, \quad 
    v = \frac{3}{2} t.
\end{equation}
The fact that there is no constant term in the above Hamiltonian also indicates that 
we are around a Dirac cone.
Since we are not interested in the graphene system itself, 
and only use it as a platform to realize Dirac fermions,
it doesn't bring any inconvenience to redefine $\Psi^\dagger_{\vb*{K} + \vb*{k}}$ as $\Psi^\dagger_{\vb*{k}}$,
and to rescale $\vb*{k}$ so that $a \vb*{k}$ becomes $\vb*{k}$,
and further, to absorb the $v$ factor into the unit of energy 
(or in other words the unit of time -- so that the ``light speed'' is set to 1)
The effective theory therefore becomes 
\begin{equation}
    H = \sum_{\vb*{k}} \Psi^\dagger_{\vb*{k}} (k_x \sigma_x + k_y \sigma_y) \Psi_{\vb*{k}}.
    \label{eq:eff-ham-k}
\end{equation}

It should be \eqref{eq:eff-ham-k} is only about K point in \prettyref{fig:graphene}(b).
It should be noted that the K' point is \emph{not} connected to the K point with a $\vb*{G}$ factor.
Though in our free theory,
there is no hopping between K and K',
to find a complete theory about Dirac cones 
we still need to include K'
(and we get a 4-component electron wave function,
which may be seen as a Dirac electron).
We therefore follow the procedure to derive \eqref{eq:f-func},
and replace $\vb*{K}$ by $- \vb*{K}$, and we get 
\begin{equation}
    f(- \vb*{K} + \vb*{k}) = \frac{3}{2} k_x a + \ii \frac{3}{2} k_y a,
\end{equation}
and therefore we need to change the sign of the $k_x$ term in \eqref{eq:eff-ham-k} for $\Gamma'$ point 
and we get 
\begin{equation}
    H = v \sum_{\vb*{k}} \Psi^\dagger_{\vb*{k}} (- k_x \sigma_x + k_y \sigma_y) \Psi_{\vb*{k}}.
    \label{eq:eff-ham-kp}
\end{equation}
Combining \eqref{eq:eff-ham-k} and \eqref{eq:eff-ham-kp} together, we get 
\begin{equation}
    H = v \sum_{\vb*{k}} \Psi^\dagger_{\vb*{k}} \underbrace{(\mu^z \tau^x k_x + \tau^y k_y)}_{\eqqcolon H_{\vb*{k}}} \Psi_{\vb*{k}},
    \label{eq:dirac-ham-1}
\end{equation}
where 
\begin{equation}
    \mu^z = \diag(1, 1, -1, -1), \quad 
    \tau^x = \diag(\sigma^x, \sigma^x), \quad 
    \tau^z = \diag(\sigma^z, \sigma^z).
    \label{eq:matrix-def}
\end{equation}
Here we actually have two discrete degrees of freedom:
The first degree of freedom is the position of valley (K or K'),
and the second is the band index -- or equivalently, the sublattice.
\eqref{eq:matrix-def} is under the basis 
\[
    \{
        (\text{K}, \text{A}),
        (\text{K}, \text{B}),
        (\text{K'}, \text{A}),
        (\text{K'}, \text{B})
    \}.
\] 

So what's \eqref{eq:dirac-ham-1}?
It has four modes,
two with dispersion relation $\epsilon = v \abs{\vb*{k}}$,
two with $\epsilon = - v \abs{\vb*{k}}$
-- it describes Dirac electrons!
So we find indeed Dirac electrons can be realized in a realistic model.
In this note we are not going to rewrite \eqref{eq:dirac-ham-1} 
into the form usually seen in high energy physics,
because the picture of underlying A sublattice and B sublattice 
proves to be useful in the following discussion.

\subsection{Symmetries}

Before going on, let's first do a sketchy analysis of the Dirac electrons.
Of course we have translational symmetry.
Note that because $\vb*{K} + \vb*{k}$ is conserved,
both $\vb*{k}$ and $\vb*{K}$ are conserved, 
because the decomposition of the real crystal momentum into $\vb*{k}$ and $\vb*{K}$
is somehow unique, allowing the difference of a $\vb*{G}$ vector.
So translational symmetry means two things in \eqref{eq:dirac-ham-1}:
First, $\vb*{k}$ is conserved,
and second, the valley degree of freedom is conserved.
The second condition also means there is no $\mu^x$ or $\mu^z$ matrix in the Hamiltonian.
(Here $\mu^i$ means 
the direct product of $\sigma^i$ in the valley space 
and the identity matrix in the sublattice space.)

We also have inversion symmetry:
Under the inversion operation, sublattice A and sublattice B are exchanged,
and $\vb*{k}$ becomes $- \vb*{k}$,
and K and K' are swapped 
(the latter two operations are equivalent to flipping the real lattice momentum $\vb*{K} + \vb*{k}$),
so because of the exchange of A and B, we have
\[
    \sigma^y = \pmqty{0 & - \ii \\ \ii & 0} \longrightarrow \pmqty{0 & \ii \\ - \ii & 0} = - \sigma^y,
\]
and similarly 
\[
    \sigma^x \longrightarrow \sigma^x,
\]
and by the definition of $\tau^z$ and $\tau^x$, 
exchange valley K and valley K' doesn't change their values, so finally we get
\begin{equation}
    \tau^x \to \tau^x, \quad \tau^y \to - \tau^y.
\end{equation}
On the other hand, swapping A and B doesn't change $\mu^z$,
but after K and K' are swapped, we get 
\begin{equation}
    \mu^z \to - \mu^z.
\end{equation}
So we find the first quantization Hamiltonian $H_{\vb*{k}}$ is invariant under spatial inversion:
The sign of $k$ and the sign of the matrices cancel.

Both translational symmetry and inversion symmetry are space group operations.
\eqref{eq:dirac-ham-1} also has a non-space group symmetry:
the time reversal symmetry.
It can be proved that if a system has time reversal symmetry 
(see \href{../group-and-topology-yang-qi/2022-4-12.pdf}{here}),
then we can always find a unitary matrix $T$ 
(which is consistent with out intuition about how time reversal changes discrete degrees of freedom)
such that 
\begin{equation}
    T H_{\vb*{k}} T^{-1} = H_{-\vb*{k}}^*.
\end{equation}
In the case of graphene,
time reversal swaps K and K', 
but leaves the lattice along,
so $T A T'$ means to swap the K part and the K' part in $A$.
Thus 
\[
    T H_{\vb*{k}} T^{-1}
    = \underbrace{T \mu^z T^{-1}}_{- \mu^z} T \tau^x T^{-1} k_x + \tau^y k_y
    = - \mu^z \tau^x k_x + \tau^y k_y,
\]
and 
\[
    H_{- \vb*{k}}^* = - \underbrace{\mu^z \tau^x}_{\text{real}} k_x + (-\tau^y) (-k_y),
\]
and indeed we find \eqref{eq:dirac-ham-1} has time reversal symmetry.

\section{Broken symmetry and Chern insulator}

\subsection{Introducing mass terms}

\eqref{eq:dirac-ham-1} is a gapless theory,
though not a metal but a semimetal.
A mass term may be introduced if some additional mechanisms are put in,
say, spontaneous symmetry breaking or external field.
The terms $m \tau^z$ and $m \tau^y$ break the inversion symmetry 
(after changing A and B, a minus sign appears).
This is usually caused by a CDW order,
and since in a CDW order, electrons are localized around atoms in the real space,
we choose $m \tau^z$,
which is diagonal in the sublattice basis.
To break the time reversal symmetry, any $m \mu^z \tau^i$ term is fine,
but again to make our model easily realizable 
we use $m \mu^z \tau^z$ which is diagonal in the sublattice basis
-- and then something like a magnetic field easily induces this term.
So the model including the two mass terms we are interested in is 
\begin{equation}
    H_{\vb*{k}} = \mu^z \tau^x k_x + \tau^y k_y + m_1 \tau^z + m_2 \mu^z \tau^z.
    \label{eq:model-ham}
\end{equation}

\subsection{The spectrum}

Now we solve the model \eqref{eq:model-ham}.
By brutal force, we diagonalize the matrix,
and find that the matrix is block diagonal, 
two two block corresponding to $\mu^z = \pm 1$, respectively,%
\footnote{
    Here we follow a common misuse of notation 
    and use the symbol $\mu^z$ to refer to 
    the matrix, the corresponding (basis-independent) operator,
    and the value of that operator on an eigenstate.
}
and for $\mu^z = 1$ (i.e. K valley) we have 
\begin{equation}
    \epsilon_{\vb*{k}}^2 = (m_1 + m_2)^2 + k_x^2 + k_y^2,
\end{equation}
and for $\mu^z = -1$ (i.e. K' valley) we have 
\begin{equation}
    \epsilon_{\vb*{k}}^2 = (n_1 - m_2)^2 + k_x^2 + k_y^2,
\end{equation}
so 
\begin{equation}
    \epsilon_{\vb*{k}, \mu^z} = \pm \sqrt{
        \vb*{k}^2 + (m_1 + \mu^z m_2)^2
    }.
\end{equation}
It can be seen that the model is mostly gapped,
except when 
\begin{equation}
    m_1 + \mu^z m_2 = 0 \Leftrightarrow \begin{cases}
        \abs{m_1} = \abs{m_2}, \\
        \mu^z = - \frac{m_2}{m_1} .
    \end{cases}
    \label{eq:gap-close}
\end{equation}
In the above case, 
the gap is closed for one of the valleys.

\subsection{Phase diagram of a non-interactive fermion theory?}

The fact that when \eqref{eq:gap-close} holds,
the gap is closed 
means it's possible that \eqref{eq:gap-close} is actually a phase transition condition. 
This seems not likely,
because anyway \eqref{eq:model-ham} is a non-interactive theory.
Further investigations, however, reveal that there is indeed a transition when \eqref{eq:gap-close} holds.

Let's consider the $\abs{m_1} \to \infty$ limit and the $\abs{m_2} \to \infty$ limit.
In the former limit, the first quantization Hamiltonian is 
\[
    H_{\vb*{k}} = \pm \abs{m_1} \pmqty{\dmat{1, -1, 1, -1}},
\]
and when $m_1 > 0$, filled states are $\ket{\vb*{k}, \text{K}, \text{B}}$ 
and $\ket{\vb*{k}, \text{K'}, \text{B}}$.
So all B states are occupied while A states are not.
The picture is quite clear:
Due to the CDW order parameter,
the electrons are gapped out,
and now in a unit cell,
the electron (note that the model is half-filled so we have two atoms but only one electron in one unit cell)
is confined around the B atom.
Similarly when $m_1 < 0$, 
the electron is confined around the A atom in a unit cell.
So $m_1 \to \infty$ limit is the ``CDW B'' limit,
while $m_1 \to - \infty$ limit is the ``CDW A'' limit.

Now let's consider the $\abs{m_2} \to \infty$ limit.
The Hamiltonian is now 
\begin{equation}
    H_{\vb*{k}} = \pm \abs{m_2} \pmqty{\dmat{1, -1, -1, 1}}.
\end{equation}
So if $m_2 > 0$, the filled states are $\ket{\vb*{k}, \text{K}, \text{B}}$
and $\ket{\vb*{k}, \text{K'}, \text{A}}$.
Something rather interesting is hidden here:
K and K' are \emph{momentum space} labels.
The fact that in the momentum space,
at K and K',
different bands are filled 
means in the real space we \emph{don't} have a picture that looks like CDW A or CDW B.
If electrons are confined around particular atoms,
we get a flat filled band
with a band index that can be traced back to the type of atom with electron localization in the unit cell.
(Of course, we can have staggering electron localization sites,
but this results in the shrinking of the first Brillouin zone,
which obviously doesn't happen here.)
And here though the bands are all flat,
we can't say electrons are around A or B.
Somehow, we get flat bands,
but there is no corresponding \emph{atomic limit} (i.e. hopping $\to 0$).

The above results strongly hint at a phase diagram like \prettyref{fig:possible-phase-1},
with CDW A, CDW B, the two flat-band-yet-no-atomic-limit states 
being the four phases on the diagram.

\begin{figure}
    \centering
    \input{phase/chern-model-ex.tex}
    \caption{Possible phase diagram of \eqref{eq:model-ham}. The red and blue triangles are CDW A and CDW B phases.}
    \label{fig:possible-phase-1}
\end{figure}

\subsection{Boundary states}

The above claim about \prettyref{fig:possible-phase-1} is still not quite convincing.
In this section, 
we explicitly place

\subsection{Laughling's argument}

The symmetric classification of Chern insulator is the same as IQHE.

\end{document}