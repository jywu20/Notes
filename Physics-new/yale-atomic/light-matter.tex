\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{underscore}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}

% More compact lists 
\setlist[itemize]{
    %itemindent=17pt, 
    %leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

\setlist[enumerate]{
    %itemindent=17pt, 
    %leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\res}{Res}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{calc}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

\lstdefinestyle{console}{
    basicstyle=\footnotesize\ttfamily,
    breaklines=true,
    postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space}
}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}
\newtcbtheorem[number within=section]{info}{Info}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}

% Displaying texts in bookmarkers

\pdfstringdefDisableCommands{%
  \def\\{}%
  \def\ce#1{<#1>}%
}

\pdfstringdefDisableCommands{%
  \def\texttt#1{<#1>}%
  \def\mathbb#1{#1}%
}
\pdfstringdefDisableCommands{\def\eqref#1{(\ref{#1})}}

\makeatletter
\pdfstringdefDisableCommands{\let\HyPsd@CatcodeWarning\@gobble}
\makeatother

\newenvironment{shelldisplay}{\begin{lstlisting}}{\end{lstlisting}}

\newcommand{\shortcode}[1]{\texttt{#1}}

\lstset{style = console}

% Make subsubsection labeled
\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\newcommand{\kB}{k_{\text{B}}}

\title{Atomic physics: theories of laser beams and atoms}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\section{Overview of atoms}

Atomic physics relies on the existence of atoms.
The idea that matter consists of atoms 
was seen in ancient Greek,
probably earlier in ancient India.
In the West, people usually attribute the idea to Democritus (450 BC),
who claimed that there are only atoms and ``void''.
The modern idea of atoms arose to explain the behavior of gases:
if we assume the basic degrees of freedom of a gas systems are 
$\vb*{r}_i$'s and $\vb*{p}_i$'s,
then everything works well -- 
except we need to use a constant $\hbar$ to decide the correct entropy of the gas:
\begin{equation}
    \dd{\Omega} = \frac{\dd[3]{\vb*{r}} \dd[3]{\vb*{p}}}{h^3}, \quad h = 2\pi \hbar.
\end{equation}
The origin of $\hbar$ led to the discovery of quantum mechanics.

The quantum nature of atoms is best demonstrated by beam splitters.
Beam splitters are widely used in optics:
they can be used to make a Mach-Zehnder interferometer, 
and the observed intensity takes the form of 
\[
    (\cos(\omega t + \phi_1) + \cos(\omega t + \phi_2))^2,
\]
and by moving the mirrors, 
we change $\phi_{1, 2}$,
and thus peaks and valleys occur in the relation between $I$ and $\phi_{1, 2}$.

\begin{figure}
    \centering

    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
    %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300
    
    %Shape: Rectangle [id:dp4592102294328868] 
    \draw   (242.28,104.79) -- (192.79,154.28) -- (185.72,147.21) -- (235.21,97.72) -- cycle ;
    %Straight Lines [id:da8168249070848908] 
    \draw    (110,122) -- (206.83,122) ;
    \draw [shift={(209.83,122)}, rotate = 180] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (10.72,-5.15) -- (0,0) -- (10.72,5.15) -- (7.12,0) -- cycle    ;
    %Straight Lines [id:da15292644630172703] 
    \draw    (209.83,122) -- (209.83,39) ;
    \draw [shift={(209.83,36)}, rotate = 90] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (10.72,-5.15) -- (0,0) -- (10.72,5.15) -- (7.12,0) -- cycle    ;
    %Straight Lines [id:da76766140394506] 
    \draw    (218.83,128) -- (315.67,128) ;
    \draw [shift={(318.67,128)}, rotate = 180] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (10.72,-5.15) -- (0,0) -- (10.72,5.15) -- (7.12,0) -- cycle    ;
    %Straight Lines [id:da5571278289677006] 
    \draw    (218.83,214) -- (218.83,131) ;
    \draw [shift={(218.83,128)}, rotate = 90] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (10.72,-5.15) -- (0,0) -- (10.72,5.15) -- (7.12,0) -- cycle    ;
    
    % Text Node
    \draw (108,122) node [anchor=east] [inner sep=0.75pt]    {$E_{1}$};
    % Text Node
    \draw (218.83,217.4) node [anchor=north] [inner sep=0.75pt]    {$E_{2}$};
    % Text Node
    \draw (209.83,32.6) node [anchor=south] [inner sep=0.75pt]    {$E_{4}$};
    % Text Node
    \draw (320.67,128) node [anchor=west] [inner sep=0.75pt]    {$E_{3}$};
    
    
    \end{tikzpicture}
    \caption{Beam splitter example}
    \label{fig:beam-splitter}    
\end{figure}

NMore generally, in \prettyref{fig:beam-splitter}, we have 
\begin{equation}
    \begin{aligned}
        \abs*{\vb*{E}_3}^2 + \abs{\vb*{E}_4}^2 &= 
        (t \vb*{E}_1 + r \vb*{E}_2) (t \vb*{E}_1 + r \vb*{E}_2)^*
        + (t \vb*{E}_2 + r \vb*{E}_1) (t \vb*{E}_2 + r \vb*{E}_1)^* \\
        &= (\abs*{\vb*{E}_1}^2 + \abs*{\vb*{E}_2}^2) (\abs*{t}^2 + \abs*{r}^2)
        + (\vb*{E}_1^* \cdot \vb*{E}_2 + \text{h.c.}) (t^* r + r^* t).
    \end{aligned}
\end{equation}
To ensure energy conservation, we get 
\begin{equation}
    \abs*{t}^2 + \abs*{r}^2 = 1,
\end{equation}
which is expected, and 
\begin{equation}
    t^* r + r^* t = 0.
\end{equation}
The last equation means there has to be a phase shift caused by the beam splitter. 
In the \SI{50}{\percent}-\SI{50}{\percent} case, 
we have $r = t \ee^{\ii \phi}$,
and solving the above equation, 
we find $\phi = \SI{90}{\degree}$.
Thus a \SI{50}{\percent}-\SI{50}{\percent} beam splitter introduces a \SI{90}{\degree} phase difference 
between the two output beams 
if one of the input beam is absent, 
i.e. the corresponding input port is a dark port.

A comment: when we deal with actual light,
not just atom beams, 
polarization also influences the phase shift.

\section{Blackbody radiation}

Blackbody radiation is where atomic physics started.
Both the candle and the incandescent light bulb
give light when heated up.
What makes it interesting is,
if we heat up a black object, 
radiation also occurs:
this can be demonstrated by 
putting a light mill before a piece of heated black object:
the vanes rotate in the same way that 
they rotate when placed before a light bulb.
When the temperature isn't too high,
we can put a infrared screener between the light mill and the heated black object
and we find the rotation rate of the light mill goes down.
This means the relation between radiation and temperature of many objects 
is at least quantitatively modeled by the ideal black body,
and therefore studying its behavior is important.

A blackbody can be modeled as a hole on a closed optical cavity:
once something goes inside, 
it's highly unlikely to be reflected back.
The possible optical modes between two walls are like 
\[
    \sin(\frac{n \pi x}{L}) \quad \text{or} \quad 
    \sin(\frac{n \pi x}{L}),
\]
and $n = 0, 1, 2, 3, \dots$.
In a cubic box, we have $n_1, n_2, n_3$ to label all the modes, 
and TODO 

We will skip the tedious historical attempts to derive the correct blackbody radiation formula,
and just jump to the final answer:
the energy of each light mode has to be quantized.
The first try is to assume 
\begin{equation}
    E_{\text{mode $\omega$}} = \hbar \omega n.
\end{equation}
Thus, for each light mode, we have 
\begin{equation}
    Z = \sum_{n=0}^\infty \ee^{- n \hbar \omega / \kB T} = \frac{1}{1 - \ee^{- \hbar \omega / \kB T}} ,
\end{equation}
and therefore 
\begin{equation}
    \expval{E} = \frac{1}{Z} \sum_{n=0}^\infty n \hbar \omega \ee^{- n \hbar \omega / \kB T} 
    = \frac{\hbar \omega}{\ee^{\hbar \omega / \kB T} - 1}.
\end{equation}
The high temperature limit would we 
\[
    \expval{E} = \frac{\hbar \omega}{
        \frac{\hbar \omega}{\kB T} + \frac{1}{2} \left(\frac{\hbar \omega}{\kB T}\right)^2 + \cdots 
    } \to 
    \kB T \left(
        1 - \frac{1}{2} \frac{\hbar \omega}{\kB T} 
    \right) = \kB T - \frac{1}{2} \hbar \omega.
\]
Thus, in order to go back to the classical prediction when $T \to \infty$, 
the energy of a single mode has to be 
\begin{equation}
    E = \hbar \omega \left( n + \frac{1}{2} \right),
\end{equation}
and the correct expected energy is 
\begin{equation}
    \expval{E} = \frac{\hbar \omega}{
        \frac{\hbar \omega}{\kB T} + \frac{1}{2} \left(\frac{\hbar \omega}{\kB T}\right)^2 + \cdots 
    } \to 
    \kB T \left(
        1 - \frac{1}{2} \frac{\hbar \omega}{\kB T} 
    \right) = \kB T - \frac{1}{2} \hbar \omega
    + \frac{1}{2} \hbar \omega.
\end{equation}

Now the total energy of the cavity can be found: 
it's 
\begin{equation}
    U = \int_0^\infty \expval{E_\omega} n(\omega) \dd{\omega}
    = L^3 
\end{equation}
The energy jet can then be found:
\begin{equation}
    J = \frac{1}{4} c U = \underbrace{\frac{\pi^2 \kB^4}{60 \hbar^3 c^3}}_{\sigma} T^4.
\end{equation}
TODO: whether we need to multiply a 2 factor to $J$;
the direction of radiation; 
the vibrational $1/2$ factor; 
the 

Blackbody radiation is related to the temperature of the Earth, actually. 
The radiation power of the sun is 
\begin{equation}
    P_\text{s} = 4\pi r_{\text{s}}^2 \cdot \sigma T^4 \cdot \epsilon_{\text{s}}, 
\end{equation}
where $\epsilon_{\text{s}}$ is a (rather coarse) estimation 
of how much the Sun deviates from an ideal blackbody.
The energy flow at the position of the Earth is 
\begin{equation}
    I_{\text{e}} = \frac{P_{\text{s}}}{4 \pi R_{\text{e}}^2},
\end{equation}
and the power received by the Earth is 
\begin{equation}
    P_{\text{e}} = \pi r_{\text{e}}^2 I_{\text{e}} \epsilon_{\text{e} 1}.
\end{equation}
Here note that we are using the cross section of the Earth 
as the ``surface'', 
because actually what we have is 
\[
    P = \int \dd{\vb*{S}} \cdot \vb*{I}.
\]
The balance of energy, therefore, means 
\begin{equation}
    P_{\text{e}} = \pi r_{\text{e}}^2 I_{\text{e}} \epsilon_{\text{e} 1}
    = 4 \pi r_{\text{e}}^2 \sigma T_{\text{e}}^4 \epsilon_{\text{e} 2}.
    \label{eq:earth-balence-1}
\end{equation}
Albedo analysis means the absorption efficiency of the Earth is $\epsilon_{\text{e} 1} = 0.65$,
and if $\epsilon_{\text{e} 2} \approx 1$, 
we find $T_{\text{e}} = \SI{251}{K}$.
This of course goes against the observed result $\SI{300}{K}$.
The point here is the Earth is not really a blackbody ideal enough when it comes to radiation,
if we view the atmosphere as a part of the Earth:
heat radiation is reflected back,
and the amount of energy flowing into the space is reduced. 
This means the temperature of the Earth has to be higher than what is estimated 
using \eqref{eq:earth-balence-1}.

\section{Spontaneous radiation}

Einstein noticed one deficiency of the traditional picture of atomic radiation:
because of the spatial rotational symmetry, 
what we get is a spherical wave,
going out infinitely. 
Now this means an atom undergoes random walking because of this radiation.

Suppose $n_2$ is the occupation of the excited state, 
and $n_1$ is the occupation of the ground state. 
Then we have 
TODO: see my old notes 

\begin{figure}
    \centering
    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]
        %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300
        
        %Straight Lines [id:da06986492460884808] 
        \draw    (37.83,127) -- (185.83,127) ;
        %Straight Lines [id:da1641788047105277] 
        \draw    (36.83,195) -- (185.83,195) ;
        %Straight Lines [id:da29601410132759565] 
        \draw    (156,127) -- (156,193) ;
        \draw [shift={(156,195)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (12,-3) -- (0,0) -- (12,3) -- cycle    ;
        %Straight Lines [id:da3431524102952239] 
        \draw    (135,129) -- (135,195) ;
        \draw [shift={(135,127)}, rotate = 90] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (12,-3) -- (0,0) -- (12,3) -- cycle    ;
        %Straight Lines [id:da3488947064919612] 
        \draw  [dash pattern={on 0.84pt off 2.51pt}]  (71,127) -- (71,193) ;
        \draw [shift={(71,195)}, rotate = 270] [fill={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.08]  [draw opacity=0] (12,-3) -- (0,0) -- (12,3) -- cycle    ;
        
        % Text Node
        \draw (187.83,127) node [anchor=west] [inner sep=0.75pt]   [align=left] {2};
        % Text Node
        \draw (187.83,195) node [anchor=west] [inner sep=0.75pt]   [align=left] {1};
        % Text Node
        \draw (158,161) node [anchor=west] [inner sep=0.75pt]    {$B_{21}$};
        % Text Node
        \draw (133,161) node [anchor=east] [inner sep=0.75pt]    {$B_{12}$};
        % Text Node
        \draw (69,161) node [anchor=east] [inner sep=0.75pt]    {$A_{21}$};
        
        
        \end{tikzpicture}
    \caption{The energy level diagram of a two-level system}
    \label{fig:two-level-jump}        
\end{figure}

The time evolution -- master equation indeed -- of the two-level system is 
\begin{equation}
    \dot{n}_2 = - n_2 A_{21} - n_2 B_{21} \rho(\omega) \dd{\omega} + n_1 B_{12} \rho(\omega) \dd{\omega},
\end{equation}
and from the fact that $\dot{n}_2 = \dot{n}_1 = 0$ 
\emph{can} be reached 
when we arrive at thermal equilibrium, i.e. when 
\begin{equation}
    \frac{n_2}{n_1} = \ee^{- \hbar \omega / \kB}, 
\end{equation} 
we get 
\begin{equation}
    A = \rho(\text{zero point energy}) \dd{\omega} B = \frac{1}{2} \frac{\hbar \omega^3}{\pi^2 c^2}.
\end{equation}

This means spontaneous radiation is necessary
as long as we assume a Bosonic distribution 
of the occupation of photonic modes, 
or otherwise our model of the two-level system is unable to 
stay at the correct equilibrium state. 

\section{Two-level system}

\begin{equation}
    \dv{t} (\rho(t) - \rho(0))
    = - \frac{\ii}{\hbar} \comm*{H(t)}{\rho(0)} 
    - \frac{1}{\hbar^2} \int_{0}^{t} \dd{t'} \comm*{H(t)}{\comm*{H(t')}{\rho(0)}} + \cdots.
\end{equation}
When the external field has zero time average, 
we find 
\[
    \dv{t} \overline{
        \rho(t) - \rho(0)
    } = - \frac{1}{\hbar^2} \int_{0}^{t} \dd{t'} 
    \overline{\comm*{H(t)}{\comm*{H(t')}{\rho(0)}}}.
\]
So we find the time averaged versions of $\rho(t)$ and $\rho(0)$ aren't that different.
Then we find 
\begin{equation}
    \dv{t} \overline{\rho(t)} = - \frac{1}{\hbar^2} \int_{0}^{t} \dd{t'} 
    \overline{\comm*{H(t)}{\comm*{H(t')}{\rho(t)}}}.
\end{equation}

\section{Polarization}

Suppose $z$ is the direction of $\vb*{k}$.
Since $\vb*{k}$ is perpendicular to both $\vb*{E}$ and $\vb*{H}$,
and the latter are orthogonal to each other, 
once $\vb*{k}$ is given, 
the direction of $\vb*{E}$ completely determines the polarization.
Thus the polarization of a beam of light can be decided by $E_x$ and $E_y$,
or to be exact, 
the complex version of them to include the phase factors.
This fact -- that the polarization direction of a massless boson is always orthogonal to $\vb*{k}$ -- 
has direct experimental consequences:
if the hopping between two states requires a $\sigma_0$ photon absorption, 
then it is forbidden.

We define 
\begin{equation}
    \ket*{H} = \pmqty{1 \\ 0}, \quad 
    \ket*{V} = \pmqty{0 \\ 1}.
\end{equation}
\SI{45}{\degree} polarization can be represented by 
mixing the two bases without a phase factor.
The right circular polarization is 
\begin{equation}
    \frac{1}{\sqrt{2}} \pmqty{1 \\ \ii} = 
    \frac{1}{\sqrt{2}} \ket*{H} 
    + \frac{\ii}{\sqrt{2}} \ket*{V} ,
\end{equation}
which contains a phase factor to create a beat 
between the $x$ and $y$ components. 

TODO: sign of circular polarization; if we flip the polarizer,
the output immediately vanishes

Polarization can be tested using polarizers, 
and this process is fully described by density matrices. 
We have two parameters in the pure state Jones vector:
the amplitude of one component 
and the phase difference between the two components.
In the density matrix, 
we have four matrix elements, 
and TODO: Stokes parameters; 

\end{document}