<div dir="ltr">Hi&nbsp;<span class="il">Chang</span> and Jacob,<div><br></div><div>Thanks for your interest in the GW methodology.&nbsp;</div><div><br></div><div>Regarding the theory of DFT and GW, I think it is actually not necessary to read books from the first page to the last. I recommend&nbsp;you to search about the following topics yourself one by one, in the order given here:</div><div><ol><li><b>Born-Oppenheimer approximation</b>. All condensed matter physics problems are about interactions between ions and valence electrons. As a starting&nbsp;point, we often treat the ions as an <i>external potential field</i> felt by the electrons. The forces acting on the ions (phonons) can be solved by calculating the derivative of the total electron energy with respect to the atomic coordinates, and this gives us phonons.</li><li><b>Hohenberg–Kohn theorems</b>. So now we want to know how to calculate the ground state energy of electrons with <i>Coulomb repulsion</i> in a given external potential field. Strikingly, it has been proven that there is a one-to-one mapping between the external potential V(r) and the ground state electron density n(r). Further, there is a functional with respect to n(r) whose minimum gives the ground state charge density as well as the ground state energy. That's why it's called <i>density functional theory</i>.</li><li><b>Kohn-Sham equations</b>. Unfortunately the energy functional mentiond above doesn't have a clear explicit form. A common practice is to assume that the ground state electron density is somehow close to the ground state electron density of a non-interactive system, and therefore n(r)=Σ_i |φ(r)|^2. Minimizing the energy functional with such an ansatz of the ground state electron density is equivalent to solving the so-called <i>Kohn-Sham equations</i>, which look like Schrodinger equations but are self-consistent: we solve φ's from n, and then we use φ's to determine n, and the process goes on and on until everything converges. Here we assume that the total energy of electrons is mostly the "kinetic energy" and "Hartree energy" calculated from the φ(r)'s: the difference between the sum of the two and the real total energy is known as the <i>exchange-correlation functional</i>.</li><li><b>Determining the exchange-correlation functional</b>. So how can we know the exchange-correlation functional or the Exc? Unfortunately we don't have a good answer. That's what people call "THE functional" for simplicity when working in the field of DFT. The simplest approximation is the <i>local density approximation</i>, which assumes that the electron gas is <i>locally homogeneous</i>, and Exc[n]=∫dV*E(n(r)). E(n(r)) is then determined by quantum Monte-Carlo simulation of the homogeneous electron gas. We also have GGA (generalized gradient approximation) where the gradient of n is included in the functional. There are many GGA functionals, although there is only one LDA functional. We also have more complicated approximations.</li><li><b>Psueopotentials</b>. If the Exc we have is good enough, we can run DFT on electrons and <i>bare atomic nuclei</i>. This is however too time consuming, so usually we assume that the behaviors of inner shell electrons do not change much when we change the environment of the atom. So now we work with ions and valence electrons (as is mentiond above). The interaction between an electron and an ion is no longer as simple as 1/r: the form is known as a <i>pseudopotential</i>.</li><li><b>Solving Kohn-Sham equations</b>. Now suppose we have the pseudopotentials of the atoms in a material. They should be prepared under the same choice of Exc, so in actual DFT calculations, we don't need to configure the choice of Exc. To actually solve the Kohn-Sham equations we still need to discretize them. Often we do the calculation in the reciprocal space: thus we need to supply a <i>k-point grid</i>&nbsp;and also a <i>cutoff energy</i> (φ's are written as φ_nk(G) in the reciprocal space, and the upper bound of the G grid is determined by the cutoff energy) to DFT codes for discretization.</li><li><b>Excited state electrons</b>. The solution of the Kohn-Sham equations - the φ's and the eigenvalues of the equations, known as Kohn-Sham energies - looks like a band structure. But in theory the only meaningful thing we get from Kohn-Sham equations is the ground state electron density. Empirically however the Kohn-Sham "band structure" looks quite like what we see in ARPES. For many materials however the band gap predicated by the Kohn-Sham "band structure" is quantitatively wrong. If we take one step back and see what's measured by ARPES, we find that it's the single-electron Green's function. The ARPES band structure is given by the poles of the interaction-corrected single-electron Green's function.&nbsp;</li><li><b>Many-body perturbation theory</b>. Now we consider applying perturbative quantum field theoretic methods to condensed matter systems. This application is known as <i>many-body perturbation theory</i>. The interaction-corrected single-electron Green's function is obtained by the <i>Dyson's equation</i>: G = G_0&nbsp;+ G_0 Σ G_0&nbsp;+ ... = G_0&nbsp;+ G_0 Σ G. To make things easier for us, we often use the single-electron Green's function calculated using the DFT Kohn-Sham orbitals and energies as G_0: in this way the Dyson's equation is G = G_0&nbsp;+ G_0 (Σ - Vxc) G. The problem then is how to calculate the self-energy Σ. In theory, Σ can be solved from a self-consistent system of equations, known as the Hedin's equations, which however is extremely time-consuming, and usually the GW approximation is good enough.</li><li><b>The GW approximation</b>. Finally we arrive at GW! In the so-called GW approximation, we assume that Σ is Hartree diagram plus interaction corrected Fock diagram: we replace the Coulomb potential in the Fock diagram by the ring diagram approximation corrected Coulomb potential (also known as the RPA-screened Coulomb potential). So we have Σ(1,2) = i G(1, 2) W(1, 2), where W is the screened Coulomb potential - that's why it's known as the GW approximation.</li><li><b>GW-BSE</b>. The GW approximation sketched above is for zero-temperature systems. It can also be applied to non-equilibrium simulations. The linear approximation of the optical response of non-equilibrium GW, ignoring the non-equilibrium evolution of W, is known as <i>Bethe-Salpeter equation (BSE)</i>. The term BSE in high-energy physics means the Dyson's equation for electron-hole pairs, and in condensed matter physics means <i>the </i>BSE from GW. BSE gives us exciton and plasmon spectrum of a system.</li><li><b>GW-BSE in action</b>. In actual GW calculations, usually we don't seek to construct the full Green's function. Instead we focus on the poles of G (assuming we still have well-defined quasiparticles - interaction renormalized electrons and holes - after GW correction).&nbsp; So the Dyson's equation becomes E_GW = E_DFT&nbsp; + Σ_GW(E_GW, φ_GW), where φ is the "single quasiparticle wave function" obtained from G. Note that this is a self-consistent matrix equation. Often we do the iteration only once, known as G0W0, and furthermore we often only&nbsp;consider the diagonal components of Σ. Also, in calculating the RPA-screened W and Σ_GW in the momentum space, we need to sum over empty bands for completeness relations, and the number of empty bands is very, very important: this is known as the convergence problem of GW. The DFT cutoff energy, the density of the k grid, and the number of empty states are all important for a reliable GW calculation. BSE doesn't involve summation over empty states, but requires a very, very fine k-grid.</li></ol><div>It's quite easy to find references for the DFT part above. The GW-BSE part is less hard to search. For references (not all of which are to be read at the first time):</div></div><div><ul><li>About Hedin's equation, how phonons are incorporated into the picture, Feynman diagrams, and diagrammatic formulation of GW: see e.g.&nbsp;<a href="https://arxiv.org/pdf/1109.3972" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://arxiv.org/pdf/1109.3972&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw0at8FcgJYwwjjspOcB-f49">here</a>,&nbsp;<a href="https://journals.aps.org/prx/pdf/10.1103/PhysRevX.13.031026" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://journals.aps.org/prx/pdf/10.1103/PhysRevX.13.031026&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw35ExN0eZTbDJnYU49viZ5G">here</a>, and&nbsp;<a href="https://www.amazon.com/Guide-Feynman-Diagrams-Many-Body-Problem/dp/0486670473" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://www.amazon.com/Guide-Feynman-Diagrams-Many-Body-Problem/dp/0486670473&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw1J2VpNS5A3kNy7e0fjaeRr">here</a>. There are many, many more references. Hedin's original paper was hard to read and I suggest you start with more recent sources. Also note that MBPT is related to the&nbsp;Brillouin-Wigner (BW) perturbation theory, and we can combine many-body wave function based method with MBPT (see <a href="https://arxiv.org/abs/1805.11265" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://arxiv.org/abs/1805.11265&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw2HdGURhx0t6I-_Ecl1JFIW">here</a>&nbsp;for example; we in Diana's group however don't do this).</li><li>About details in GW-BSE: see&nbsp;<a href="https://berkeleygw.org/documentation/literature/" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://berkeleygw.org/documentation/literature/&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw14Yjl4q1pgCzKqFpAbsb8d">this list</a>. The authors belong to the BerkeleyGW community, not the Yambo community, but the basic principles are the same. <a href="https://journals.aps.org/prb/pdf/10.1103/PhysRevB.34.5390" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://journals.aps.org/prb/pdf/10.1103/PhysRevB.34.5390&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw2tTeJ_f9MWGD953oQoN3ID">This paper</a>&nbsp;goes into the details of the "GW-BSE in action" point above.</li><li>On the relation between GW and BSE, and also on TD-aGW: TD-aGW is introduced e.g.&nbsp;<a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.84.245110" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://journals.aps.org/prb/abstract/10.1103/PhysRevB.84.245110&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw0LIMQwFwfL38oPkn7ZCJLi">here</a>. (The term TD-aGW is used e.g. <a href="https://www.pnas.org/doi/10.1073/pnas.2301957120" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://www.pnas.org/doi/10.1073/pnas.2301957120&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw2mJR615SWl8RZvmq85n_ho">here</a>) The paper proves the equivalence between linearized TD-aGW and BSE. Note that TD-aGW actually is based on an approximation of GW with all retardation effects removed, known as static COHSEX (also see&nbsp;<a href="https://journals.aps.org/prb/pdf/10.1103/PhysRevB.34.5390" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://journals.aps.org/prb/pdf/10.1103/PhysRevB.34.5390&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw2tTeJ_f9MWGD953oQoN3ID">this paper</a>).&nbsp;</li></ul></div><div>Alright, so much for theory. What I mentioned above looks complicated, but they are very important for you to understand what you are doing when you work with first-principles softwares. Now we turn to actual implementations and tutorials.</div><div><br></div><div>Our group uses Quantum ESPRESSO plus BerkeleyGW. The first is for the DFT part, and the second is for the GW-BSE part.&nbsp;Installing QE and BGW can be painstaking, so it will be the best if you can manage to get access to the Perlmutter supercomputer, with the two softwares installed. Go to&nbsp;<a href="https://workshop2022.berkeleygw.org/tutorial-workshop-resources/about" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://workshop2022.berkeleygw.org/tutorial-workshop-resources/about&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw0swleRmifyC6hbnqF0xzUs">this page</a>&nbsp;and scroll down to the bottom and enter the Globus repository of BerkeleyGW tutorials. Go to the data folder, and copy the&nbsp;1a-silicon folder to your supercomputer account. Go to 1-mf to do the QE run. First do 1-mf/1-scf, in which the Kohn-Sham equation is iteratively solved. In 1-mf/2.1-wfn, the Kohn-Sham equation is solved based on the ground state density in 1-scf, and we get a set of Kohn-Sham wave functions and energies on a much finer k-grid. In 1-mf/2.2-wfnq we do the same but on a shifted k-grid to avoid singularities of Coulomb interaction in the following GW calculation. Then we go to 2-bgw. In 1-epsilon, we calculate W under RPA, and in 2-sigma we calculate GW corrections (see the "GW-BSE in action" section above). You can read the input files and check out the options in the documentation of <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html" target="_blank" data-saferedirecturl="https://www.google.com/url?q=https://www.quantum-espresso.org/Doc/INPUT_PW.html&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw1wqMVHZQl6vJoTPRWRlGm-">QE </a>and <a href="http://manual.berkeleygw.org/4.0/" target="_blank" data-saferedirecturl="https://www.google.com/url?q=http://manual.berkeleygw.org/4.0/&amp;source=gmail&amp;ust=1739935407782000&amp;usg=AOvVaw3_IGg13IzT16-SblY3uRmO">BGW</a>. You can explore the rest of the tutorial to have a thorough understanding of the QE-BGW workflow.</div><div><br></div><div>If you finish the tutorial and feel attracted by the filed, I think Diana is quite willing to take intern students! I'm not sure whether she wants to take more PhD students in the future, because our group is already quite large, but she has wide connections in the first-principles community. Enjoy your journey in ab initio calculations!</div><div><br></div><div>Best,</div><div>Jinyuan</div><div class="yj6qo ajU"><div id=":13y" class="ajR" role="button" tabindex="0" data-tooltip="Show trimmed content" aria-label="Show trimmed content" aria-expanded="false"><img class="ajT" src="//ssl.gstatic.com/ui/v1/icons/mail/images/cleardot.gif"></div></div><div class="adL"><br></div></div></div></div></div></div></div></div><div class="HOEnZb adL"><div class="adm"><div id="q_24" class="ajR h4"><div class="ajT"></div></div></div><div class="h5"><br><div class="gmail_quote"><div dir="ltr" class="gmail_attr">On Mon, Feb 10, 2025 at 11:33 AM <span class="il">Chang</span> <span class="il">Shu</span> &lt;<a href="mailto:changshu@umich.edu" target="_blank"><span class="il">changshu</span>@umich.edu</a>&gt; wrote:<br></div><blockquote class="gmail_quote" style="margin:0px 0px 0px 0.8ex;border-left:1px solid rgb(204,204,204);padding-left:1ex"><div dir="ltr">Hey Jinyuan,<br><br>I’m reaching out to ask for your expertise on behalf of my mentee, Jacob Shemka (cc’d here), an undergraduate participating in our department’s Directed Reading Program this semester. Jacob is highly motivated and deeply interested in condensed matter, particularly in bridging theory with computational methods. While I'll be guiding him on some topics, he has expressed strong enthusiasm to learn about density functional theory (DFT) and the GW method—areas where my own background is limited.<br><br>Given your extensive experience and knowledge in DFT/GW, could you point us to your go-to intro textbooks, lecture notes, or even practical tutorials/codes (Python/Julia/whatever) for beginners? Jacob is eager to dive into these topics, please feel free to share any advice or insider's perspectives.<div><br></div><div>BTW, since your advisor, Prof. Diana Qiu, leads a group doing cutting-edge work in this area, would you happen to know if your team has any internship or research assistant openings in the&nbsp;future? Jacob has demonstrated exceptional dedication and would thrive in a collaborative environment where he could gain hands-on experience. If there's an opportunity let me know and I would be happy to connect you both.</div><div><br></div><div><div>Thank you very much for your time and guidance—we truly appreciate it!<br><br>Best,</div><div><span class="il">Chang</span></div></div></div>
</blockquote></div>
</div></div></div></div><div class="WhmR8e" data-hash="0"></div></div></div>