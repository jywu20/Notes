\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}

% More compact lists 
\setlist[itemize]{
    itemindent=17pt, 
    leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\res}{Res}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}
\newtcbtheorem[number within=section]{info}{Info}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}

% Displaying texts in bookmarkers

\pdfstringdefDisableCommands{%
  \def\\{}%
  \def\ce#1{<#1>}%
}

\pdfstringdefDisableCommands{%
  \def\texttt#1{<#1>}%
  \def\mathbb#1{#1}%
}
\pdfstringdefDisableCommands{\def\eqref#1{(\ref{#1})}}

\makeatletter
\pdfstringdefDisableCommands{\let\HyPsd@CatcodeWarning\@gobble}
\makeatother

\newenvironment{shelldisplay}{\begin{lstlisting}}{\end{lstlisting}}


\title{$GW$ and BSE methods}
\author{Jinyuan Wu}

\begin{document}
    
\maketitle

\section{Diagrammatics}

\subsection{Infinitesimals}

Note that here we need to do some ``mini-regularization''.
The first is about the value of the propagator 
to ensure that when $t = 0$, $\timeorder \expval*{c(t) c^\dagger(0)}$ is the particle number 
(so that if we evaluate the tadpole diagram, 
we get the Hartree term), 
the contribution of an electron line is actually 
\begin{equation}
    \timeorder \expval*{c_{\vb*{k}}(t) c_{\vb*{k}}^\dagger(0)} 
    = \int \frac{\dd{\omega}}{2\pi} \ee^{- \ii \omega (t - 0^+)} \frac{\ii}{\omega - \varepsilon_{\vb*{k}} + \mu}
    = \int \frac{\dd{\omega}}{2\pi} \ee^{\ii \omega 0^+} \ii G_0(\omega, \vb*{k}) .
\end{equation}
Another mini-regularization is when necessary, 
in the real space, 
we should assume the ``out-time'' is the ``in-time'' plus $0^+$,
because the Coulomb interaction isn't really spontaneous
and there is a small time retardation.
In the frequency space,
we need to assume that there is an infinite amount of energy on the interaction line,
and 
\begin{equation}
    V (q) = \frac{4 \pi e^2}{\vb*{q}^2 - \omega^2 - \ii 0^+}.
\end{equation}

\section{Overview of $GW$}


\subsection{One-shot $GW$}

In practice, one-shot $GW$ is usually preferred over self-consistent schemes.
The point here is that GW neglects the vertex,
so iterative $GW$ only leads us towards the more and more inaccurate way. 
Still, this only explains why iterative $GW$ is band 
but doesn't explain why one-shot $GW$ is good. 
In other words, we need to know how certain factors 
in the one-shot $GW$ scheme somehow makes up for 
the missing vertex correction.

One possible form of the vertex is the electron-hole interaction, which is calculated by solving the BSE. 
Now an empirical fact is  
LDA tends to give the same band gap as BSE, 
leading to a pretty good one-shot approximation. 

The question, then, is why LDA in some cases works as well as BSE.
The reason for this is because of the relation between the derivative discontinuity in DFT and electron-hole interaction kernel
TODO: the relation with \cite{perdew1982density}


\subsection{Deriving formulas}

\subsection{Discussion: what's missing in the Hartree-Fock approximation, then?}


\section{Accuracy of $GW$}

\subsection{On so-called failure of $GW$}

Some (weak-correlated, of course) materials are claimed to be impossible 
to be characterized correctly using $GW$,
or at least $G^0 W^0$.
\cite{shih2010quasiparticle} refutes such a claim, 
at least for \ce{ZnO}.

\subsection{Convergence issues}

See https://www.nersc.gov/assets/Uploads/ConvergenceinBGW.pdf

\bibliographystyle{plain}
\bibliography{gw,dft}

\end{document}