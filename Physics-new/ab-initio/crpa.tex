\documentclass{beamer}
\usepackage{physics}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{mathdots}
\usepackage{yhmath}
\usepackage{cancel}
\usepackage{color}
\usepackage{siunitx}
\usepackage{array}
\usepackage{multirow}
\usepackage[version=4]{mhchem}
\usepackage{amssymb}
\usepackage{textcomp, gensymb}
\usepackage{pifont}
\newcommand{\cmark}{\ding{51}}%
\newcommand{\xmark}{\ding{55}}%
\usepackage{tabularx}
\usepackage{extarrows}
\usepackage{booktabs}
\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}
\usepackage[style=verbose,backend=bibtex]{biblatex}
\addbibresource{wannier.bib}
\addbibresource{hubbard.bib}
\renewcommand{\footnotesize}{\scriptsize}
\usepackage{listings}
\usepackage{hyperref}

\newcommand{\pair}[1]{\langle #1 \rangle}
\DeclareMathOperator{\ee}{e}
\DeclareMathOperator{\ii}{i}

\newcommand{\concept}[1]{\textbf{#1}}
\newcommand*{\abinitio}{\textit{ab initio}}
\newcommand{\shortcode}[1]{\texttt{#1}}

%Information to be included in the title page:
\title{Constrained RPA}
\author{Jinyuan Wu}

\usetheme{madrid}

\begin{document}

\frame{\titlepage}

\begin{frame}
\frametitle{Table of contents}

\tableofcontents    

\end{frame}

\section{General idea}

\begin{frame}
\frametitle{Motivation}

Strongly correlated electrons are \dots
\begin{itemize}
    \item Hard to treat \abinitio
    \item Should be described by a lattice model
\end{itemize}    

\begin{equation}
    H = - t \sum_{\pair{\vb*{i}, \vb*{j}}, \sigma}
        c^\dagger_{\vb*{i} \sigma} c_{\vb*{j} \sigma}
        + \text{h.c.}
        + U \sum_{\vb*{i}} n_{\vb*{i} \uparrow} n_{\vb*{i} \downarrow}.
\end{equation}

But should all electrons be included?

\begin{itemize}
    \item $d$ electron: correlated ones 
    \item $r$ electron: ``trivial'' ones
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Diagrammatics}

Screening by $d$ and $r$ = first screened by $r$ and then $d$

\begin{equation}
    W = (1 - v P)^{-1} v = (1 - W_r P_d)^{-1} W_r, \quad 
    W_r = (1 - v P_r)^{-1} v,
\end{equation}
\begin{itemize}
    \item $W$ is effective interaction 
    \item where $P_d$ is the polarization within $d$ subspace,
    \item and $P_r = P - P_d$
\end{itemize}

\begin{center}
    \input{feyn/crpa-1.tex}
\end{center}

\end{frame}

\begin{frame}
\frametitle{Diagrammatics}

\begin{itemize}
    \item $P_d$ hard to obtain $\Rightarrow$ we left it to an effective interaction 
    without doing resummation for it
    \item $P_r$ can be done by \shortcode{epsilon} $\Rightarrow$
        $W_r$ can be obtained by \shortcode{epsilon}
    \item But 
    \begin{center}
        \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-0.6,xscale=0.6]
            %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300
            
            %Straight Lines [id:da24436922749346324] 
            \draw    (347.33,149.91) -- (359.75,149.91) ;
            %Straight Lines [id:da2754743780079656] 
            \draw    (419.75,150.66) -- (432.16,150.66) ;
            %Shape: Arc [id:dp8646599824167052] 
            \draw  [draw opacity=0][line width=1.5]  (359.75,149.91) .. controls (359.92,133.49) and (373.29,120.23) .. (389.75,120.23) .. controls (406.32,120.23) and (419.75,133.66) .. (419.75,150.23) .. controls (419.75,150.37) and (419.75,150.52) .. (419.75,150.66) -- (389.75,150.23) -- cycle ; \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][line width=1.5]  (359.75,149.91) .. controls (359.92,133.49) and (373.29,120.23) .. (389.75,120.23) .. controls (406.32,120.23) and (419.75,133.66) .. (419.75,150.23) .. controls (419.75,150.37) and (419.75,150.52) .. (419.75,150.66) ;  
            %Shape: Arc [id:dp0010091790996433758] 
            \draw  [draw opacity=0][line width=1.5]  (419.72,150) .. controls (419.73,150.32) and (419.73,150.64) .. (419.73,150.96) .. controls (419.73,167.53) and (406.3,180.96) .. (389.73,180.96) .. controls (373.17,180.96) and (359.73,167.53) .. (359.73,150.96) .. controls (359.73,150.61) and (359.74,150.26) .. (359.75,149.91) -- (389.73,150.96) -- cycle ; \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][line width=1.5]  (419.72,150) .. controls (419.73,150.32) and (419.73,150.64) .. (419.73,150.96) .. controls (419.73,167.53) and (406.3,180.96) .. (389.73,180.96) .. controls (373.17,180.96) and (359.73,167.53) .. (359.73,150.96) .. controls (359.73,150.61) and (359.74,150.26) .. (359.75,149.91) ;  
            %Straight Lines [id:da4499744987871399] 
            \draw [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ]   (390.21,120.5) -- (391.75,120.49) ;
            \draw [shift={(394.75,120.48)}, rotate = 179.74] [fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;
            %Straight Lines [id:da7286267028918754] 
            \draw [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ]   (390.71,180.75) -- (387.25,180.74) ;
            \draw [shift={(384.25,180.73)}, rotate = 0.18] [fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ; 
            \end{tikzpicture}            
    \end{center}
    is not in $P_r$, or otherwise we have double counting
    \item That's what we call \concept{constrained RPA (cRPA)}
    \item A program to calculate a single ring diagram is needed
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Band part}

In $GW$:

\begin{equation}
    \begin{aligned}
        \varepsilon^{GW} &= \varepsilon^0 + \Sigma^{\text{Hartree}} + \Sigma^{GW} \\
        &= \underbrace{\varepsilon^0 + \Sigma^{\text{Hartree}} + V^{\text{xc}}}_{\text{\shortcode{WFN}}} 
        + \underbrace{\Sigma^{GW}}_{\text{\shortcode{sigma}}} 
        - \underbrace{V^{\text{xc}}}_{\text{\shortcode{vxc.dat}}}
    \end{aligned}
\end{equation}

In the effective model \dots
\begin{itemize}
    \item We want $\varepsilon^0$ 
    \item So the same $-V^{\text{xc}}$ procedure is needed
    \item A problem to calculate a single ring diagram is needed.
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Risks in accuracy}

Uncontrolled approximation: does RPA work for 
\begin{center}
    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-0.6,xscale=0.6]
        %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300
        
        %Straight Lines [id:da24436922749346324] 
        \draw    (347.33,149.91) -- (359.75,149.91) ;
        %Straight Lines [id:da2754743780079656] 
        \draw    (419.75,150.66) -- (432.16,150.66) ;
        %Shape: Arc [id:dp8646599824167052] 
        \draw  [draw opacity=0][line width=1.5]  (359.75,149.91) .. controls (359.92,133.49) and (373.29,120.23) .. (389.75,120.23) .. controls (406.32,120.23) and (419.75,133.66) .. (419.75,150.23) .. controls (419.75,150.37) and (419.75,150.52) .. (419.75,150.66) -- (389.75,150.23) -- cycle ; \draw  [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ][line width=1.5]  (359.75,149.91) .. controls (359.92,133.49) and (373.29,120.23) .. (389.75,120.23) .. controls (406.32,120.23) and (419.75,133.66) .. (419.75,150.23) .. controls (419.75,150.37) and (419.75,150.52) .. (419.75,150.66) ;  
        %Shape: Arc [id:dp0010091790996433758] 
        \draw  [draw opacity=0][line width=1.5]  (419.72,150) .. controls (419.73,150.32) and (419.73,150.64) .. (419.73,150.96) .. controls (419.73,167.53) and (406.3,180.96) .. (389.73,180.96) .. controls (373.17,180.96) and (359.73,167.53) .. (359.73,150.96) .. controls (359.73,150.61) and (359.74,150.26) .. (359.75,149.91) -- (389.73,150.96) -- cycle ; \draw  [color={rgb, 255:red, 74; green, 144; blue, 226 }  ,draw opacity=1 ][line width=1.5]  (419.72,150) .. controls (419.73,150.32) and (419.73,150.64) .. (419.73,150.96) .. controls (419.73,167.53) and (406.3,180.96) .. (389.73,180.96) .. controls (373.17,180.96) and (359.73,167.53) .. (359.73,150.96) .. controls (359.73,150.61) and (359.74,150.26) .. (359.75,149.91) ;  
        %Straight Lines [id:da4499744987871399] 
        \draw [color={rgb, 255:red, 208; green, 2; blue, 27 }  ,draw opacity=1 ]   (390.21,120.5) -- (391.75,120.49) ;
        \draw [shift={(394.75,120.48)}, rotate = 179.74] [fill={rgb, 255:red, 208; green, 2; blue, 27 }  ,fill opacity=1 ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;
        %Straight Lines [id:da7286267028918754] 
        \draw [color={rgb, 255:red, 74; green, 144; blue, 226 }  ,draw opacity=1 ]   (390.71,180.75) -- (387.25,180.74) ;
        \draw [shift={(384.25,180.73)}, rotate = 0.18] [fill={rgb, 255:red, 74; green, 144; blue, 226 }  ,fill opacity=1 ][line width=0.08]  [draw opacity=0] (9.82,-4.72) -- (0,0) -- (9.82,4.72) -- (6.52,0) -- cycle    ;
        \end{tikzpicture}        
\end{center}

The hopping between $d$ electrons is small $\Rightarrow$ it's safe to do so 
\footcite{aryasetiawan2004frequency}

\end{frame}

\section{The problem of dynamic Hubbard model}

\begin{frame}
\frametitle{Dynamic interaction in Hubbard model}

Recall that $W = W(\vb*{r}, \vb*{r}, \textcolor{red}{\omega} )$
$\Rightarrow$ 
$U_{\vb*{i} \vb*{j} \vb*{k} \vb*{l}}(\omega)$
$\Rightarrow$
retarded interaction! 

\begin{itemize}
    \item Hamiltonian form: interactions are always immediate 
    (bosonic auxiliary field required to create retardation)
    \item \dots or path integral formalism is to be used 
    \item Either it, it's slow!!! 
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{Dynamic interaction in Hubbard model}

Is it possible to just enforce $\omega = 0$ \dots
But it's not accurate!\footcite{aryasetiawan2004frequency}

\begin{center}
    \includegraphics[width=0.45\textwidth]{plots/ni-re-sigma-1.PNG}
    \includegraphics[width=0.45\textwidth]{plots/ni-im-sigma-1.PNG}
\end{center}

\ce{Ni} self-energy, from static Hubbard $U = W_r(\omega = 0)$,
and from full $W(\omega)$ 

\end{frame}

\begin{frame}
\frametitle{Dynamic interaction in Hubbard model}

\textbf{Why $\Im \Sigma$ is better captured by static $U$ than $\Re \Sigma$?}

Because $\Im \Sigma \propto \text{DOS}$ TODO: why??

And then high-frequency electrons contribute to low-frequency $\Re \Sigma$ 

\end{frame}

\begin{frame}
\frametitle{Possible way to make the Hubbard model static}

\textbf{Key point: correct the single-electron Hamiltonian using the retarded interaction}

\begin{itemize}
    \item Def: $G_d$ = Green function for $d$ electrons; 
        $\tilde{G}_d$ = Green function for $d$ electrons corrected by $W - W_d$; 
        $W$ = RPA screened Coulomb interaction; 
        $W_d$ = static Hubbard $U$ screened by $G_d$; 
        $\tilde{W}_d$ = static Hubbard $U$ screened by $\tilde{G}_d$;
    \item Ignoring hopping between $d$ and $r$ subspaces caused by $W$
        (so the $\ii W (G - G_d)$ term is irrelevant for $d$ electrons), we have 
        \begin{equation}
            \tilde{G}_d^{-1} - \ii \tilde{G}_d \tilde{W}_d = 
            G_d^{-1} - \ii G_d W_d - \ii G_d (W - W_d).
        \end{equation}
    \item  From
    \begin{equation}
        W = (1 - UP)^{-1} U, \quad P = - \ii G G \Rightarrow
        G^{-1} - \ii GW = (1 - UP)^{-1} G^{-1} 
    \end{equation} 
    we get the final equation: 
    (here $\tilde{P}_d = - \ii \tilde{G}_d \tilde{G}_d$, 
    $P_d = - \ii G_d G_d$)
    \begin{equation}
            (1 - U \tilde{P}_d)^{-1} \tilde{G}_d^{-1}
            = (1 - U P_d^{-1})^{-1} G_d^{-1}
            - \ii G_d  (W -W_d).
        \end{equation}
\end{itemize}

\end{frame}

\section{Existing implementations}

\begin{frame}
\frametitle{Existing implementations}

\begin{itemize}
    \item \textbf{VASP}    
    \shortcode{ALGO=CRPA} selects constrained RPA calculations, 
    available as of VASP.6.4
    \item \textbf{ABINIT} 
    \shortcode{ucrpa} before version 9, 
    as an option in \href{https://docs.abinit.org/variables/gw/\#ucrpa}{the RPA module}
    \item \textbf{BerkeleyGW} \xmark Unfortunately \dots
\end{itemize}

\end{frame}

\end{document}