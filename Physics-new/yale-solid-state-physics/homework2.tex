\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

% More compact lists 
\setlist[itemize]{
    itemindent=17pt, 
    leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}
\newtcbtheorem[number within=section]{info}{Info}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}

\newenvironment{shelldisplay}{\begin{lstlisting}}{\end{lstlisting}}

\title{Solid State Physics Homework 2}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\paragraph{Problem 1} [15 points] Problem 2 of Chapter 1 of Kittel:
Consider the planes with indices (100) and (001); the lattice is fcc, and the indices refer to the conventional cubic cell. What are the indices of these planes when referred to the primitive axes of Fig. 11?

\paragraph{Solution} $(100)$ planes are parallel to $\vb*{a}_3 - \vb*{a}_1$ and $\vb*{a}_2$,
so the $\vb*{a}_1$-intercept and the $\vb*{a}_3$-intercept are the same,
while the $\vb*{a}_2$-intercept is $\infty$.
So the new indices are 
\[
    1 : \frac{1}{\infty} : 1 = 1 : 0 : 1,
\]
i.e. $(101)$. Similarly, the new indices for the $(001)$ planes are $(011)$.

\paragraph{Problem 2} [15 points] Problem 1 of Chapter 2 of Kittel:
Consider a plane $h k l$ in a crystal lattice. (a) Prove that the reciprocal lattice vector $\mathbf{G}=h \mathbf{b}_1+k \mathbf{b}_2+l \mathbf{b}_3$ is perpendicular to this plane. (b) Prove that the distance between two adjacent parallel planes of the lattice is $d(h k l)=2 \pi /|\mathbf{G}|$. (c) Show for a simple cubic lattice that $d^2=a^2 /\left(h^2+k^2+l^2\right)$.

\paragraph{Solution} 
\begin{itemize}
\item[(a)] Since 
\[
    \vb*{a} \cdot \vb*{b}_j = 2 \pi \delta_{ij},
\]
suppose $\{x_i\}$ are the coordinates based on $\{\vb*{a}_i\}$, i.e. 
\begin{equation}
    \vb*{r} = \sum_{i=1}^3 x_i \vb*{a}_i,
\end{equation}
we have 
\begin{equation}
    x_i = \frac{1}{2\pi} \vb*{b}_i \cdot \vb*{r}.
\end{equation}
So 
\begin{equation}
    \grad{x_i} = \frac{1}{2 \pi} \vb*{b}_i.
\end{equation}
The equation of a $(hkl)$ plane is 
\begin{equation}
    h x_1 + k x_2 + l x_3 = \text{const},
\end{equation}
so one of the normal vector of the plane is given by 
\begin{equation}
    \grad{(h x_1 + k x_2 + l x_3)} = \frac{h}{2\pi} \vb*{b}_1 + \frac{k}{2\pi} \vb*{b}_2 + \frac{l}{2\pi} \vb*{b}_3,
\end{equation}
and of course this is parallel to $\vb*{G}$,
so $\vb*{G}$ is perpendicular to the plane.

\item[(b)] There has to be a lattice vector connecting two $(hkl)$ planes.
The distance between the two planes is therefore 
\begin{equation}
    d = \frac{\abs{\vb*{G}' \cdot \vb*{G}}}{\abs{\vb*{G}}} 
    = \frac{2\pi \abs{h x_1' + k x_2' + l x_3'}}{\abs{\vb*{G}}}, \quad 
    \vb*{G}' = \sum_{i=1}^3 x_i' \vb*{b}_i.
\end{equation}
For two adjacent planes, we should take the non-zero minimum value of $d$.
Of course 
\[
    \abs{h x_1' + k x_2' + l x_3'} \in \mathbb{N},
\]
and a elementary number theory theorem tells us 
that 1 is a linear combination of any coprime integers,
so the non-zero minimum of $\abs{h x_1' + k x_2' + l x_3'}$ is 1,
and thus 
\begin{equation}
    d_{\min} = \frac{2\pi}{\abs{\vb*{G}}}.
\end{equation}

\item[(c)] For a simple cubic lattice, 
$\vb*{a}_i$ vectors are orthogonal to each other,
and so are $\vb*{b}_i$ vectors.
The condition $\vb*{a}_i \cdot \vb*{b}_j = 2\pi \delta_{ij}$ means 
the length of all $\vb*{b}_i$ vectors is $2\pi / a$,
so 
\[
    \abs{\vb*{G}} = \sqrt{ \left(\frac{2\pi}{a}\right)^2 (h^2 + k^2 + l^2) },
\]
and therefore 
\begin{equation}
    d^2 = \frac{a^2}{h^2 + k^2 + l^2}.
\end{equation}

\end{itemize}

\paragraph{Problem 3} [20 points] Graphene is purely $2 D$ carbon material. It has a $2 D$ hexagonal lattice with a two-atom basis. 
Let the length of the primitive lattice vectors be $a$. Show that (i) the $2 D$ reciprocal lattice is also hexagonal but rotated by 30 degrees, (ii) find the length of the primitive reciprocal lattice vectors, and (iii) find and draw a sketch of the 2D Wigner-Seitz cell of the reciprocal space lattice: the corners are the ``famous'' ``K points'' of graphene.

\paragraph{Solution} See \prettyref{fig:problem-3-answer}. 
The first question is graphically answered by the rotation.
Since
\[
    \vb*{a}_1 \cdot \vb*{b}_1 = 2\pi \Rightarrow \abs{\vb*{b}_1} = \frac{2\pi}{\abs{\vb*{a}_1}} = \frac{2\pi}{a},
\]
the answer of the second question is given by $2\pi / a$.
The third question is answered by looking at the pink area in the diagram.

\begin{figure}
    \centering
    \input{lattices/graphene-unit-cell.tex}
    \caption{Relevant diagrams in Problem 3}
    \label{fig:problem-3-answer}
\end{figure}

\paragraph{Problem 4} [15 points] Problem 3 of Chapter 2 of Kittel: a Brillouin zone is simply the Wigner-Seitz cell of reciprocal space (you don't have to use the provided vector identity but you can; you can also use any result we had in lecture relating to the alternative derivation of reciprocal lattice vectors involving the inverse matrix method).
Show that the volume of the first Brillouin zone is $(2 \pi)^3 / V_c$, where $V_c$ is the volume of a crystal primitive cell. Hint: The volume of a Brillouin zone is equal to the volume of the primitive parallelepiped in Fourier space. Recall the vector identity $(\mathbf{c} \times \mathbf{a}) \times(\mathbf{a} \times \mathbf{b})=(\mathbf{c} \cdot \mathbf{a} \times \mathbf{b}) \mathbf{a}$.

\paragraph{Solution} Since the volume of all primitive cells of the same lattice is the same,
we can just calculate the volume of the parallelepiped spanned by $\{\vb*{b}_i\}$.
The condition $\vb*{a}_i \cdot \vb*{b}_j = 2\pi \delta_{ij}$ can be rewritten as 
\[
    \pmqty{ \vb*{b}_1^\top \\ \vb*{b}_2^\top \\ \vb*{b}_3^\top } \pmqty{ \vb*{a}_1 & \vb*{a}_2 & \vb*{a}_3 } = 2\pi I_{3 \times 3},
\]
and by taking the determinant of the equation we get 
\[
    \det \pmqty{ \vb*{b}_1^\top \\ \vb*{b}_2^\top \\ \vb*{b}_3^\top } \det \pmqty{ \vb*{a}_1 & \vb*{a}_2 & \vb*{a}_3 } = (2\pi)^3 = \det \pmqty{ \vb*{b}_1 & \vb*{b}_2 & \vb*{b}_3 } \det \pmqty{\vb*{a}_1 & \vb*{a}_2 & \vb*{a}_3},
\]
so 
\[
    V_{\text{inverse space unit cell}} V_{\text{unit cell}} = (2\pi)^3,
\]
\begin{equation}
    V_{\text{Brillouin}} = \frac{(2\pi)^3}{V_{\text{unit cell}}}.
\end{equation}

\paragraph{Problem 5} [20 points] Problem 7 Chapter 2 of Kittel with added question:
Consider a line of atoms $A B A B \ldots A B$, with an $A-B$ bond length of $\frac{1}{2} a$. The form factors are $f_A, f_B$ for atoms $A, B$, respectively. The incident beam of $\mathrm{x}$-rays is perpendicular to the line of atoms. (a) Show that the interference condition is $n \lambda=a \cos \theta$, where $\theta$ is the angle between the diffracted beam and the line of atoms. (b) Show that the intensity of the diffracted beam is proportional to $\left|f_A-f_B\right|^2$ for $n$ odd, and to $\left|f_A+f_B\right|^2$ for $n$ even. (c) Explain what happens if $f_A=f_B$.

After you answer that, explain WHY what happens in part (c) happens (i.e. what the physical meaning is).

\paragraph{Solution} \begin{itemize}

\item[(a)] The intensity is given by 
\begin{equation}
    I(\vb*{k}') \propto \abs{\int \dd[3]{\vb*{r}} n(\vb*{r}) \ee^{- \ii \vb*{q} \cdot \vb*{r}}}^2, \quad \vb*{q} = \vb*{k}' - \vb*{k}.
\end{equation}
In the case of this problem, $\vb*{k} \parallel \vu*{y}$,
and the density is given by 
\[
    n(\vb*{r}) = \sum_{\vb*{R}_{\vb*{i}}} (
        n_A(\vb*{r} - \vb*{R}_{\vb*{i}}) 
        + n_B(\vb*{r} - \vb*{R}_{\vb*{i}} - a \vu*{x} / 2)),
\]
where $\vb*{R}_{\vb*{i}}$ is an arbitrary lattice vector.
Now we have 
\[
    \begin{aligned}
        \int \dd[3]{\vb*{r}} n(\vb*{r}) \ee^{- \ii \vb*{q} \cdot \vb*{r}} &= 
        \sum_{\vb*{i}} \int \dd[3]{\vb*{r}} 
        (\ee^{- \ii \vb*{q} \cdot (\vb*{r} + \vb*{R}_{\vb*{i}})} n_A(\vb*{r})
        + \ee^{-\ii \vb*{q} \cdot (\vb*{r} + \vb*{R}_{\vb*{i}} + a \vu*{x} / 2)} n_B(\vb*{r})) \\
        &= \sum_{\vb*{i}} \ee^{- \ii \vb*{q} \cdot \vb*{R}_{\vb*{i}}}
        \int \dd[3]{\vb*{r}} \ee^{- \ii \vb*{q} \cdot \vb*{r}} (n_A(\vb*{r}) + \ee^{- \ii q_x a /2 } n_B(\vb*{r})) \\
        &= \sum_{\vb*{i}} \ee^{- \ii \vb*{q} \cdot \vb*{R}_{\vb*{i}}} (f_A + \ee^{- \ii k'_x a / 2} f_B),
    \end{aligned}
\]
where the form factors are given by 
\begin{equation}
    f_{A, B} = \int \dd[3]{\vb*{r}} \ee^{- \ii \vb*{q} \cdot \vb*{r}} n_{A, B} (\vb*{r}) .
\end{equation}
Thus the intensity is 
\[
    I(\vb*{k}') \propto \abs{\sum_{\vb*{i}} \ee^{- \ii \vb*{q} \cdot \vb*{R}_{\vb*{i}}} (f_A + \ee^{- \ii k'_x a / 2} f_B)}^2.
\]
The lattice in question is one-dimensional, 
and the reciprocal space lattice vector index $\vb*{m}$ is just $m \in \mathbb{Z}$,
so we have 
\[
    \vb*{G}_n = \frac{2\pi}{a} n \vu*{x}, \quad n \in \mathbb{Z}.
\]
Thus 
\begin{equation}
    \sum_{\vb*{i}} \ee^{- \ii \vb*{q} \cdot \vb*{R}_{\vb*{i}}} = \sum_{n} \delta_{\frac{2\pi}{a}n, q_x} = 
    \sum_{n} \delta_{\frac{2\pi}{a} n, k_x'} = \sum_{n} \delta_{\frac{2\pi}{a}n, \frac{2\pi}{\lambda} \cos \theta}.
    \label{eq:delta-function-diffraction}
\end{equation}
So finally we have
\begin{equation}
    \begin{aligned}
        I(\vb*{k}')  &\propto \begin{cases}
           \abs*{f_A + \ee^{- \ii k_x' a / 2} f_B }^2 , & n \lambda = a \cos \theta, \\
            0 &, \text{otherwise}
        \end{cases} \\
        &= \begin{cases}
            \abs*{f_A + (-1)^n f_B}, & n \lambda = a \cos \theta , \\
            0 &, \text{otherwise}.
        \end{cases}
    \end{aligned}
\end{equation}
The above equation means we can only find diffracted beam on the directions decided by 
\begin{equation}
    n \lambda = a \cos \theta, \quad n \in \mathbb{Z},
    \label{eq:diffraction-condition-1}
\end{equation}
and the intensity is proportion to $\abs*{f_A - f_B}^2$ when $n$ is odd
and $\abs*{f_A + f_B}$ when $n$ is even.

\item[(c)] When $f_A = f_B$, 
at odd $n$ there is no diffracted beam.
This happens because at this case, actually the lattice constant is $a/2$ and not $a$,
because $A$ and $B$ atoms can no longer be distinguished from each other.
So \eqref{eq:delta-function-diffraction} should be replaced by 
\begin{equation}
    \sum_{\vb*{i}} \ee^{- \ii \vb*{q} \cdot \vb*{R}_{\vb*{i}}} = \sum_{n} \delta_{\frac{2\pi}{a/2}n, \frac{2\pi}{\lambda} \cos \theta},
\end{equation}
which is non-zero when 
\[
    \frac{2\pi}{a/2}n = \frac{2\pi}{\lambda} \cos \theta ,
\]
\begin{equation}
    \cos \theta = \frac{\lambda}{a} 2n = \frac{\lambda}{a} \times \text{even number}.
\end{equation}
Comparing this with \eqref{eq:diffraction-condition-1},
which can be rewritten as 
\[
    \cos \theta = \frac{\lambda}{a} n,
\]
we find when $A$ and $B$ looks the same, 
indeed only at even $n$ do we have diffracted beams.

\end{itemize}

\begin{figure}
    \centering
    \input{lattices/a-b-chain.tex}
    \caption{The lattice structure in Problem 5}
\end{figure}

\paragraph{Problem 6} [15 points] Ashcroft and Mermin discuss the geometrical structure factor of the monoatomic diamond lattice (e.g., diamond, Si, or $\mathrm{Ge}$ ) on pages 104 and 106107. They predict that the $(222)$ reflection should have zero intensity and is thus a "forbidden" reflection. However, the (222) reflection is observable experimentally although it is extremely weak. So, there must be a fundamental error in their discussion. Since the math is done correctly, there must be a physical problem or problematic physical assumption somewhere. What is the error? [A similar mistake is made for the hcp structure in problem 3 of chapter $6 .$ ] (Note: this is not about multiple scattering of $x$-rays, nor should you have to look up literature to answer this question.)

\paragraph{Solution} The claim that the (222) reflection is forbidden 
is based on the ideal structure of the diamond lattice.
We can slightly break the symmetry of the system by, say,
moving $\vb*{d}_2$ slightly, and then 
\[
    S_{\vb*{K}}=1+\exp \left[\frac{1}{2} \ii \pi\left( (1 + \delta_1) n_1+ (1 + \delta_2) n_2+ (1 + \delta_3) n_3\right)\right],
\]
and now under all $(n_1, n_2, n_3)$,
the RHS is non-zero (though its value can be small).

\end{document}