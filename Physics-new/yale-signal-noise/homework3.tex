\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}

% More compact lists 
\setlist[itemize]{
    itemindent=17pt, 
    leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}
\newtcbtheorem[number within=section]{info}{Info}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}

\newenvironment{shelldisplay}{\begin{lstlisting}}{\end{lstlisting}}

\title{Homework 3}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\paragraph{Problem} 

\paragraph{Solution} 
\begin{itemize}
\item[(a)] The transmission line model is still a quasi-magnetostatic model.
Ignoring all resistance, and assuming that 
the only conducting objects in the system 
are the line at $r = 0$ and the boundary of the transmission line
(or otherwise we need several ``vertical layers'' in the effective circuit model),
that the inner structures of which can be ignored
(or otherwise there may be multiple modes of the system),
and that the boundary is grounded everywhere so there is no spatial variation of voltage on it
(or otherwise there has to be an inductor on the top line in \prettyref{fig:transmission}(b)),
the physics of a line element is shown in \prettyref{fig:transmission}(a):
The current along the $x$ direction creates a magnetic field, 
which induces an electric field component along the $x$ axis 
because $\curl{\vb*{E}} = - \pdv*{\vb*{B}}{t}$.
We also have a radial component of $\vb*{E}$ 
because of the electrostatic field established between the surface and the inner conducting line.

Thus, in \prettyref{fig:transmission}(a),
we have two electric current degrees of freedom (one at $r=0$, the other on the boundary),
one electric field degrees of freedom between the central line and the boundary,
one magnetic field degree of freedom 
which gives $\vb*{E}_{\text{ind}}$ along the $x$ direction.
The distribution of the magnetic field is completely decided by the currents 
so we only need one scalar -- the magnetic flux -- to represent the magnetic field,
and similarly we only need two scalars -- the voltage on the central conducting line 
and the voltage between the $r=0$ line and the surface -- 
to represent $\vb*{E}_{\text{ind}}$ and $\vb*{E}_{\text{static}}$.
The resulting theory for the line element in \prettyref{fig:transmission}(a) 
has the same equations of motion with the shaded area in \prettyref{fig:transmission}(b).

Suppose the parameters of the capacitor and the inductor in \prettyref{fig:transmission}(b)
are $C$ and $L$, respectively.
Note that $\varphi(x, t)$ is defined on the capacitors, not the inductors,
and the variable doesn't represent the magnetic flux.

By basic circuit analysis we know 
the electromotive force on the insulator in \prettyref{fig:transmission}(b) is
\[
    \mathcal{E} = V_{n+1} - V_{n},
\]
and according to Faraday's law of induction, the electromotive force on the inductor is 
(here the ``inductor'' is single-turned, which can be found by looking at \prettyref{fig:transmission}(a))
\[
    \mathcal{E} = - \dv{\Phi}{t},
\]
so the current is 
\[
    I = \frac{1}{L} \Phi = - \frac{1}{L} \int \dd{t} \mathcal{E} = \frac{1}{L} (\varphi_n - \varphi_{n+1}) ,
\]
so the energy is 
\begin{equation}
    \frac{1}{2} L I^2 = \frac{1}{2L} (\varphi_n - \varphi_{n+1})^2.
    \label{eq:magnetic-energy}
\end{equation}
The energy of $C_n$ is by definition
\begin{equation}
    \frac{1}{2} C V_n^2 = \frac{1}{2} C \dot{\varphi_n}^2.
    \label{eq:electric-energy}
\end{equation}
Tracing the origin of \eqref{eq:magnetic-energy} and \eqref{eq:electric-energy},
we find they eventually come from the magnetic part and the electric part of electromagnetic energy,
and since in the electromagnetism Lagrangian,
they are recognized as the kinetic energy part and the potential energy part, respectively,
in our effective model the same should be done, 
so the Lagrangian of the shaded part in \prettyref{fig:transmission}(b) is
\begin{equation}
    L_{n} = \frac{1}{2} C \dot{\varphi}_n^2 - \frac{1}{2 L} (\varphi_n - \varphi_{n+1})^2.
\end{equation}
So the total Lagrangian is 
\begin{equation}
    \begin{aligned}
        L &= \sum_n L_n = 
        \sum_n \left( \frac{1}{2} C \dot{\varphi}_n^2 - \frac{1}{2 L} (\varphi_n - \varphi_{n+1})^2 \right) 
        = \sum \frac{\Delta{x}}{a} 
        \left( \frac{1}{2} C \dot{\varphi}_n^2 - \frac{1}{2 L} (\varphi_n - \varphi_{n+1})^2 \right) \\
        &= \sum \Delta{x} \left(
            \frac{1}{2} \frac{C}{a} \dot{\varphi_n}^2 
            - \frac{1}{2 L / a} 
            \frac{(\varphi_n - \varphi_{n+1})^2}{a^2}  
        \right) \\
        &= \int \dd{x} \left(
            \frac{1}{2} c (\partial_t \varphi)^2 - \frac{1}{2 l} (\grad{\varphi})^2
        \right).
    \end{aligned}
\end{equation}
The dynamic equation is 
\[
    \partial_t \pdv{\mathcal{L}}{\partial_t \varphi} + \div \pdv{\mathcal{L}}{\grad{\varphi}} = 0,
\]
\begin{equation}
    c \pdv[2]{\varphi}{t} = \frac{1}{l} \laplacian \varphi.
    \label{eq:telegraph-eq}
\end{equation}

\item[(b)] By definition, 
\begin{equation}
    \pi(x, t) = \pdv{\mathcal{L}}{\dot{\varphi}} = c \dot{\varphi},
\end{equation}
and the Hamiltonian is 
\begin{equation}
    \begin{aligned}
        H &= \int \dd{x} (\pi \dot{\varphi} - \mathcal{L}) 
        = \int \dd{x} \left( \frac{1}{2} c \dot{\varphi}^2 + \frac{1}{2l} (\grad{\varphi})^2 \right) \\
        &= \int \dd{x} \left( \frac{1}{2c} \pi^2 + \frac{1}{2l} (\grad{\varphi})^2 \right) .
    \end{aligned}
\end{equation}
The EOM in Hamiltonian language is 
\begin{equation}
    \dot{\varphi} = \frac{1}{c} \pi, \quad 
    \dot{\pi} = - \fdv{H}{\varphi} = \frac{1}{l} \laplacian \varphi.
\end{equation}

\item[(c)] Suppose 
\begin{equation}
    \varphi(x, t) = \frac{1}{\sqrt{V}} \sum_k 
    (\underbrace{A_k \ee^{- \ii \omega_k t}}_{A_k(t)} \ee^{\ii k x}
    + \underbrace{A_k^* \ee^{\ii \omega_k t}}_{A^*_k(t)} \ee^{- \ii k x}).
\end{equation}
The momentum variable is 
\begin{equation}
    \pi(x, t) = c \dot{\varphi} 
    = \frac{c}{\sqrt{V}} \sum_k 
    (- \ii \omega_k \underbrace{A_k \ee^{- \ii \omega_k t}}_{A_k(t)} \ee^{\ii k x}
    + \ii \omega_k \underbrace{A_k^* \ee^{\ii \omega_k t}}_{A^*_k(t)} \ee^{- \ii k x}).
\end{equation}
So we have 
\[
    \begin{aligned}
        &\underbrace{\frac{1}{\sqrt{V}} \int \ee^{- \ii k x} \varphi(x, t)}_{\varphi_k(t)}
        = A_k(t) + A^*_{-k} , \\
        &\frac{1}{c} \underbrace{\frac{1}{\sqrt{V}} \int \ee^{- \ii k x} \pi(x, t)}_{\pi_k(t)}
        = - \ii \omega_k A_k(t) + \ii \omega_{-k} A_{-k}^*(t),
    \end{aligned}
\] 
where from \eqref{eq:telegraph-eq}, we have 
\begin{equation}
    \omega_k = \frac{\abs{k}}{\sqrt{lc}} = \omega_{-k}.
\end{equation}
So now $A_k(t)$ can be found from the above equation system:
\begin{equation}
    A_k(t) = \frac{1}{2} \left( \varphi_k - \frac{1}{\ii c \omega_k} \pi_k \right)
    = \frac{1}{2} \left( \varphi_k - \frac{Z}{\ii \abs{k}} \pi_k \right),
\end{equation}
and 
\begin{equation}
    A_k^*(t) = \frac{1}{2} \left( \varphi_{-k} + \frac{1}{\ii c \omega_k} \pi_{-k} \right)
    = \frac{1}{2} \left( \varphi_{-k} + \frac{Z}{\ii \abs{k}} \pi_{-k} \right).
\end{equation}
Now we compare this with $A^\leftarrow$ and $A^\rightarrow$.
We have 
\begin{equation}
    A^\leftarrow(x, t) = \frac{1}{2 \sqrt{Z}} (V(x, t) - Z I(x, t)).
\end{equation}
Circuit analysis means 
\begin{equation}
    I_{n-1} - I_n = C \dv{V}{t},
\end{equation}
and its continuous version is 
\begin{equation}
    - \pdv{I}{x} = c \pdv{V}{t} = c \pdv[2]{\varphi}{2} = \pdv{\pi}{t}, 
\end{equation}
So we have 
\begin{equation}
    A^\leftarrow(x, t) = \frac{1}{2 \sqrt{Z}} \left( \pdv{\varphi}{t} + Z \int \dd{x'} \pdv{\pi(x', t)}{t} \right).
\end{equation}
After Fourier transformation, we have 
\begin{equation}
    A_k^\leftarrow(t) = \frac{1}{2 \sqrt{Z}} \pdv{t} \left( \varphi_k(t) + Z \frac{1}{\ii k} \pi_k(t) \right)
    = \frac{- \ii \omega_k}{2 \sqrt{Z}} \left( \varphi_k(t) + Z \frac{1}{\ii k} \pi_k(t) \right).
\end{equation}
Similarly, we have 
\begin{equation}
    A_k^\rightarrow(t) = \frac{1}{2 \sqrt{Z}} \pdv{t} \left( \varphi_k(t) + Z \frac{1}{\ii k} \pi_k(t) \right)
    = \frac{- \ii \omega_k}{2 \sqrt{Z}} \left( \varphi_k(t) - Z \frac{1}{\ii k} \pi_k(t) \right).
\end{equation}
So when $k > 0$, we have 
\begin{equation}
    \begin{aligned}
        A_k^\rightarrow(t) &= \frac{- \ii \omega_k}{\sqrt{Z}} A_k(t), \\
        A_k^\leftarrow(t) &= \frac{- \ii \omega_k}{\sqrt{Z}} A_{-k}^*(t),
    \end{aligned}
\end{equation}
and when $k < 0$, we have 
\begin{equation}
    \begin{aligned}
        A_k^\leftarrow(t) &= \frac{- \ii \omega_k}{\sqrt{Z}} A_k(t), \\
        A_k^\rightarrow(t) &= \frac{- \ii \omega_k}{\sqrt{Z}} A_{-k}^*(t).
    \end{aligned}
\end{equation}
This is expected if we interpret 

\end{itemize}

\begin{figure}
    \centering
    \input{systems/transmission.tex}
    \caption{Transmission line}
    \label{fig:transmission}
\end{figure}

\end{document}