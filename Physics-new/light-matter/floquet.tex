\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{soulutf8}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{acro}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[backend=bibtex,sorting=none]{biblatex}
\addbibresource{floquet.bib}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}

% More compact lists 
\setlist[itemize]{
    itemindent=17pt, 
    leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\res}{Res}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Reference formatting
\newcommand*{\citesec}[1]{\S~{#1}}
\newcommand*{\citechap}[1]{chap.~{#1}}
\newcommand*{\citefig}[1]{Fig.~{#1}}
\newcommand*{\citetable}[1]{Table~{#1}}
\newcommand*{\citepage}[1]{pp.~{#1}}
\newrefformat{fig}{Fig.~\ref{#1}}
\newcommand*{\term}[1]{\textit{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}

\newtcbtheorem{infobox}{Box}{
    enhanced,
    boxrule=0pt,
    colback=blue!5,
    colframe=blue!5,
    coltitle=blue!50,
    borderline west={4pt}{0pt}{blue!65},
    sharp corners,
    fonttitle=\bfseries, 
    breakable,
    before upper={\parindent15pt\noindent}}{box}
\newtcbtheorem[use counter from=infobox]{theorybox}{Box}{
    enhanced,
    boxrule=0pt,
    colback=orange!5, 
    colframe=orange!5, 
    coltitle=orange!50,
    borderline west={4pt}{0pt}{orange!65},
    sharp corners,
    fonttitle=\bfseries, 
    breakable,
    before upper={\parindent15pt\noindent}}{box}
\newtcbtheorem[use counter from=infobox]{learnbox}{Box}{
    enhanced,
    boxrule=0pt,
    colback=green!5,
    colframe=green!5,
    coltitle=green!50,
    borderline west={4pt}{0pt}{green!65},
    sharp corners,
    fonttitle=\bfseries, 
    breakable,
    before upper={\parindent15pt\noindent}}{box}


\newenvironment{shelldisplay}{\begin{lstlisting}}{\end{lstlisting}}

% Shorthands
\DeclareAcronym{arpes}{long = angle-resolved photoemission spectroscopy, short = ARPES}

\newcommand*{\kB}{k_{\text{B}}}
\newcommand*{\muB}{\mu_{\text{B}}}
\newcommand*{\efermi}{E_{\text{F}}}
\newcommand*{\pfermi}{p_{\text{F}}}
\newcommand*{\vfermi}{v_{\text{F}}}
\newcommand*{\sA}{\text{A}}
\newcommand*{\sB}{\text{B}}
\newcommand*{\Tc}{T_{\text{c}}}
\newcommand*{\hethree}{$^3$He}
\newcommand*{\hefour}{$^4$He}
\newcommand{\epsr}{\epsilon_{\text{r}}}
\newcommand{\chie}{\chi_{\text{e}}}
\newcommand{\Efreq}{\tilde{\vb{E}}}
\newcommand{\Dfreq}{\tilde{\vb{D}}}
\newcommand{\Pfreq}{\tilde{\vb{P}}}

\title{Floquet theory}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\section{Introduction} 

\section{The Floquet formalism: quasienergies and quasi-stationary states}

In this section we outline the basic formalism of Floquet physics,
following the notation in \cite{rudner2020floquet}.
As is mentioned in the introduction,
Floquet effects happen with a time-periodic Hamiltonian;
below we let $T = 2 \pi / \omega$ be the period.
Such a Hamiltonian is usually an effective Hamiltonian
when the system (hereafter ``matter'')
is coupled with another degree of freedom
which does not change much in the time evolution;
the latter is hereafter called ``light'',
since in condensed matter systems, 
periodic driving is usually achieved by 
shedding a beam of light to the matter:
consider the general form of light-matter interaction Hamiltonian 
with only one active photon mode
\begin{equation}
    H_{\text{full}} = 
    H \otimes 1_{\text{light}} + 1_{\text{matter}} \otimes \hbar \left(
        b^\dagger b + \frac{1}{2} 
    \right) 
    + \underbrace{
        b V + b^\dagger V^\dagger  
    }_{H_{\text{light-matter coupling}}} ,
    \label{eq:full-light-matter}
\end{equation}
and we assume that the state of the electromagnetic part 
is close to a coherent state $\ket*{\alpha \ee^{- \ii \omega t}}$ 
with strong intensity that almost has zero time evolution. 
Under this assumption, we can project out the electromagnetic degree of freedom by 
\begin{equation}
    P = \sum_{i} \ket*{i} \bra*{i} \otimes \bra*{\alpha \ee^{- \ii \omega t}}, 
    \label{eq:from-extended-to-matter}
\end{equation} 
where $i$ labels eigenstates of the matter degrees of freedom,
and this means the Hamiltonian for the matter part is 
\begin{equation}
    H_{\text{driven}} = P H_{\text{full}} P = 
    H + \underbrace{\hbar \abs*{\alpha}^2 }_{\const.} + \alpha V \ee^{- \ii \omega t} + \alpha^* V^\dagger \ee^{\ii \omega t},
\end{equation}
which indeed evolves with period $2\pi / \omega$.


From the Floquet theory of differential equation, 
we know it is possible to expand an arbitrary state that 
evolves according to $H$ into 
a linear combination (the coefficients are constants) of 
$\{\ket*{\psi_n(t)}\}$ where 
\begin{equation}
    \ket*{\psi_n (t)} = \ee^{- \ii \varepsilon_n t / \hbar} \ket*{\Phi_n(t)},
    \quad \ket*{\Phi_n(t + T)} = \ket*{\Phi_n(t)}.
    \label{eq:floquet-wave-function}
\end{equation}
By discrete periodicity of $\ket*{\Phi_n(t)}$ we make Fourier expansion 
\begin{equation}
    \ket*{\Phi_n(t)} = \sum_m \ee^{- \ii m \omega t} \ket*{\phi_n^{(m)}},
    \label{eq:big-phi-to-extended-hilbert}
\end{equation}
where $m$ goes over all integers.
Note that here $\ket*{\phi_n^{(m)}}$
are \emph{Fourier coefficients} and are not eigenstates of anything; 
there is no normalization or orthogonality condition for them.
Using $i$ to label the eigenstates of the matter, 
we have 
\begin{equation}
    \ket*{\Phi_n(t)} = \sum_{i} \sum_{m}
    \ee^{- \ii m \omega t} \braket*{i}{\phi_n^{(m)}} \ket*{i}.
\end{equation}
The coefficients before $\ket*{i}$, 
not coefficients before $\ket*{\phi_n^{(m)}}$ in \eqref{eq:big-phi-to-extended-hilbert}, 
give the expansion of $\ket*{\Phi}$ in a 
complete, orthogonal basis.
The significance of $\ket*{\phi}$ vectors can be seen immediately below.

The Schrodinger equation 
\begin{equation}
    \dv{t} \ket*{\psi_n(t)} = H \ket*{\psi_n(t)}
\end{equation}
now reads 
\begin{equation}
    (\varepsilon_n + m \hbar \omega) \ket*{\phi_n^{(m)}} 
    = \sum_{m'} H^{(m - m')} \ket*{\phi_n^{(m')}},
\end{equation}
where 
\begin{equation}
    H(t) = \sum_{m} \ee^{- \ii m \omega t} H^{(m)}.
\end{equation}
Thus we find 
\begin{equation}
    \varepsilon_n \ket*{\phi^{(m)}_n}
    = \sum_{m'} (
        H^{(m - m')} - m \hbar \omega \delta_{m m'}
    ) \ket*{\phi^{(m')}_{n}}.
    \label{eq:floquet-ham-eigen}
\end{equation}
Note that this equation is an eigenvalue problem in the \emph{extended Hilbert space}:
the component $\braket*{i}{\phi_n^{(m)}}$ is labeled by both $m$ and $i$.
The eigenvalues $\varepsilon_n$ are known as the \emph{Floquet quasienergy} of 
the \emph{Floquet quasi-stationary state (or quasi-eigenstate)} $\ket*{\Psi_n(t)}$,
which can be obtained by diagonalizing 
\begin{equation}
    H_{\text{Floquet}, mm'} = H^{(m - m')} - m \hbar \omega \delta_{m m'}.
    \label{eq:floquet-ham}
\end{equation}

\eqref{eq:floquet-ham} looks like a light-matter interaction Hamiltonian 
written in operator form for the matter part 
and in the Fock basis for the light part (labeled by $m$ and $m'$, which look like photon numbers);
when a cutoff on $m$ is applied, 
it appears to be an effective Hamiltonian where photon degrees of freedom 
have been integrated out.
However, unlike conventional effective Hamiltonians
whose eigenstates can in principle be obtained by 
applying a projection operator on a subset of eigenstates of the full Hamiltonian,
eigenstates of \eqref{eq:floquet-ham} 
\emph{do not} correspond to any eigenstate of 
the full Hamiltonian e.g. \eqref{eq:full-light-matter}:
the light part is in a coherent state,
which is far from any eigenstate of the linear electromagnetic Hamiltonian $\hbar \omega (n + \frac{1}{2})$.
Instead, Floquet formalisms is to be understood in a more generic framework of non-equilibrium physics:
Floquet Green function can be calculated within the Keldysh formalism,
and \eqref{eq:floquet-ham} can be understood as the 
non-equilibrium self-energy \cite{lubatsch2019evolution,aoki2014nonequilibrium}
and therefore is not necessarily an equilibrium effective Hamiltonian.

Finally, we go on to characterize the structure of the solutions of  \eqref{eq:floquet-ham-eigen}.
The difference between the Floquet effective Hamiltonian \eqref{eq:floquet-ham}
and conventional, ``equilibrium'' effective Hamiltonians can also be seen  
by the structure of its eigenstates, 
because the dimension of \eqref{eq:floquet-ham}, fully expanded into its matrix elements,
is the number of the values of $m$ considered 
times the dimension of the matter Hilbert space,
and thus \eqref{eq:floquet-ham}'s eigenstates are overcomplete.
We can actually point out where overcompletion appears:
note that if $\varepsilon_n$ satisfies \eqref{eq:floquet-wave-function},
then so does $\varepsilon_n + m \hbar \omega$.
We can directly prove that if $(\varepsilon, \{\ket*{\phi^{(m)}}\}_m)$ 
is a solution of \eqref{eq:floquet-ham-eigen},
then so is $(\varepsilon + \hbar m' \omega, \{\ket*{\phi^{(m + m')}}\}_m)$.
This fact can also be proved by noticing that  
\begin{equation}
    \ket*{\psi_n(t)} = \ee^{- \ii \varepsilon_n t / \hbar} \sum_m \ee^{- \ii m \omega t} \ket*{\phi_n^{(m)}}
    = \ee^{- \ii (\varepsilon + \hbar m' \omega) t / \hbar}
    \sum_m \ee^{- \ii m \omega t} \ket*{\phi_n^{(m + m')}}.
\end{equation}
Therefore, the spectrum of \eqref{eq:floquet-ham} has redundancy. 
There however is no redundant information in $\{\ket*{\phi_n^{(m)}}\}$,
because $\braket*{i}{\phi_n^{(m)}}$ is the 
$m \omega$-frequency component of $\ket*{\Phi_n(t)}$
projected on the basis vector $\ket*{i}$,
and every $\ket*{\phi_n^{(m)}}$ is needed to determine $\ket*{\Phi_n(t)}$
and thus $\ket*{\psi_n(t)}$.

Although there is no generic orthogonal relation pertaining to $\{\ket*{\psi_n(t)}\}$,
after time averaging an orthogonal relation can be obtained.
From the fact that \eqref{eq:floquet-ham} is Hermitian, we have 
\begin{equation}
    \sum_m \braket*{\phi_n^{(m)}}{\psi_{n'}^{(m)}} = \delta_{nn'},
\end{equation}
and therefore the time average of $\braket*{\psi_n(t)}{\psi_{n'}(t)}$ is 
\begin{equation}
    \begin{aligned}
        \overline{\braket*{\psi_n(t)}{\psi_{n'}(t)}} &= 
        \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} \dd{t} 
        \ee^{\ii (\varepsilon_n - \varepsilon_{n'}) t}
        \sum_{m, m'}  \ee^{\ii (m - m') t}
        \braket*{\phi_n^{(m)}}{\phi_{n'}^{(m')}} \\
        &= \sum_{m, m'} \delta_{\varepsilon_n, \varepsilon_{n'}}
        \delta_{mm'} \braket*{\phi_n^{(m)}}{\phi_{n'}^{(m')}}  \\
        &= \delta_{\varepsilon_n, \varepsilon_{n'}} \sum_{m} \braket*{\phi_n^{(m)}}{\psi_{n'}^{(m)}}
        = \delta_{nn'}.
    \end{aligned}
    \label{eq:orthogonal}
\end{equation}
Therefore, after time averaging, the Floquet quasi-stationary states 
are orthogonal to each other.

In conclusion, a Floquet system is an inherently non-equilibrium system,
but a set of quasi-eigenstates $\{ \ket*{\psi_n} \}$
with orthogonality relation \eqref{eq:orthogonal} can still be well defined,
the number of which is the same as 
the dimension of the Hilbert space 
(\emph{not} the extended Hilbert space).
The quasi-eigenstates and their quasi-energies can be found by solving 
the eigenvalue problem \eqref{eq:floquet-ham-eigen} in the extended Hilbert space
(\emph{not} the Hilbert space) 
and then putting the resulting $(\varepsilon_n, \{\phi_n^{(m)}\})$
into \eqref{eq:floquet-wave-function}.
For each quasi-eigenstate,
we have countable infinite quasi-energies,
the difference between the nearest two being $\hbar \omega$;
thus all distinct Floquet quasi-eigenstates can be indexed 
by quasi-energies that are within one ``Floquet-Brillouin zone''.

\section{Floquet formalisms compared with conventional treatment of periodic driving}

Periodic driving can also be construed in alternative approaches.
In this section we review some of them and discuss the advantage 
of introducing Floquet quasienergies and quasi-stationary states.
First, periodic driving is in principle well captured by time-dependent perturbation theory.
TODO: 

In optics, the rotational wave approximation (RWA) is also used when the detuning is small.

\section{Floquet effects in spectroscopy}

Ordinary \ac{arpes} spectra 
\begin{equation}
    I(\vb{k}, \omega) \propto \sum_{\vb{k}', c} 
    \abs*{M_{\vb{k} \vb{k}'}^{fc}}^2 \delta(\omega - \epsilon_{c \vb{k}'}) f(\omega),
    \label{eq:spectral-arpes}
\end{equation}
where $(f, \vb{k})$ is the out-coming electron mode, 
$(c, \vb{k}')$ is an electronic mode within the material 
and $f(\omega)$ is the Fermi-Dirac distribution,
are usually calculated by Fermi golden rule \cite{sobota2021angle};
when the starting state is non-equilibrium, 
the spectral function should be replaced by the lesser Green function 
and we get \cite{freericks2009theoretical,rustagi2018photoemission,chan2023giant} TODO: cross term where $c \neq c'$
\begin{equation}
    I(t, \vb{k}, \omega) \propto - \ii \int_{t_0}^t \dd{t_1} \int_{t_0}^t \dd{t_2} s(t_1) s(t_2) 
    \abs*{M_{\vb{k} \vb{k}'}^{fc}}^2 G^<_{\vb{k}'}(t_2, t_1) \ee^{\ii \omega (t_1 - t_2)} ,
    \label{eq:lesser-arpes}
\end{equation}
where $s(t)$ is the envelope of the probe pulse.
When the system indeed stays in equilibrium, 
and the probe pulse is long enough and 
hence $s(t)$ can be seen as a constant and $t \to \infty$, 
it can be directly verified that \eqref{eq:lesser-arpes} reduces to \eqref{eq:spectral-arpes}.
When the system is Floquet-driven, \eqref{eq:spectral-arpes} is not correct, 
but in the long probe pulse limit, \eqref{eq:lesser-arpes} becomes 
\begin{equation}
    I(t \to \infty, \vb{k}, \omega) \propto
    - \ii \int \dd{\bar{t}} \int \dd{\tau} G^<_{\vb{k}'}(\bar{t}, \bar{t} + \tau) \ee^{\ii \omega \tau} 
    = - \ii \expval{\int \dd{\tau} \ee^{\ii \omega \tau}
    G^<_{\vb{k}'}(\bar{t}, \bar{t} + \tau)}_{\bar{t}},
\end{equation} 
or in other words, the time-averaged occupied density of states.
This, then, can be determined by the Floquet quasi-stationary states and quasienergies.
We have \cite{rudner2020floquet}
\begin{equation}
    \bar{\rho}(\Omega) = - \ii \expval{\int \dd{\tau} \ee^{\ii \omega \tau} G^<_{\vb{k}}} 
    =\sum_{n \vb{k}, m} A_{n \vb{k}}^{(m)} \delta\left(\varepsilon_{n \vb{k}} +m \omega-\Omega\right), 
    \quad A_{n \vb{k}}^{(m)}= \braket*{\phi_{n \vb{k}}^{(m)}}{\phi_{n \vb{k}}^{(m)}}.
\end{equation}
The ARPES spectrum of a Floquet-driven band structure, therefore, 
is given by all Floquet bands weighted by the magnitude of $\ket*{\phi_{n \vb{k}}^{(m)}}$.

TODO: But then what about non-diagonal terms in Floquet Hamiltonian? Note that $n \neq n'$ are not considered above.

Interestingly, it is possible to use light to stimulate 
some long-lived degrees of freedom in a solid 
and let it drive the rest of the system, 
which sometimes is known as ``self-driving''.
In \cite{chan2023giant}, it is demonstrated that 
Floquet renormalization of the band structure can be observed 
even long after the pump is turned off, 
which is due to the existence of excitons previously created by the pump.
TODO: exciton captured by electron self-energy; 
exciton creates $\Sigma_{cv}$

In principle there are indefinite exciton-driven Floquet quasi-band ARPES signatures,
but since the signatures are weighted by $A^{(m)}_{n \vb{k}}$,
which are usually small when $\abs*{m}$ is large, 
usually only the $m=1$ Floquet signatures are important,
which can be calculated from Fermi golden rule in a more conventional way.

TODO: can band renormalization be captured by Fermi golden rule?

\printbibliography

\end{document}